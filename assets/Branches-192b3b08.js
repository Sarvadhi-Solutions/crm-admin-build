import{a as q,r as u,j as e}from"./index-23438ae7.js";import"./Alert-2ee7f6ed.js";import"./index-0f4eb207.js";import"./Badge-d8b21e8e.js";import{B as H}from"./Button-6151e38d.js";import"./RangeCalendar-241f4707.js";import"./Card-f69b93fe.js";import"./index-58319d48.js";import"./index-88435c39.js";import"./Dialog-dadf7059.js";import"./Drawer-91500bd4.js";import"./index-0225ab21.js";import{F as Q,a as p}from"./FormItem-81d96ba6.js";import"./toString-43f8d781.js";import{I as b}from"./Input-56c39592.js";import{I as R}from"./index-bd0ae7e4.js";import"./index-e115d598.js";import"./index-3e7750c4.js";import{t as k,N as E}from"./toast-dce6e6a9.js";import"./Pagination-d8250938.js";import"./Progress-8255b424.js";import"./index-9b7c753a.js";import"./ScrollBar-85bd4202.js";import"./index-b55caea5.js";import{S as w,c as M}from"./Select-95f0cb48.js";import"./Skeleton-a15387d3.js";import"./index-be5eba8a.js";import{S as C}from"./Switcher-4e23edc7.js";import"./index-bc82ff52.js";import"./index-05c2f418.js";import"./Tag-1f728080.js";import"./index-6e98d156.js";import"./index-c9a86e91.js";import"./Tooltip-7ead0d1d.js";import"./Upload-2033c099.js";import{c as S}from"./countries.constant-5369f7df.js";import{g as P,c as D}from"./index-fd08ba5b.js";import{F as V,a as T,b as h}from"./formik.esm-88d9cb0a.js";import{N as z}from"./react-number-format.es-d919bdee.js";import{c as G,a as x,f as L}from"./index.esm-c939c475.js";import{u as W}from"./index-21a06146.js";import"./useTimeout-6cd1f175.js";import"./index.esm-abf109fc.js";import"./CloseButton-f525b5b0.js";import"./StatusIcon-5855f3ff.js";import"./Views-9f1346e4.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-b36b44b8.js";import"./cloneDeep-1b943ce1.js";import"./_MapCache-68b4b736.js";import"./_getPrototype-4ab4f81a.js";import"./_baseIsEqual-700638f4.js";import"./get-f6970d5e.js";import"./useRootClose-46c6f66d.js";import"./usePopper-c0ab2d6a.js";import"./TimeInput-4ee6bd8b.js";import"./useUniqueId-26473376.js";import"./useDidUpdate-2e5d793b.js";import"./index-3ba2d1e2.js";import"./useUncertainRef-988c2c0d.js";import"./isNil-3b5b1f9c.js";import"./index-cf95bcca.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-24b37abb.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-89eeae84.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-9ad427af.js";import"./index.esm-d8984845.js";import"./index.esm-755a26e3.js";import"./index.esm-c3615cb9.js";import"./CrmService-adaf9185.js";import"./AdaptableCard-2ca25d0f.js";import"./useThemeClass-ff7f30ed.js";import"./AccountServices-1084d120.js";const{SingleValue:J}=M,K=t=>e.jsx(b,{...t,value:t.field.value}),X=({onValueChange:t,...n})=>e.jsx(z,{customInput:b,type:"text",autoComplete:"off",onValueChange:t,...n}),Y=({innerProps:t,data:n,isSelected:j})=>e.jsx("div",{className:`cursor-pointer flex items-center justify-between p-2 ${j?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...t,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{children:["(",n.value,") ",n.dialCode]})})}),m=[],Z=t=>{const n=t.getValue()[0];return e.jsx(J,{...t,children:n&&e.jsx("span",{children:n.dialCode})})},_=G().shape({branchName:x().required("Details are required"),addressInformation:x(),isHeadQuarter:L(),branchOwnerId:x().required("This field is required").test("is-valid-contact","Invalid contact selected",t=>!!m.find(n=>n.value==t)),contact:x().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",t=>!isNaN(t)).test("is-ten-digits","Contact must be exactly 10 digits",t=>{if(t){const n=Number(t);return/^\d{10}$/.test(n.toString())}return!0}).test("is-ten-digits","Contact number cannot start with 0",t=>t?!t.startsWith("0"):!0)}),Nr=({data:t={branchName:"",addressInformation:"",isHeadQuarter:!1,branchOwnerId:"",contact:"",dialCode:""},onNextChange:n,currentStepStatus:j})=>{const g=q(),[N,B]=u.useState([]),[O,F]=u.useState(!1),f=u.useRef(null),v=u.useCallback(async()=>{const r=await g(P());B(r==null?void 0:r.payload.data)},[g]);m.length=0,N==null||N.forEach(r=>{m==null||m.push({label:`${r==null?void 0:r.firstName} ${r==null?void 0:r.lastName}`,value:r.id})}),u.useEffect(()=>{v()},[v]);const I=W(r=>r.auth.user),A=async(r,s)=>{var d,o,y;const i=await g(D(r));let l="",c="",a="";(d=i==null?void 0:i.payload)!=null&&d.success?(l="Successfully Added",c=(o=i==null?void 0:i.payload)==null?void 0:o.message,a="success",n==null||n(r,"branches",s)):(l="Something went wrong !!!",c=(y=i==null?void 0:i.error)==null?void 0:y.message,a="danger"),k.push(e.jsx(E,{title:l,type:a,duration:2500,children:c}),{placement:"top-end"}),s(!1)},$=(r,s)=>{var l;let i="";r?i=I==null?void 0:I.id:i="",F(r),(l=f==null?void 0:f.current)==null||l.setFieldValue("branchOwnerId",i)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"mb-2",children:"Branches Information"}),e.jsx("p",{children:"Basic information to create a branch"})]}),e.jsx(V,{innerRef:f,initialValues:t,enableReinitialize:!0,validationSchema:_,onSubmit:(r,{setSubmitting:s})=>{s(!0),setTimeout(()=>{A(r,s)},1e3)},children:({values:r,errors:s,touched:i,isSubmitting:l,setFieldValue:c})=>e.jsx(T,{children:e.jsxs(Q,{children:[e.jsx("div",{className:"md:grid grid-cols-1 gap-4",children:e.jsx(p,{label:"Branch Name",invalid:s.branchName&&i.branchName,errorMessage:s.branchName,children:e.jsx(h,{type:"text",autoComplete:"off",name:"branchName",placeholder:"Branch Name",component:b})})}),e.jsxs("div",{className:"md:grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(p,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"form-label",style:{marginRight:"10px"},children:"Head Quarter"}),e.jsx(h,{autoComplete:"off",name:"isHeadQuarter",component:C,checked:r.isHeadQuarter,onChange:a=>{c("isHeadQuarter",a)}})]})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(p,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"form-label",style:{marginRight:"10px"},children:"Assign me as Owner"}),e.jsx(C,{onChange:$})]})})})]}),e.jsxs("div",{className:"md:grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(p,{label:"Phone Number",invalid:s.dialCode&&i.dialCode||s.contact&&i.contact,errorMessage:"Please enter your phone number",children:e.jsxs(R,{children:[e.jsx(h,{name:"dialCode",children:({field:a,form:d})=>e.jsx(w,{className:"min-w-[130px]",placeholder:"Dial Code",components:{Option:Y,SingleValue:Z},field:a,form:d,options:S,value:S.find(o=>o.value===r.dialCode),onChange:o=>{c(a.name,o==null?void 0:o.value)}})}),e.jsx(h,{name:"contact",children:({field:a,form:d})=>e.jsx(X,{form:d,field:a,customInput:K,placeholder:"Phone Number",onValueChange:o=>{c(a.name,o.value)}})})]})})}),e.jsx("div",{className:"col-span-1",children:!O&&e.jsx(p,{label:"Branch Owner",children:e.jsx(w,{isClearable:!0,name:"branchOwnerId",placeholder:"Branch Owner",options:m,id:"branchOwnerId",value:m==null?void 0:m.find(a=>(a==null?void 0:a.value)===(r==null?void 0:r.branchOwnerId)),onChange:a=>{c("branchOwnerId",a==null?void 0:a.value)}})})})]}),e.jsx(p,{label:"Address",invalid:s.addressInformation&&i.addressInformation,errorMessage:s.addressInformation,children:e.jsx(h,{textArea:!0,type:"text",autoComplete:"off",name:"addressInformation",placeholder:"Address",component:b})}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(H,{loading:l,variant:"solid",type:"submit",children:j==="complete"?"Save":"Next"})})]})})})]})};export{Nr as default,m as usersOptions};
