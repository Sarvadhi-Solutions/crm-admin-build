import{r as g,a as h,j as e,ai as P,ar as U}from"./index-b09faefa.js";import{A as W}from"./AdaptableCard-9a87f3ff.js";import{D as G}from"./DataTable-ca158282.js";import{u as p,s as V,a as N,t as v,d as _,g as S,b as I,c as w,e as E,f as F,r as J}from"./AdditionalTag-ee3a6411.js";import{u as L}from"./useThemeClass-ee0e86a7.js";import{B as y}from"./Button-3bdf4581.js";import{D as Q}from"./Drawer-1ea16c4a.js";import{C as X}from"./CustomerForm-a6c38c1c.js";import{c as b}from"./cloneDeep-de9ec659.js";import{T as Y}from"./TagsList-a530de63.js";import{u as D}from"./checkEditUpdate-cffc7ae3.js";import{t as A,N as k}from"./toast-2c9f9fcf.js";import{C as Z}from"./ConfirmDialog-1096cdd6.js";import{T as j}from"./TextTruncate-222d0204.js";import{I as ee}from"./Input-8c731b0c.js";import{b as te,d as se,m as oe,A as re}from"./index.esm-2c67faf2.js";import{d as ae}from"./debounce-24a9e0ff.js";import{S as ne,c as ie}from"./Select-71db8857.js";import{B as O}from"./Badge-d1515062.js";import{C as le}from"./Card-33431fc8.js";import{A as ce}from"./index-2f1f758f.js";import{M as me}from"./MediaSkeleton-c8e82dc6.js";import{N as de}from"./react-number-format.es-25924e56.js";import"./index-a157bc37.js";import"./index.esm-dbc068f5.js";import"./Pagination-d71ebe95.js";import"./index-c173cf47.js";import"./_Uint8Array-b1a93c95.js";import"./_MapCache-a97510fd.js";import"./Views-57e82c67.js";import"./_baseIsEqual-77ddc906.js";import"./get-263a9377.js";import"./toString-9cef9a7f.js";import"./TableRowSkeleton-a83d3c9d.js";import"./Skeleton-5bf82d8e.js";import"./index-e08096fb.js";import"./formik.esm-93e44345.js";import"./Alert-a515d81f.js";import"./useTimeout-68d097ea.js";import"./CloseButton-13cd4a8c.js";import"./StatusIcon-b02f9bab.js";import"./Calendar-6959847d.js";import"./useControllableState-5d01e6b9.js";import"./index-82bb2b50.js";import"./useMergeRef-788c4cb0.js";import"./useRootClose-3c97a09c.js";import"./usePopper-29fe3cd5.js";import"./RangeCalendar-b4e9e88f.js";import"./TimeInput-23ce06d7.js";import"./useUniqueId-6d806f5c.js";import"./useDidUpdate-ec3bfb81.js";import"./Dialog-a2bd00be.js";import"./index-8c214619.js";import"./index-96409d01.js";import"./useUncertainRef-b762bd82.js";import"./isNil-f81aee01.js";import"./index-62df96f3.js";import"./chainedFunction-070f832c.js";import"./index-ae319e32.js";import"./FormItem-cdcc11d5.js";import"./context-80e77f1b.js";import"./index-c886a512.js";import"./index-056a1440.js";import"./Progress-a1e68dcb.js";import"./index-bc0f434c.js";import"./ScrollBar-a256ec53.js";import"./index-d106a35e.js";import"./index-975733af.js";import"./mapCloneElement-ef910f8e.js";import"./Switcher-e643b9c6.js";import"./index-addd5e63.js";import"./Tag-0d544e3b.js";import"./index-ba770d43.js";import"./index-dd0b5a15.js";import"./Tooltip-5b8c5fcd.js";import"./index.esm-7a963ea9.js";import"./Upload-8f332031.js";import"./index.esm-a78f5b32.js";import"./index.esm-aece8080.js";import"./CrmService-5f2f53bd.js";import"./index.esm-333232d6.js";import"./index.esm-ef7b0069.js";import"./tagAndCategory-2dd74600.js";/* empty css              */import"./_getPrototype-3540f1e6.js";import"./slicedToArray-00fbfd7c.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-f69b773e.js";import"./floating-ui.dom-bef9cea3.js";const B=g.forwardRef((s,t)=>{h();const r=p(i=>i.crmCustomers.data.selectedCustomer);p(i=>i.crmCustomers.data.customerList);const o=async i=>{};return e.jsx(X,{ref:t,customer:r,onFormSubmit:o})});B.displayName="CustomerEditContent";const ue=({onSaveClick:s,onCancel:t})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(y,{size:"sm",className:"mr-2",onClick:t,children:"Cancel"}),e.jsx(y,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),pe=()=>{const s=h(),t=p(a=>a.crmCustomers.data.drawerOpen),r=()=>{s(V()),s(N({}))},o=g.useRef(null),i=()=>{var a,l;console.log("formSubmit function called",(a=o.current)==null?void 0:a.values),(l=o.current)==null||l.submitForm()};return e.jsx(Q,{isOpen:t,closable:!1,bodyClass:"p-0",footer:e.jsx(ue,{onCancel:r,onSaveClick:i}),onClose:r,onRequestClose:r,children:e.jsx(B,{ref:o})})},Ce=()=>{const s=h(),t=p(a=>a.crmCustomers.data.deleteConfirmation),r=p(a=>a.crmCustomers.data.selectedCustomer),o=()=>{s(v(!1))},i=async()=>{var l,u,c;s(v(!1));const a=await s(_(r.id));(l=a==null?void 0:a.payload)!=null&&l.success?A.push(e.jsx(k,{title:"Successfuly Deleted",type:"success",duration:2500,children:(u=a==null?void 0:a.payload)==null?void 0:u.message}),{placement:"top-end"}):A.push(e.jsx(k,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(c=a==null?void 0:a.error)==null?void 0:c.message}),{placement:"top-end"}),await s(S()),await s(I())};return e.jsx(Z,{isOpen:t,type:"danger",title:"Delete Client",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this client? All record related to this client will be deleted as well. This action cannot be undone."})})},ge=({row:s})=>{const{textTheme:t}=L(),r=h(),o=()=>{r(E()),r(N(s))};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},he=({row:s})=>{const{textTheme:t}=L(),r=h(),o=async()=>{await r(N(s)),r(v(!0))};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold text-red-500`,onClick:o,children:"Delete"})},xe=()=>{const s=h(),t=p(m=>m.crmCustomers.data.displayedCustomersList),r=p(m=>m.crmCustomers.data.loading),o=D("clients","canModify"),i=D("clients","canDelete");p(m=>m.crmCustomers.data.filterData);const{pageIndex:a,pageSize:l,sort:u,query:c,total:x}=p(m=>m.crmCustomers.data.tableData),T=g.useCallback(()=>{s(S())},[s]);g.useEffect(()=>{T()},[T]);const f=g.useMemo(()=>({pageIndex:a,pageSize:l,sort:u,query:c,total:x}),[a,l,u,c,x]),M=g.useMemo(()=>{const m=[{header:"Clients Name",accessorKey:"clientName",cell:n=>{var d;const C=(d=n.row.original)==null?void 0:d.clientName;return e.jsx(j,{text:C,maxLength:20})}},{header:"Clients Number",accessorKey:"contactInfo",cell:n=>n.row.original.contactInfo},{header:"Address",accessorKey:"address",cell:n=>{var d;const C=(d=n.row.original)==null?void 0:d.address;return e.jsx(j,{text:C,maxLength:20})}},{header:"Billing Details",accessorKey:"billingDetails",cell:n=>{var d;const C=(d=n.row.original)==null?void 0:d.billingDetails;return e.jsx(j,{text:C,maxLength:20})}},{header:"History",accessorKey:"history",cell:n=>{var d;const C=(d=n.row.original)==null?void 0:d.history;return e.jsx(j,{text:C,maxLength:20})}},{header:"Notes",accessorKey:"notes",cell:n=>{var d;const C=(d=n.row.original)==null?void 0:d.notes;return e.jsx(j,{text:C,maxLength:20})}},{header:"Tag Name",accessorKey:"tagName",cell:n=>{var d;const C=((d=n.row.original)==null?void 0:d.tags)||[];return e.jsx(Y,{tags:C})}}];return i&&m.unshift({header:"Delete",id:"action",cell:n=>e.jsx(he,{row:n.row.original})}),o&&m.unshift({header:"Edit",id:"action",cell:n=>e.jsx(ge,{row:n.row.original})}),m},[o,i]),q=m=>{const n=b(f);n.pageIndex=m,s(w(n))},H=m=>{const n=b(f);n.pageSize=Number(m),n.pageIndex=1,s(w(n))},$=m=>{const n=b(f);n.sort=m,s(w(n))};return e.jsxs("div",{children:[e.jsx(G,{columns:M,data:t,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:r,pagingData:{total:f.total,pageIndex:f.pageIndex,pageSize:f.pageSize},onPaginationChange:q,onSelectChange:H,onSort:$}),e.jsx(pe,{}),e.jsx(Ce,{})]})},K=g.forwardRef((s,t)=>{const{onInputChange:r}=s,o=ae(i,500);function i(l){r==null||r(l)}const a=l=>{o(l.target.value)};return e.jsx(ee,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(te,{className:"text-lg"}),onChange:a})});K.displayName="CustomerTableSearch";const{Control:fe}=ie,R=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],je=({innerProps:s,label:t,data:r,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{innerClass:r.color}),e.jsx("span",{children:t})]}),o&&e.jsx(se,{className:"text-emerald-500 text-xl"})]}),be=({children:s,...t})=>{const r=t.getValue()[0];return e.jsxs(fe,{...t,children:[r&&e.jsx(O,{className:"ltr:ml-4 rtl:mr-4",innerClass:r.color}),s]})},we=()=>{const s=h(),{status:t}=p(o=>o.crmCustomers.data.filterData),r=o=>{s(F({status:o==null?void 0:o.value}))};return e.jsx(ne,{options:R,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:je,Control:be},value:R.filter(o=>o.value===t),onChange:r})},ye=()=>{const s=h(),t=g.useRef(null),r=p(c=>c.crmCustomers.data.tableData),o=D("clients","canCreate"),i=c=>{const x=b(r);x.query=c,x.pageIndex=1,typeof c=="string"&&c.length>1&&a(x),typeof c=="string"&&c.length===0&&a(x)},a=c=>{s(w(c)),s(S())},l=()=>{const c=b(r);c.query="",t.current&&(t.current.value=""),s(F({status:""})),a(c)},u=()=>{s(E())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(K,{ref:t,onInputChange:i}),e.jsx(we,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{size:"sm",className:"me-2",onClick:l,children:"Clear All"}),o&&e.jsx(y,{size:"sm",onClick:u,children:"Add New"})]})]})},z=s=>{const{icon:t,avatarClass:r,label:o,value:i,growthRate:a,loading:l}=s,u=55;return e.jsx(le,{bordered:!0,children:e.jsx(P,{loading:l,customLoader:e.jsx(me,{avatarProps:{className:"rounded",width:u,height:u}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ce,{className:r,size:u,icon:t}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(de,{thousandSeparator:!0,displayType:"text",value:i})})]})]})})})})},ve=()=>{var o,i,a,l;const s=h(),t=p(u=>u.crmCustomers.data.statisticData);console.log(t,"statisticData");const r=p(u=>u.crmCustomers.data.statisticLoading);return g.useEffect(()=>{s(I())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(z,{icon:e.jsx(oe,{}),avatarClass:"!bg-indigo-600",label:"Total Clients",value:(o=t==null?void 0:t.totalCustomers)==null?void 0:o.value,growthRate:(i=t==null?void 0:t.totalCustomers)==null?void 0:i.growShrink,loading:r}),e.jsx(z,{icon:e.jsx(re,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Clients",value:(a=t==null?void 0:t.newCustomers)==null?void 0:a.value,growthRate:(l=t==null?void 0:t.newCustomers)==null?void 0:l.growShrink,loading:r})]})};U("crmCustomers",J);const De=()=>e.jsxs(e.Fragment,{children:[e.jsx(ve,{}),e.jsxs(W,{bodyClass:"h-full",children:[e.jsx(ye,{}),e.jsx(xe,{})]})]}),ls=De;export{ls as default};
