import{am as A,an as te,ao as oe,ap as ne,r as j,j as e,a as w,aq as le}from"./index-deb31e10.js";import{T as Ee}from"./index-9d4e7a55.js";import{aC as se,aD as ie,aE as de,Z as Ge,u as He,G as Ue}from"./CrmService-d5fba30c.js";import{B as V}from"./Button-c9bc60b5.js";import{I as F}from"./Input-b4f9603d.js";import{b as re,O as ce,P as me,Q as N}from"./index.esm-7e071777.js";import{d as pe}from"./debounce-9e364d4c.js";import{c as I}from"./cloneDeep-67d59bdf.js";import{D as ue}from"./DataTable-1874c51c.js";import{u as L}from"./checkEditUpdate-163351c4.js";import{u as ge}from"./useThemeClass-be6073dc.js";import{T as fe}from"./TextTruncate-491d409f.js";import"./Alert-5f36c2a0.js";import"./index-c67702c1.js";import"./Badge-d9ae855b.js";import"./RangeCalendar-8afb665c.js";import"./Card-085ac9b2.js";import"./index-3a77fb06.js";import"./index-3c726209.js";import{D as xe}from"./Dialog-f52addba.js";import"./Drawer-d475ebcd.js";import"./index-23d0fcae.js";import{a as S}from"./FormItem-b6ea2884.js";import"./toString-e34703ad.js";import"./index-f2daafea.js";import"./index-39c1c8e6.js";import"./index-700f33d8.js";import{N as W,t as E}from"./toast-241185e8.js";import"./Pagination-a5e381f1.js";import"./Progress-a11c2f12.js";import"./index-5baf7804.js";import"./ScrollBar-a7c63350.js";import"./index-e541606c.js";import{S as ye}from"./Select-dc99a09b.js";import"./Skeleton-503ea522.js";import"./index-208bb167.js";import"./Switcher-d01b1c88.js";import"./index-5994de1d.js";import"./Tag-ea07611a.js";import"./index-d4f33a77.js";import"./index-70acf077.js";import"./Tooltip-97f81a61.js";import"./Upload-762c02a1.js";import"./Views-5dd9e85c.js";import"./chart.constant-f9507da5.js";import"./GrowShrinkTag-fa336753.js";import"./react-tooltip.min-7de9806e.js";import"./RichTextEditor-6a57c324.js";import"./SegmentItemOption-a6fce820.js";import{S as he}from"./StickyFooter-d0667857.js";import"./SvgIcon-fab1c8c3.js";import{F as Ce,a as be,b as D}from"./formik.esm-2d8f8c6a.js";import{A as je}from"./index.esm-61700a93.js";import{c as we,a as M}from"./index.esm-a41489ce.js";import{I as $}from"./helper-64c17a1c.js";import{G as Te}from"./index.esm-bd582331.js";import{C as De}from"./ConfirmDialog-0f01438c.js";import{u as Z}from"./useGetModule-72ab103a.js";const Qe="crmCustomerFields",J=A("crm/custom-fields",async({id:o,payload:t})=>{var l,n;try{return(await se(o,t)).data}catch(d){throw new Error((n=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:n.message)}}),Ze=A("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:t})=>{var l,n;try{return(await ie(o,t)).data}catch(d){throw new Error((n=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:n.message)}}),Je=A("crmCustomFields/data/deleteCustomFields",async o=>{var t,l;try{return await de(o)}catch(n){throw new Error((l=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:l.message)}}),q=A("crmCustomFields/data/getcustomFields",async o=>(await Ge(o)).data),Xe={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Ye={loading:!1,tableData:Xe,displayedCustomFields:[],customFields:[],isDialogOpen:!1,dialogMode:"Add",ModuleId:[],selectedCustomField:null,deleteConfirmation:!1},ke=te({name:`${Qe}/state`,initialState:Ye,reducers:{setTableData:(o,t)=>{o.tableData=t.payload;const l=o.customFields.filter(n=>n.name.toLowerCase().includes(t.payload.query.toLowerCase()));o.displayedCustomFields=l.slice(t.payload.pageSize*(t.payload.pageIndex-1),t.payload.pageSize*t.payload.pageIndex)},setSelectedCustomField:(o,t)=>{o.selectedCustomField=t.payload},setDialogToggle:(o,t)=>{o.isDialogOpen=t.payload},setDialogMode:(o,t)=>{o.dialogMode=t.payload},toggleDeleteConfirmation:(o,t)=>{o.deleteConfirmation=t.payload},setLoading:(o,t)=>{o.loading=t.payload},setModule:(o,t)=>{o.ModuleId=t.payload}},extraReducers:o=>{o.addCase(J.fulfilled,(t,l)=>{t.loading=!1}).addCase(J.pending,t=>{t.loading=!0}).addCase(q.fulfilled,(t,l)=>{var n;t.customFields=l==null?void 0:l.payload.data,t.tableData.total=(n=l.payload.data)==null?void 0:n.length,t.displayedCustomFields=l==null?void 0:l.payload.data.slice(0,10),t.loading=!1}).addCase(q.pending,t=>{t.loading=!0})}}),{setModule:ve,setLoading:Fe,setTableData:H,setDialogToggle:_,setDialogMode:Le,setSelectedCustomField:Ne,toggleDeleteConfirmation:X}=ke.actions,ea=ke.reducer,aa=oe({data:ea}),z=ne,$e=j.forwardRef((o,t)=>{const{onInputChange:l}=o,n=pe(d,500);function d(i){l==null||l(i)}const p=i=>{n(i.target.value)};return e.jsx(F,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(re,{className:"text-lg"}),onChange:p})});$e.displayName="CFContactTableSearch";const ta=()=>{const o=w(),t=j.useRef(null),{ModuleId:l,tableData:n}=z(i=>{var r;return(r=i==null?void 0:i.crmCustomFields)==null?void 0:r.data}),d=i=>{const r=I(n);r.query=i,r.pageIndex=1,typeof i=="string"&&i.length>1&&p(r),typeof i=="string"&&i.length===0&&p(r)},p=i=>{o(i?H(i):q(l))};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx($e,{ref:t,onInputChange:d})}),e.jsx("div",{className:"mb-4",children:e.jsx(V,{size:"sm",onClick:()=>{o(_(!0)),o(Le("Add"))},children:"Add New"})})]})},oa=()=>{const o=w(),t=L("roles","canModify"),l=L("roles","canDelete"),{pageIndex:n,pageSize:d,sort:p,query:i,total:r}=z(m=>m.crmCustomFields.data.tableData),{loading:h,displayedCustomFields:u}=z(m=>{var s;return(s=m==null?void 0:m.crmCustomFields)==null?void 0:s.data}),a=({row:m})=>{const s=w();ge();const b=()=>{s(Ne(m)),s(_(!0)),s(Le("Edit"))},C=async()=>{await s(Ne(m)),s(X(!0))};return e.jsxs("div",{className:"flex justify-start text-base",children:[e.jsx("button",{className:"circle items-center  cursor-pointer hover:text-indigo-500",onClick:b,children:e.jsx(ce,{})}),e.jsx("button",{className:"cursor-pointer hover:text-red-500 mx-1 circle items-center",onClick:C,children:e.jsx(me,{})})]})},c=j.useMemo(()=>({pageIndex:n,pageSize:d,sort:p,query:i,total:r}),[n,d,p,i,r]),f=j.useMemo(()=>[{header:"Action",id:"action",cell:s=>e.jsx(a,{row:s.row.original})},{header:"Input Type",accessorKey:"inputType",cell:s=>s.row.original.inputType},{header:"Label",accessorKey:"label",cell:s=>s.row.original.label},{header:"Name",accessorKey:"name",cell:s=>s.row.original.name},{header:"Default Value",accessorKey:"defaultValue",cell:s=>{var C,T;const b=(C=s.row.original)!=null&&C.defaultValue?(T=s.row.original)==null?void 0:T.defaultValue:"-";return e.jsx(fe,{text:b,maxLength:15})}}],[t,l]),y=m=>{const s=I(c);s.pageIndex=m,o(H(s))},g=m=>{const s=I(c);s.pageSize=Number(m),s.pageIndex=1,o(H(s))},x=m=>{const s=I(c);s.sort=m,o(H(s))};return e.jsx("div",{children:e.jsx(ue,{columns:f,data:u,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:h,pagingData:{total:c.total,pageIndex:c.pageIndex,pageSize:c.pageSize},onPaginationChange:y,onSelectChange:g,onSort:x})})},qe=j.forwardRef((o,t)=>{const l=w(),{selectedCustomField:n,dialogMode:d,ModuleId:p}=z(u=>{var a;return(a=u==null?void 0:u.crmCustomFields)==null?void 0:a.data}),i=()=>{l(_(!1))},r=async(u,a,c,f,y)=>{var C,T,k;const g={inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue},x=await f(u==="Add"?J({id:p,payload:g}):Ze({CustomFieldsId:c==null?void 0:c.id,updatedData:{inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue}}));let m="",s="",b="danger";(C=x==null?void 0:x.payload)!=null&&C.success?(m="Successfully Added",s=(T=x==null?void 0:x.payload)==null?void 0:T.message,b="success",f(_(!1))):(m="Something went wrong !!!",s=(k=x==null?void 0:x.error)==null?void 0:k.message),y.push(e.jsx(W,{title:m,type:b,duration:2500,children:s}),{placement:"top-end"}),await f(q(p))},h=we().shape({inputType:M().required("Input Type is required"),label:M().required("Label is required"),name:M().required("Field Name is required"),defaultValue:M()});return e.jsx(Ce,{innerRef:t,initialValues:{name:d==="Edit"?n==null?void 0:n.name:"",inputType:d==="Edit"?n==null?void 0:n.inputType:"",label:d==="Edit"?n==null?void 0:n.label:"",defaultValue:d==="Edit"?n==null?void 0:n.defaultValue:""},validationSchema:h,onSubmit:async(u,{setSubmitting:a})=>{d==="Add"?await r("Add",u,null,l,E):await r("Edit",u,n,l,E),a(!1)},children:({touched:u,errors:a,values:c,setFieldValue:f})=>{var y;return e.jsxs(be,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Input Type *",invalid:a.inputType&&u.inputType,errorMessage:a.inputType,children:e.jsx(D,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:ye,options:$,value:(y=$)==null?void 0:y.find(g=>(g==null?void 0:g.value)==(c==null?void 0:c.inputType)),prefix:e.jsx(Te,{className:"text-xl"}),onChange:g=>{f("inputType",g==null?void 0:g.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Label *",invalid:a.label&&u.label,errorMessage:a.label,children:e.jsx(D,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:F,prefix:e.jsx(N,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Name *",invalid:a.name&&u.name,errorMessage:a.name,children:e.jsx(D,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:F,prefix:e.jsx(N,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"DefaultValue",invalid:a.defaultValue&&u.defaultValue,errorMessage:a.defaultValue,children:c.inputType==="textArea"?e.jsx(D,{textArea:!0,type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:F,prefix:e.jsx(N,{className:"text-xl"})}):e.jsx(D,{type:c.inputType==="datetime-local"?"datetime-local":c.inputType==="number"?"number":"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:F,prefix:e.jsx(N,{className:"text-xl"})})})})]}),e.jsx(he,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(V,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:i,children:"Cancel"}),e.jsx(V,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(je,{}),children:"Save"})]})})]})}})});qe.displayName="CFContactForm";const na=()=>{const o=w(),{selectedCustomField:t,deleteConfirmation:l,ModuleId:n}=z(r=>{var h;return(h=r==null?void 0:r.crmCustomFields)==null?void 0:h.data}),d=()=>{o(X(!1))},p=(r,h,u,a)=>{var f,y,g;const c=(f=r==null?void 0:r.payload)==null?void 0:f.success;h.push(e.jsx(W,{title:c?u:a,type:c?"success":"danger",duration:2500,children:c?(y=r==null?void 0:r.payload)==null?void 0:y.message:(g=r==null?void 0:r.error)==null?void 0:g.message}),{placement:"top-end"})},i=async()=>{o(X(!1));const r=await o(Je(t==null?void 0:t.id));p(r,E,"Successfully Deleted","Something Went Wrong !!!"),await o(q(n))};return e.jsx(De,{isOpen:l,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:d,onRequestClose:d,onCancel:d,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Contact? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};le("crmCustomFields",aa);const la=()=>{const o=w(),{dialogMode:t,isDialogOpen:l}=z(p=>{var i;return(i=p.crmCustomFields)==null?void 0:i.data}),n=()=>{o(_(!1))},{getModule:d}=Z();return j.useEffect(()=>{(async()=>{try{await o(Fe(!0));const i=await d("contacts");await o(q(i)),await o(ve(i))}catch(i){await o(Fe(!1)),console.error("Error fetching module data:",i)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(ta,{}),e.jsx(oa,{}),e.jsxs(xe,{isOpen:l,onClose:n,children:[e.jsxs("h5",{className:"mb-4",children:[t==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(qe,{})]}),e.jsx(na,{})]})},sa="crmCustomerFields",Y=A("crm/custom-fields",async({id:o,payload:t})=>{var l,n;try{return(await se(o,t)).data}catch(d){throw new Error((n=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:n.message)}}),ia=A("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:t})=>{var l,n;try{return(await ie(o,t)).data}catch(d){throw new Error((n=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:n.message)}}),da=A("crmCustomFields/data/deleteCustomFields",async o=>{var t,l;try{return await de(o)}catch(n){throw new Error((l=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:l.message)}}),R=A("crmCustomFields/data/getcustomFields",async o=>{const t=await He(o);return console.log({response:t}),t.data}),ra={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ca={loading:!1,tableData:ra,displayedCustomFields:[],customFields:[],ModuleId:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},ze=te({name:`${sa}/state`,initialState:ca,reducers:{setTableData:(o,t)=>{o.tableData=t.payload;const l=o.customFields.filter(n=>n.name.toLowerCase().includes(t.payload.query.toLowerCase()));o.displayedCustomFields=l.slice(t.payload.pageSize*(t.payload.pageIndex-1),t.payload.pageSize*t.payload.pageIndex)},setSelectedCustomField:(o,t)=>{o.selectedCustomField=t.payload},setDialogToggle:(o,t)=>{o.isDialogOpen=t.payload},setDialogMode:(o,t)=>{o.dialogMode=t.payload},toggleDeleteConfirmation:(o,t)=>{o.deleteConfirmation=t.payload},setLoading:(o,t)=>{o.loading=t.payload},setModule:(o,t)=>{o.ModuleId=t.payload}},extraReducers:o=>{o.addCase(Y.fulfilled,(t,l)=>{t.loading=!1}).addCase(Y.pending,t=>{t.loading=!0}).addCase(R.fulfilled,(t,l)=>{var n;t.customFields=l==null?void 0:l.payload.data,t.tableData.total=(n=l.payload.data)==null?void 0:n.length,t.displayedCustomFields=l==null?void 0:l.payload.data.slice(0,10),t.loading=!1}).addCase(R.pending,t=>{t.loading=!0})}}),{setModule:ma,setLoading:Se,setTableData:U,setDialogToggle:B,setDialogMode:Re,setSelectedCustomField:Me,toggleDeleteConfirmation:v}=ze.actions,pa=ze.reducer,ua=oe({data:pa}),K=ne,Ke=j.forwardRef((o,t)=>{const{onInputChange:l}=o,n=pe(d,500);function d(i){l==null||l(i)}const p=i=>{n(i.target.value)};return e.jsx(F,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(re,{className:"text-lg"}),onChange:p})});Ke.displayName="CFLeadTableSearch";const ga=()=>{const o=w(),t=j.useRef(null),{tableData:l,ModuleId:n}=K(i=>i.crmCustomFields.data),d=i=>{const r=I(l);r.query=i,r.pageIndex=1,typeof i=="string"&&i.length>1&&p(r),typeof i=="string"&&i.length===0&&p(r)},p=i=>{o(i?U(i):R(n))};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(Ke,{ref:t,onInputChange:d})}),e.jsx("div",{className:"mb-4",children:e.jsx(V,{size:"sm",onClick:()=>{o(B(!0)),o(Re("Add"))},children:"Add New"})})]})},fa=()=>{const o=w(),t=L("roles","canModify"),l=L("roles","canDelete"),{pageIndex:n,pageSize:d,sort:p,query:i,total:r}=K(m=>m.crmCustomFields.data.tableData),{displayedCustomFields:h,loading:u}=K(m=>m.crmCustomFields.data),a=({row:m})=>{const s=w();ge();const b=()=>{s(Me(m)),s(B(!0)),s(Re("Edit"))},C=async()=>{await s(Me(m)),s(v(!0))};return e.jsxs("div",{className:"flex justify-start text-base",children:[e.jsx("button",{className:"circle items-center  cursor-pointer hover:text-indigo-500",onClick:b,children:e.jsx(ce,{})}),e.jsx("button",{className:"cursor-pointer hover:text-red-500 mx-1 circle items-center",onClick:C,children:e.jsx(me,{})})]})},c=j.useMemo(()=>({pageIndex:n,pageSize:d,sort:p,query:i,total:r}),[n,d,p,i,r]),f=j.useMemo(()=>[{header:"Action",id:"action",cell:s=>e.jsx(a,{row:s.row.original})},{header:"Input Type",accessorKey:"inputType",cell:s=>s.row.original.inputType},{header:"Label",accessorKey:"label",cell:s=>s.row.original.label},{header:"Name",accessorKey:"name",cell:s=>s.row.original.name},{header:"Default Value",accessorKey:"defaultValue",cell:s=>{var C,T;const b=(C=s.row.original)!=null&&C.defaultValue?(T=s.row.original)==null?void 0:T.defaultValue:"-";return e.jsx(fe,{text:b,maxLength:15})}}],[t,l]),y=m=>{const s=I(c);s.pageIndex=m,o(U(s))},g=m=>{const s=I(c);s.pageSize=Number(m),s.pageIndex=1,o(U(s))},x=m=>{const s=I(c);s.sort=m,o(U(s))};return e.jsx("div",{children:e.jsx(ue,{columns:f,data:h,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:u,pagingData:{total:c.total,pageIndex:c.pageIndex,pageSize:c.pageSize},onPaginationChange:y,onSelectChange:g,onSort:x})})},Oe=j.forwardRef((o,t)=>{const l=w(),{selectedCustomField:n,ModuleId:d,dialogMode:p}=K(u=>{var a;return(a=u==null?void 0:u.crmCustomFields)==null?void 0:a.data}),i=()=>{l(B(!1))},r=async(u,a,c,f,y)=>{var C,T,k;const g={inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue},x=await f(u==="Add"?Y({id:d,payload:g}):ia({CustomFieldsId:c==null?void 0:c.id,updatedData:{inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue}}));let m="",s="",b="danger";(C=x==null?void 0:x.payload)!=null&&C.success?(m="Successfully Added",s=(T=x==null?void 0:x.payload)==null?void 0:T.message,b="success",f(B(!1))):(m="Something went wrong !!!",s=(k=x==null?void 0:x.error)==null?void 0:k.message),y.push(e.jsx(W,{title:m,type:b,duration:2500,children:s}),{placement:"top-end"}),await f(R(d))},h=we().shape({inputType:M().required("Input Type is required"),label:M().required("Label is required"),name:M().required("Field Name is required"),defaultValue:M()});return e.jsx(Ce,{innerRef:t,initialValues:{name:p==="Edit"?n==null?void 0:n.name:"",inputType:p==="Edit"?n==null?void 0:n.inputType:"",label:p==="Edit"?n==null?void 0:n.label:"",defaultValue:p==="Edit"?n==null?void 0:n.defaultValue:""},validationSchema:h,onSubmit:async(u,{setSubmitting:a})=>{p==="Add"?await r("Add",u,null,l,E):await r("Edit",u,n,l,E),a(!1)},children:({touched:u,errors:a,values:c,setFieldValue:f})=>{var y;return e.jsxs(be,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Input Type *",invalid:a.inputType&&u.inputType,errorMessage:a.inputType,children:e.jsx(D,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:ye,options:$,value:(y=$)==null?void 0:y.find(g=>(g==null?void 0:g.value)==(c==null?void 0:c.inputType)),prefix:e.jsx(Te,{className:"text-xl"}),onChange:g=>{f("inputType",g==null?void 0:g.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Label *",invalid:a.label&&u.label,errorMessage:a.label,children:e.jsx(D,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:F,prefix:e.jsx(N,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Name *",invalid:a.name&&u.name,errorMessage:a.name,children:e.jsx(D,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:F,prefix:e.jsx(N,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"DefaultValue",invalid:a.defaultValue&&u.defaultValue,errorMessage:a.defaultValue,children:c.inputType==="textArea"?e.jsx(D,{textArea:!0,type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:F,prefix:e.jsx(N,{className:"text-xl"})}):e.jsx(D,{type:c.inputType==="datetime-local"?"datetime-local":c.inputType==="number"?"number":"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:F,prefix:e.jsx(N,{className:"text-xl"})})})})]}),e.jsx(he,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(V,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:i,children:"Cancel"}),e.jsx(V,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(je,{}),children:"Save"})]})})]})}})});Oe.displayName="CFLeadForm";const xa=()=>{const o=w(),{selectedCustomField:t,deleteConfirmation:l,ModuleId:n}=K(r=>{var h;return(h=r==null?void 0:r.crmCustomFields)==null?void 0:h.data}),d=()=>{o(v(!1))},p=(r,h,u,a)=>{var f,y,g;const c=(f=r==null?void 0:r.payload)==null?void 0:f.success;h.push(e.jsx(W,{title:c?u:a,type:c?"success":"danger",duration:2500,children:c?(y=r==null?void 0:r.payload)==null?void 0:y.message:(g=r==null?void 0:r.error)==null?void 0:g.message}),{placement:"top-end"})},i=async()=>{o(v(!1));const r=await o(da(t==null?void 0:t.id));p(r,E,"Successfully Deleted","Something Went Wrong !!!"),await o(R(n))};return e.jsx(De,{isOpen:l,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:d,onRequestClose:d,onCancel:d,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Lead? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};le("crmCustomFields",ua);const ya=()=>{const o=w(),{dialogMode:t,isDialogOpen:l}=K(p=>{var i;return(i=p==null?void 0:p.crmCustomFields)==null?void 0:i.data}),n=()=>{o(B(!1))},{getModule:d}=Z();return j.useEffect(()=>{(async()=>{try{await o(Se(!0));const i=await d("leads");await o(R(i)),await o(ma(i))}catch(i){await o(Se(!1)),console.error("Error fetching module data:",i)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(ga,{}),e.jsx(fa,{}),e.jsxs(xe,{isOpen:l,onClose:n,children:[e.jsxs("h5",{className:"mb-4",children:[t==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(Oe,{})]}),e.jsx(xa,{})]})},ha="crmCustomerFields",ee=A("crm/custom-fields",async({id:o,payload:t})=>{var l,n;try{return(await se(o,t)).data}catch(d){throw new Error((n=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:n.message)}}),Ca=A("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:t})=>{var l,n;try{return(await ie(o,t)).data}catch(d){throw new Error((n=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:n.message)}}),ba=A("crmCustomFields/data/deleteCustomFields",async o=>{var t,l;try{return await de(o)}catch(n){throw new Error((l=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:l.message)}}),O=A("crmCustomFields/data/getcustomFields",async o=>(await Ue(o)).data),ja={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},wa={loading:!1,tableData:ja,displayedCustomFields:[],customFields:[],ModuleId:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},Pe=te({name:`${ha}/state`,initialState:wa,reducers:{setTableData:(o,t)=>{o.tableData=t.payload;const l=o.customFields.filter(n=>n.name.toLowerCase().includes(t.payload.query.toLowerCase()));o.displayedCustomFields=l.slice(t.payload.pageSize*(t.payload.pageIndex-1),t.payload.pageSize*t.payload.pageIndex)},setSelectedCustomField:(o,t)=>{o.selectedCustomField=t.payload},setDialogToggle:(o,t)=>{o.isDialogOpen=t.payload},setDialogMode:(o,t)=>{o.dialogMode=t.payload},toggleDeleteConfirmation:(o,t)=>{o.deleteConfirmation=t.payload},setLoading:(o,t)=>{o.loading=t.payload},setModule:(o,t)=>{o.ModuleId=t.payload}},extraReducers:o=>{o.addCase(ee.fulfilled,(t,l)=>{t.loading=!1}).addCase(ee.pending,t=>{t.loading=!0}).addCase(O.fulfilled,(t,l)=>{var n;t.customFields=l==null?void 0:l.payload.data,t.tableData.total=(n=l.payload.data)==null?void 0:n.length,t.displayedCustomFields=l==null?void 0:l.payload.data.slice(0,10),t.loading=!1}).addCase(O.pending,t=>{t.loading=!0})}}),{setModule:Ta,setLoading:Ie,setTableData:Q,setDialogToggle:G,setDialogMode:We,setSelectedCustomField:Ae,toggleDeleteConfirmation:ae}=Pe.actions,Da=Pe.reducer,Fa=oe({data:Da}),P=ne,_e=j.forwardRef((o,t)=>{const{onInputChange:l}=o,n=pe(d,500);function d(i){l==null||l(i)}const p=i=>{n(i.target.value)};return e.jsx(F,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(re,{className:"text-lg"}),onChange:p})});_e.displayName="CFTaskTableSearch";const Na=()=>{const o=w(),t=j.useRef(null),{tableData:l,ModuleId:n}=P(i=>i.crmCustomFields.data),d=i=>{const r=I(l);r.query=i,r.pageIndex=1,typeof i=="string"&&i.length>1&&p(r),typeof i=="string"&&i.length===0&&p(r)},p=i=>{o(i?Q(i):O(n))};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(_e,{ref:t,onInputChange:d})}),e.jsx("div",{className:"mb-4",children:e.jsx(V,{size:"sm",onClick:()=>{o(G(!0)),o(We("Add"))},children:"Add New"})})]})},Sa=()=>{const o=w(),t=L("roles","canModify"),l=L("roles","canDelete"),{pageIndex:n,pageSize:d,sort:p,query:i,total:r}=P(m=>m.crmCustomFields.data.tableData),{displayedCustomFields:h,loading:u}=P(m=>m.crmCustomFields.data),a=({row:m})=>{const s=w();ge();const b=()=>{s(Ae(m)),s(G(!0)),s(We("Edit"))},C=async()=>{await s(Ae(m)),s(ae(!0))};return e.jsxs("div",{className:"flex justify-start text-base",children:[e.jsx("button",{className:"circle items-center  cursor-pointer hover:text-indigo-500",onClick:b,children:e.jsx(ce,{})}),e.jsx("button",{className:"cursor-pointer hover:text-red-500 mx-1 circle items-center",onClick:C,children:e.jsx(me,{})})]})},c=j.useMemo(()=>({pageIndex:n,pageSize:d,sort:p,query:i,total:r}),[n,d,p,i,r]),f=j.useMemo(()=>[{header:"Action",id:"action",cell:s=>e.jsx(a,{row:s.row.original})},{header:"Input Type",accessorKey:"inputType",cell:s=>s.row.original.inputType},{header:"Label",accessorKey:"label",cell:s=>s.row.original.label},{header:"Name",accessorKey:"name",cell:s=>s.row.original.name},{header:"Default Value",accessorKey:"defaultValue",cell:s=>{var C,T;const b=(C=s.row.original)!=null&&C.defaultValue?(T=s.row.original)==null?void 0:T.defaultValue:"-";return e.jsx(fe,{text:b,maxLength:15})}}],[t,l]),y=m=>{const s=I(c);s.pageIndex=m,o(Q(s))},g=m=>{const s=I(c);s.pageSize=Number(m),s.pageIndex=1,o(Q(s))},x=m=>{const s=I(c);s.sort=m,o(Q(s))};return e.jsx("div",{children:e.jsx(ue,{columns:f,data:h,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:u,pagingData:{total:c.total,pageIndex:c.pageIndex,pageSize:c.pageSize},onPaginationChange:y,onSelectChange:g,onSort:x})})},Be=j.forwardRef((o,t)=>{const l=w(),{selectedCustomField:n,dialogMode:d,ModuleId:p}=P(u=>{var a;return(a=u.crmCustomFields)==null?void 0:a.data}),i=()=>{l(G(!1))};Z();const r=async(u,a,c,f,y)=>{var C,T,k;const g={inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue},x=await f(u==="Add"?ee({id:p,payload:g}):Ca({CustomFieldsId:c==null?void 0:c.id,updatedData:{inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue}}));let m="",s="",b="danger";(C=x==null?void 0:x.payload)!=null&&C.success?(m="Successfully Added",s=(T=x==null?void 0:x.payload)==null?void 0:T.message,b="success",f(G(!1))):(m="Something went wrong !!!",s=(k=x==null?void 0:x.error)==null?void 0:k.message),y.push(e.jsx(W,{title:m,type:b,duration:2500,children:s}),{placement:"top-end"}),await f(O(p))},h=we().shape({inputType:M().required("Input Type is required"),label:M().required("Label is required"),name:M().required("Field Name is required"),defaultValue:M()});return e.jsx(Ce,{innerRef:t,initialValues:{name:d==="Edit"?n==null?void 0:n.name:"",inputType:d==="Edit"?n==null?void 0:n.inputType:"",label:d==="Edit"?n==null?void 0:n.label:"",defaultValue:d==="Edit"?n==null?void 0:n.defaultValue:""},validationSchema:h,onSubmit:async(u,{setSubmitting:a})=>{d==="Add"?await r("Add",u,null,l,E):await r("Edit",u,n,l,E),a(!1)},children:({touched:u,errors:a,values:c,setFieldValue:f})=>{var y;return e.jsxs(be,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Input Type *",invalid:a.inputType&&u.inputType,errorMessage:a.inputType,children:e.jsx(D,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:ye,options:$,value:(y=$)==null?void 0:y.find(g=>(g==null?void 0:g.value)==(c==null?void 0:c.inputType)),prefix:e.jsx(Te,{className:"text-xl"}),onChange:g=>{f("inputType",g==null?void 0:g.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Label *",invalid:a.label&&u.label,errorMessage:a.label,children:e.jsx(D,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:F,prefix:e.jsx(N,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"Name *",invalid:a.name&&u.name,errorMessage:a.name,children:e.jsx(D,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:F,prefix:e.jsx(N,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(S,{label:"DefaultValue",invalid:a.defaultValue&&u.defaultValue,errorMessage:a.defaultValue,children:c.inputType==="textArea"?e.jsx(D,{textArea:!0,type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:F,prefix:e.jsx(N,{className:"text-xl"})}):e.jsx(D,{type:c.inputType==="datetime-local"?"datetime-local":c.inputType==="number"?"number":"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:F,prefix:e.jsx(N,{className:"text-xl"})})})})]}),e.jsx(he,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(V,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:i,children:"Cancel"}),e.jsx(V,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(je,{}),children:"Save"})]})})]})}})});Be.displayName="CFTaskForm";const Ma=()=>{const o=w(),{selectedCustomField:t,deleteConfirmation:l,ModuleId:n}=P(r=>{var h;return(h=r.crmCustomFields)==null?void 0:h.data}),d=()=>{o(ae(!1))},p=(r,h,u,a)=>{var f,y,g;const c=(f=r==null?void 0:r.payload)==null?void 0:f.success;h.push(e.jsx(W,{title:c?u:a,type:c?"success":"danger",duration:2500,children:c?(y=r==null?void 0:r.payload)==null?void 0:y.message:(g=r==null?void 0:r.error)==null?void 0:g.message}),{placement:"top-end"})},i=async()=>{o(ae(!1));const r=await o(ba(t==null?void 0:t.id));p(r,E,"Successfully Deleted","Something Went Wrong !!!"),await o(O(n))};return e.jsx(De,{isOpen:l,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:d,onRequestClose:d,onCancel:d,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Task? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};le("crmCustomFields",Fa);const Ia=()=>{const o=w(),{dialogMode:t,isDialogOpen:l}=P(p=>{var i;return(i=p==null?void 0:p.crmCustomFields)==null?void 0:i.data}),n=()=>{o(G(!1))},{getModule:d}=Z();return j.useEffect(()=>{(async()=>{try{await o(Ie(!0));const i=await d("tasks");await o(O(i)),await o(Ta(i))}catch(i){await o(Ie(!1)),console.error("Error fetching module data:",i)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(Na,{}),e.jsx(Sa,{}),e.jsxs(xe,{isOpen:l,onClose:n,children:[e.jsxs("h5",{className:"mb-4",children:[t==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(Be,{})]}),e.jsx(Ma,{})]})},{TabNav:Aa,TabList:Va}=Ee,Ve={CFContact:{label:"Contact",path:"CFContact"},CFLead:{label:"Lead",path:"CFLead"},CFTask:{label:"Task",path:"CFTask"}},Ea=()=>{const[o,t]=j.useState("CFContact"),l=n=>{t(n)};return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{value:o,variant:"pill",onChange:n=>l(n),children:e.jsx(Va,{children:Object.keys(Ve).map(n=>e.jsx(Aa,{value:n,children:Ve[n].label},n))})}),e.jsx("div",{className:"py-4",children:e.jsxs(j.Suspense,{fallback:e.jsx(e.Fragment,{children:"loading..."}),children:[o==="CFContact"&&e.jsx(la,{}),o==="CFLead"&&e.jsx(ya,{}),o==="CFTask"&&e.jsx(Ia,{})]})})]})},zt=Ea;export{zt as C};
