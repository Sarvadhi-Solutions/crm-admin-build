import{a as B,r as y,j as e,ai as $,aq as S,ar as K}from"./index-7c10d2a3.js";import{m as L,C as P}from"./Views-5cb69e9a.js";import{A as U}from"./AdaptableCard-d528512e.js";import{C as M}from"./Card-4ce3f213.js";import{B as m}from"./Button-208b5861.js";import{T as z}from"./Tooltip-6aa5489c.js";import{D as C}from"./index-ddb7b536.js";import{T as F}from"./TextEllipsis-f5c4e114.js";import{U as G}from"./UsersAvatarGroup-0499f6de.js";import{D as O}from"./Dialog-ab50fc44.js";import{I as T}from"./Input-81114df0.js";import{C as I}from"./ConfirmDialog-cb7325f0.js";import{u as d,t as w,s as f,a as N,b as R,c as V,g as W,d as k,r as X}from"./index-407d18f4.js";import{c as j}from"./cloneDeep-b9fa1e05.js";import{a as J}from"./useUniqueId-ade48d2a.js";import{c as Q,ag as Y,j as Z,aO as _,X as ee,W as te}from"./index.esm-d9298b40.js";import"./context-0e2e9d1c.js";import"./usePopper-80f33697.js";import"./index.esm-db0614cf.js";import"./index-be56d80d.js";import"./useUncertainRef-4da6c90d.js";import"./isNil-d3ca72b8.js";import"./chainedFunction-070f832c.js";import"./index-8f8a0e52.js";import"./useRootClose-06442b2e.js";import"./index-e31e1427.js";import"./useMergeRef-788c4cb0.js";import"./acronym-600fd4f9.js";import"./index-72e63a8f.js";import"./CloseButton-7345a4c9.js";import"./get-5a481960.js";import"./toString-18e1007d.js";import"./_MapCache-e75dc2ce.js";import"./KnowledgeBaseService-7e0f4535.js";import"./_Uint8Array-be229bd0.js";import"./_getPrototype-2f204ca7.js";const se=({data:t})=>{const s=B(),l=y.useRef(null),n=y.useRef(null),a=d(o=>o.knowledgeBaseManageArticles.data.articleDeleteConfirmation),A=d(o=>o.knowledgeBaseManageArticles.data.categoryDeleteConfirmation),v=d(o=>o.knowledgeBaseManageArticles.data.categoryRenameDialog),x=d(o=>o.knowledgeBaseManageArticles.data.categoryAddDialog),g=d(o=>o.knowledgeBaseManageArticles.data.selected),u=()=>{s(w(!1))},D=()=>{const c=j(t).map(i=>(i.value===g.categoryValue&&(i.articles=i.articles.filter(H=>H.id!==g.id)),i));s(w(!1)),s(f(c))},p=()=>{s(N(!1))},h=()=>{const c=j(t).map(i=>(i.value===g.categoryValue&&l.current&&(i.label=l.current.value),i));s(N(!1)),s(f(c))},r=()=>{s(R(!1))},q=()=>{const c=j(t).filter(i=>i.value!==g.categoryValue);s(R(!1)),s(f(c))},b=()=>{s(V(!1))},E=()=>{const o=j(t);if(n.current){const c=[{label:n.current.value,value:J("new-category"),articles:[]},...o];s(f(c))}s(V(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(I,{isOpen:a,type:"danger",title:"Delete article",confirmButtonColor:"red-600",onClose:u,onRequestClose:u,onCancel:u,onConfirm:D,children:e.jsx("p",{children:"Are you sure you want to delete this article? This action cannot be undone."})}),e.jsx(I,{isOpen:A,type:"danger",title:"Delete category",confirmButtonColor:"red-600",onClose:r,onRequestClose:r,onCancel:r,onConfirm:q,children:e.jsx("p",{children:"Are you sure you want to delete this category? All the articles under this category will be deleted as well. All This action cannot be undone."})}),e.jsxs(O,{isOpen:v,onClose:p,onRequestClose:p,children:[e.jsx("h5",{className:"mb-4",children:"Rename Category"}),e.jsx("div",{children:e.jsx(T,{ref:l})}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(m,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:p,children:"Cancel"}),e.jsx(m,{variant:"solid",onClick:h,children:"Confirm"})]})]}),e.jsxs(O,{isOpen:x,onClose:b,onRequestClose:b,children:[e.jsx("h5",{className:"mb-4",children:"Add Category"}),e.jsx("div",{children:e.jsx(T,{ref:n})}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(m,{size:"sm",className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:b,children:"Cancel"}),e.jsx(m,{size:"sm",variant:"solid",onClick:E,children:"Add"})]})]})]})},re=({data:t})=>{var p,h;const s=B(),[l,n]=y.useState(!1),a=S(),A=()=>{n(!l)},v=r=>{a(`/app/knowledge-base/edit-article?id=${r}&categoryLabel=${t.label}&categoryValue=${t.value}`)},x=()=>{a(`/app/knowledge-base/edit-article?categoryLabel=${t.label}&categoryValue=${t.value}`)},g=r=>{s(k({id:r,categoryValue:t.value})),s(w(!0))},u=()=>{s(k({id:"",categoryValue:t.value})),s(N(!0))},D=()=>{s(k({id:"",categoryValue:t.value})),s(R(!0))};return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 cursor-pointer select-none",onClick:A,children:[e.jsx("span",{className:"text-lg",children:l?e.jsx(Q,{}):e.jsx(Y,{})}),e.jsx("h5",{children:t==null?void 0:t.label}),e.jsxs("span",{children:["(",(p=t==null?void 0:t.articles)==null?void 0:p.length,")"]})]}),e.jsx("hr",{className:"mx-3 w-full"}),e.jsxs(C,{placement:"bottom-end",renderTitle:e.jsx(m,{shape:"circle",variant:"plain",icon:e.jsx(Z,{})}),children:[e.jsx(C.Item,{eventKey:"addArticle",onClick:()=>x(),children:"Add article"}),e.jsx(C.Item,{eventKey:"rename",onClick:u,children:"Rename"}),e.jsx(C.Item,{eventKey:"delete",onClick:D,children:"Delete"})]})]}),e.jsxs(L.div,{className:"grid xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-4 mt-4",initial:{opacity:0,height:0,overflow:"hidden"},animate:{opacity:l?0:1,height:l?0:"auto"},transition:{duration:.15},children:[t.articles.length===0&&e.jsx(M,{clickable:!0,className:"group border-dashed border-2 hover:border-indigo-600",onClick:x,children:e.jsxs("div",{className:"flex flex-col justify-center items-center py-5",children:[e.jsx("div",{className:"p-4 border-2 border-dashed rounded-full border-gray-200 dark:border-gray-600 group-hover:border-indigo-600",children:e.jsx(_,{className:"text-4xl text-gray-200 dark:text-gray-600 group-hover:text-indigo-600"})}),e.jsx("p",{className:"mt-5 font-semibold",children:"Add article"})]})}),(h=t==null?void 0:t.articles)==null?void 0:h.map(r=>e.jsxs(M,{bordered:!0,children:[e.jsx("h6",{className:"truncate mb-4",children:r.title}),e.jsx("div",{className:"min-h-[60px]",children:e.jsx(F,{text:r.content.replace(/<[^>]*>?/gm,""),maxTextCount:120})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx(G,{avatarProps:{size:25},users:r.authors||[]}),e.jsxs("div",{className:"flex",children:[e.jsx(z,{title:"Delete",children:e.jsx(m,{shape:"circle",variant:"plain",size:"sm",icon:e.jsx(ee,{}),onClick:()=>g(r.id)})}),e.jsx(z,{title:"Edit",children:e.jsx(m,{shape:"circle",variant:"plain",size:"sm",icon:e.jsx(te,{}),onClick:()=>v(r.id)})})]})]})]},r.id))]})]})},oe=()=>{const t=B(),s=d(a=>a.knowledgeBaseManageArticles.data.loading),l=d(a=>a.knowledgeBaseManageArticles.data.categorizedArticles);y.useEffect(()=>{n()},[]);const n=()=>{t(W())};return e.jsxs($,{loading:s,children:[l.map(a=>e.jsx(re,{data:a},a.value)),e.jsx(se,{data:l})]})};K("knowledgeBaseManageArticles",X);const le=()=>e.jsx(P,{children:e.jsx(U,{children:e.jsx(oe,{})})}),Le=le;export{Le as default};
