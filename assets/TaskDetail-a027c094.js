var es=Object.defineProperty;var ns=(g,e,D)=>e in g?es(g,e,{enumerable:!0,configurable:!0,writable:!0,value:D}):g[e]=D;var ne=(g,e,D)=>(ns(g,typeof e!="symbol"?e+"":e,D),D),je=(g,e,D)=>{if(!e.has(g))throw TypeError("Cannot "+D)};var t=(g,e,D)=>(je(g,e,"read from private field"),D?D.call(g):e.get(g)),H=(g,e,D)=>{if(e.has(g))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(g):e.set(g,D)},ot=(g,e,D,n)=>(je(g,e,"write to private field"),n?n.call(g,D):e.set(g,D),D);var me=(g,e,D,n)=>({set _(u){ot(g,e,u,D)},get _(){return t(g,e,n)}}),Y=(g,e,D)=>(je(g,e,"access private method"),D);import{am as createAsyncThunk,an as createSlice,ao as combineReducers,ap as useSelector,a as useAppDispatch,r as reactExports,j as jsxRuntimeExports,al as useNavigate,at as getAugmentedNamespace,m as getDefaultExportFromCjs,a3 as React,aq as injectReducer,as as useParams,ah as Loading}from"./index-deb31e10.js";import{b as _pt,C as Container,i as isEmpty}from"./Views-5dd9e85c.js";import{x as apiGetCrmTaskById,g as apiCreateCrmNotes,h as apiEditCrmNotes,i as apiDeleteCrmNotes}from"./CrmService-d5fba30c.js";import{A as AdaptableCard}from"./AdaptableCard-007746c5.js";import"./Badge-d9ae855b.js";import"./chart.constant-f9507da5.js";import"./GrowShrinkTag-fa336753.js";import"./index-c67702c1.js";import{B as Button}from"./Button-c9bc60b5.js";import{D as Dialog}from"./Dialog-f52addba.js";import"./DataTable-1874c51c.js";import{D as DoubleSidedImage}from"./DoubleSidedImage-e48a6be0.js";import{I as Input}from"./Input-b4f9603d.js";import"./Skeleton-503ea522.js";import"./react-tooltip.min-7de9806e.js";import"./RichTextEditor-6a57c324.js";import"./SegmentItemOption-a6fce820.js";import"./SvgIcon-fab1c8c3.js";import"./Tooltip-97f81a61.js";import{N as NoteTimeline}from"./NoteTimeline-d73baef5.js";import"./Alert-5f36c2a0.js";import"./RangeCalendar-8afb665c.js";import{C as Card}from"./Card-085ac9b2.js";import"./index-3a77fb06.js";import"./index-3c726209.js";import"./Drawer-d475ebcd.js";import"./index-23d0fcae.js";import{F as FormContainer,a as FormItem}from"./FormItem-b6ea2884.js";import"./toString-e34703ad.js";import"./index-f2daafea.js";import"./index-39c1c8e6.js";import"./index-700f33d8.js";import{t as toast,N as Notification}from"./toast-241185e8.js";import"./Pagination-a5e381f1.js";import"./Progress-a11c2f12.js";import"./index-5baf7804.js";import"./ScrollBar-a7c63350.js";import"./index-e541606c.js";import"./Select-dc99a09b.js";import"./index-208bb167.js";import"./Switcher-d01b1c88.js";import"./index-5994de1d.js";import"./index-9d4e7a55.js";import"./Tag-ea07611a.js";import"./index-d4f33a77.js";import"./index-70acf077.js";import"./Upload-762c02a1.js";import{u as useCheckEditUpdate}from"./checkEditUpdate-163351c4.js";import{a as BiSolidMessageSquareAdd}from"./index.esm-55d0b5fd.js";import{I as IoIosArrowRoundBack}from"./index.esm-8799b183.js";import{L as LeadActivity}from"./LeadActivity-898344f1.js";import{F as Formik,a as Form,b as Field,c as FieldArray,w as warning}from"./formik.esm-2d8f8c6a.js";import{c as create$3,a as create$6}from"./index.esm-a41489ce.js";import{u as useAppSelector$1,m as modulesOptions}from"./TagCategoryDetailsForm-e8542efb.js";import{C as ConfirmDialog}from"./ConfirmDialog-0f01438c.js";import{S as StatusCapsule}from"./StatusCapsule-6a1c7833.js";import{T as TagsList}from"./TagsList-5bb7dd11.js";import{h as hooks}from"./moment-fbc5633a.js";import{P as HiOutlineTrash}from"./index.esm-7e071777.js";import{u as useAppSelector$2,b as setSelectedTask,t as toggleDeleteConfirmation$1,d as deleteTask,g as getTasks,c as getTasksStatistic}from"./index-9696b820.js";import{i as invariant}from"./tiny-invariant-dd7d57d2.js";import"./useMergeRef-788c4cb0.js";import"./index-43dec7b5.js";import"./CloseButton-359f8e10.js";import"./index-253040fb.js";import"./isNil-6cac775c.js";import"./get-08d776af.js";import"./_MapCache-e5138a4d.js";import"./floating-ui.dom-4bc0055b.js";import"./_baseIsEqual-9fca32a6.js";import"./cloneDeep-67d59bdf.js";import"./_getPrototype-4373fe9f.js";import"./useThemeClass-be6073dc.js";import"./usePopper-0c8aa062.js";import"./index.esm-ca652311.js";import"./index-a5be5469.js";import"./useTimeout-795c2b07.js";import"./StatusIcon-b64ae86b.js";import"./useControllableState-b869d145.js";import"./useRootClose-2dd50c51.js";import"./TimeInput-cf442084.js";import"./useUniqueId-675d2864.js";import"./useDidUpdate-14274714.js";import"./useUncertainRef-2aa5b3de.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-8d2f732a.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-16e47dbf.js";import"./mapCloneElement-39911d05.js";import"./index.esm-7afe35c3.js";import"./index.esm-94d88beb.js";/* empty css              */import"./index-9d7fd320.js";import"./index-e7d9ab6b.js";function _mergeNamespaces(g,e){for(var D=0;D<e.length;D++){const n=e[D];if(typeof n!="string"&&!Array.isArray(n)){for(const u in n)if(u!=="default"&&!(u in g)){const $=Object.getOwnPropertyDescriptor(n,u);$&&Object.defineProperty(g,u,$.get?$:{enumerable:!0,get:()=>n[u]})}}}return Object.freeze(Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}))}const SLICE_NAME="crmTaskDetails",initialState={loading:!0,task:{},addForm:!1,dialogMode:"",selectedNote:{},deleteConfirmation:!1,firstTimeLoad:!0},getTaskById=createAsyncThunk(`${SLICE_NAME}/getTaskById`,async g=>{var e,D;try{return await apiGetCrmTaskById(g)}catch(n){throw new Error((D=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:D.message)}}),createNotes=createAsyncThunk(`${SLICE_NAME}/getNotes`,async g=>{var e,D;try{return(await apiCreateCrmNotes(g)).data}catch(n){throw new Error((D=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:D.message)}}),editNotes=createAsyncThunk(`${SLICE_NAME}/editNotes`,async({id:g,formData:e})=>{var D,n;try{return(await apiEditCrmNotes(g,e)).data}catch(u){throw new Error((n=(D=u==null?void 0:u.response)==null?void 0:D.data)==null?void 0:n.message)}}),deleteNote=createAsyncThunk(`${SLICE_NAME}/deleteNote`,async g=>{var e,D;try{return(await apiDeleteCrmNotes(g)).data}catch(n){throw new Error((D=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:D.message)}}),taskDetailSlice=createSlice({name:`${SLICE_NAME}/state`,initialState,reducers:{toggleAddForm:(g,e)=>{g.addForm=e.payload},setSelectedNote:(g,e)=>{g.selectedNote=e.payload},setDialogMode:(g,e)=>{g.dialogMode=e.payload},toggleDeleteConfirmation:(g,e)=>{g.deleteConfirmation=e.payload},setFirstTimeLoad:(g,e)=>{g.firstTimeLoad=e.payload}},extraReducers:g=>{g.addCase(getTaskById.fulfilled,(e,D)=>{e.loading=!1,e.task=D==null?void 0:D.payload.data,e.firstTimeLoad=!1}).addCase(getTaskById.pending,e=>{e.firstTimeLoad&&(e.loading=!0)})}}),{toggleAddForm,setSelectedNote,setDialogMode,setFirstTimeLoad,toggleDeleteConfirmation}=taskDetailSlice.actions,reducers=taskDetailSlice.reducer,reducer$1=combineReducers({data:reducers}),useAppSelector=useSelector,validationSchema=create$3({notes:create$6().required("Notes is required")}),NotesAddFormTask=()=>{var rt;const g=useAppDispatch(),e=useAppSelector$1(R=>{var y;return(y=R==null?void 0:R.crmTaskDetails)==null?void 0:y.data}),[D,n]=reactExports.useState([]),u=useAppSelector$1(R=>{var y,m,O;return(O=(m=(y=R.crmTaskDetails)==null?void 0:y.data)==null?void 0:m.task)==null?void 0:O.data}),$=useAppSelector$1(R=>R.crmTaskDetails.data.addForm);modulesOptions.length=0,D==null||D.forEach(R=>{modulesOptions.push({value:R.id,label:R.moduleName})});const L=()=>{g(toggleAddForm(!1))};return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Dialog,{isOpen:$,onClose:L,children:jsxRuntimeExports.jsx(Formik,{validationSchema,initialValues:{notes:(e==null?void 0:e.dialogMode)==="Edit"?(rt=e.selectedNote)==null?void 0:rt.notes:""},onSubmit:async R=>{var k,_,w,p,E,P,C;let y="",m="",O="";const j={notes:R.notes,masterId:"6",modelDataId:u==null?void 0:u.id};if((e==null?void 0:e.dialogMode)==="Edit"&&e.selectedNote){const v=(k=e==null?void 0:e.selectedNote)==null?void 0:k.id,l=await g(editNotes({id:v,formData:j}));(_=l==null?void 0:l.payload)!=null&&_.success?(y="Successfully Edited",m=(w=l==null?void 0:l.payload)==null?void 0:w.message,O="success"):(y="Something went wrong !!!",m=(p=l==null?void 0:l.error)==null?void 0:p.message,O="danger")}else{const v=await g(createNotes(j));(E=v==null?void 0:v.payload)!=null&&E.success?(y="Successfully Added",m=(P=v==null?void 0:v.payload)==null?void 0:P.message,O="success"):(y="Something went wrong !!!",m=(C=v==null?void 0:v.error)==null?void 0:C.message,O="danger")}toast.push(jsxRuntimeExports.jsx(Notification,{title:y,type:O,duration:2500,children:m}),{placement:"top-end"}),g(toggleAddForm(!1)),g(getTaskById(u==null?void 0:u.id))},children:({touched:R,errors:y,values:m,setFieldValue:O})=>jsxRuntimeExports.jsx(Form,{children:jsxRuntimeExports.jsx(FormContainer,{layout:"inline",children:jsxRuntimeExports.jsxs("div",{className:"w-full custom-scrollbar",style:{maxHeight:"75vh"},children:[jsxRuntimeExports.jsxs("div",{className:"mb-10",children:[jsxRuntimeExports.jsxs("h5",{className:"mb-4",children:[" ",(e==null?void 0:e.dialogMode)==="Add"?"Add Notes":"Edit Notes"]}),jsxRuntimeExports.jsx(FormItem,{layout:"vertical",label:"Notes",invalid:y.notes&&R.notes,errorMessage:y.notes,children:jsxRuntimeExports.jsx(Field,{textArea:!0,placeholder:"Notes",name:"notes",component:Input})})]}),jsxRuntimeExports.jsx(FieldArray,{name:"tags",children:({form:j,remove:k,push:_})=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Button,{type:"submit",variant:"solid",children:(e==null?void 0:e.dialogMode)==="Add"?"Add":"Edit"})})})})]})})})})})})},NotesDeleteConfirmationTask=()=>{const g=useAppDispatch(),e=useAppSelector(L=>{var rt,R,y;return(y=(R=(rt=L.crmTaskDetails)==null?void 0:rt.data)==null?void 0:R.task)==null?void 0:y.data}),D=useAppSelector(L=>{var rt,R;return(R=(rt=L.crmTaskDetails)==null?void 0:rt.data)==null?void 0:R.deleteConfirmation}),n=useAppSelector(L=>{var rt;return(rt=L==null?void 0:L.crmTaskDetails)==null?void 0:rt.data}),u=()=>{g(toggleDeleteConfirmation(!1))},$=async()=>{var rt,R,y,m,O;g(toggleDeleteConfirmation(!1)),console.log("jh===d",(rt=n==null?void 0:n.selectedNote)==null?void 0:rt.id);const L=await g(deleteNote((R=n==null?void 0:n.selectedNote)==null?void 0:R.id));await g(getTaskById(e==null?void 0:e.id)),console.log("wdwd",L),(y=L==null?void 0:L.payload)!=null&&y.success?toast.push(jsxRuntimeExports.jsx(Notification,{title:"Successfuly Deleted",type:"success",duration:2500,children:(m=L==null?void 0:L.payload)==null?void 0:m.message}),{placement:"top-end"}):toast.push(jsxRuntimeExports.jsx(Notification,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(O=L==null?void 0:L.error)==null?void 0:O.message}),{placement:"top-end"}),await g(getTaskById(e==null?void 0:e.id))};return jsxRuntimeExports.jsx(ConfirmDialog,{isOpen:D,type:"danger",title:"Delete Note",confirmButtonColor:"red-600",onClose:u,onRequestClose:u,onCancel:u,onConfirm:$,children:jsxRuntimeExports.jsx("p",{children:"Are you sure you want to delete this Note? This action cannot be undone."})})},TaskProfileAction=g=>{const e=useAppSelector$2(y=>{var m,O;return(O=(m=y.crmTasks)==null?void 0:m.data)==null?void 0:O.selectedTask}),D=useAppDispatch(),[n,u]=reactExports.useState(!1),$=useNavigate(),L=()=>{u(!1)},rt=()=>{u(!0)},R=async()=>{var m,O,j;await D(setSelectedTask(g)),D(toggleDeleteConfirmation$1(!1));const y=await D(deleteTask(e.id));await D(getTasks()),(m=y==null?void 0:y.payload)!=null&&m.success?(toast.push(jsxRuntimeExports.jsx(Notification,{title:"Successfuly Deleted",type:"success",duration:2500,children:(O=y==null?void 0:y.payload)==null?void 0:O.message}),{placement:"top-end"}),$("/app/crm/tasks"),D(setSelectedTask({}))):toast.push(jsxRuntimeExports.jsx(Notification,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(j=y==null?void 0:y.error)==null?void 0:j.message}),{placement:"top-end"}),await D(getTasks()),await D(getTasksStatistic())};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{size:"xs",onClick:rt,block:!0,variant:"solid",children:jsxRuntimeExports.jsx(HiOutlineTrash,{className:"text-lg"})}),jsxRuntimeExports.jsx(ConfirmDialog,{isOpen:n,type:"danger",title:"Delete Task",confirmButtonColor:"red-600",onClose:L,onRequestClose:L,onCancel:L,onConfirm:R,children:jsxRuntimeExports.jsx("p",{children:"Are you sure you want to delete this Task? All record related to this Task will be deleted as well. This action cannot be undone."})})]})},TaskProfile=({data:g={}})=>{var e,D,n,u,$;return jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col xl:flex-row",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-5 gap-2 wrap-data",children:[(g==null?void 0:g.priority)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Priority:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:jsxRuntimeExports.jsx(StatusCapsule,{status:g==null?void 0:g.priority})})]}),(g==null?void 0:g.completionStatus)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Status:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:jsxRuntimeExports.jsx(StatusCapsule,{status:g==null?void 0:g.completionStatus})})]}),(g==null?void 0:g.dueDate)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Due Date:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:hooks(g==null?void 0:g.dueDate).format("DD MMMM YYYY")})]}),(g==null?void 0:g.title)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Title:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:g==null?void 0:g.title})]}),(g==null?void 0:g.assignedToData)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Assigned To:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:`${(e=g==null?void 0:g.assignedToData)==null?void 0:e.firstName} ${(D=g==null?void 0:g.assignedToData)==null?void 0:D.lastName}`})]}),(g==null?void 0:g.module)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Module:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:g==null?void 0:g.module})]}),(g==null?void 0:g.type)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Type:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:g==null?void 0:g.type})]}),(g==null?void 0:g.nextDateTime)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Date Time:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:hooks(g==null?void 0:g.nextDateTime).format("DD MMMM YYYY")})]}),(g==null?void 0:g.connectedLead)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Connected Lead:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:(n=g==null?void 0:g.leadModel)==null?void 0:n.title})]}),((u=g==null?void 0:g.tags)==null?void 0:u.length)>0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Tags:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:jsxRuntimeExports.jsx(TagsList,{fullDisplay:!0,tags:g==null?void 0:g.tags})})]}),(($=g==null?void 0:g.taskFields)==null?void 0:$.length)>0&&g.taskFields.map((L,rt)=>{var R;return L.value&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:[(R=L==null?void 0:L.customKey)==null?void 0:R.label,":"]}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:L.value})]},rt)})]}),jsxRuntimeExports.jsx("div",{className:"w-10",children:jsxRuntimeExports.jsx(TaskProfileAction,{data:g})})]})})};function commonjsRequire(g){throw new Error('Could not dynamically require "'+g+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,D){module.exports=e.pdfjsLib=D()})(globalThis,()=>(()=>{var __webpack_modules__=[,(g,e)=>{var Xt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=dt,e.bytesToString=W,e.createValidAbsoluteUrl=Et,e.getModificationDate=Ct,e.getUuid=Gt,e.getVerbosityLevel=X,e.info=at,e.isArrayBuffer=pt,e.isArrayEqual=Tt,e.isNodeJS=void 0,e.normalizeUnicode=zt,e.objectFromMap=ht,e.objectSize=et,e.setVerbosityLevel=S,e.shadow=wt,e.string32=tt,e.stringToBytes=it,e.stringToPDFString=gt,e.stringToUTF8String=nt,e.unreachable=V,e.utf8StringToString=st,e.warn=ct;const D=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=D;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const u=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=u;const $=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=$;const L=1.35;e.LINE_FACTOR=L;const rt=.35;e.LINE_DESCENT_FACTOR=rt;const R=rt/L;e.BASELINE_FACTOR=R;const y={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=y;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=m;const O="pdfjs_internal_editor_";e.AnnotationEditorPrefix=O;const j={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=j;const k={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=k;const _={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=_;const w={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=w;const p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=p;const E={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=E;const P={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=P;const C={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=C;const v={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=v;const l={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=l;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=d;const I={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=I;const A={O:"PageOpen",C:"PageClose"};e.PageActionEventType=A;const c={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=c;const F={NONE:0,BINARY:1};e.CMapCompressionType=F;const b={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=b;const G={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=G;let z=c.WARNINGS;function S(ft){Number.isInteger(ft)&&(z=ft)}function X(){return z}function at(ft){z>=c.INFOS&&console.log(`Info: ${ft}`)}function ct(ft){z>=c.WARNINGS&&console.log(`Warning: ${ft}`)}function V(ft){throw new Error(ft)}function dt(ft,Z){ft||V(Z)}function mt(ft){switch(ft==null?void 0:ft.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Et(ft,Z=null,K=null){if(!ft)return null;try{if(K&&typeof ft=="string"){if(K.addDefaultProtocol&&ft.startsWith("www.")){const vt=ft.match(/\./g);(vt==null?void 0:vt.length)>=2&&(ft=`http://${ft}`)}if(K.tryConvertEncoding)try{ft=nt(ft)}catch{}}const At=Z?new URL(ft,Z):new URL(ft);if(mt(At))return At}catch{}return null}function wt(ft,Z,K,At=!1){return Object.defineProperty(ft,Z,{value:K,enumerable:!At,configurable:!0,writable:!1}),K}const M=function(){function Z(K,At){this.constructor===Z&&V("Cannot initialize BaseException."),this.message=K,this.name=At}return Z.prototype=new Error,Z.constructor=Z,Z}();e.BaseException=M;class i extends M{constructor(Z,K){super(Z,"PasswordException"),this.code=K}}e.PasswordException=i;class o extends M{constructor(Z,K){super(Z,"UnknownErrorException"),this.details=K}}e.UnknownErrorException=o;class a extends M{constructor(Z){super(Z,"InvalidPDFException")}}e.InvalidPDFException=a;class h extends M{constructor(Z){super(Z,"MissingPDFException")}}e.MissingPDFException=h;class f extends M{constructor(Z,K){super(Z,"UnexpectedResponseException"),this.status=K}}e.UnexpectedResponseException=f;class T extends M{constructor(Z){super(Z,"FormatError")}}e.FormatError=T;class N extends M{constructor(Z){super(Z,"AbortException")}}e.AbortException=N;function W(ft){(typeof ft!="object"||(ft==null?void 0:ft.length)===void 0)&&V("Invalid argument for bytesToString");const Z=ft.length,K=8192;if(Z<K)return String.fromCharCode.apply(null,ft);const At=[];for(let vt=0;vt<Z;vt+=K){const ee=Math.min(vt+K,Z),te=ft.subarray(vt,ee);At.push(String.fromCharCode.apply(null,te))}return At.join("")}function it(ft){typeof ft!="string"&&V("Invalid argument for stringToBytes");const Z=ft.length,K=new Uint8Array(Z);for(let At=0;At<Z;++At)K[At]=ft.charCodeAt(At)&255;return K}function tt(ft){return String.fromCharCode(ft>>24&255,ft>>16&255,ft>>8&255,ft&255)}function et(ft){return Object.keys(ft).length}function ht(ft){const Z=Object.create(null);for(const[K,At]of ft)Z[K]=At;return Z}function bt(){const ft=new Uint8Array(4);return ft[0]=1,new Uint32Array(ft.buffer,0,1)[0]===1}function ut(){try{return new Function(""),!0}catch{return!1}}class Ft{static get isLittleEndian(){return wt(this,"isLittleEndian",bt())}static get isEvalSupported(){return wt(this,"isEvalSupported",ut())}static get isOffscreenCanvasSupported(){return wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?wt(this,"platform",{isWin:!1,isMac:!1}):wt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Z,K;return wt(this,"isCSSRoundSupported",(K=(Z=globalThis.CSS)==null?void 0:Z.supports)==null?void 0:K.call(Z,"width: round(1.5px, 1px)"))}}e.FeatureTest=Ft;const Bt=[...Array(256).keys()].map(ft=>ft.toString(16).padStart(2,"0"));class St{static makeHexColor(Z,K,At){return`#${Bt[Z]}${Bt[K]}${Bt[At]}`}static scaleMinMax(Z,K){let At;Z[0]?(Z[0]<0&&(At=K[0],K[0]=K[1],K[1]=At),K[0]*=Z[0],K[1]*=Z[0],Z[3]<0&&(At=K[2],K[2]=K[3],K[3]=At),K[2]*=Z[3],K[3]*=Z[3]):(At=K[0],K[0]=K[2],K[2]=At,At=K[1],K[1]=K[3],K[3]=At,Z[1]<0&&(At=K[2],K[2]=K[3],K[3]=At),K[2]*=Z[1],K[3]*=Z[1],Z[2]<0&&(At=K[0],K[0]=K[1],K[1]=At),K[0]*=Z[2],K[1]*=Z[2]),K[0]+=Z[4],K[1]+=Z[4],K[2]+=Z[5],K[3]+=Z[5]}static transform(Z,K){return[Z[0]*K[0]+Z[2]*K[1],Z[1]*K[0]+Z[3]*K[1],Z[0]*K[2]+Z[2]*K[3],Z[1]*K[2]+Z[3]*K[3],Z[0]*K[4]+Z[2]*K[5]+Z[4],Z[1]*K[4]+Z[3]*K[5]+Z[5]]}static applyTransform(Z,K){const At=Z[0]*K[0]+Z[1]*K[2]+K[4],vt=Z[0]*K[1]+Z[1]*K[3]+K[5];return[At,vt]}static applyInverseTransform(Z,K){const At=K[0]*K[3]-K[1]*K[2],vt=(Z[0]*K[3]-Z[1]*K[2]+K[2]*K[5]-K[4]*K[3])/At,ee=(-Z[0]*K[1]+Z[1]*K[0]+K[4]*K[1]-K[5]*K[0])/At;return[vt,ee]}static getAxialAlignedBoundingBox(Z,K){const At=this.applyTransform(Z,K),vt=this.applyTransform(Z.slice(2,4),K),ee=this.applyTransform([Z[0],Z[3]],K),te=this.applyTransform([Z[2],Z[1]],K);return[Math.min(At[0],vt[0],ee[0],te[0]),Math.min(At[1],vt[1],ee[1],te[1]),Math.max(At[0],vt[0],ee[0],te[0]),Math.max(At[1],vt[1],ee[1],te[1])]}static inverseTransform(Z){const K=Z[0]*Z[3]-Z[1]*Z[2];return[Z[3]/K,-Z[1]/K,-Z[2]/K,Z[0]/K,(Z[2]*Z[5]-Z[4]*Z[3])/K,(Z[4]*Z[1]-Z[5]*Z[0])/K]}static singularValueDecompose2dScale(Z){const K=[Z[0],Z[2],Z[1],Z[3]],At=Z[0]*K[0]+Z[1]*K[2],vt=Z[0]*K[1]+Z[1]*K[3],ee=Z[2]*K[0]+Z[3]*K[2],te=Z[2]*K[1]+Z[3]*K[3],Q=(At+te)/2,xt=Math.sqrt((At+te)**2-4*(At*te-ee*vt))/2,It=Q+xt||1,Pt=Q-xt||1;return[Math.sqrt(It),Math.sqrt(Pt)]}static normalizeRect(Z){const K=Z.slice(0);return Z[0]>Z[2]&&(K[0]=Z[2],K[2]=Z[0]),Z[1]>Z[3]&&(K[1]=Z[3],K[3]=Z[1]),K}static intersect(Z,K){const At=Math.max(Math.min(Z[0],Z[2]),Math.min(K[0],K[2])),vt=Math.min(Math.max(Z[0],Z[2]),Math.max(K[0],K[2]));if(At>vt)return null;const ee=Math.max(Math.min(Z[1],Z[3]),Math.min(K[1],K[3])),te=Math.min(Math.max(Z[1],Z[3]),Math.max(K[1],K[3]));return ee>te?null:[At,ee,vt,te]}static bezierBoundingBox(Z,K,At,vt,ee,te,Q,xt){const It=[],Pt=[[],[]];let Nt,jt,Qt,yt,Kt,Ot,B,s;for(let J=0;J<2;++J){if(J===0?(jt=6*Z-12*At+6*ee,Nt=-3*Z+9*At-9*ee+3*Q,Qt=3*At-3*Z):(jt=6*K-12*vt+6*te,Nt=-3*K+9*vt-9*te+3*xt,Qt=3*vt-3*K),Math.abs(Nt)<1e-12){if(Math.abs(jt)<1e-12)continue;yt=-Qt/jt,0<yt&&yt<1&&It.push(yt);continue}B=jt*jt-4*Qt*Nt,s=Math.sqrt(B),!(B<0)&&(Kt=(-jt+s)/(2*Nt),0<Kt&&Kt<1&&It.push(Kt),Ot=(-jt-s)/(2*Nt),0<Ot&&Ot<1&&It.push(Ot))}let x=It.length,U;const q=x;for(;x--;)yt=It[x],U=1-yt,Pt[0][x]=U*U*U*Z+3*U*U*yt*At+3*U*yt*yt*ee+yt*yt*yt*Q,Pt[1][x]=U*U*U*K+3*U*U*yt*vt+3*U*yt*yt*te+yt*yt*yt*xt;return Pt[0][q]=Z,Pt[1][q]=K,Pt[0][q+1]=Q,Pt[1][q+1]=xt,Pt[0].length=Pt[1].length=q+2,[Math.min(...Pt[0]),Math.min(...Pt[1]),Math.max(...Pt[0]),Math.max(...Pt[1])]}}e.Util=St;const Lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function gt(ft){if(ft[0]>="ï"){let K;if(ft[0]==="þ"&&ft[1]==="ÿ"?K="utf-16be":ft[0]==="ÿ"&&ft[1]==="þ"?K="utf-16le":ft[0]==="ï"&&ft[1]==="»"&&ft[2]==="¿"&&(K="utf-8"),K)try{const At=new TextDecoder(K,{fatal:!0}),vt=it(ft);return At.decode(vt)}catch(At){ct(`stringToPDFString: "${At}".`)}}const Z=[];for(let K=0,At=ft.length;K<At;K++){const vt=Lt[ft.charCodeAt(K)];Z.push(vt?String.fromCharCode(vt):ft.charAt(K))}return Z.join("")}function nt(ft){return decodeURIComponent(escape(ft))}function st(ft){return unescape(encodeURIComponent(ft))}function pt(ft){return typeof ft=="object"&&(ft==null?void 0:ft.byteLength)!==void 0}function Tt(ft,Z){if(ft.length!==Z.length)return!1;for(let K=0,At=ft.length;K<At;K++)if(ft[K]!==Z[K])return!1;return!0}function Ct(ft=new Date){return[ft.getUTCFullYear().toString(),(ft.getUTCMonth()+1).toString().padStart(2,"0"),ft.getUTCDate().toString().padStart(2,"0"),ft.getUTCHours().toString().padStart(2,"0"),ft.getUTCMinutes().toString().padStart(2,"0"),ft.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){H(this,Xt,!1);this.promise=new Promise((Z,K)=>{this.resolve=At=>{ot(this,Xt,!0),Z(At)},this.reject=At=>{ot(this,Xt,!0),K(At)}})}get settled(){return t(this,Xt)}}Xt=new WeakMap,e.PromiseCapability=Ut;let Vt=null,Wt=null;function zt(ft){return Vt||(Vt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Wt=new Map([["ﬅ","ſt"]])),ft.replaceAll(Vt,(Z,K,At)=>K?K.normalize("NFKC"):Wt.get(At))}function Gt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ft=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ft);else for(let Z=0;Z<32;Z++)ft[Z]=Math.floor(Math.random()*255);return W(ft)}const Ht="pdfjs_internal_id_";e.AnnotationPrefix=Ht},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var g,D,n,u,de,L,xe,R,y,m,O,j,k,_,w,p,we,P,C,Be,l,d;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(A){if(typeof A=="string"||A instanceof URL?A={url:A}:(0,_util.isArrayBuffer)(A)&&(A={data:A}),typeof A!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!A.url&&!A.data&&!A.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const c=new PDFDocumentLoadingTask,{docId:F}=c,b=A.url?getUrlProp(A.url):null,G=A.data?getDataProp(A.data):null,z=A.httpHeaders||null,S=A.withCredentials===!0,X=A.password??null,at=A.range instanceof PDFDataRangeTransport?A.range:null,ct=Number.isInteger(A.rangeChunkSize)&&A.rangeChunkSize>0?A.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let V=A.worker instanceof PDFWorker?A.worker:null;const dt=A.verbosity,mt=typeof A.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(A.docBaseUrl)?A.docBaseUrl:null,Et=typeof A.cMapUrl=="string"?A.cMapUrl:null,wt=A.cMapPacked!==!1,M=A.CMapReaderFactory||DefaultCMapReaderFactory,i=typeof A.standardFontDataUrl=="string"?A.standardFontDataUrl:null,o=A.StandardFontDataFactory||DefaultStandardFontDataFactory,a=A.stopAtErrors!==!0,h=Number.isInteger(A.maxImageSize)&&A.maxImageSize>-1?A.maxImageSize:-1,f=A.isEvalSupported!==!1,T=typeof A.isOffscreenCanvasSupported=="boolean"?A.isOffscreenCanvasSupported:!_util.isNodeJS,N=Number.isInteger(A.canvasMaxAreaInBytes)?A.canvasMaxAreaInBytes:-1,W=typeof A.disableFontFace=="boolean"?A.disableFontFace:_util.isNodeJS,it=A.fontExtraProperties===!0,tt=A.enableXfa===!0,et=A.ownerDocument||globalThis.document,ht=A.disableRange===!0,bt=A.disableStream===!0,ut=A.disableAutoFetch===!0,Ft=A.pdfBug===!0,Bt=at?at.length:A.length??NaN,St=typeof A.useSystemFonts=="boolean"?A.useSystemFonts:!_util.isNodeJS&&!W,Lt=typeof A.useWorkerFetch=="boolean"?A.useWorkerFetch:M===_display_utils.DOMCMapReaderFactory&&o===_display_utils.DOMStandardFontDataFactory&&Et&&i&&(0,_display_utils.isValidFetchUrl)(Et,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI),gt=A.canvasFactory||new DefaultCanvasFactory({ownerDocument:et}),nt=A.filterFactory||new DefaultFilterFactory({docId:F,ownerDocument:et}),st=null;(0,_util.setVerbosityLevel)(dt);const pt={canvasFactory:gt,filterFactory:nt};if(Lt||(pt.cMapReaderFactory=new M({baseUrl:Et,isCompressed:wt}),pt.standardFontDataFactory=new o({baseUrl:i})),!V){const Ut={verbosity:dt,port:_worker_options.GlobalWorkerOptions.workerPort};V=Ut.port?PDFWorker.fromPort(Ut):new PDFWorker(Ut),c._worker=V}const Tt={docId:F,apiVersion:"3.11.174",data:G,password:X,disableAutoFetch:ut,rangeChunkSize:ct,length:Bt,docBaseUrl:mt,enableXfa:tt,evaluatorOptions:{maxImageSize:h,disableFontFace:W,ignoreErrors:a,isEvalSupported:f,isOffscreenCanvasSupported:T,canvasMaxAreaInBytes:N,fontExtraProperties:it,useSystemFonts:St,cMapUrl:Lt?Et:null,standardFontDataUrl:Lt?i:null}},Ct={ignoreErrors:a,isEvalSupported:f,disableFontFace:W,fontExtraProperties:it,enableXfa:tt,ownerDocument:et,disableAutoFetch:ut,pdfBug:Ft,styleElement:st};return V.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const Ut=_fetchDocument(V,Tt),Vt=new Promise(function(Wt){let zt;at?zt=new _transport_stream.PDFDataTransportStream({length:Bt,initialData:at.initialData,progressiveDone:at.progressiveDone,contentDispositionFilename:at.contentDispositionFilename,disableRange:ht,disableStream:bt},at):G||(zt=(Ht=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Ht):(0,_display_utils.isValidFetchUrl)(Ht.url)?new _displayFetch_stream.PDFFetchStream(Ht):new _displayNetwork.PDFNetworkStream(Ht))({url:b,length:Bt,httpHeaders:z,withCredentials:S,rangeChunkSize:ct,disableRange:ht,disableStream:bt})),Wt(zt)});return Promise.all([Ut,Vt]).then(function([Wt,zt]){if(c.destroyed)throw new Error("Loading aborted");const Gt=new _message_handler.MessageHandler(F,Wt,V.port),Ht=new WorkerTransport(Gt,c,zt,Ct,pt);c._transport=Ht,Gt.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(A,c){if(A.destroyed)throw new Error("Worker was destroyed");const F=await A.messageHandler.sendWithPromise("GetDocRequest",c,c.data?[c.data.buffer]:null);if(A.destroyed)throw new Error("Worker was destroyed");return F}function getUrlProp(A){if(A instanceof URL)return A.href;try{return new URL(A,window.location).href}catch{if(_util.isNodeJS&&typeof A=="string")return A}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(A){if(_util.isNodeJS&&typeof Buffer<"u"&&A instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength)return A;if(typeof A=="string")return(0,_util.stringToBytes)(A);if(typeof A=="object"&&!isNaN(A==null?void 0:A.length)||(0,_util.isArrayBuffer)(A))return new Uint8Array(A);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${me(e,g)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var c,F,b;this.destroyed=!0;try{(c=this._worker)!=null&&c.port&&(this._worker._pendingDestroy=!0),await((F=this._transport)==null?void 0:F.destroy())}catch(G){throw(b=this._worker)!=null&&b.port&&delete this._worker._pendingDestroy,G}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};g=new WeakMap,H(e,g,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,F,b=!1,G=null){this.length=c,this.initialData=F,this.progressiveDone=b,this.contentDispositionFilename=G,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,F){for(const b of this._rangeListeners)b(c,F)}onDataProgress(c,F){this._readyCapability.promise.then(()=>{for(const b of this._progressListeners)b(c,F)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const F of this._progressiveReadListeners)F(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,F){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,F){this._pdfInfo=c,this._transport=F,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(b=>{if(!b)return b;const G=[];for(const z in b)G.push(...b[z]);return G}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,F,b,G=!1){H(this,u);H(this,L);H(this,D,null);H(this,n,!1);this._pageIndex=c,this._pageInfo=F,this._transport=b,this._stats=G?new _display_utils.StatTimer:null,this._pdfBug=G,this.commonObjs=b.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:F=this.rotate,offsetX:b=0,offsetY:G=0,dontFlip:z=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:F,offsetX:b,offsetY:G,dontFlip:z})}getAnnotations({intent:c="display"}={}){const F=this._transport.getRenderingIntent(c);return this._transport.getAnnotations(this._pageIndex,F.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:F,intent:b="display",annotationMode:G=_util.AnnotationMode.ENABLE,transform:z=null,background:S=null,optionalContentConfigPromise:X=null,annotationCanvasMap:at=null,pageColors:ct=null,printAnnotationStorage:V=null}){var o,a;(o=this._stats)==null||o.time("Overall");const dt=this._transport.getRenderingIntent(b,G,V);ot(this,n,!1),Y(this,L,xe).call(this),X||(X=this._transport.getOptionalContentConfig());let mt=this._intentStates.get(dt.cacheKey);mt||(mt=Object.create(null),this._intentStates.set(dt.cacheKey,mt)),mt.streamReaderCancelTimeout&&(clearTimeout(mt.streamReaderCancelTimeout),mt.streamReaderCancelTimeout=null);const Et=!!(dt.renderingIntent&_util.RenderingIntentFlag.PRINT);mt.displayReadyCapability||(mt.displayReadyCapability=new _util.PromiseCapability,mt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(a=this._stats)==null||a.time("Page Request"),this._pumpOperatorList(dt));const wt=h=>{var f,T;mt.renderTasks.delete(M),(this._maybeCleanupAfterRender||Et)&&ot(this,n,!0),Y(this,u,de).call(this,!Et),h?(M.capability.reject(h),this._abortOperatorList({intentState:mt,reason:h instanceof Error?h:new Error(h)})):M.capability.resolve(),(f=this._stats)==null||f.timeEnd("Rendering"),(T=this._stats)==null||T.timeEnd("Overall")},M=new InternalRenderTask({callback:wt,params:{canvasContext:c,viewport:F,transform:z,background:S},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:at,operatorList:mt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Et,pdfBug:this._pdfBug,pageColors:ct});(mt.renderTasks||(mt.renderTasks=new Set)).add(M);const i=M.task;return Promise.all([mt.displayReadyCapability.promise,X]).then(([h,f])=>{var T;if(this.destroyed){wt();return}(T=this._stats)==null||T.time("Rendering"),M.initializeGraphics({transparency:h,optionalContentConfig:f}),M.operatorListChanged()}).catch(wt),i}getOperatorList({intent:c="display",annotationMode:F=_util.AnnotationMode.ENABLE,printAnnotationStorage:b=null}={}){var at;function G(){S.operatorList.lastChunk&&(S.opListReadCapability.resolve(S.operatorList),S.renderTasks.delete(X))}const z=this._transport.getRenderingIntent(c,F,b,!0);let S=this._intentStates.get(z.cacheKey);S||(S=Object.create(null),this._intentStates.set(z.cacheKey,S));let X;return S.opListReadCapability||(X=Object.create(null),X.operatorListChanged=G,S.opListReadCapability=new _util.PromiseCapability,(S.renderTasks||(S.renderTasks=new Set)).add(X),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(at=this._stats)==null||at.time("Page Request"),this._pumpOperatorList(z)),S.opListReadCapability.promise}streamTextContent({includeMarkedContent:c=!1,disableNormalization:F=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:c===!0,disableNormalization:F===!0},{highWaterMark:100,size(G){return G.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(b=>_xfa_text.XfaText.textContent(b));const F=this.streamTextContent(c);return new Promise(function(b,G){function z(){S.read().then(function({value:at,done:ct}){if(ct){b(X);return}Object.assign(X.styles,at.styles),X.items.push(...at.items),z()},G)}const S=F.getReader(),X={items:[],styles:Object.create(null)};z()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const c=[];for(const F of this._intentStates.values())if(this._abortOperatorList({intentState:F,reason:new Error("Page was destroyed."),force:!0}),!F.opListReadCapability)for(const b of F.renderTasks)c.push(b.completed),b.cancel();return this.objs.clear(),ot(this,n,!1),Y(this,L,xe).call(this),Promise.all(c)}cleanup(c=!1){ot(this,n,!0);const F=Y(this,u,de).call(this,!1);return c&&F&&this._stats&&(this._stats=new _display_utils.StatTimer),F}_startRenderPage(c,F){var G,z;const b=this._intentStates.get(F);b&&((G=this._stats)==null||G.timeEnd("Page Request"),(z=b.displayReadyCapability)==null||z.resolve(c))}_renderPageChunk(c,F){for(let b=0,G=c.length;b<G;b++)F.operatorList.fnArray.push(c.fnArray[b]),F.operatorList.argsArray.push(c.argsArray[b]);F.operatorList.lastChunk=c.lastChunk,F.operatorList.separateAnnots=c.separateAnnots;for(const b of F.renderTasks)b.operatorListChanged();c.lastChunk&&Y(this,u,de).call(this,!0)}_pumpOperatorList({renderingIntent:c,cacheKey:F,annotationStorageSerializable:b}){const{map:G,transfers:z}=b,X=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:F,annotationStorage:G},z).getReader(),at=this._intentStates.get(F);at.streamReader=X;const ct=()=>{X.read().then(({value:V,done:dt})=>{if(dt){at.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(V,at),ct())},V=>{if(at.streamReader=null,!this._transport.destroyed){if(at.operatorList){at.operatorList.lastChunk=!0;for(const dt of at.renderTasks)dt.operatorListChanged();Y(this,u,de).call(this,!0)}if(at.displayReadyCapability)at.displayReadyCapability.reject(V);else if(at.opListReadCapability)at.opListReadCapability.reject(V);else throw V}})};ct()}_abortOperatorList({intentState:c,reason:F,force:b=!1}){if(c.streamReader){if(c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null),!b){if(c.renderTasks.size>0)return;if(F instanceof _display_utils.RenderingCancelledException){let G=RENDERING_CANCELLED_TIMEOUT;F.extraDelay>0&&F.extraDelay<1e3&&(G+=F.extraDelay),c.streamReaderCancelTimeout=setTimeout(()=>{c.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:c,reason:F,force:!0})},G);return}}if(c.streamReader.cancel(new _util.AbortException(F.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[G,z]of this._intentStates)if(z===c){this._intentStates.delete(G);break}this.cleanup()}}}get stats(){return this._stats}}D=new WeakMap,n=new WeakMap,u=new WeakSet,de=function(c=!1){if(Y(this,L,xe).call(this),!t(this,n)||this.destroyed)return!1;if(c)return ot(this,D,setTimeout(()=>{ot(this,D,null),Y(this,u,de).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:F,operatorList:b}of this._intentStates.values())if(F.size>0||!b.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ot(this,n,!1),!0},L=new WeakSet,xe=function(){t(this,D)&&(clearTimeout(t(this,D)),ot(this,D,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){H(this,R,new Set);H(this,y,Promise.resolve())}postMessage(c,F){const b={data:structuredClone(c,F?{transfer:F}:null)};t(this,y).then(()=>{for(const G of t(this,R))G.call(this,b)})}addEventListener(c,F){t(this,R).add(F)}removeEventListener(c,F){t(this,R).delete(F)}terminate(){t(this,R).clear()}}R=new WeakMap,y=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const A=(m=document==null?void 0:document.currentScript)==null?void 0:m.src;A&&(PDFWorkerUtil.fallbackWorkerSrc=A.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(A,c){let F;try{if(F=new URL(A),!F.origin||F.origin==="null")return!1}catch{return!1}const b=new URL(c,F);return F.origin===b.origin},PDFWorkerUtil.createCDNWrapper=function(A){const c=`importScripts("${A}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class _PDFWorker{constructor({name:A=null,port:c=null,verbosity:F=(0,_util.getVerbosityLevel)()}={}){var b;if(this.name=A,this.destroyed=!1,this.verbosity=F,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,c){if((b=t(_PDFWorker,O))!=null&&b.has(c))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,O)||ot(_PDFWorker,O,new WeakMap)).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(A){this._port=A,this._messageHandler=new _message_handler.MessageHandler("main","worker",A),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:A}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,A)||(A=PDFWorkerUtil.createCDNWrapper(new URL(A,window.location).href));const c=new Worker(A),F=new _message_handler.MessageHandler("main","worker",c),b=()=>{c.removeEventListener("error",G),F.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},G=()=>{this._webWorker||b()};c.addEventListener("error",G),F.on("test",S=>{if(c.removeEventListener("error",G),this.destroyed){b();return}S?(this._messageHandler=F,this._port=c,this._webWorker=c,this._readyCapability.resolve(),F.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),F.destroy(),c.terminate())}),F.on("ready",S=>{if(c.removeEventListener("error",G),this.destroyed){b();return}try{z()}catch{this._setupFakeWorker()}});const z=()=>{const S=new Uint8Array;F.send("test",S,[S.buffer])};z();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(A=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const F=`fake${PDFWorkerUtil.fakeWorkerId++}`,b=new _message_handler.MessageHandler(F+"_worker",F,c);A.setup(b,c);const G=new _message_handler.MessageHandler(F,F+"_worker",c);this._messageHandler=G,this._readyCapability.resolve(),G.send("configure",{verbosity:this.verbosity})}).catch(A=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${A.message}".`))})}destroy(){var A;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(A=t(_PDFWorker,O))==null||A.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(A){var F;if(!(A!=null&&A.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const c=(F=t(this,O))==null?void 0:F.get(A.port);if(c){if(c._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return c}return new _PDFWorker(A)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var A;try{return((A=globalThis.pdfjsWorker)==null?void 0:A.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};O=new WeakMap,H(_PDFWorker,O,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(c,F,b,G,z){H(this,p);H(this,j,new Map);H(this,k,new Map);H(this,_,new Map);H(this,w,null);this.messageHandler=c,this.loadingTask=F,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:G.ownerDocument,styleElement:G.styleElement}),this._params=G,this.canvasFactory=z.canvasFactory,this.filterFactory=z.filterFactory,this.cMapReaderFactory=z.cMapReaderFactory,this.standardFontDataFactory=z.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=b,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(c,F=_util.AnnotationMode.ENABLE,b=null,G=!1){let z=_util.RenderingIntentFlag.DISPLAY,S=_annotation_storage.SerializableEmpty;switch(c){case"any":z=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":z=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch(F){case _util.AnnotationMode.DISABLE:z+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:z+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:z+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,S=(z&_util.RenderingIntentFlag.PRINT&&b instanceof _annotation_storage.PrintAnnotationStorage?b:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${F}`)}return G&&(z+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:z,cacheKey:`${z}_${S.hash}`,annotationStorageSerializable:S}}destroy(){var b;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(b=t(this,w))==null||b.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const G of t(this,k).values())c.push(G._destroy());t(this,k).clear(),t(this,_).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const F=this.messageHandler.sendWithPromise("Terminate",null);return c.push(F),Promise.all(c).then(()=>{var G;this.commonObjs.clear(),this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(),(G=this._networkStream)==null||G.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:F}=this;c.on("GetReader",(b,G)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=z=>{this._lastProgress={loaded:z.loaded,total:z.total}},G.onPull=()=>{this._fullReader.read().then(function({value:z,done:S}){if(S){G.close();return}(0,_util.assert)(z instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),G.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{G.error(z)})},G.onCancel=z=>{this._fullReader.cancel(z),G.ready.catch(S=>{if(!this.destroyed)throw S})}}),c.on("ReaderHeadersReady",b=>{const G=new _util.PromiseCapability,z=this._fullReader;return z.headersReady.then(()=>{var S;(!z.isStreamingSupported||!z.isRangeSupported)&&(this._lastProgress&&((S=F.onProgress)==null||S.call(F,this._lastProgress)),z.onProgress=X=>{var at;(at=F.onProgress)==null||at.call(F,{loaded:X.loaded,total:X.total})}),G.resolve({isStreamingSupported:z.isStreamingSupported,isRangeSupported:z.isRangeSupported,contentLength:z.contentLength})},G.reject),G.promise}),c.on("GetRangeReader",(b,G)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const z=this._networkStream.getRangeReader(b.begin,b.end);if(!z){G.close();return}G.onPull=()=>{z.read().then(function({value:S,done:X}){if(X){G.close();return}(0,_util.assert)(S instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),G.enqueue(new Uint8Array(S),1,[S])}).catch(S=>{G.error(S)})},G.onCancel=S=>{z.cancel(S),G.ready.catch(X=>{if(!this.destroyed)throw X})}}),c.on("GetDoc",({pdfInfo:b})=>{this._numPages=b.numPages,this._htmlForXfa=b.htmlForXfa,delete b.htmlForXfa,F._capability.resolve(new PDFDocumentProxy(b,this))}),c.on("DocException",function(b){let G;switch(b.name){case"PasswordException":G=new _util.PasswordException(b.message,b.code);break;case"InvalidPDFException":G=new _util.InvalidPDFException(b.message);break;case"MissingPDFException":G=new _util.MissingPDFException(b.message);break;case"UnexpectedResponseException":G=new _util.UnexpectedResponseException(b.message,b.status);break;case"UnknownErrorException":G=new _util.UnknownErrorException(b.message,b.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}F._capability.reject(G)}),c.on("PasswordRequest",b=>{if(ot(this,w,new _util.PromiseCapability),F.onPassword){const G=z=>{z instanceof Error?t(this,w).reject(z):t(this,w).resolve({password:z})};try{F.onPassword(G,b.code)}catch(z){t(this,w).reject(z)}}else t(this,w).reject(new _util.PasswordException(b.message,b.code));return t(this,w).promise}),c.on("DataLoaded",b=>{var G;(G=F.onProgress)==null||G.call(F,{loaded:b.length,total:b.length}),this.downloadInfoCapability.resolve(b)}),c.on("StartRenderPage",b=>{if(this.destroyed)return;t(this,k).get(b.pageIndex)._startRenderPage(b.transparency,b.cacheKey)}),c.on("commonobj",([b,G,z])=>{var S;if(!this.destroyed&&!this.commonObjs.has(b))switch(G){case"Font":const X=this._params;if("error"in z){const V=z.error;(0,_util.warn)(`Error during font loading: ${V}`),this.commonObjs.resolve(b,V);break}const at=X.pdfBug&&((S=globalThis.FontInspector)!=null&&S.enabled)?(V,dt)=>globalThis.FontInspector.fontAdded(V,dt):null,ct=new _font_loader.FontFaceObject(z,{isEvalSupported:X.isEvalSupported,disableFontFace:X.disableFontFace,ignoreErrors:X.ignoreErrors,inspectFont:at});this.fontLoader.bind(ct).catch(V=>c.sendWithPromise("FontFallback",{id:b})).finally(()=>{!X.fontExtraProperties&&ct.data&&(ct.data=null),this.commonObjs.resolve(b,ct)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(b,z);break;default:throw new Error(`Got unknown common object type ${G}`)}}),c.on("obj",([b,G,z,S])=>{var at;if(this.destroyed)return;const X=t(this,k).get(G);if(!X.objs.has(b))switch(z){case"Image":if(X.objs.resolve(b,S),S){let ct;if(S.bitmap){const{width:V,height:dt}=S;ct=V*dt*4}else ct=((at=S.data)==null?void 0:at.length)||0;ct>_util.MAX_IMAGE_SIZE_TO_CACHE&&(X._maybeCleanupAfterRender=!0)}break;case"Pattern":X.objs.resolve(b,S);break;default:throw new Error(`Got unknown object type ${z}`)}}),c.on("DocProgress",b=>{var G;this.destroyed||(G=F.onProgress)==null||G.call(F,{loaded:b.loaded,total:b.total})}),c.on("FetchBuiltInCMap",b=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(b):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",b=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(b):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var b;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:c,transfers:F}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:c,filename:((b=this._fullReader)==null?void 0:b.filename)??null},F).finally(()=>{this.annotationStorage.resetModified()})}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const F=c-1,b=t(this,_).get(F);if(b)return b;const G=this.messageHandler.sendWithPromise("GetPage",{pageIndex:F}).then(z=>{if(this.destroyed)throw new Error("Transport destroyed");const S=new PDFPageProxy(F,z,this,this._params.pdfBug);return t(this,k).set(F,S),S});return t(this,_).set(F,G),G}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,F){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:F})}getFieldObjects(){return Y(this,p,we).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,p,we).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,p,we).call(this,"GetDocJSActions")}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const c="GetMetadata",F=t(this,j).get(c);if(F)return F;const b=this.messageHandler.sendWithPromise(c,null).then(G=>{var z,S;return{info:G[0],metadata:G[1]?new _metadata.Metadata(G[1]):null,contentDispositionFilename:((z=this._fullReader)==null?void 0:z.filename)??null,contentLength:((S=this._fullReader)==null?void 0:S.contentLength)??null}});return t(this,j).set(c,b),b}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const F of t(this,k).values())if(!F.cleanup())throw new Error(`startCleanup: Page ${F.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:c,enableXfa:F}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c,enableXfa:F})}}j=new WeakMap,k=new WeakMap,_=new WeakMap,w=new WeakMap,p=new WeakSet,we=function(c,F=null){const b=t(this,j).get(c);if(b)return b;const G=this.messageHandler.sendWithPromise(c,F);return t(this,j).set(c,G),G};class PDFObjects{constructor(){H(this,C);H(this,P,Object.create(null))}get(c,F=null){if(F){const G=Y(this,C,Be).call(this,c);return G.capability.promise.then(()=>F(G.data)),null}const b=t(this,P)[c];if(!(b!=null&&b.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return b.data}has(c){const F=t(this,P)[c];return(F==null?void 0:F.capability.settled)||!1}resolve(c,F=null){const b=Y(this,C,Be).call(this,c);b.data=F,b.capability.resolve()}clear(){var c;for(const F in t(this,P)){const{data:b}=t(this,P)[F];(c=b==null?void 0:b.bitmap)==null||c.close()}ot(this,P,Object.create(null))}}P=new WeakMap,C=new WeakSet,Be=function(c){var F;return(F=t(this,P))[c]||(F[c]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(c){H(this,l,null);ot(this,l,c),this.onContinue=null}get promise(){return t(this,l).capability.promise}cancel(c=0){t(this,l).cancel(null,c)}get separateAnnots(){const{separateAnnots:c}=t(this,l).operatorList;if(!c)return!1;const{annotationCanvasMap:F}=t(this,l);return c.form||c.canvas&&(F==null?void 0:F.size)>0}}l=new WeakMap,exports.RenderTask=RenderTask;const I=class I{constructor({callback:c,params:F,objs:b,commonObjs:G,annotationCanvasMap:z,operatorList:S,pageIndex:X,canvasFactory:at,filterFactory:ct,useRequestAnimationFrame:V=!1,pdfBug:dt=!1,pageColors:mt=null}){this.callback=c,this.params=F,this.objs=b,this.commonObjs=G,this.annotationCanvasMap=z,this.operatorListIdx=null,this.operatorList=S,this._pageIndex=X,this.canvasFactory=at,this.filterFactory=ct,this._pdfBug=dt,this.pageColors=mt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=V===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=F.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:F}){var X,at;if(this.cancelled)return;if(this._canvas){if(t(I,d).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(I,d).add(this._canvas)}this._pdfBug&&((X=globalThis.StepperManager)!=null&&X.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:b,viewport:G,transform:z,background:S}=this.params;this.gfx=new _canvas.CanvasGraphics(b,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:F},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:z,viewport:G,transparency:c,background:S}),this.operatorListIdx=0,this.graphicsReady=!0,(at=this.graphicsReadyCallback)==null||at.call(this)}cancel(c=null,F=0){var b;this.running=!1,this.cancelled=!0,(b=this.gfx)==null||b.endDrawing(),t(I,d).delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,F))}operatorListChanged(){var c;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(c=this.stepper)==null||c.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(I,d).delete(this._canvas),this.callback())))}};d=new WeakMap,H(I,d,new WeakSet);let InternalRenderTask=I;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(g,e,D)=>{var y,m,O,vn,k;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=D(1),u=D(4),$=D(8);const L=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=L;class rt{constructor(){H(this,O);H(this,y,!1);H(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(w,p){const E=t(this,m).get(w);return E===void 0?p:Object.assign(p,E)}getRawValue(w){return t(this,m).get(w)}remove(w){if(t(this,m).delete(w),t(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const p of t(this,m).values())if(p instanceof u.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(w,p){const E=t(this,m).get(w);let P=!1;if(E!==void 0)for(const[C,v]of Object.entries(p))E[C]!==v&&(P=!0,E[C]=v);else P=!0,t(this,m).set(w,p);P&&Y(this,O,vn).call(this),p instanceof u.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(p.constructor._type)}has(w){return t(this,m).has(w)}getAll(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}setAll(w){for(const[p,E]of Object.entries(w))this.setValue(p,E)}get size(){return t(this,m).size}resetModified(){t(this,y)&&(ot(this,y,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new R(this)}get serializable(){if(t(this,m).size===0)return L;const w=new Map,p=new $.MurmurHash3_64,E=[],P=Object.create(null);let C=!1;for(const[v,l]of t(this,m)){const d=l instanceof u.AnnotationEditor?l.serialize(!1,P):l;d&&(w.set(v,d),p.update(`${v}:${JSON.stringify(d)}`),C||(C=!!d.bitmap))}if(C)for(const v of w.values())v.bitmap&&E.push(v.bitmap);return w.size>0?{map:w,hash:p.hexdigest(),transfers:E}:L}}y=new WeakMap,m=new WeakMap,O=new WeakSet,vn=function(){t(this,y)||(ot(this,y,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=rt;class R extends rt{constructor(p){super();H(this,k,void 0);const{map:E,hash:P,transfers:C}=p.serializable,v=structuredClone(E,C?{transfer:C}:null);ot(this,k,{map:v,hash:P,transfers:C})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,k)}}k=new WeakMap,e.PrintAnnotationStorage=R},(g,e,D)=>{var R,y,m,O,j,k,_,w,p,E,P,C,v,l,d,Ue,A,We,F,He,G,$e,S,En,at,Sn,V,xn,mt,Ge,wt,wn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=D(5),u=D(1),$=D(6);const i=class i{constructor(a){H(this,d);H(this,A);H(this,G);H(this,S);H(this,at);H(this,V);H(this,mt);H(this,wt);H(this,R,"");H(this,y,!1);H(this,m,null);H(this,O,null);H(this,j,null);H(this,k,!1);H(this,_,null);H(this,w,this.focusin.bind(this));H(this,p,this.focusout.bind(this));H(this,E,!1);H(this,P,!1);H(this,C,!1);ne(this,"_initialOptions",Object.create(null));ne(this,"_uiManager",null);ne(this,"_focusEventsAllowed",!0);ne(this,"_l10nPromise",null);H(this,v,!1);H(this,l,i._zIndex++);this.constructor===i&&(0,u.unreachable)("Cannot initialize AnnotationEditor."),this.parent=a.parent,this.id=a.id,this.width=this.height=null,this.pageIndex=a.parent.pageIndex,this.name=a.name,this.div=null,this._uiManager=a.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=a.isCentered,this._structTreeParentId=null;const{rotation:h,rawDims:{pageWidth:f,pageHeight:T,pageX:N,pageY:W}}=this.parent.viewport;this.rotation=h,this.pageRotation=(360+h-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[f,T],this.pageTranslation=[N,W];const[it,tt]=this.parentDimensions;this.x=a.x/it,this.y=a.y/tt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,u.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(a){const h=new rt({id:a.parent.getNextId(),parent:a.parent,uiManager:a._uiManager});h.annotationElementId=a.annotationElementId,h.deleted=!0,h._uiManager.addToAnnotationStorage(h)}static initialize(a,h=null){if(i._l10nPromise||(i._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(T=>[T,a.get(T)]))),h!=null&&h.strings)for(const T of h.strings)i._l10nPromise.set(T,a.get(T));if(i._borderLineWidth!==-1)return;const f=getComputedStyle(document.documentElement);i._borderLineWidth=parseFloat(f.getPropertyValue("--outline-width"))||0}static updateDefaultParams(a,h){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(a){return!1}static paste(a,h){(0,u.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,v)}set _isDraggable(a){var h;ot(this,v,a),(h=this.div)==null||h.classList.toggle("draggable",a)}center(){const[a,h]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*h/(a*2),this.y+=this.width*a/(h*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*h/(a*2),this.y-=this.width*a/(h*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(a){this._uiManager.addCommands(a)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,l)}setParent(a){a!==null&&(this.pageIndex=a.pageIndex,this.pageDimensions=a.pageDimensions),this.parent=a}focusin(a){this._focusEventsAllowed&&(t(this,E)?ot(this,E,!1):this.parent.setSelected(this))}focusout(a){var f;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const h=a.relatedTarget;h!=null&&h.closest(`#${this.id}`)||(a.preventDefault(),(f=this.parent)!=null&&f.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(a,h,f,T){const[N,W]=this.parentDimensions;[f,T]=this.screenToPageTranslation(f,T),this.x=(a+f)/N,this.y=(h+T)/W,this.fixAndSetPosition()}translate(a,h){Y(this,d,Ue).call(this,this.parentDimensions,a,h)}translateInPage(a,h){Y(this,d,Ue).call(this,this.pageDimensions,a,h),this.div.scrollIntoView({block:"nearest"})}drag(a,h){const[f,T]=this.parentDimensions;if(this.x+=a/f,this.y+=h/T,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:et,y:ht}=this.div.getBoundingClientRect();this.parent.findNewParent(this,et,ht)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:N,y:W}=this;const[it,tt]=Y(this,A,We).call(this);N+=it,W+=tt,this.div.style.left=`${(100*N).toFixed(2)}%`,this.div.style.top=`${(100*W).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[a,h]=this.pageDimensions;let{x:f,y:T,width:N,height:W}=this;switch(N*=a,W*=h,f*=a,T*=h,this.rotation){case 0:f=Math.max(0,Math.min(a-N,f)),T=Math.max(0,Math.min(h-W,T));break;case 90:f=Math.max(0,Math.min(a-W,f)),T=Math.min(h,Math.max(N,T));break;case 180:f=Math.min(a,Math.max(N,f)),T=Math.min(h,Math.max(W,T));break;case 270:f=Math.min(a,Math.max(W,f)),T=Math.max(0,Math.min(h-N,T));break}this.x=f/=a,this.y=T/=h;const[it,tt]=Y(this,A,We).call(this);f+=it,T+=tt;const{style:et}=this.div;et.left=`${(100*f).toFixed(2)}%`,et.top=`${(100*T).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(a,h){var f;return Y(f=i,F,He).call(f,a,h,this.parentRotation)}pageTranslationToScreen(a,h){var f;return Y(f=i,F,He).call(f,a,h,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:a,pageDimensions:[h,f]}=this,T=h*a,N=f*a;return u.FeatureTest.isCSSRoundSupported?[Math.round(T),Math.round(N)]:[T,N]}setDims(a,h){var N;const[f,T]=this.parentDimensions;this.div.style.width=`${(100*a/f).toFixed(2)}%`,t(this,k)||(this.div.style.height=`${(100*h/T).toFixed(2)}%`),(N=t(this,m))==null||N.classList.toggle("small",a<i.SMALL_EDITOR_SIZE||h<i.SMALL_EDITOR_SIZE)}fixDims(){const{style:a}=this.div,{height:h,width:f}=a,T=f.endsWith("%"),N=!t(this,k)&&h.endsWith("%");if(T&&N)return;const[W,it]=this.parentDimensions;T||(a.width=`${(100*parseFloat(f)/W).toFixed(2)}%`),!t(this,k)&&!N&&(a.height=`${(100*parseFloat(h)/it).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,m))return;const a=ot(this,m,document.createElement("button"));a.className="altText";const h=await i._l10nPromise.get("editor_alt_text_button_label");a.textContent=h,a.setAttribute("aria-label",h),a.tabIndex="0",a.addEventListener("contextmenu",$.noContextMenu),a.addEventListener("pointerdown",f=>f.stopPropagation()),a.addEventListener("click",f=>{f.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),a.addEventListener("keydown",f=>{f.target===a&&f.key==="Enter"&&(f.preventDefault(),this._uiManager.editAltText(this))}),Y(this,mt,Ge).call(this),this.div.append(a),i.SMALL_EDITOR_SIZE||(i.SMALL_EDITOR_SIZE=Math.min(128,Math.round(a.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,R),decorative:t(this,y)}}set altTextData({altText:a,decorative:h}){t(this,R)===a&&t(this,y)===h||(ot(this,R,a),ot(this,y,h),Y(this,mt,Ge).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,w)),this.div.addEventListener("focusout",t(this,p));const[a,h]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*h/a).toFixed(2)}%`,this.div.style.maxHeight=`${(100*a/h).toFixed(2)}%`);const[f,T]=this.getInitialTranslation();return this.translate(f,T),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(a){const{isMac:h}=u.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&h){a.preventDefault();return}ot(this,E,!0),Y(this,wt,wn).call(this,a)}moveInDOM(){var a;(a=this.parent)==null||a.moveEditorInDOM(this)}_setParentAndPosition(a,h,f){a.changeParent(this),this.x=h,this.y=f,this.fixAndSetPosition()}getRect(a,h){const f=this.parentScale,[T,N]=this.pageDimensions,[W,it]=this.pageTranslation,tt=a/f,et=h/f,ht=this.x*T,bt=this.y*N,ut=this.width*T,Ft=this.height*N;switch(this.rotation){case 0:return[ht+tt+W,N-bt-et-Ft+it,ht+tt+ut+W,N-bt-et+it];case 90:return[ht+et+W,N-bt+tt+it,ht+et+Ft+W,N-bt+tt+ut+it];case 180:return[ht-tt-ut+W,N-bt+et+it,ht-tt+W,N-bt+et+Ft+it];case 270:return[ht-et-Ft+W,N-bt-tt-ut+it,ht-et+W,N-bt-tt+it];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(a,h){const[f,T,N,W]=a,it=N-f,tt=W-T;switch(this.rotation){case 0:return[f,h-W,it,tt];case 90:return[f,h-T,tt,it];case 180:return[N,h-T,it,tt];case 270:return[N,h-W,tt,it];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ot(this,C,!0)}disableEditMode(){ot(this,C,!1)}isInEditMode(){return t(this,C)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var a,h;(a=this.div)==null||a.addEventListener("focusin",t(this,w)),(h=this.div)==null||h.addEventListener("focusout",t(this,p))}serialize(a=!1,h=null){(0,u.unreachable)("An editor must be serializable")}static deserialize(a,h,f){const T=new this.prototype.constructor({parent:h,id:h.getNextId(),uiManager:f});T.rotation=a.rotation;const[N,W]=T.pageDimensions,[it,tt,et,ht]=T.getRectInCurrentCoords(a.rect,W);return T.x=it/N,T.y=tt/W,T.width=et/N,T.height=ht/W,T}remove(){var a;this.div.removeEventListener("focusin",t(this,w)),this.div.removeEventListener("focusout",t(this,p)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(a=t(this,m))==null||a.remove(),ot(this,m,null),ot(this,O,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,S,En).call(this),t(this,_).classList.remove("hidden"))}select(){var a;this.makeResizable(),(a=this.div)==null||a.classList.add("selectedEditor")}unselect(){var a,h,f;(a=t(this,_))==null||a.classList.add("hidden"),(h=this.div)==null||h.classList.remove("selectedEditor"),(f=this.div)!=null&&f.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(a,h){}disableEditing(){t(this,m)&&(t(this,m).hidden=!0)}enableEditing(){t(this,m)&&(t(this,m).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,P)}set isEditing(a){ot(this,P,a),this.parent&&(a?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(a,h){ot(this,k,!0);const f=a/h,{style:T}=this.div;T.aspectRatio=f,T.height="auto"}static get MIN_SIZE(){return 16}};R=new WeakMap,y=new WeakMap,m=new WeakMap,O=new WeakMap,j=new WeakMap,k=new WeakMap,_=new WeakMap,w=new WeakMap,p=new WeakMap,E=new WeakMap,P=new WeakMap,C=new WeakMap,v=new WeakMap,l=new WeakMap,d=new WeakSet,Ue=function([a,h],f,T){[f,T]=this.screenToPageTranslation(f,T),this.x+=f/a,this.y+=T/h,this.fixAndSetPosition()},A=new WeakSet,We=function(){const[a,h]=this.parentDimensions,{_borderLineWidth:f}=i,T=f/a,N=f/h;switch(this.rotation){case 90:return[-T,N];case 180:return[T,N];case 270:return[T,-N];default:return[-T,-N]}},F=new WeakSet,He=function(a,h,f){switch(f){case 90:return[h,-a];case 180:return[-a,-h];case 270:return[-h,a];default:return[a,h]}},G=new WeakSet,$e=function(a){switch(a){case 90:{const[h,f]=this.pageDimensions;return[0,-h/f,f/h,0]}case 180:return[-1,0,0,-1];case 270:{const[h,f]=this.pageDimensions;return[0,h/f,-f/h,0]}default:return[1,0,0,1]}},S=new WeakSet,En=function(){if(t(this,_))return;ot(this,_,document.createElement("div")),t(this,_).classList.add("resizers");const a=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||a.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const h of a){const f=document.createElement("div");t(this,_).append(f),f.classList.add("resizer",h),f.addEventListener("pointerdown",Y(this,at,Sn).bind(this,h)),f.addEventListener("contextmenu",$.noContextMenu)}this.div.prepend(t(this,_))},at=new WeakSet,Sn=function(a,h){h.preventDefault();const{isMac:f}=u.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&f)return;const T=Y(this,V,xn).bind(this,a),N=this._isDraggable;this._isDraggable=!1;const W={passive:!0,capture:!0};window.addEventListener("pointermove",T,W);const it=this.x,tt=this.y,et=this.width,ht=this.height,bt=this.parent.div.style.cursor,ut=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(h.target).cursor;const Ft=()=>{this._isDraggable=N,window.removeEventListener("pointerup",Ft),window.removeEventListener("blur",Ft),window.removeEventListener("pointermove",T,W),this.parent.div.style.cursor=bt,this.div.style.cursor=ut;const Bt=this.x,St=this.y,Lt=this.width,gt=this.height;Bt===it&&St===tt&&Lt===et&&gt===ht||this.addCommands({cmd:()=>{this.width=Lt,this.height=gt,this.x=Bt,this.y=St;const[nt,st]=this.parentDimensions;this.setDims(nt*Lt,st*gt),this.fixAndSetPosition()},undo:()=>{this.width=et,this.height=ht,this.x=it,this.y=tt;const[nt,st]=this.parentDimensions;this.setDims(nt*et,st*ht),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Ft),window.addEventListener("blur",Ft)},V=new WeakSet,xn=function(a,h){const[f,T]=this.parentDimensions,N=this.x,W=this.y,it=this.width,tt=this.height,et=i.MIN_SIZE/f,ht=i.MIN_SIZE/T,bt=At=>Math.round(At*1e4)/1e4,ut=Y(this,G,$e).call(this,this.rotation),Ft=(At,vt)=>[ut[0]*At+ut[2]*vt,ut[1]*At+ut[3]*vt],Bt=Y(this,G,$e).call(this,360-this.rotation),St=(At,vt)=>[Bt[0]*At+Bt[2]*vt,Bt[1]*At+Bt[3]*vt];let Lt,gt,nt=!1,st=!1;switch(a){case"topLeft":nt=!0,Lt=(At,vt)=>[0,0],gt=(At,vt)=>[At,vt];break;case"topMiddle":Lt=(At,vt)=>[At/2,0],gt=(At,vt)=>[At/2,vt];break;case"topRight":nt=!0,Lt=(At,vt)=>[At,0],gt=(At,vt)=>[0,vt];break;case"middleRight":st=!0,Lt=(At,vt)=>[At,vt/2],gt=(At,vt)=>[0,vt/2];break;case"bottomRight":nt=!0,Lt=(At,vt)=>[At,vt],gt=(At,vt)=>[0,0];break;case"bottomMiddle":Lt=(At,vt)=>[At/2,vt],gt=(At,vt)=>[At/2,0];break;case"bottomLeft":nt=!0,Lt=(At,vt)=>[0,vt],gt=(At,vt)=>[At,0];break;case"middleLeft":st=!0,Lt=(At,vt)=>[0,vt/2],gt=(At,vt)=>[At,vt/2];break}const pt=Lt(it,tt),Tt=gt(it,tt);let Ct=Ft(...Tt);const Ut=bt(N+Ct[0]),Vt=bt(W+Ct[1]);let Wt=1,zt=1,[Gt,Ht]=this.screenToPageTranslation(h.movementX,h.movementY);if([Gt,Ht]=St(Gt/f,Ht/T),nt){const At=Math.hypot(it,tt);Wt=zt=Math.max(Math.min(Math.hypot(Tt[0]-pt[0]-Gt,Tt[1]-pt[1]-Ht)/At,1/it,1/tt),et/it,ht/tt)}else st?Wt=Math.max(et,Math.min(1,Math.abs(Tt[0]-pt[0]-Gt)))/it:zt=Math.max(ht,Math.min(1,Math.abs(Tt[1]-pt[1]-Ht)))/tt;const Xt=bt(it*Wt),ft=bt(tt*zt);Ct=Ft(...gt(Xt,ft));const Z=Ut-Ct[0],K=Vt-Ct[1];this.width=Xt,this.height=ft,this.x=Z,this.y=K,this.setDims(f*Xt,T*ft),this.fixAndSetPosition()},mt=new WeakSet,Ge=async function(){var f;const a=t(this,m);if(!a)return;if(!t(this,R)&&!t(this,y)){a.classList.remove("done"),(f=t(this,O))==null||f.remove();return}i._l10nPromise.get("editor_alt_text_edit_button_label").then(T=>{a.setAttribute("aria-label",T)});let h=t(this,O);if(!h){ot(this,O,h=document.createElement("span")),h.className="tooltip",h.setAttribute("role","tooltip");const T=h.id=`alt-text-tooltip-${this.id}`;a.setAttribute("aria-describedby",T);const N=100;a.addEventListener("mouseenter",()=>{ot(this,j,setTimeout(()=>{ot(this,j,null),t(this,O).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},N))}),a.addEventListener("mouseleave",()=>{var W;clearTimeout(t(this,j)),ot(this,j,null),(W=t(this,O))==null||W.classList.remove("show")})}a.classList.add("done"),h.innerText=t(this,y)?await i._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,R),h.parentNode||a.append(h)},wt=new WeakSet,wn=function(a){if(!this._isDraggable)return;const h=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let f,T;h&&(f={passive:!0,capture:!0},T=W=>{const[it,tt]=this.screenToPageTranslation(W.movementX,W.movementY);this._uiManager.dragSelectedEditors(it,tt)},window.addEventListener("pointermove",T,f));const N=()=>{if(window.removeEventListener("pointerup",N),window.removeEventListener("blur",N),h&&window.removeEventListener("pointermove",T,f),ot(this,E,!1),!this._uiManager.endDragSession()){const{isMac:W}=u.FeatureTest.platform;a.ctrlKey&&!W||a.shiftKey||a.metaKey&&W?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",N),window.addEventListener("blur",N)},H(i,F),ne(i,"_borderLineWidth",-1),ne(i,"_colorManager",new n.ColorManager),ne(i,"_zIndex",1),ne(i,"SMALL_EDITOR_SIZE",0);let L=i;e.AnnotationEditor=L;class rt extends L{constructor(a){super(a),this.annotationElementId=a.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(g,e,D)=>{var k,_,w,p,E,Ve,v,l,d,I,A,Tn,b,G,z,S,X,at,ct,V,dt,mt,Et,wt,M,i,o,a,h,f,T,N,W,it,tt,et,ht,bt,ut,Ft,Bt,St,Lt,gt,nt,st,pt,Cn,Ct,ze,Vt,Xe,zt,Te,Ht,qe,ft,Ye,K,ae,vt,be,te,Pn,xt,Rn,Pt,Ke,jt,_e,yt,Je;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=$,e.opacityToHex=L;var n=D(1),u=D(6);function $(B,s,x){for(const U of x)s.addEventListener(U,B[U].bind(B))}function L(B){return Math.round(Math.min(255,Math.max(1,255*B))).toString(16).padStart(2,"0")}class rt{constructor(){H(this,k,0)}getId(){return`${n.AnnotationEditorPrefix}${me(this,k)._++}`}}k=new WeakMap;const C=class C{constructor(){H(this,E);H(this,_,(0,n.getUuid)());H(this,w,0);H(this,p,null)}static get _isSVGFittingCanvas(){const s='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',U=new OffscreenCanvas(1,3).getContext("2d"),q=new Image;q.src=s;const J=q.decode().then(()=>(U.drawImage(q,0,0,1,1,0,0,1,3),new Uint32Array(U.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",J)}async getFromFile(s){const{lastModified:x,name:U,size:q,type:J}=s;return Y(this,E,Ve).call(this,`${x}_${U}_${q}_${J}`,s)}async getFromUrl(s){return Y(this,E,Ve).call(this,s,s)}async getFromId(s){t(this,p)||ot(this,p,new Map);const x=t(this,p).get(s);return x?x.bitmap?(x.refCounter+=1,x):x.file?this.getFromFile(x.file):this.getFromUrl(x.url):null}getSvgUrl(s){const x=t(this,p).get(s);return x!=null&&x.isSvg?x.svgUrl:null}deleteId(s){t(this,p)||ot(this,p,new Map);const x=t(this,p).get(s);x&&(x.refCounter-=1,x.refCounter===0&&(x.bitmap=null))}isValidId(s){return s.startsWith(`image_${t(this,_)}_`)}};_=new WeakMap,w=new WeakMap,p=new WeakMap,E=new WeakSet,Ve=async function(s,x){t(this,p)||ot(this,p,new Map);let U=t(this,p).get(s);if(U===null)return null;if(U!=null&&U.bitmap)return U.refCounter+=1,U;try{U||(U={bitmap:null,id:`image_${t(this,_)}_${me(this,w)._++}`,refCounter:0,isSvg:!1});let q;if(typeof x=="string"){U.url=x;const J=await fetch(x);if(!J.ok)throw new Error(J.statusText);q=await J.blob()}else q=U.file=x;if(q.type==="image/svg+xml"){const J=C._isSVGFittingCanvas,lt=new FileReader,_t=new Image,kt=new Promise((Rt,qt)=>{_t.onload=()=>{U.bitmap=_t,U.isSvg=!0,Rt()},lt.onload=async()=>{const Mt=U.svgUrl=lt.result;_t.src=await J?`${Mt}#svgView(preserveAspectRatio(none))`:Mt},_t.onerror=lt.onerror=qt});lt.readAsDataURL(q),await kt}else U.bitmap=await createImageBitmap(q);U.refCounter=1}catch(q){console.error(q),U=null}return t(this,p).set(s,U),U&&t(this,p).set(U.id,U),U};let R=C;class y{constructor(s=128){H(this,v,[]);H(this,l,!1);H(this,d,void 0);H(this,I,-1);ot(this,d,s)}add({cmd:s,undo:x,mustExec:U,type:q=NaN,overwriteIfSameType:J=!1,keepUndo:lt=!1}){if(U&&s(),t(this,l))return;const _t={cmd:s,undo:x,type:q};if(t(this,I)===-1){t(this,v).length>0&&(t(this,v).length=0),ot(this,I,0),t(this,v).push(_t);return}if(J&&t(this,v)[t(this,I)].type===q){lt&&(_t.undo=t(this,v)[t(this,I)].undo),t(this,v)[t(this,I)]=_t;return}const kt=t(this,I)+1;kt===t(this,d)?t(this,v).splice(0,1):(ot(this,I,kt),kt<t(this,v).length&&t(this,v).splice(kt)),t(this,v).push(_t)}undo(){t(this,I)!==-1&&(ot(this,l,!0),t(this,v)[t(this,I)].undo(),ot(this,l,!1),ot(this,I,t(this,I)-1))}redo(){t(this,I)<t(this,v).length-1&&(ot(this,I,t(this,I)+1),ot(this,l,!0),t(this,v)[t(this,I)].cmd(),ot(this,l,!1))}hasSomethingToUndo(){return t(this,I)!==-1}hasSomethingToRedo(){return t(this,I)<t(this,v).length-1}destroy(){ot(this,v,null)}}v=new WeakMap,l=new WeakMap,d=new WeakMap,I=new WeakMap,e.CommandManager=y;class m{constructor(s){H(this,A);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:x}=n.FeatureTest.platform;for(const[U,q,J={}]of s)for(const lt of U){const _t=lt.startsWith("mac+");x&&_t?(this.callbacks.set(lt.slice(4),{callback:q,options:J}),this.allKeys.add(lt.split("+").at(-1))):!x&&!_t&&(this.callbacks.set(lt,{callback:q,options:J}),this.allKeys.add(lt.split("+").at(-1)))}}exec(s,x){if(!this.allKeys.has(x.key))return;const U=this.callbacks.get(Y(this,A,Tn).call(this,x));if(!U)return;const{callback:q,options:{bubbles:J=!1,args:lt=[],checker:_t=null}}=U;_t&&!_t(s,x)||(q.bind(s,...lt)(),J||(x.stopPropagation(),x.preventDefault()))}}A=new WeakSet,Tn=function(s){s.altKey&&this.buffer.push("alt"),s.ctrlKey&&this.buffer.push("ctrl"),s.metaKey&&this.buffer.push("meta"),s.shiftKey&&this.buffer.push("shift"),this.buffer.push(s.key);const x=this.buffer.join("+");return this.buffer.length=0,x},e.KeyboardManager=m;const F=class F{get _colors(){const s=new Map([["CanvasText",null],["Canvas",null]]);return(0,u.getColorValues)(s),(0,n.shadow)(this,"_colors",s)}convert(s){const x=(0,u.getRGB)(s);if(!window.matchMedia("(forced-colors: active)").matches)return x;for(const[U,q]of this._colors)if(q.every((J,lt)=>J===x[lt]))return F._colorsMapping.get(U);return x}getHexCode(s){const x=this._colors.get(s);return x?n.Util.makeHexColor(...x):s}};ne(F,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let O=F;e.ColorManager=O;const Ot=class Ot{constructor(s,x,U,q,J,lt){H(this,pt);H(this,Ct);H(this,Vt);H(this,zt);H(this,Ht);H(this,ft);H(this,K);H(this,vt);H(this,te);H(this,xt);H(this,Pt);H(this,jt);H(this,yt);H(this,b,null);H(this,G,new Map);H(this,z,new Map);H(this,S,null);H(this,X,null);H(this,at,new y);H(this,ct,0);H(this,V,new Set);H(this,dt,null);H(this,mt,null);H(this,Et,new Set);H(this,wt,null);H(this,M,new rt);H(this,i,!1);H(this,o,!1);H(this,a,null);H(this,h,n.AnnotationEditorType.NONE);H(this,f,new Set);H(this,T,null);H(this,N,this.blur.bind(this));H(this,W,this.focus.bind(this));H(this,it,this.copy.bind(this));H(this,tt,this.cut.bind(this));H(this,et,this.paste.bind(this));H(this,ht,this.keydown.bind(this));H(this,bt,this.onEditingAction.bind(this));H(this,ut,this.onPageChanging.bind(this));H(this,Ft,this.onScaleChanging.bind(this));H(this,Bt,this.onRotationChanging.bind(this));H(this,St,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});H(this,Lt,[0,0]);H(this,gt,null);H(this,nt,null);H(this,st,null);ot(this,nt,s),ot(this,st,x),ot(this,S,U),this._eventBus=q,this._eventBus._on("editingaction",t(this,bt)),this._eventBus._on("pagechanging",t(this,ut)),this._eventBus._on("scalechanging",t(this,Ft)),this._eventBus._on("rotationchanging",t(this,Bt)),ot(this,X,J.annotationStorage),ot(this,wt,J.filterFactory),ot(this,T,lt),this.viewParameters={realScale:u.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const s=Ot.prototype,x=J=>{const{activeElement:lt}=document;return lt&&t(J,nt).contains(lt)&&J.hasSomethingToControl()},U=this.TRANSLATE_SMALL,q=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],s.selectAll],[["ctrl+z","mac+meta+z"],s.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],s.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],s.delete],[["Escape","mac+Escape"],s.unselectAll],[["ArrowLeft","mac+ArrowLeft"],s.translateSelectedEditors,{args:[-U,0],checker:x}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s.translateSelectedEditors,{args:[-q,0],checker:x}],[["ArrowRight","mac+ArrowRight"],s.translateSelectedEditors,{args:[U,0],checker:x}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s.translateSelectedEditors,{args:[q,0],checker:x}],[["ArrowUp","mac+ArrowUp"],s.translateSelectedEditors,{args:[0,-U],checker:x}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s.translateSelectedEditors,{args:[0,-q],checker:x}],[["ArrowDown","mac+ArrowDown"],s.translateSelectedEditors,{args:[0,U],checker:x}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s.translateSelectedEditors,{args:[0,q],checker:x}]]))}destroy(){Y(this,zt,Te).call(this),Y(this,Ct,ze).call(this),this._eventBus._off("editingaction",t(this,bt)),this._eventBus._off("pagechanging",t(this,ut)),this._eventBus._off("scalechanging",t(this,Ft)),this._eventBus._off("rotationchanging",t(this,Bt));for(const s of t(this,z).values())s.destroy();t(this,z).clear(),t(this,G).clear(),t(this,Et).clear(),ot(this,b,null),t(this,f).clear(),t(this,at).destroy(),t(this,S).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,T)?t(this,wt).addHCMFilter(t(this,T).foreground,t(this,T).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,nt)).direction)}editAltText(s){var x;(x=t(this,S))==null||x.editAltText(this,s)}onPageChanging({pageNumber:s}){ot(this,ct,s-1)}focusMainContainer(){t(this,nt).focus()}findParent(s,x){for(const U of t(this,z).values()){const{x:q,y:J,width:lt,height:_t}=U.div.getBoundingClientRect();if(s>=q&&s<=q+lt&&x>=J&&x<=J+_t)return U}return null}disableUserSelect(s=!1){t(this,st).classList.toggle("noUserSelect",s)}addShouldRescale(s){t(this,Et).add(s)}removeShouldRescale(s){t(this,Et).delete(s)}onScaleChanging({scale:s}){this.commitOrRemove(),this.viewParameters.realScale=s*u.PixelsPerInch.PDF_TO_CSS_UNITS;for(const x of t(this,Et))x.onScaleChanging()}onRotationChanging({pagesRotation:s}){this.commitOrRemove(),this.viewParameters.rotation=s}addToAnnotationStorage(s){!s.isEmpty()&&t(this,X)&&!t(this,X).has(s.id)&&t(this,X).setValue(s.id,s)}blur(){if(!this.hasSelection)return;const{activeElement:s}=document;for(const x of t(this,f))if(x.div.contains(s)){ot(this,a,[x,s]),x._focusEventsAllowed=!1;break}}focus(){if(!t(this,a))return;const[s,x]=t(this,a);ot(this,a,null),x.addEventListener("focusin",()=>{s._focusEventsAllowed=!0},{once:!0}),x.focus()}addEditListeners(){Y(this,Vt,Xe).call(this),Y(this,Ht,qe).call(this)}removeEditListeners(){Y(this,zt,Te).call(this),Y(this,ft,Ye).call(this)}copy(s){var U;if(s.preventDefault(),(U=t(this,b))==null||U.commitOrRemove(),!this.hasSelection)return;const x=[];for(const q of t(this,f)){const J=q.serialize(!0);J&&x.push(J)}x.length!==0&&s.clipboardData.setData("application/pdfjs",JSON.stringify(x))}cut(s){this.copy(s),this.delete()}paste(s){s.preventDefault();const{clipboardData:x}=s;for(const J of x.items)for(const lt of t(this,mt))if(lt.isHandlingMimeForPasting(J.type)){lt.paste(J,this.currentLayer);return}let U=x.getData("application/pdfjs");if(!U)return;try{U=JSON.parse(U)}catch(J){(0,n.warn)(`paste: "${J.message}".`);return}if(!Array.isArray(U))return;this.unselectAll();const q=this.currentLayer;try{const J=[];for(const kt of U){const Rt=q.deserialize(kt);if(!Rt)return;J.push(Rt)}const lt=()=>{for(const kt of J)Y(this,Pt,Ke).call(this,kt);Y(this,yt,Je).call(this,J)},_t=()=>{for(const kt of J)kt.remove()};this.addCommands({cmd:lt,undo:_t,mustExec:!0})}catch(J){(0,n.warn)(`paste: "${J.message}".`)}}keydown(s){var x;(x=this.getActive())!=null&&x.shouldGetKeyboardEvents()||Ot._keyboardManager.exec(this,s)}onEditingAction(s){["undo","redo","delete","selectAll"].includes(s.name)&&this[s.name]()}setEditingState(s){s?(Y(this,pt,Cn).call(this),Y(this,Vt,Xe).call(this),Y(this,Ht,qe).call(this),Y(this,K,ae).call(this,{isEditing:t(this,h)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,jt,_e).call(this),hasSomethingToUndo:t(this,at).hasSomethingToUndo(),hasSomethingToRedo:t(this,at).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,Ct,ze).call(this),Y(this,zt,Te).call(this),Y(this,ft,Ye).call(this),Y(this,K,ae).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(s){if(!t(this,mt)){ot(this,mt,s);for(const x of t(this,mt))Y(this,vt,be).call(this,x.defaultPropertiesToUpdate)}}getId(){return t(this,M).getId()}get currentLayer(){return t(this,z).get(t(this,ct))}getLayer(s){return t(this,z).get(s)}get currentPageIndex(){return t(this,ct)}addLayer(s){t(this,z).set(s.pageIndex,s),t(this,i)?s.enable():s.disable()}removeLayer(s){t(this,z).delete(s.pageIndex)}updateMode(s,x=null){if(t(this,h)!==s){if(ot(this,h,s),s===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,xt,Rn).call(this);return}this.setEditingState(!0),Y(this,te,Pn).call(this),this.unselectAll();for(const U of t(this,z).values())U.updateMode(s);if(x){for(const U of t(this,G).values())if(U.annotationElementId===x){this.setSelected(U),U.enterInEditMode();break}}}}updateToolbar(s){s!==t(this,h)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:s})}updateParams(s,x){if(t(this,mt)){if(s===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(s);return}for(const U of t(this,f))U.updateParams(s,x);for(const U of t(this,mt))U.updateDefaultParams(s,x)}}enableWaiting(s=!1){if(t(this,o)!==s){ot(this,o,s);for(const x of t(this,z).values())s?x.disableClick():x.enableClick(),x.div.classList.toggle("waiting",s)}}getEditors(s){const x=[];for(const U of t(this,G).values())U.pageIndex===s&&x.push(U);return x}getEditor(s){return t(this,G).get(s)}addEditor(s){t(this,G).set(s.id,s)}removeEditor(s){var x;t(this,G).delete(s.id),this.unselect(s),(!s.annotationElementId||!t(this,V).has(s.annotationElementId))&&((x=t(this,X))==null||x.remove(s.id))}addDeletedAnnotationElement(s){t(this,V).add(s.annotationElementId),s.deleted=!0}isDeletedAnnotationElement(s){return t(this,V).has(s)}removeDeletedAnnotationElement(s){t(this,V).delete(s.annotationElementId),s.deleted=!1}setActiveEditor(s){t(this,b)!==s&&(ot(this,b,s),s&&Y(this,vt,be).call(this,s.propertiesToUpdate))}toggleSelected(s){if(t(this,f).has(s)){t(this,f).delete(s),s.unselect(),Y(this,K,ae).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,f).add(s),s.select(),Y(this,vt,be).call(this,s.propertiesToUpdate),Y(this,K,ae).call(this,{hasSelectedEditor:!0})}setSelected(s){for(const x of t(this,f))x!==s&&x.unselect();t(this,f).clear(),t(this,f).add(s),s.select(),Y(this,vt,be).call(this,s.propertiesToUpdate),Y(this,K,ae).call(this,{hasSelectedEditor:!0})}isSelected(s){return t(this,f).has(s)}unselect(s){s.unselect(),t(this,f).delete(s),Y(this,K,ae).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,f).size!==0}undo(){t(this,at).undo(),Y(this,K,ae).call(this,{hasSomethingToUndo:t(this,at).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,jt,_e).call(this)})}redo(){t(this,at).redo(),Y(this,K,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,at).hasSomethingToRedo(),isEmpty:Y(this,jt,_e).call(this)})}addCommands(s){t(this,at).add(s),Y(this,K,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,jt,_e).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const s=[...t(this,f)],x=()=>{for(const q of s)q.remove()},U=()=>{for(const q of s)Y(this,Pt,Ke).call(this,q)};this.addCommands({cmd:x,undo:U,mustExec:!0})}commitOrRemove(){var s;(s=t(this,b))==null||s.commitOrRemove()}hasSomethingToControl(){return t(this,b)||this.hasSelection}selectAll(){for(const s of t(this,f))s.commit();Y(this,yt,Je).call(this,t(this,G).values())}unselectAll(){if(t(this,b)){t(this,b).commitOrRemove();return}if(this.hasSelection){for(const s of t(this,f))s.unselect();t(this,f).clear(),Y(this,K,ae).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(s,x,U=!1){if(U||this.commitOrRemove(),!this.hasSelection)return;t(this,Lt)[0]+=s,t(this,Lt)[1]+=x;const[q,J]=t(this,Lt),lt=[...t(this,f)],_t=1e3;t(this,gt)&&clearTimeout(t(this,gt)),ot(this,gt,setTimeout(()=>{ot(this,gt,null),t(this,Lt)[0]=t(this,Lt)[1]=0,this.addCommands({cmd:()=>{for(const kt of lt)t(this,G).has(kt.id)&&kt.translateInPage(q,J)},undo:()=>{for(const kt of lt)t(this,G).has(kt.id)&&kt.translateInPage(-q,-J)},mustExec:!1})},_t));for(const kt of lt)kt.translateInPage(s,x)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ot(this,dt,new Map);for(const s of t(this,f))t(this,dt).set(s,{savedX:s.x,savedY:s.y,savedPageIndex:s.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,dt))return!1;this.disableUserSelect(!1);const s=t(this,dt);ot(this,dt,null);let x=!1;for(const[{x:q,y:J,pageIndex:lt},_t]of s)_t.newX=q,_t.newY=J,_t.newPageIndex=lt,x||(x=q!==_t.savedX||J!==_t.savedY||lt!==_t.savedPageIndex);if(!x)return!1;const U=(q,J,lt,_t)=>{if(t(this,G).has(q.id)){const kt=t(this,z).get(_t);kt?q._setParentAndPosition(kt,J,lt):(q.pageIndex=_t,q.x=J,q.y=lt)}};return this.addCommands({cmd:()=>{for(const[q,{newX:J,newY:lt,newPageIndex:_t}]of s)U(q,J,lt,_t)},undo:()=>{for(const[q,{savedX:J,savedY:lt,savedPageIndex:_t}]of s)U(q,J,lt,_t)},mustExec:!0}),!0}dragSelectedEditors(s,x){if(t(this,dt))for(const U of t(this,dt).keys())U.drag(s,x)}rebuild(s){if(s.parent===null){const x=this.getLayer(s.pageIndex);x?(x.changeParent(s),x.addOrRebuild(s)):(this.addEditor(s),this.addToAnnotationStorage(s),s.rebuild())}else s.parent.addOrRebuild(s)}isActive(s){return t(this,b)===s}getActive(){return t(this,b)}getMode(){return t(this,h)}get imageManager(){return(0,n.shadow)(this,"imageManager",new R)}};b=new WeakMap,G=new WeakMap,z=new WeakMap,S=new WeakMap,X=new WeakMap,at=new WeakMap,ct=new WeakMap,V=new WeakMap,dt=new WeakMap,mt=new WeakMap,Et=new WeakMap,wt=new WeakMap,M=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,h=new WeakMap,f=new WeakMap,T=new WeakMap,N=new WeakMap,W=new WeakMap,it=new WeakMap,tt=new WeakMap,et=new WeakMap,ht=new WeakMap,bt=new WeakMap,ut=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,St=new WeakMap,Lt=new WeakMap,gt=new WeakMap,nt=new WeakMap,st=new WeakMap,pt=new WeakSet,Cn=function(){window.addEventListener("focus",t(this,W)),window.addEventListener("blur",t(this,N))},Ct=new WeakSet,ze=function(){window.removeEventListener("focus",t(this,W)),window.removeEventListener("blur",t(this,N))},Vt=new WeakSet,Xe=function(){window.addEventListener("keydown",t(this,ht),{capture:!0})},zt=new WeakSet,Te=function(){window.removeEventListener("keydown",t(this,ht),{capture:!0})},Ht=new WeakSet,qe=function(){document.addEventListener("copy",t(this,it)),document.addEventListener("cut",t(this,tt)),document.addEventListener("paste",t(this,et))},ft=new WeakSet,Ye=function(){document.removeEventListener("copy",t(this,it)),document.removeEventListener("cut",t(this,tt)),document.removeEventListener("paste",t(this,et))},K=new WeakSet,ae=function(s){Object.entries(s).some(([U,q])=>t(this,St)[U]!==q)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,St),s)})},vt=new WeakSet,be=function(s){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:s})},te=new WeakSet,Pn=function(){if(!t(this,i)){ot(this,i,!0);for(const s of t(this,z).values())s.enable()}},xt=new WeakSet,Rn=function(){if(this.unselectAll(),t(this,i)){ot(this,i,!1);for(const s of t(this,z).values())s.disable()}},Pt=new WeakSet,Ke=function(s){const x=t(this,z).get(s.pageIndex);x?x.addOrRebuild(s):this.addEditor(s)},jt=new WeakSet,_e=function(){if(t(this,G).size===0)return!0;if(t(this,G).size===1)for(const s of t(this,G).values())return s.isEmpty();return!1},yt=new WeakSet,Je=function(s){t(this,f).clear();for(const x of s)x.isEmpty()||(t(this,f).add(x),x.select());Y(this,K,ae).call(this,{hasSelectedEditor:!0})},ne(Ot,"TRANSLATE_SMALL",1),ne(Ot,"TRANSLATE_BIG",10);let j=Ot;e.AnnotationEditorUIManager=j},(g,e,D)=>{var ct,V,dt,mt,Et,wt,M,i,o,a,h,f,ue,N,fe,it,Qe,et,Ce,bt,Pe,Ft,Ae,St,ye;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=I,e.getColorValues=G,e.getCurrentTransform=z,e.getCurrentTransformInverse=S,e.getFilenameFromUrl=E,e.getPdfFilenameFromUrl=P,e.getRGB=b,e.getXfaPageViewport=F,e.isDataScheme=w,e.isPdfFile=p,e.isValidFetchUrl=v,e.loadScript=d,e.noContextMenu=l,e.setLayerDimensions=X;var n=D(7),u=D(1);const $="http://www.w3.org/2000/svg",at=class at{};ne(at,"CSS",96),ne(at,"PDF",72),ne(at,"PDF_TO_CSS_UNITS",at.CSS/at.PDF);let L=at;e.PixelsPerInch=L;class rt extends n.BaseFilterFactory{constructor({docId:st,ownerDocument:pt=globalThis.document}={}){super();H(this,f);H(this,N);H(this,it);H(this,et);H(this,bt);H(this,Ft);H(this,St);H(this,ct,void 0);H(this,V,void 0);H(this,dt,void 0);H(this,mt,void 0);H(this,Et,void 0);H(this,wt,void 0);H(this,M,void 0);H(this,i,void 0);H(this,o,void 0);H(this,a,void 0);H(this,h,0);ot(this,dt,st),ot(this,mt,pt)}addFilter(st){if(!st)return"none";let pt=t(this,f,ue).get(st);if(pt)return pt;let Tt,Ct,Ut,Vt;if(st.length===1){const Ht=st[0],Xt=new Array(256);for(let ft=0;ft<256;ft++)Xt[ft]=Ht[ft]/255;Vt=Tt=Ct=Ut=Xt.join(",")}else{const[Ht,Xt,ft]=st,Z=new Array(256),K=new Array(256),At=new Array(256);for(let vt=0;vt<256;vt++)Z[vt]=Ht[vt]/255,K[vt]=Xt[vt]/255,At[vt]=ft[vt]/255;Tt=Z.join(","),Ct=K.join(","),Ut=At.join(","),Vt=`${Tt}${Ct}${Ut}`}if(pt=t(this,f,ue).get(Vt),pt)return t(this,f,ue).set(st,pt),pt;const Wt=`g_${t(this,dt)}_transfer_map_${me(this,h)._++}`,zt=`url(#${Wt})`;t(this,f,ue).set(st,zt),t(this,f,ue).set(Vt,zt);const Gt=Y(this,et,Ce).call(this,Wt);return Y(this,Ft,Ae).call(this,Tt,Ct,Ut,Gt),zt}addHCMFilter(st,pt){var Xt;const Tt=`${st}-${pt}`;if(t(this,wt)===Tt)return t(this,M);if(ot(this,wt,Tt),ot(this,M,"none"),(Xt=t(this,Et))==null||Xt.remove(),!st||!pt)return t(this,M);const Ct=Y(this,St,ye).call(this,st);st=u.Util.makeHexColor(...Ct);const Ut=Y(this,St,ye).call(this,pt);if(pt=u.Util.makeHexColor(...Ut),t(this,N,fe).style.color="",st==="#000000"&&pt==="#ffffff"||st===pt)return t(this,M);const Vt=new Array(256);for(let ft=0;ft<=255;ft++){const Z=ft/255;Vt[ft]=Z<=.03928?Z/12.92:((Z+.055)/1.055)**2.4}const Wt=Vt.join(","),zt=`g_${t(this,dt)}_hcm_filter`,Gt=ot(this,i,Y(this,et,Ce).call(this,zt));Y(this,Ft,Ae).call(this,Wt,Wt,Wt,Gt),Y(this,it,Qe).call(this,Gt);const Ht=(ft,Z)=>{const K=Ct[ft]/255,At=Ut[ft]/255,vt=new Array(Z+1);for(let ee=0;ee<=Z;ee++)vt[ee]=K+ee/Z*(At-K);return vt.join(",")};return Y(this,Ft,Ae).call(this,Ht(0,5),Ht(1,5),Ht(2,5),Gt),ot(this,M,`url(#${zt})`),t(this,M)}addHighlightHCMFilter(st,pt,Tt,Ct){var At;const Ut=`${st}-${pt}-${Tt}-${Ct}`;if(t(this,o)===Ut)return t(this,a);if(ot(this,o,Ut),ot(this,a,"none"),(At=t(this,i))==null||At.remove(),!st||!pt)return t(this,a);const[Vt,Wt]=[st,pt].map(Y(this,St,ye).bind(this));let zt=Math.round(.2126*Vt[0]+.7152*Vt[1]+.0722*Vt[2]),Gt=Math.round(.2126*Wt[0]+.7152*Wt[1]+.0722*Wt[2]),[Ht,Xt]=[Tt,Ct].map(Y(this,St,ye).bind(this));Gt<zt&&([zt,Gt,Ht,Xt]=[Gt,zt,Xt,Ht]),t(this,N,fe).style.color="";const ft=(vt,ee,te)=>{const Q=new Array(256),xt=(Gt-zt)/te,It=vt/255,Pt=(ee-vt)/(255*te);let Nt=0;for(let jt=0;jt<=te;jt++){const Qt=Math.round(zt+jt*xt),yt=It+jt*Pt;for(let Kt=Nt;Kt<=Qt;Kt++)Q[Kt]=yt;Nt=Qt+1}for(let jt=Nt;jt<256;jt++)Q[jt]=Q[Nt-1];return Q.join(",")},Z=`g_${t(this,dt)}_hcm_highlight_filter`,K=ot(this,i,Y(this,et,Ce).call(this,Z));return Y(this,it,Qe).call(this,K),Y(this,Ft,Ae).call(this,ft(Ht[0],Xt[0],5),ft(Ht[1],Xt[1],5),ft(Ht[2],Xt[2],5),K),ot(this,a,`url(#${Z})`),t(this,a)}destroy(st=!1){st&&(t(this,M)||t(this,a))||(t(this,V)&&(t(this,V).parentNode.parentNode.remove(),ot(this,V,null)),t(this,ct)&&(t(this,ct).clear(),ot(this,ct,null)),ot(this,h,0))}}ct=new WeakMap,V=new WeakMap,dt=new WeakMap,mt=new WeakMap,Et=new WeakMap,wt=new WeakMap,M=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,h=new WeakMap,f=new WeakSet,ue=function(){return t(this,ct)||ot(this,ct,new Map)},N=new WeakSet,fe=function(){if(!t(this,V)){const st=t(this,mt).createElement("div"),{style:pt}=st;pt.visibility="hidden",pt.contain="strict",pt.width=pt.height=0,pt.position="absolute",pt.top=pt.left=0,pt.zIndex=-1;const Tt=t(this,mt).createElementNS($,"svg");Tt.setAttribute("width",0),Tt.setAttribute("height",0),ot(this,V,t(this,mt).createElementNS($,"defs")),st.append(Tt),Tt.append(t(this,V)),t(this,mt).body.append(st)}return t(this,V)},it=new WeakSet,Qe=function(st){const pt=t(this,mt).createElementNS($,"feColorMatrix");pt.setAttribute("type","matrix"),pt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),st.append(pt)},et=new WeakSet,Ce=function(st){const pt=t(this,mt).createElementNS($,"filter");return pt.setAttribute("color-interpolation-filters","sRGB"),pt.setAttribute("id",st),t(this,N,fe).append(pt),pt},bt=new WeakSet,Pe=function(st,pt,Tt){const Ct=t(this,mt).createElementNS($,pt);Ct.setAttribute("type","discrete"),Ct.setAttribute("tableValues",Tt),st.append(Ct)},Ft=new WeakSet,Ae=function(st,pt,Tt,Ct){const Ut=t(this,mt).createElementNS($,"feComponentTransfer");Ct.append(Ut),Y(this,bt,Pe).call(this,Ut,"feFuncR",st),Y(this,bt,Pe).call(this,Ut,"feFuncG",pt),Y(this,bt,Pe).call(this,Ut,"feFuncB",Tt)},St=new WeakSet,ye=function(st){return t(this,N,fe).style.color=st,b(getComputedStyle(t(this,N,fe)).getPropertyValue("color"))},e.DOMFilterFactory=rt;class R extends n.BaseCanvasFactory{constructor({ownerDocument:nt=globalThis.document}={}){super(),this._document=nt}_createCanvas(nt,st){const pt=this._document.createElement("canvas");return pt.width=nt,pt.height=st,pt}}e.DOMCanvasFactory=R;async function y(gt,nt=!1){if(v(gt,document.baseURI)){const st=await fetch(gt);if(!st.ok)throw new Error(st.statusText);return nt?new Uint8Array(await st.arrayBuffer()):(0,u.stringToBytes)(await st.text())}return new Promise((st,pt)=>{const Tt=new XMLHttpRequest;Tt.open("GET",gt,!0),nt&&(Tt.responseType="arraybuffer"),Tt.onreadystatechange=()=>{if(Tt.readyState===XMLHttpRequest.DONE){if(Tt.status===200||Tt.status===0){let Ct;if(nt&&Tt.response?Ct=new Uint8Array(Tt.response):!nt&&Tt.responseText&&(Ct=(0,u.stringToBytes)(Tt.responseText)),Ct){st(Ct);return}}pt(new Error(Tt.statusText))}},Tt.send(null)})}class m extends n.BaseCMapReaderFactory{_fetchData(nt,st){return y(nt,this.isCompressed).then(pt=>({cMapData:pt,compressionType:st}))}}e.DOMCMapReaderFactory=m;class O extends n.BaseStandardFontDataFactory{_fetchData(nt){return y(nt,!0)}}e.DOMStandardFontDataFactory=O;class j extends n.BaseSVGFactory{_createSVG(nt){return document.createElementNS($,nt)}}e.DOMSVGFactory=j;class k{constructor({viewBox:nt,scale:st,rotation:pt,offsetX:Tt=0,offsetY:Ct=0,dontFlip:Ut=!1}){this.viewBox=nt,this.scale=st,this.rotation=pt,this.offsetX=Tt,this.offsetY=Ct;const Vt=(nt[2]+nt[0])/2,Wt=(nt[3]+nt[1])/2;let zt,Gt,Ht,Xt;switch(pt%=360,pt<0&&(pt+=360),pt){case 180:zt=-1,Gt=0,Ht=0,Xt=1;break;case 90:zt=0,Gt=1,Ht=1,Xt=0;break;case 270:zt=0,Gt=-1,Ht=-1,Xt=0;break;case 0:zt=1,Gt=0,Ht=0,Xt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ut&&(Ht=-Ht,Xt=-Xt);let ft,Z,K,At;zt===0?(ft=Math.abs(Wt-nt[1])*st+Tt,Z=Math.abs(Vt-nt[0])*st+Ct,K=(nt[3]-nt[1])*st,At=(nt[2]-nt[0])*st):(ft=Math.abs(Vt-nt[0])*st+Tt,Z=Math.abs(Wt-nt[1])*st+Ct,K=(nt[2]-nt[0])*st,At=(nt[3]-nt[1])*st),this.transform=[zt*st,Gt*st,Ht*st,Xt*st,ft-zt*st*Vt-Ht*st*Wt,Z-Gt*st*Vt-Xt*st*Wt],this.width=K,this.height=At}get rawDims(){const{viewBox:nt}=this;return(0,u.shadow)(this,"rawDims",{pageWidth:nt[2]-nt[0],pageHeight:nt[3]-nt[1],pageX:nt[0],pageY:nt[1]})}clone({scale:nt=this.scale,rotation:st=this.rotation,offsetX:pt=this.offsetX,offsetY:Tt=this.offsetY,dontFlip:Ct=!1}={}){return new k({viewBox:this.viewBox.slice(),scale:nt,rotation:st,offsetX:pt,offsetY:Tt,dontFlip:Ct})}convertToViewportPoint(nt,st){return u.Util.applyTransform([nt,st],this.transform)}convertToViewportRectangle(nt){const st=u.Util.applyTransform([nt[0],nt[1]],this.transform),pt=u.Util.applyTransform([nt[2],nt[3]],this.transform);return[st[0],st[1],pt[0],pt[1]]}convertToPdfPoint(nt,st){return u.Util.applyInverseTransform([nt,st],this.transform)}}e.PageViewport=k;class _ extends u.BaseException{constructor(nt,st=0){super(nt,"RenderingCancelledException"),this.extraDelay=st}}e.RenderingCancelledException=_;function w(gt){const nt=gt.length;let st=0;for(;st<nt&&gt[st].trim()==="";)st++;return gt.substring(st,st+5).toLowerCase()==="data:"}function p(gt){return typeof gt=="string"&&/\.pdf$/i.test(gt)}function E(gt,nt=!1){return nt||([gt]=gt.split(/[#?]/,1)),gt.substring(gt.lastIndexOf("/")+1)}function P(gt,nt="document.pdf"){if(typeof gt!="string")return nt;if(w(gt))return(0,u.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),nt;const st=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,pt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Tt=st.exec(gt);let Ct=pt.exec(Tt[1])||pt.exec(Tt[2])||pt.exec(Tt[3]);if(Ct&&(Ct=Ct[0],Ct.includes("%")))try{Ct=pt.exec(decodeURIComponent(Ct))[0]}catch{}return Ct||nt}class C{constructor(){ne(this,"started",Object.create(null));ne(this,"times",[])}time(nt){nt in this.started&&(0,u.warn)(`Timer is already running for ${nt}`),this.started[nt]=Date.now()}timeEnd(nt){nt in this.started||(0,u.warn)(`Timer has not been started for ${nt}`),this.times.push({name:nt,start:this.started[nt],end:Date.now()}),delete this.started[nt]}toString(){const nt=[];let st=0;for(const{name:pt}of this.times)st=Math.max(pt.length,st);for(const{name:pt,start:Tt,end:Ct}of this.times)nt.push(`${pt.padEnd(st)} ${Ct-Tt}ms
`);return nt.join("")}}e.StatTimer=C;function v(gt,nt){try{const{protocol:st}=nt?new URL(gt,nt):new URL(gt);return st==="http:"||st==="https:"}catch{return!1}}function l(gt){gt.preventDefault()}function d(gt,nt=!1){return new Promise((st,pt)=>{const Tt=document.createElement("script");Tt.src=gt,Tt.onload=function(Ct){nt&&Tt.remove(),st(Ct)},Tt.onerror=function(){pt(new Error(`Cannot load script at: ${Tt.src}`))},(document.head||document.documentElement).append(Tt)})}function I(gt){console.log("Deprecated API usage: "+gt)}let A;class c{static toDateObject(nt){if(!nt||typeof nt!="string")return null;A||(A=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const st=A.exec(nt);if(!st)return null;const pt=parseInt(st[1],10);let Tt=parseInt(st[2],10);Tt=Tt>=1&&Tt<=12?Tt-1:0;let Ct=parseInt(st[3],10);Ct=Ct>=1&&Ct<=31?Ct:1;let Ut=parseInt(st[4],10);Ut=Ut>=0&&Ut<=23?Ut:0;let Vt=parseInt(st[5],10);Vt=Vt>=0&&Vt<=59?Vt:0;let Wt=parseInt(st[6],10);Wt=Wt>=0&&Wt<=59?Wt:0;const zt=st[7]||"Z";let Gt=parseInt(st[8],10);Gt=Gt>=0&&Gt<=23?Gt:0;let Ht=parseInt(st[9],10)||0;return Ht=Ht>=0&&Ht<=59?Ht:0,zt==="-"?(Ut+=Gt,Vt+=Ht):zt==="+"&&(Ut-=Gt,Vt-=Ht),new Date(Date.UTC(pt,Tt,Ct,Ut,Vt,Wt))}}e.PDFDateString=c;function F(gt,{scale:nt=1,rotation:st=0}){const{width:pt,height:Tt}=gt.attributes.style,Ct=[0,0,parseInt(pt),parseInt(Tt)];return new k({viewBox:Ct,scale:nt,rotation:st})}function b(gt){if(gt.startsWith("#")){const nt=parseInt(gt.slice(1),16);return[(nt&16711680)>>16,(nt&65280)>>8,nt&255]}return gt.startsWith("rgb(")?gt.slice(4,-1).split(",").map(nt=>parseInt(nt)):gt.startsWith("rgba(")?gt.slice(5,-1).split(",").map(nt=>parseInt(nt)).slice(0,3):((0,u.warn)(`Not a valid color format: "${gt}"`),[0,0,0])}function G(gt){const nt=document.createElement("span");nt.style.visibility="hidden",document.body.append(nt);for(const st of gt.keys()){nt.style.color=st;const pt=window.getComputedStyle(nt).color;gt.set(st,b(pt))}nt.remove()}function z(gt){const{a:nt,b:st,c:pt,d:Tt,e:Ct,f:Ut}=gt.getTransform();return[nt,st,pt,Tt,Ct,Ut]}function S(gt){const{a:nt,b:st,c:pt,d:Tt,e:Ct,f:Ut}=gt.getTransform().invertSelf();return[nt,st,pt,Tt,Ct,Ut]}function X(gt,nt,st=!1,pt=!0){if(nt instanceof k){const{pageWidth:Tt,pageHeight:Ct}=nt.rawDims,{style:Ut}=gt,Vt=u.FeatureTest.isCSSRoundSupported,Wt=`var(--scale-factor) * ${Tt}px`,zt=`var(--scale-factor) * ${Ct}px`,Gt=Vt?`round(${Wt}, 1px)`:`calc(${Wt})`,Ht=Vt?`round(${zt}, 1px)`:`calc(${zt})`;!st||nt.rotation%180===0?(Ut.width=Gt,Ut.height=Ht):(Ut.width=Ht,Ut.height=Gt)}pt&&gt.setAttribute("data-main-rotation",nt.rotation)}},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=D(1);class u{constructor(){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,O){return"none"}addHighlightHCMFilter(m,O,j,k){return"none"}destroy(m=!1){}}e.BaseFilterFactory=u;class ${constructor(){this.constructor===$&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,O){if(m<=0||O<=0)throw new Error("Invalid canvas size");const j=this._createCanvas(m,O);return{canvas:j,context:j.getContext("2d")}}reset(m,O,j){if(!m.canvas)throw new Error("Canvas is not specified");if(O<=0||j<=0)throw new Error("Invalid canvas size");m.canvas.width=O,m.canvas.height=j}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,O){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=$;class L{constructor({baseUrl:m=null,isCompressed:O=!0}){this.constructor===L&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=O}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const O=this.baseUrl+m+(this.isCompressed?".bcmap":""),j=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(O,j).catch(k=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${O}`)})}_fetchData(m,O){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=L;class rt{constructor({baseUrl:m=null}){this.constructor===rt&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const O=`${this.baseUrl}${m}`;return this._fetchData(O).catch(j=>{throw new Error(`Unable to load font data at: ${O}`)})}_fetchData(m){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=rt;class R{constructor(){this.constructor===R&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,O,j=!1){if(m<=0||O<=0)throw new Error("Invalid SVG dimensions");const k=this._createSVG("svg:svg");return k.setAttribute("version","1.1"),j||(k.setAttribute("width",`${m}px`),k.setAttribute("height",`${O}px`)),k.setAttribute("preserveAspectRatio","none"),k.setAttribute("viewBox",`0 0 ${m} ${O}`),k}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=R},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=D(1);const u=3285377520,$=4294901760,L=65535;class rt{constructor(y){this.h1=y?y&4294967295:u,this.h2=y?y&4294967295:u}update(y){let m,O;if(typeof y=="string"){m=new Uint8Array(y.length*2),O=0;for(let I=0,A=y.length;I<A;I++){const c=y.charCodeAt(I);c<=255?m[O++]=c:(m[O++]=c>>>8,m[O++]=c&255)}}else if((0,n.isArrayBuffer)(y))m=y.slice(),O=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const j=O>>2,k=O-j*4,_=new Uint32Array(m.buffer,0,j);let w=0,p=0,E=this.h1,P=this.h2;const C=3432918353,v=461845907,l=C&L,d=v&L;for(let I=0;I<j;I++)I&1?(w=_[I],w=w*C&$|w*l&L,w=w<<15|w>>>17,w=w*v&$|w*d&L,E^=w,E=E<<13|E>>>19,E=E*5+3864292196):(p=_[I],p=p*C&$|p*l&L,p=p<<15|p>>>17,p=p*v&$|p*d&L,P^=p,P=P<<13|P>>>19,P=P*5+3864292196);switch(w=0,k){case 3:w^=m[j*4+2]<<16;case 2:w^=m[j*4+1]<<8;case 1:w^=m[j*4],w=w*C&$|w*l&L,w=w<<15|w>>>17,w=w*v&$|w*d&L,j&1?E^=w:P^=w}this.h1=E,this.h2=P}hexdigest(){let y=this.h1,m=this.h2;return y^=m>>>1,y=y*3981806797&$|y*36045&L,m=m*4283543511&$|((m<<16|y>>>16)*2950163797&$)>>>16,y^=m>>>1,y=y*444984403&$|y*60499&L,m=m*3301882366&$|((m<<16|y>>>16)*3120437893&$)>>>16,y^=m>>>1,(y>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=rt},(g,e,D)=>{var L;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=D(1);class u{constructor({ownerDocument:R=globalThis.document,styleElement:y=null}){H(this,L,new Set);this._document=R,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(R){this.nativeFontFaces.add(R),this._document.fonts.add(R)}removeNativeFontFace(R){this.nativeFontFaces.delete(R),this._document.fonts.delete(R)}insertRule(R){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const y=this.styleElement.sheet;y.insertRule(R,y.cssRules.length)}clear(){for(const R of this.nativeFontFaces)this._document.fonts.delete(R);this.nativeFontFaces.clear(),t(this,L).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(R){if(!(!R||t(this,L).has(R.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:y,src:m,style:O}=R,j=new FontFace(y,m,O);this.addNativeFontFace(j);try{await j.load(),t(this,L).add(y)}catch{(0,n.warn)(`Cannot load system font: ${R.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(j)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(R){if(R.attached||R.missingFile&&!R.systemFontInfo)return;if(R.attached=!0,R.systemFontInfo){await this.loadSystemFont(R.systemFontInfo);return}if(this.isFontLoadingAPISupported){const m=R.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(O){throw(0,n.warn)(`Failed to load font '${m.family}': '${O}'.`),R.disableFontFace=!0,O}}return}const y=R.createFontFaceRule();if(y){if(this.insertRule(y),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const O=this._queueLoadingCallback(m);this._prepareFontLoadEvent(R,O)})}}get isFontLoadingAPISupported(){var y;const R=!!((y=this._document)!=null&&y.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",R)}get isSyncFontLoadingSupported(){let R=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(R=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",R)}_queueLoadingCallback(R){function y(){for((0,n.assert)(!O.done,"completeRequest() cannot be called twice."),O.done=!0;m.length>0&&m[0].done;){const j=m.shift();setTimeout(j.callback,0)}}const{loadingRequests:m}=this,O={done:!1,complete:y,callback:R};return m.push(O),O}get _loadTestFont(){const R=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",R)}_prepareFontLoadEvent(R,y){function m(b,G){return b.charCodeAt(G)<<24|b.charCodeAt(G+1)<<16|b.charCodeAt(G+2)<<8|b.charCodeAt(G+3)&255}function O(b,G,z,S){const X=b.substring(0,G),at=b.substring(G+z);return X+S+at}let j,k;const _=this._document.createElement("canvas");_.width=1,_.height=1;const w=_.getContext("2d");let p=0;function E(b,G){if(++p>30){(0,n.warn)("Load test font never loaded."),G();return}if(w.font="30px "+b,w.fillText(".",0,20),w.getImageData(0,0,1,1).data[3]>0){G();return}setTimeout(E.bind(null,b,G))}const P=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=O(C,976,P.length,P);const l=16,d=1482184792;let I=m(C,l);for(j=0,k=P.length-3;j<k;j+=4)I=I-d+m(P,j)|0;j<P.length&&(I=I-d+m(P+"XXX",j)|0),C=O(C,l,4,(0,n.string32)(I));const A=`url(data:font/opentype;base64,${btoa(C)});`,c=`@font-face {font-family:"${P}";src:${A}}`;this.insertRule(c);const F=this._document.createElement("div");F.style.visibility="hidden",F.style.width=F.style.height="10px",F.style.position="absolute",F.style.top=F.style.left="0px";for(const b of[R.loadedName,P]){const G=this._document.createElement("span");G.textContent="Hi",G.style.fontFamily=b,F.append(G)}this._document.body.append(F),E(P,()=>{F.remove(),y.complete()})}}L=new WeakMap,e.FontLoader=u;class ${constructor(R,{isEvalSupported:y=!0,disableFontFace:m=!1,ignoreErrors:O=!1,inspectFont:j=null}){this.compiledGlyphs=Object.create(null);for(const k in R)this[k]=R[k];this.isEvalSupported=y!==!1,this.disableFontFace=m===!0,this.ignoreErrors=O===!0,this._inspectFont=j}createNativeFontFace(){var y;if(!this.data||this.disableFontFace)return null;let R;if(!this.cssFontInfo)R=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),R=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(y=this._inspectFont)==null||y.call(this,this),R}createFontFaceRule(){var O;if(!this.data||this.disableFontFace)return null;const R=(0,n.bytesToString)(this.data),y=`url(data:${this.mimetype};base64,${btoa(R)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${y}}`;else{let j=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(j+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${j}src:${y}}`}return(O=this._inspectFont)==null||O.call(this,this,y),m}getPathGenerator(R,y){if(this.compiledGlyphs[y]!==void 0)return this.compiledGlyphs[y];let m;try{m=R.get(this.loadedName+"_path_"+y)}catch(O){if(!this.ignoreErrors)throw O;return(0,n.warn)(`getPathGenerator - ignoring character: "${O}".`),this.compiledGlyphs[y]=function(j,k){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const O=[];for(const j of m){const k=j.args!==void 0?j.args.join(","):"";O.push("c.",j.cmd,"(",k,`);
`)}return this.compiledGlyphs[y]=new Function("c","size",O.join(""))}return this.compiledGlyphs[y]=function(O,j){for(const k of m)k.cmd==="scale"&&(k.args=[j,-j]),O[k.cmd].apply(O,k.args)}}}e.FontFaceObject=$},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=D(7);D(1);const u=function(y){return new Promise((m,O)=>{require$$5.readFile(y,(k,_)=>{if(k||!_){O(new Error(k));return}m(new Uint8Array(_))})})};class $ extends n.BaseFilterFactory{}e.NodeFilterFactory=$;class L extends n.BaseCanvasFactory{_createCanvas(m,O){return require$$5.createCanvas(m,O)}}e.NodeCanvasFactory=L;class rt extends n.BaseCMapReaderFactory{_fetchData(m,O){return u(m).then(j=>({cMapData:j,compressionType:O}))}}e.NodeCMapReaderFactory=rt;class R extends n.BaseStandardFontDataFactory{_fetchData(m){return u(m)}}e.NodeStandardFontDataFactory=R},(g,e,D)=>{var V,Ze,mt,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=D(1),u=D(6),$=D(12),L=D(13);const rt=16,R=100,y=4096,m=15,O=10,j=1e3,k=16;function _(M,i){if(M._removeMirroring)throw new Error("Context is already forwarding operations.");M.__originalSave=M.save,M.__originalRestore=M.restore,M.__originalRotate=M.rotate,M.__originalScale=M.scale,M.__originalTranslate=M.translate,M.__originalTransform=M.transform,M.__originalSetTransform=M.setTransform,M.__originalResetTransform=M.resetTransform,M.__originalClip=M.clip,M.__originalMoveTo=M.moveTo,M.__originalLineTo=M.lineTo,M.__originalBezierCurveTo=M.bezierCurveTo,M.__originalRect=M.rect,M.__originalClosePath=M.closePath,M.__originalBeginPath=M.beginPath,M._removeMirroring=()=>{M.save=M.__originalSave,M.restore=M.__originalRestore,M.rotate=M.__originalRotate,M.scale=M.__originalScale,M.translate=M.__originalTranslate,M.transform=M.__originalTransform,M.setTransform=M.__originalSetTransform,M.resetTransform=M.__originalResetTransform,M.clip=M.__originalClip,M.moveTo=M.__originalMoveTo,M.lineTo=M.__originalLineTo,M.bezierCurveTo=M.__originalBezierCurveTo,M.rect=M.__originalRect,M.closePath=M.__originalClosePath,M.beginPath=M.__originalBeginPath,delete M._removeMirroring},M.save=function(){i.save(),this.__originalSave()},M.restore=function(){i.restore(),this.__originalRestore()},M.translate=function(a,h){i.translate(a,h),this.__originalTranslate(a,h)},M.scale=function(a,h){i.scale(a,h),this.__originalScale(a,h)},M.transform=function(a,h,f,T,N,W){i.transform(a,h,f,T,N,W),this.__originalTransform(a,h,f,T,N,W)},M.setTransform=function(a,h,f,T,N,W){i.setTransform(a,h,f,T,N,W),this.__originalSetTransform(a,h,f,T,N,W)},M.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},M.rotate=function(a){i.rotate(a),this.__originalRotate(a)},M.clip=function(a){i.clip(a),this.__originalClip(a)},M.moveTo=function(o,a){i.moveTo(o,a),this.__originalMoveTo(o,a)},M.lineTo=function(o,a){i.lineTo(o,a),this.__originalLineTo(o,a)},M.bezierCurveTo=function(o,a,h,f,T,N){i.bezierCurveTo(o,a,h,f,T,N),this.__originalBezierCurveTo(o,a,h,f,T,N)},M.rect=function(o,a,h,f){i.rect(o,a,h,f),this.__originalRect(o,a,h,f)},M.closePath=function(){i.closePath(),this.__originalClosePath()},M.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class w{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,o,a){let h;return this.cache[i]!==void 0?(h=this.cache[i],this.canvasFactory.reset(h,o,a)):(h=this.canvasFactory.create(o,a),this.cache[i]=h),h}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const o=this.cache[i];this.canvasFactory.destroy(o),delete this.cache[i]}}}function p(M,i,o,a,h,f,T,N,W,it){const[tt,et,ht,bt,ut,Ft]=(0,u.getCurrentTransform)(M);if(et===0&&ht===0){const Lt=T*tt+ut,gt=Math.round(Lt),nt=N*bt+Ft,st=Math.round(nt),pt=(T+W)*tt+ut,Tt=Math.abs(Math.round(pt)-gt)||1,Ct=(N+it)*bt+Ft,Ut=Math.abs(Math.round(Ct)-st)||1;return M.setTransform(Math.sign(tt),0,0,Math.sign(bt),gt,st),M.drawImage(i,o,a,h,f,0,0,Tt,Ut),M.setTransform(tt,et,ht,bt,ut,Ft),[Tt,Ut]}if(tt===0&&bt===0){const Lt=N*ht+ut,gt=Math.round(Lt),nt=T*et+Ft,st=Math.round(nt),pt=(N+it)*ht+ut,Tt=Math.abs(Math.round(pt)-gt)||1,Ct=(T+W)*et+Ft,Ut=Math.abs(Math.round(Ct)-st)||1;return M.setTransform(0,Math.sign(et),Math.sign(ht),0,gt,st),M.drawImage(i,o,a,h,f,0,0,Ut,Tt),M.setTransform(tt,et,ht,bt,ut,Ft),[Ut,Tt]}M.drawImage(i,o,a,h,f,T,N,W,it);const Bt=Math.hypot(tt,et),St=Math.hypot(ht,bt);return[Bt*W,St*it]}function E(M){const{width:i,height:o}=M;if(i>j||o>j)return null;const a=1e3,h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),f=i+1;let T=new Uint8Array(f*(o+1)),N,W,it;const tt=i+7&-8;let et=new Uint8Array(tt*o),ht=0;for(const St of M.data){let Lt=128;for(;Lt>0;)et[ht++]=St&Lt?0:255,Lt>>=1}let bt=0;for(ht=0,et[ht]!==0&&(T[0]=1,++bt),W=1;W<i;W++)et[ht]!==et[ht+1]&&(T[W]=et[ht]?2:1,++bt),ht++;for(et[ht]!==0&&(T[W]=2,++bt),N=1;N<o;N++){ht=N*tt,it=N*f,et[ht-tt]!==et[ht]&&(T[it]=et[ht]?1:8,++bt);let St=(et[ht]?4:0)+(et[ht-tt]?8:0);for(W=1;W<i;W++)St=(St>>2)+(et[ht+1]?4:0)+(et[ht-tt+1]?8:0),h[St]&&(T[it+W]=h[St],++bt),ht++;if(et[ht-tt]!==et[ht]&&(T[it+W]=et[ht]?2:4,++bt),bt>a)return null}for(ht=tt*(o-1),it=N*f,et[ht]!==0&&(T[it]=8,++bt),W=1;W<i;W++)et[ht]!==et[ht+1]&&(T[it+W]=et[ht]?4:8,++bt),ht++;if(et[ht]!==0&&(T[it+W]=4,++bt),bt>a)return null;const ut=new Int32Array([0,f,-1,0,-f,0,0,0,1]),Ft=new Path2D;for(N=0;bt&&N<=o;N++){let St=N*f;const Lt=St+i;for(;St<Lt&&!T[St];)St++;if(St===Lt)continue;Ft.moveTo(St%f,N);const gt=St;let nt=T[St];do{const st=ut[nt];do St+=st;while(!T[St]);const pt=T[St];pt!==5&&pt!==10?(nt=pt,T[St]=0):(nt=pt&51*nt>>4,T[St]&=nt>>2|nt<<2),Ft.lineTo(St%f,St/f|0),T[St]||--bt}while(gt!==St);--N}return et=null,T=null,function(St){St.save(),St.scale(1/i,-1/o),St.translate(0,-o),St.fill(Ft),St.beginPath(),St.restore()}}class P{constructor(i,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,o])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,o){this.x=i,this.y=o}updatePathMinMax(i,o,a){[o,a]=n.Util.applyTransform([o,a],i),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,a),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,a)}updateRectMinMax(i,o){const a=n.Util.applyTransform(o,i),h=n.Util.applyTransform(o.slice(2),i);this.minX=Math.min(this.minX,a[0],h[0]),this.minY=Math.min(this.minY,a[1],h[1]),this.maxX=Math.max(this.maxX,a[0],h[0]),this.maxY=Math.max(this.maxY,a[1],h[1])}updateScalingPathMinMax(i,o){n.Util.scaleMinMax(i,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(i,o,a,h,f,T,N,W,it,tt){const et=n.Util.bezierBoundingBox(o,a,h,f,T,N,W,it);if(tt){tt[0]=Math.min(tt[0],et[0],et[2]),tt[1]=Math.max(tt[1],et[0],et[2]),tt[2]=Math.min(tt[2],et[1],et[3]),tt[3]=Math.max(tt[3],et[1],et[3]);return}this.updateRectMinMax(i,et)}getPathBoundingBox(i=$.PathType.FILL,o=null){const a=[this.minX,this.minY,this.maxX,this.maxY];if(i===$.PathType.STROKE){o||(0,n.unreachable)("Stroke bounding box must include transform.");const h=n.Util.singularValueDecompose2dScale(o),f=h[0]*this.lineWidth/2,T=h[1]*this.lineWidth/2;a[0]-=f,a[1]-=T,a[2]+=f,a[3]+=T}return a}updateClipFromPath(){const i=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=$.PathType.FILL,o=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(i,o))}}function C(M,i){if(typeof ImageData<"u"&&i instanceof ImageData){M.putImageData(i,0,0);return}const o=i.height,a=i.width,h=o%k,f=(o-h)/k,T=h===0?f:f+1,N=M.createImageData(a,k);let W=0,it;const tt=i.data,et=N.data;let ht,bt,ut,Ft;if(i.kind===n.ImageKind.GRAYSCALE_1BPP){const Bt=tt.byteLength,St=new Uint32Array(et.buffer,0,et.byteLength>>2),Lt=St.length,gt=a+7>>3,nt=4294967295,st=n.FeatureTest.isLittleEndian?4278190080:255;for(ht=0;ht<T;ht++){for(ut=ht<f?k:h,it=0,bt=0;bt<ut;bt++){const pt=Bt-W;let Tt=0;const Ct=pt>gt?a:pt*8-7,Ut=Ct&-8;let Vt=0,Wt=0;for(;Tt<Ut;Tt+=8)Wt=tt[W++],St[it++]=Wt&128?nt:st,St[it++]=Wt&64?nt:st,St[it++]=Wt&32?nt:st,St[it++]=Wt&16?nt:st,St[it++]=Wt&8?nt:st,St[it++]=Wt&4?nt:st,St[it++]=Wt&2?nt:st,St[it++]=Wt&1?nt:st;for(;Tt<Ct;Tt++)Vt===0&&(Wt=tt[W++],Vt=128),St[it++]=Wt&Vt?nt:st,Vt>>=1}for(;it<Lt;)St[it++]=0;M.putImageData(N,0,ht*k)}}else if(i.kind===n.ImageKind.RGBA_32BPP){for(bt=0,Ft=a*k*4,ht=0;ht<f;ht++)et.set(tt.subarray(W,W+Ft)),W+=Ft,M.putImageData(N,0,bt),bt+=k;ht<T&&(Ft=a*h*4,et.set(tt.subarray(W,W+Ft)),M.putImageData(N,0,bt))}else if(i.kind===n.ImageKind.RGB_24BPP)for(ut=k,Ft=a*ut,ht=0;ht<T;ht++){for(ht>=f&&(ut=h,Ft=a*ut),it=0,bt=Ft;bt--;)et[it++]=tt[W++],et[it++]=tt[W++],et[it++]=tt[W++],et[it++]=255;M.putImageData(N,0,ht*k)}else throw new Error(`bad image kind: ${i.kind}`)}function v(M,i){if(i.bitmap){M.drawImage(i.bitmap,0,0);return}const o=i.height,a=i.width,h=o%k,f=(o-h)/k,T=h===0?f:f+1,N=M.createImageData(a,k);let W=0;const it=i.data,tt=N.data;for(let et=0;et<T;et++){const ht=et<f?k:h;({srcPos:W}=(0,L.convertBlackAndWhiteToRGBA)({src:it,srcPos:W,dest:tt,width:a,height:ht,nonBlackColor:0})),M.putImageData(N,0,et*k)}}function l(M,i){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of o)M[a]!==void 0&&(i[a]=M[a]);M.setLineDash!==void 0&&(i.setLineDash(M.getLineDash()),i.lineDashOffset=M.lineDashOffset)}function d(M){if(M.strokeStyle=M.fillStyle="#000000",M.fillRule="nonzero",M.globalAlpha=1,M.lineWidth=1,M.lineCap="butt",M.lineJoin="miter",M.miterLimit=10,M.globalCompositeOperation="source-over",M.font="10px sans-serif",M.setLineDash!==void 0&&(M.setLineDash([]),M.lineDashOffset=0),!n.isNodeJS){const{filter:i}=M;i!=="none"&&i!==""&&(M.filter="none")}}function I(M,i,o,a){const h=M.length;for(let f=3;f<h;f+=4){const T=M[f];if(T===0)M[f-3]=i,M[f-2]=o,M[f-1]=a;else if(T<255){const N=255-T;M[f-3]=M[f-3]*T+i*N>>8,M[f-2]=M[f-2]*T+o*N>>8,M[f-1]=M[f-1]*T+a*N>>8}}}function A(M,i,o){const a=M.length,h=1/255;for(let f=3;f<a;f+=4){const T=o?o[M[f]]:M[f];i[f]=i[f]*T*h|0}}function c(M,i,o){const a=M.length;for(let h=3;h<a;h+=4){const f=M[h-3]*77+M[h-2]*152+M[h-1]*28;i[h]=o?i[h]*o[f>>8]>>8:i[h]*f>>16}}function F(M,i,o,a,h,f,T,N,W,it,tt){const et=!!f,ht=et?f[0]:0,bt=et?f[1]:0,ut=et?f[2]:0,Ft=h==="Luminosity"?c:A,St=Math.min(a,Math.ceil(1048576/o));for(let Lt=0;Lt<a;Lt+=St){const gt=Math.min(St,a-Lt),nt=M.getImageData(N-it,Lt+(W-tt),o,gt),st=i.getImageData(N,Lt+W,o,gt);et&&I(nt.data,ht,bt,ut),Ft(nt.data,st.data,T),i.putImageData(st,N,Lt+W)}}function b(M,i,o,a){const h=a[0],f=a[1],T=a[2]-h,N=a[3]-f;T===0||N===0||(F(i.context,o,T,N,i.subtype,i.backdrop,i.transferMap,h,f,i.offsetX,i.offsetY),M.save(),M.globalAlpha=1,M.globalCompositeOperation="source-over",M.setTransform(1,0,0,1,0,0),M.drawImage(o.canvas,0,0),M.restore())}function G(M,i){const o=n.Util.singularValueDecompose2dScale(M);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*u.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:o[0]<=a||o[1]<=a}const z=["butt","round","square"],S=["miter","round","bevel"],X={},at={},wt=class wt{constructor(i,o,a,h,f,{optionalContentConfig:T,markedContentStack:N=null},W,it){H(this,V);H(this,mt);this.ctx=i,this.current=new P(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=a,this.canvasFactory=h,this.filterFactory=f,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=N||[],this.optionalContentConfig=T,this.cachedCanvases=new w(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=W,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=it,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,o=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):o}beginDrawing({transform:i,viewport:o,transparency:a=!1,background:h=null}){const f=this.ctx.canvas.width,T=this.ctx.canvas.height,N=this.ctx.fillStyle;if(this.ctx.fillStyle=h||"#ffffff",this.ctx.fillRect(0,0,f,T),this.ctx.fillStyle=N,a){const W=this.cachedCanvases.getCanvas("transparent",f,T);this.compositeCtx=this.ctx,this.transparentCanvas=W.canvas,this.ctx=W.context,this.ctx.save(),this.ctx.transform(...(0,u.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,u.getCurrentTransform)(this.ctx)}executeOperatorList(i,o,a,h){const f=i.argsArray,T=i.fnArray;let N=o||0;const W=f.length;if(W===N)return N;const it=W-N>O&&typeof a=="function",tt=it?Date.now()+m:0;let et=0;const ht=this.commonObjs,bt=this.objs;let ut;for(;;){if(h!==void 0&&N===h.nextBreakPoint)return h.breakIt(N,a),N;if(ut=T[N],ut!==n.OPS.dependency)this[ut].apply(this,f[N]);else for(const Ft of f[N]){const Bt=Ft.startsWith("g_")?ht:bt;if(!Bt.has(Ft))return Bt.get(Ft,a),N}if(N++,N===W)return N;if(it&&++et>O){if(Date.now()>tt)return a(),N;et=0}}}endDrawing(){Y(this,V,Ze).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const o of i.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);i.clear()}this._cachedBitmapsMap.clear(),Y(this,mt,tn).call(this)}_scaleImage(i,o){const a=i.width,h=i.height;let f=Math.max(Math.hypot(o[0],o[1]),1),T=Math.max(Math.hypot(o[2],o[3]),1),N=a,W=h,it="prescale1",tt,et;for(;f>2&&N>1||T>2&&W>1;){let ht=N,bt=W;f>2&&N>1&&(ht=N>=16384?Math.floor(N/2)-1||1:Math.ceil(N/2),f/=N/ht),T>2&&W>1&&(bt=W>=16384?Math.floor(W/2)-1||1:Math.ceil(W)/2,T/=W/bt),tt=this.cachedCanvases.getCanvas(it,ht,bt),et=tt.context,et.clearRect(0,0,ht,bt),et.drawImage(i,0,0,N,W,0,0,ht,bt),i=tt.canvas,N=ht,W=bt,it=it==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:N,paintHeight:W}}_createMaskCanvas(i){const o=this.ctx,{width:a,height:h}=i,f=this.current.fillColor,T=this.current.patternFill,N=(0,u.getCurrentTransform)(o);let W,it,tt,et;if((i.bitmap||i.data)&&i.count>1){const Tt=i.bitmap||i.data.buffer;it=JSON.stringify(T?N:[N.slice(0,4),f]),W=this._cachedBitmapsMap.get(Tt),W||(W=new Map,this._cachedBitmapsMap.set(Tt,W));const Ct=W.get(it);if(Ct&&!T){const Ut=Math.round(Math.min(N[0],N[2])+N[4]),Vt=Math.round(Math.min(N[1],N[3])+N[5]);return{canvas:Ct,offsetX:Ut,offsetY:Vt}}tt=Ct}tt||(et=this.cachedCanvases.getCanvas("maskCanvas",a,h),v(et.context,i));let ht=n.Util.transform(N,[1/a,0,0,-1/h,0,0]);ht=n.Util.transform(ht,[1,0,0,1,0,-h]);const bt=n.Util.applyTransform([0,0],ht),ut=n.Util.applyTransform([a,h],ht),Ft=n.Util.normalizeRect([bt[0],bt[1],ut[0],ut[1]]),Bt=Math.round(Ft[2]-Ft[0])||1,St=Math.round(Ft[3]-Ft[1])||1,Lt=this.cachedCanvases.getCanvas("fillCanvas",Bt,St),gt=Lt.context,nt=Math.min(bt[0],ut[0]),st=Math.min(bt[1],ut[1]);gt.translate(-nt,-st),gt.transform(...ht),tt||(tt=this._scaleImage(et.canvas,(0,u.getCurrentTransformInverse)(gt)),tt=tt.img,W&&T&&W.set(it,tt)),gt.imageSmoothingEnabled=G((0,u.getCurrentTransform)(gt),i.interpolate),p(gt,tt,0,0,tt.width,tt.height,0,0,a,h),gt.globalCompositeOperation="source-in";const pt=n.Util.transform((0,u.getCurrentTransformInverse)(gt),[1,0,0,1,-nt,-st]);return gt.fillStyle=T?f.getPattern(o,this,pt,$.PathType.FILL):f,gt.fillRect(0,0,a,h),W&&!T&&(this.cachedCanvases.delete("fillCanvas"),W.set(it,Lt.canvas)),{canvas:Lt.canvas,offsetX:Math.round(nt),offsetY:Math.round(st)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=z[i]}setLineJoin(i){this.ctx.lineJoin=S[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,o){const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(i),a.lineDashOffset=o)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[o,a]of i)switch(o){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.current.fillAlpha=a,this.ctx.globalAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,o=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(a,i,o);this.suspendedCtx=this.ctx,this.ctx=h.context;const f=this.ctx;f.setTransform(...(0,u.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,f),_(f,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,a=this.suspendedCtx;b(a,o,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,o,a,h,f,T){this.ctx.transform(i,o,a,h,f,T),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,o,a){const h=this.ctx,f=this.current;let T=f.x,N=f.y,W,it;const tt=(0,u.getCurrentTransform)(h),et=tt[0]===0&&tt[3]===0||tt[1]===0&&tt[2]===0,ht=et?a.slice(0):null;for(let bt=0,ut=0,Ft=i.length;bt<Ft;bt++)switch(i[bt]|0){case n.OPS.rectangle:T=o[ut++],N=o[ut++];const Bt=o[ut++],St=o[ut++],Lt=T+Bt,gt=N+St;h.moveTo(T,N),Bt===0||St===0?h.lineTo(Lt,gt):(h.lineTo(Lt,N),h.lineTo(Lt,gt),h.lineTo(T,gt)),et||f.updateRectMinMax(tt,[T,N,Lt,gt]),h.closePath();break;case n.OPS.moveTo:T=o[ut++],N=o[ut++],h.moveTo(T,N),et||f.updatePathMinMax(tt,T,N);break;case n.OPS.lineTo:T=o[ut++],N=o[ut++],h.lineTo(T,N),et||f.updatePathMinMax(tt,T,N);break;case n.OPS.curveTo:W=T,it=N,T=o[ut+4],N=o[ut+5],h.bezierCurveTo(o[ut],o[ut+1],o[ut+2],o[ut+3],T,N),f.updateCurvePathMinMax(tt,W,it,o[ut],o[ut+1],o[ut+2],o[ut+3],T,N,ht),ut+=6;break;case n.OPS.curveTo2:W=T,it=N,h.bezierCurveTo(T,N,o[ut],o[ut+1],o[ut+2],o[ut+3]),f.updateCurvePathMinMax(tt,W,it,T,N,o[ut],o[ut+1],o[ut+2],o[ut+3],ht),T=o[ut+2],N=o[ut+3],ut+=4;break;case n.OPS.curveTo3:W=T,it=N,T=o[ut+2],N=o[ut+3],h.bezierCurveTo(o[ut],o[ut+1],T,N,T,N),f.updateCurvePathMinMax(tt,W,it,o[ut],o[ut+1],T,N,T,N,ht),ut+=4;break;case n.OPS.closePath:h.closePath();break}et&&f.updateScalingPathMinMax(tt,ht),f.setCurrentPoint(T,N)}closePath(){this.ctx.closePath()}stroke(i=!0){const o=this.ctx,a=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof a=="object"&&(a!=null&&a.getPattern)?(o.save(),o.strokeStyle=a.getPattern(o,this,(0,u.getCurrentTransformInverse)(o),$.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const o=this.ctx,a=this.current.fillColor,h=this.current.patternFill;let f=!1;h&&(o.save(),o.fillStyle=a.getPattern(o,this,(0,u.getCurrentTransformInverse)(o),$.PathType.FILL),f=!0);const T=this.current.getClippedPathBoundingBox();this.contentVisible&&T!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),f&&o.restore(),i&&this.consumePath(T)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=X}eoClip(){this.pendingClip=at}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,o=this.ctx;if(i===void 0){o.beginPath();return}o.save(),o.beginPath();for(const a of i)o.setTransform(...a.transform),o.translate(a.x,a.y),a.addToPath(o,a.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,o){var tt;const a=this.commonObjs.get(i),h=this.current;if(!a)throw new Error(`Can't find font for ${i}`);if(h.fontMatrix=a.fontMatrix||n.FONT_IDENTITY_MATRIX,(h.fontMatrix[0]===0||h.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+i),o<0?(o=-o,h.fontDirection=-1):h.fontDirection=1,this.current.font=a,this.current.fontSize=o,a.isType3Font)return;const f=a.loadedName||"sans-serif",T=((tt=a.systemFontInfo)==null?void 0:tt.css)||`"${f}", ${a.fallbackName}`;let N="normal";a.black?N="900":a.bold&&(N="bold");const W=a.italic?"italic":"normal";let it=o;o<rt?it=rt:o>R&&(it=R),this.current.fontSizeScale=o/it,this.ctx.font=`${W} ${N} ${it}px ${T}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,o){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=o}setLeadingMoveText(i,o){this.setLeading(-o),this.moveText(i,o)}setTextMatrix(i,o,a,h,f,T){this.current.textMatrix=[i,o,a,h,f,T],this.current.textMatrixScale=Math.hypot(i,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,o,a,h){const f=this.ctx,T=this.current,N=T.font,W=T.textRenderingMode,it=T.fontSize/T.fontSizeScale,tt=W&n.TextRenderingMode.FILL_STROKE_MASK,et=!!(W&n.TextRenderingMode.ADD_TO_PATH_FLAG),ht=T.patternFill&&!N.missingFile;let bt;(N.disableFontFace||et||ht)&&(bt=N.getPathGenerator(this.commonObjs,i)),N.disableFontFace||ht?(f.save(),f.translate(o,a),f.beginPath(),bt(f,it),h&&f.setTransform(...h),(tt===n.TextRenderingMode.FILL||tt===n.TextRenderingMode.FILL_STROKE)&&f.fill(),(tt===n.TextRenderingMode.STROKE||tt===n.TextRenderingMode.FILL_STROKE)&&f.stroke(),f.restore()):((tt===n.TextRenderingMode.FILL||tt===n.TextRenderingMode.FILL_STROKE)&&f.fillText(i,o,a),(tt===n.TextRenderingMode.STROKE||tt===n.TextRenderingMode.FILL_STROKE)&&f.strokeText(i,o,a)),et&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,u.getCurrentTransform)(f),x:o,y:a,fontSize:it,addToPath:bt})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const o=i.getImageData(0,0,10,10).data;let a=!1;for(let h=3;h<o.length;h+=4)if(o[h]>0&&o[h]<255){a=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",a)}showText(i){const o=this.current,a=o.font;if(a.isType3Font)return this.showType3Text(i);const h=o.fontSize;if(h===0)return;const f=this.ctx,T=o.fontSizeScale,N=o.charSpacing,W=o.wordSpacing,it=o.fontDirection,tt=o.textHScale*it,et=i.length,ht=a.vertical,bt=ht?1:-1,ut=a.defaultVMetrics,Ft=h*o.fontMatrix[0],Bt=o.textRenderingMode===n.TextRenderingMode.FILL&&!a.disableFontFace&&!o.patternFill;f.save(),f.transform(...o.textMatrix),f.translate(o.x,o.y+o.textRise),it>0?f.scale(tt,-1):f.scale(tt,1);let St;if(o.patternFill){f.save();const pt=o.fillColor.getPattern(f,this,(0,u.getCurrentTransformInverse)(f),$.PathType.FILL);St=(0,u.getCurrentTransform)(f),f.restore(),f.fillStyle=pt}let Lt=o.lineWidth;const gt=o.textMatrixScale;if(gt===0||Lt===0){const pt=o.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(pt===n.TextRenderingMode.STROKE||pt===n.TextRenderingMode.FILL_STROKE)&&(Lt=this.getSinglePixelWidth())}else Lt/=gt;if(T!==1&&(f.scale(T,T),Lt/=T),f.lineWidth=Lt,a.isInvalidPDFjsFont){const pt=[];let Tt=0;for(const Ct of i)pt.push(Ct.unicode),Tt+=Ct.width;f.fillText(pt.join(""),0,0),o.x+=Tt*Ft*tt,f.restore(),this.compose();return}let nt=0,st;for(st=0;st<et;++st){const pt=i[st];if(typeof pt=="number"){nt+=bt*pt*h/1e3;continue}let Tt=!1;const Ct=(pt.isSpace?W:0)+N,Ut=pt.fontChar,Vt=pt.accent;let Wt,zt,Gt=pt.width;if(ht){const Xt=pt.vmetric||ut,ft=-(pt.vmetric?Xt[1]:Gt*.5)*Ft,Z=Xt[2]*Ft;Gt=Xt?-Xt[0]:Gt,Wt=ft/T,zt=(nt+Z)/T}else Wt=nt/T,zt=0;if(a.remeasure&&Gt>0){const Xt=f.measureText(Ut).width*1e3/h*T;if(Gt<Xt&&this.isFontSubpixelAAEnabled){const ft=Gt/Xt;Tt=!0,f.save(),f.scale(ft,1),Wt/=ft}else Gt!==Xt&&(Wt+=(Gt-Xt)/2e3*h/T)}if(this.contentVisible&&(pt.isInFont||a.missingFile)){if(Bt&&!Vt)f.fillText(Ut,Wt,zt);else if(this.paintChar(Ut,Wt,zt,St),Vt){const Xt=Wt+h*Vt.offset.x/T,ft=zt-h*Vt.offset.y/T;this.paintChar(Vt.fontChar,Xt,ft,St)}}const Ht=ht?Gt*Ft-Ct*it:Gt*Ft+Ct*it;nt+=Ht,Tt&&f.restore()}ht?o.y-=nt:o.x+=nt*tt,f.restore(),this.compose()}showType3Text(i){const o=this.ctx,a=this.current,h=a.font,f=a.fontSize,T=a.fontDirection,N=h.vertical?1:-1,W=a.charSpacing,it=a.wordSpacing,tt=a.textHScale*T,et=a.fontMatrix||n.FONT_IDENTITY_MATRIX,ht=i.length,bt=a.textRenderingMode===n.TextRenderingMode.INVISIBLE;let ut,Ft,Bt,St;if(!(bt||f===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...a.textMatrix),o.translate(a.x,a.y),o.scale(tt,T),ut=0;ut<ht;++ut){if(Ft=i[ut],typeof Ft=="number"){St=N*Ft*f/1e3,this.ctx.translate(St,0),a.x+=St*tt;continue}const Lt=(Ft.isSpace?it:0)+W,gt=h.charProcOperatorList[Ft.operatorListId];if(!gt){(0,n.warn)(`Type3 character "${Ft.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Ft,this.save(),o.scale(f,f),o.transform(...et),this.executeOperatorList(gt),this.restore()),Bt=n.Util.applyTransform([Ft.width,0],et)[0]*f+Lt,o.translate(Bt,0),a.x+=Bt*tt}o.restore(),this.processingType3=null}}setCharWidth(i,o){}setCharWidthAndBounds(i,o,a,h,f,T){this.ctx.rect(a,h,f-a,T-h),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let o;if(i[0]==="TilingPattern"){const a=i[1],h=this.baseTransform||(0,u.getCurrentTransform)(this.ctx),f={createCanvasGraphics:T=>new wt(T,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};o=new $.TilingPattern(i,a,this.ctx,f,h)}else o=this._getPattern(i[1],i[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,o,a){const h=n.Util.makeHexColor(i,o,a);this.ctx.strokeStyle=h,this.current.strokeColor=h}setFillRGBColor(i,o,a){const h=n.Util.makeHexColor(i,o,a);this.ctx.fillStyle=h,this.current.fillColor=h,this.current.patternFill=!1}_getPattern(i,o=null){let a;return this.cachedPatterns.has(i)?a=this.cachedPatterns.get(i):(a=(0,$.getShadingPattern)(this.getObject(i)),this.cachedPatterns.set(i,a)),o&&(a.matrix=o),a}shadingFill(i){if(!this.contentVisible)return;const o=this.ctx;this.save();const a=this._getPattern(i);o.fillStyle=a.getPattern(o,this,(0,u.getCurrentTransformInverse)(o),$.PathType.SHADING);const h=(0,u.getCurrentTransformInverse)(o);if(h){const{width:f,height:T}=o.canvas,[N,W,it,tt]=n.Util.getAxialAlignedBoundingBox([0,0,f,T],h);this.ctx.fillRect(N,W,it-N,tt-W)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,u.getCurrentTransform)(this.ctx),o)){const a=o[2]-o[0],h=o[3]-o[1];this.ctx.rect(o[0],o[1],a,h),this.current.updateRectMinMax((0,u.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;i.isolated||(0,n.info)("TODO: Support non-isolated groups."),i.knockout&&(0,n.warn)("Knockout groups not supported.");const a=(0,u.getCurrentTransform)(o);if(i.matrix&&o.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let h=n.Util.getAxialAlignedBoundingBox(i.bbox,(0,u.getCurrentTransform)(o));const f=[0,0,o.canvas.width,o.canvas.height];h=n.Util.intersect(h,f)||[0,0,0,0];const T=Math.floor(h[0]),N=Math.floor(h[1]);let W=Math.max(Math.ceil(h[2])-T,1),it=Math.max(Math.ceil(h[3])-N,1),tt=1,et=1;W>y&&(tt=W/y,W=y),it>y&&(et=it/y,it=y),this.current.startNewPathAndClipBox([0,0,W,it]);let ht="groupAt"+this.groupLevel;i.smask&&(ht+="_smask_"+this.smaskCounter++%2);const bt=this.cachedCanvases.getCanvas(ht,W,it),ut=bt.context;ut.scale(1/tt,1/et),ut.translate(-T,-N),ut.transform(...a),i.smask?this.smaskStack.push({canvas:bt.canvas,context:ut,offsetX:T,offsetY:N,scaleX:tt,scaleY:et,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(T,N),o.scale(tt,et),o.save()),l(o,ut),this.ctx=ut,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const h=(0,u.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...h);const f=n.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],h);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(f)}}beginAnnotation(i,o,a,h,f){if(Y(this,V,Ze).call(this),d(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const T=o[2]-o[0],N=o[3]-o[1];if(f&&this.annotationCanvasMap){a=a.slice(),a[4]-=o[0],a[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=T,o[3]=N;const[W,it]=n.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(this.ctx)),{viewportScale:tt}=this,et=Math.ceil(T*this.outputScaleX*tt),ht=Math.ceil(N*this.outputScaleY*tt);this.annotationCanvas=this.canvasFactory.create(et,ht);const{canvas:bt,context:ut}=this.annotationCanvas;this.annotationCanvasMap.set(i,bt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ut,this.ctx.save(),this.ctx.setTransform(W,0,0,-it,0,N*it),d(this.ctx)}else d(this.ctx),this.ctx.rect(o[0],o[1],T,N),this.ctx.clip(),this.endPath()}this.current=new P(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...a),this.transform(...h)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,mt,tn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const o=i.count;i=this.getObject(i.data,i),i.count=o;const a=this.ctx,h=this.processingType3;if(h&&(h.compiled===void 0&&(h.compiled=E(i)),h.compiled)){h.compiled(a);return}const f=this._createMaskCanvas(i),T=f.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(T,f.offsetX,f.offsetY),a.restore(),this.compose()}paintImageMaskXObjectRepeat(i,o,a=0,h=0,f,T){if(!this.contentVisible)return;i=this.getObject(i.data,i);const N=this.ctx;N.save();const W=(0,u.getCurrentTransform)(N);N.transform(o,a,h,f,0,0);const it=this._createMaskCanvas(i);N.setTransform(1,0,0,1,it.offsetX-W[4],it.offsetY-W[5]);for(let tt=0,et=T.length;tt<et;tt+=2){const ht=n.Util.transform(W,[o,a,h,f,T[tt],T[tt+1]]),[bt,ut]=n.Util.applyTransform([0,0],ht);N.drawImage(it.canvas,bt,ut)}N.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const o=this.ctx,a=this.current.fillColor,h=this.current.patternFill;for(const f of i){const{data:T,width:N,height:W,transform:it}=f,tt=this.cachedCanvases.getCanvas("maskCanvas",N,W),et=tt.context;et.save();const ht=this.getObject(T,f);v(et,ht),et.globalCompositeOperation="source-in",et.fillStyle=h?a.getPattern(et,this,(0,u.getCurrentTransformInverse)(o),$.PathType.FILL):a,et.fillRect(0,0,N,W),et.restore(),o.save(),o.transform(...it),o.scale(1,-1),p(o,tt.canvas,0,0,N,W,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const o=this.getObject(i);if(!o){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(i,o,a,h){if(!this.contentVisible)return;const f=this.getObject(i);if(!f){(0,n.warn)("Dependent image isn't ready yet");return}const T=f.width,N=f.height,W=[];for(let it=0,tt=h.length;it<tt;it+=2)W.push({transform:[o,0,0,a,h[it],h[it+1]],x:0,y:0,w:T,h:N});this.paintInlineImageXObjectGroup(f,W)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:o,width:a,height:h}=i,f=this.cachedCanvases.getCanvas("inlineImage",a,h),T=f.context;return T.filter=this.current.transferMaps,T.drawImage(o,0,0),T.filter="none",f.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const o=i.width,a=i.height,h=this.ctx;if(this.save(),!n.isNodeJS){const{filter:N}=h;N!=="none"&&N!==""&&(h.filter="none")}h.scale(1/o,-1/a);let f;if(i.bitmap)f=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)f=i;else{const W=this.cachedCanvases.getCanvas("inlineImage",o,a).context;C(W,i),f=this.applyTransferMapsToCanvas(W)}const T=this._scaleImage(f,(0,u.getCurrentTransformInverse)(h));h.imageSmoothingEnabled=G((0,u.getCurrentTransform)(h),i.interpolate),p(h,T.img,0,0,T.paintWidth,T.paintHeight,0,-a,o,a),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,o){if(!this.contentVisible)return;const a=this.ctx;let h;if(i.bitmap)h=i.bitmap;else{const f=i.width,T=i.height,W=this.cachedCanvases.getCanvas("inlineImage",f,T).context;C(W,i),h=this.applyTransferMapsToCanvas(W)}for(const f of o)a.save(),a.transform(...f.transform),a.scale(1,-1),p(a,h,f.x,f.y,f.w,f.h,0,-1,1,1),a.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,o){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,o){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const a=this.ctx;this.pendingClip&&(o||(this.pendingClip===at?a.clip("evenodd"):a.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),a.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,u.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const o=Math.abs(i[0]*i[3]-i[2]*i[1]),a=Math.hypot(i[0],i[2]),h=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(a,h)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:o,b:a,c:h,d:f}=this.ctx.getTransform();let T,N;if(a===0&&h===0){const W=Math.abs(o),it=Math.abs(f);if(W===it)if(i===0)T=N=1/W;else{const tt=W*i;T=N=tt<1?1/tt:1}else if(i===0)T=1/W,N=1/it;else{const tt=W*i,et=it*i;T=tt<1?1/tt:1,N=et<1?1/et:1}}else{const W=Math.abs(o*f-a*h),it=Math.hypot(o,a),tt=Math.hypot(h,f);if(i===0)T=tt/W,N=it/W;else{const et=i*W;T=tt>et?tt/et:1,N=it>et?it/et:1}}this._cachedScaleForStroking[0]=T,this._cachedScaleForStroking[1]=N}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:o}=this,{lineWidth:a}=this.current,[h,f]=this.getScaleForStroking();if(o.lineWidth=a||1,h===1&&f===1){o.stroke();return}const T=o.getLineDash();if(i&&o.save(),o.scale(h,f),T.length>0){const N=Math.max(h,f);o.setLineDash(T.map(W=>W/N)),o.lineDashOffset/=N}o.stroke(),i&&o.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};V=new WeakSet,Ze=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},mt=new WeakSet,tn=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const o=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=o}}};let ct=wt;e.CanvasGraphics=ct;for(const M in n.OPS)ct.prototype[M]!==void 0&&(ct.prototype[n.OPS[M]]=ct.prototype[M])},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=k;var n=D(1),u=D(6);const $={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=$;function L(E,P){if(!P)return;const C=P[2]-P[0],v=P[3]-P[1],l=new Path2D;l.rect(P[0],P[1],C,v),E.clip(l)}class rt{constructor(){this.constructor===rt&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class R extends rt{constructor(P){super(),this._type=P[1],this._bbox=P[2],this._colorStops=P[3],this._p0=P[4],this._p1=P[5],this._r0=P[6],this._r1=P[7],this.matrix=null}_createGradient(P){let C;this._type==="axial"?C=P.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=P.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const v of this._colorStops)C.addColorStop(v[0],v[1]);return C}getPattern(P,C,v,l){let d;if(l===$.STROKE||l===$.FILL){const I=C.current.getClippedPathBoundingBox(l,(0,u.getCurrentTransform)(P))||[0,0,0,0],A=Math.ceil(I[2]-I[0])||1,c=Math.ceil(I[3]-I[1])||1,F=C.cachedCanvases.getCanvas("pattern",A,c,!0),b=F.context;b.clearRect(0,0,b.canvas.width,b.canvas.height),b.beginPath(),b.rect(0,0,b.canvas.width,b.canvas.height),b.translate(-I[0],-I[1]),v=n.Util.transform(v,[1,0,0,1,I[0],I[1]]),b.transform(...C.baseTransform),this.matrix&&b.transform(...this.matrix),L(b,this._bbox),b.fillStyle=this._createGradient(b),b.fill(),d=P.createPattern(F.canvas,"no-repeat");const G=new DOMMatrix(v);d.setTransform(G)}else L(P,this._bbox),d=this._createGradient(P);return d}}function y(E,P,C,v,l,d,I,A){const c=P.coords,F=P.colors,b=E.data,G=E.width*4;let z;c[C+1]>c[v+1]&&(z=C,C=v,v=z,z=d,d=I,I=z),c[v+1]>c[l+1]&&(z=v,v=l,l=z,z=I,I=A,A=z),c[C+1]>c[v+1]&&(z=C,C=v,v=z,z=d,d=I,I=z);const S=(c[C]+P.offsetX)*P.scaleX,X=(c[C+1]+P.offsetY)*P.scaleY,at=(c[v]+P.offsetX)*P.scaleX,ct=(c[v+1]+P.offsetY)*P.scaleY,V=(c[l]+P.offsetX)*P.scaleX,dt=(c[l+1]+P.offsetY)*P.scaleY;if(X>=dt)return;const mt=F[d],Et=F[d+1],wt=F[d+2],M=F[I],i=F[I+1],o=F[I+2],a=F[A],h=F[A+1],f=F[A+2],T=Math.round(X),N=Math.round(dt);let W,it,tt,et,ht,bt,ut,Ft;for(let Bt=T;Bt<=N;Bt++){if(Bt<ct){const st=Bt<X?0:(X-Bt)/(X-ct);W=S-(S-at)*st,it=mt-(mt-M)*st,tt=Et-(Et-i)*st,et=wt-(wt-o)*st}else{let st;Bt>dt?st=1:ct===dt?st=0:st=(ct-Bt)/(ct-dt),W=at-(at-V)*st,it=M-(M-a)*st,tt=i-(i-h)*st,et=o-(o-f)*st}let St;Bt<X?St=0:Bt>dt?St=1:St=(X-Bt)/(X-dt),ht=S-(S-V)*St,bt=mt-(mt-a)*St,ut=Et-(Et-h)*St,Ft=wt-(wt-f)*St;const Lt=Math.round(Math.min(W,ht)),gt=Math.round(Math.max(W,ht));let nt=G*Bt+Lt*4;for(let st=Lt;st<=gt;st++)St=(W-st)/(W-ht),St<0?St=0:St>1&&(St=1),b[nt++]=it-(it-bt)*St|0,b[nt++]=tt-(tt-ut)*St|0,b[nt++]=et-(et-Ft)*St|0,b[nt++]=255}}function m(E,P,C){const v=P.coords,l=P.colors;let d,I;switch(P.type){case"lattice":const A=P.verticesPerRow,c=Math.floor(v.length/A)-1,F=A-1;for(d=0;d<c;d++){let b=d*A;for(let G=0;G<F;G++,b++)y(E,C,v[b],v[b+1],v[b+A],l[b],l[b+1],l[b+A]),y(E,C,v[b+A+1],v[b+1],v[b+A],l[b+A+1],l[b+1],l[b+A])}break;case"triangles":for(d=0,I=v.length;d<I;d+=3)y(E,C,v[d],v[d+1],v[d+2],l[d],l[d+1],l[d+2]);break;default:throw new Error("illegal figure")}}class O extends rt{constructor(P){super(),this._coords=P[2],this._colors=P[3],this._figures=P[4],this._bounds=P[5],this._bbox=P[7],this._background=P[8],this.matrix=null}_createMeshCanvas(P,C,v){const A=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),F=Math.ceil(this._bounds[2])-A,b=Math.ceil(this._bounds[3])-c,G=Math.min(Math.ceil(Math.abs(F*P[0]*1.1)),3e3),z=Math.min(Math.ceil(Math.abs(b*P[1]*1.1)),3e3),S=F/G,X=b/z,at={coords:this._coords,colors:this._colors,offsetX:-A,offsetY:-c,scaleX:1/S,scaleY:1/X},ct=G+2*2,V=z+2*2,dt=v.getCanvas("mesh",ct,V,!1),mt=dt.context,Et=mt.createImageData(G,z);if(C){const M=Et.data;for(let i=0,o=M.length;i<o;i+=4)M[i]=C[0],M[i+1]=C[1],M[i+2]=C[2],M[i+3]=255}for(const M of this._figures)m(Et,M,at);return mt.putImageData(Et,2,2),{canvas:dt.canvas,offsetX:A-2*S,offsetY:c-2*X,scaleX:S,scaleY:X}}getPattern(P,C,v,l){L(P,this._bbox);let d;if(l===$.SHADING)d=n.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(P));else if(d=n.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const A=n.Util.singularValueDecompose2dScale(this.matrix);d=[d[0]*A[0],d[1]*A[1]]}const I=this._createMeshCanvas(d,l===$.SHADING?null:this._background,C.cachedCanvases);return l!==$.SHADING&&(P.setTransform(...C.baseTransform),this.matrix&&P.transform(...this.matrix)),P.translate(I.offsetX,I.offsetY),P.scale(I.scaleX,I.scaleY),P.createPattern(I.canvas,"no-repeat")}}class j extends rt{getPattern(){return"hotpink"}}function k(E){switch(E[0]){case"RadialAxial":return new R(E);case"Mesh":return new O(E);case"Dummy":return new j}throw new Error(`Unknown IR type: ${E[0]}`)}const _={COLORED:1,UNCOLORED:2},p=class p{constructor(P,C,v,l,d){this.operatorList=P[2],this.matrix=P[3]||[1,0,0,1,0,0],this.bbox=P[4],this.xstep=P[5],this.ystep=P[6],this.paintType=P[7],this.tilingType=P[8],this.color=C,this.ctx=v,this.canvasGraphicsFactory=l,this.baseTransform=d}createPatternCanvas(P){const C=this.operatorList,v=this.bbox,l=this.xstep,d=this.ystep,I=this.paintType,A=this.tilingType,c=this.color,F=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+A);const b=v[0],G=v[1],z=v[2],S=v[3],X=n.Util.singularValueDecompose2dScale(this.matrix),at=n.Util.singularValueDecompose2dScale(this.baseTransform),ct=[X[0]*at[0],X[1]*at[1]],V=this.getSizeAndScale(l,this.ctx.canvas.width,ct[0]),dt=this.getSizeAndScale(d,this.ctx.canvas.height,ct[1]),mt=P.cachedCanvases.getCanvas("pattern",V.size,dt.size,!0),Et=mt.context,wt=F.createCanvasGraphics(Et);wt.groupLevel=P.groupLevel,this.setFillAndStrokeStyleToContext(wt,I,c);let M=b,i=G,o=z,a=S;return b<0&&(M=0,o+=Math.abs(b)),G<0&&(i=0,a+=Math.abs(G)),Et.translate(-(V.scale*M),-(dt.scale*i)),wt.transform(V.scale,0,0,dt.scale,0,0),Et.save(),this.clipBbox(wt,M,i,o,a),wt.baseTransform=(0,u.getCurrentTransform)(wt.ctx),wt.executeOperatorList(C),wt.endDrawing(),{canvas:mt.canvas,scaleX:V.scale,scaleY:dt.scale,offsetX:M,offsetY:i}}getSizeAndScale(P,C,v){P=Math.abs(P);const l=Math.max(p.MAX_PATTERN_SIZE,C);let d=Math.ceil(P*v);return d>=l?d=l:v=d/P,{scale:v,size:d}}clipBbox(P,C,v,l,d){const I=l-C,A=d-v;P.ctx.rect(C,v,I,A),P.current.updateRectMinMax((0,u.getCurrentTransform)(P.ctx),[C,v,l,d]),P.clip(),P.endPath()}setFillAndStrokeStyleToContext(P,C,v){const l=P.ctx,d=P.current;switch(C){case _.COLORED:const I=this.ctx;l.fillStyle=I.fillStyle,l.strokeStyle=I.strokeStyle,d.fillColor=I.fillStyle,d.strokeColor=I.strokeStyle;break;case _.UNCOLORED:const A=n.Util.makeHexColor(v[0],v[1],v[2]);l.fillStyle=A,l.strokeStyle=A,d.fillColor=A,d.strokeColor=A;break;default:throw new n.FormatError(`Unsupported paint type: ${C}`)}}getPattern(P,C,v,l){let d=v;l!==$.SHADING&&(d=n.Util.transform(d,C.baseTransform),this.matrix&&(d=n.Util.transform(d,this.matrix)));const I=this.createPatternCanvas(C);let A=new DOMMatrix(d);A=A.translate(I.offsetX,I.offsetY),A=A.scale(1/I.scaleX,1/I.scaleY);const c=P.createPattern(I.canvas,"repeat");return c.setTransform(A),c}};ne(p,"MAX_PATTERN_SIZE",3e3);let w=p;e.TilingPattern=w},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=$,e.convertToRGBA=u,e.grayToRGBA=rt;var n=D(1);function u(R){switch(R.kind){case n.ImageKind.GRAYSCALE_1BPP:return $(R);case n.ImageKind.RGB_24BPP:return L(R)}return null}function $({src:R,srcPos:y=0,dest:m,width:O,height:j,nonBlackColor:k=4294967295,inverseDecode:_=!1}){const w=n.FeatureTest.isLittleEndian?4278190080:255,[p,E]=_?[k,w]:[w,k],P=O>>3,C=O&7,v=R.length;m=new Uint32Array(m.buffer);let l=0;for(let d=0;d<j;d++){for(const A=y+P;y<A;y++){const c=y<v?R[y]:255;m[l++]=c&128?E:p,m[l++]=c&64?E:p,m[l++]=c&32?E:p,m[l++]=c&16?E:p,m[l++]=c&8?E:p,m[l++]=c&4?E:p,m[l++]=c&2?E:p,m[l++]=c&1?E:p}if(C===0)continue;const I=y<v?R[y++]:255;for(let A=0;A<C;A++)m[l++]=I&1<<7-A?E:p}return{srcPos:y,destPos:l}}function L({src:R,srcPos:y=0,dest:m,destPos:O=0,width:j,height:k}){let _=0;const w=R.length>>2,p=new Uint32Array(R.buffer,y,w);if(n.FeatureTest.isLittleEndian){for(;_<w-2;_+=3,O+=4){const E=p[_],P=p[_+1],C=p[_+2];m[O]=E|4278190080,m[O+1]=E>>>24|P<<8|4278190080,m[O+2]=P>>>16|C<<16|4278190080,m[O+3]=C>>>8|4278190080}for(let E=_*4,P=R.length;E<P;E+=3)m[O++]=R[E]|R[E+1]<<8|R[E+2]<<16|4278190080}else{for(;_<w-2;_+=3,O+=4){const E=p[_],P=p[_+1],C=p[_+2];m[O]=E|255,m[O+1]=E<<24|P>>>8|255,m[O+2]=P<<16|C>>>16|255,m[O+3]=C<<8|255}for(let E=_*4,P=R.length;E<P;E+=3)m[O++]=R[E]<<24|R[E+1]<<16|R[E+2]<<8|255}return{srcPos:y,destPos:O}}function rt(R,y){if(n.FeatureTest.isLittleEndian)for(let m=0,O=R.length;m<O;m++)y[m]=R[m]*65793|4278190080;else for(let m=0,O=R.length;m<O;m++)y[m]=R[m]*16843008|255}},(g,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const D=Object.create(null);e.GlobalWorkerOptions=D,D.workerPort=null,D.workerSrc=""},(g,e,D)=>{var R,kn,m,Fn,j,Re;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=D(1);const u={UNKNOWN:0,DATA:1,ERROR:2},$={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function L(_){switch(_ instanceof Error||typeof _=="object"&&_!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),_.name){case"AbortException":return new n.AbortException(_.message);case"MissingPDFException":return new n.MissingPDFException(_.message);case"PasswordException":return new n.PasswordException(_.message,_.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(_.message,_.status);case"UnknownErrorException":return new n.UnknownErrorException(_.message,_.details);default:return new n.UnknownErrorException(_.message,_.toString())}}class rt{constructor(w,p,E){H(this,R);H(this,m);H(this,j);this.sourceName=w,this.targetName=p,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=P=>{const C=P.data;if(C.targetName!==this.sourceName)return;if(C.stream){Y(this,m,Fn).call(this,C);return}if(C.callback){const l=C.callbackId,d=this.callbackCapabilities[l];if(!d)throw new Error(`Cannot resolve callback ${l}`);if(delete this.callbackCapabilities[l],C.callback===u.DATA)d.resolve(C.data);else if(C.callback===u.ERROR)d.reject(L(C.reason));else throw new Error("Unexpected callback case");return}const v=this.actionHandler[C.action];if(!v)throw new Error(`Unknown action from worker: ${C.action}`);if(C.callbackId){const l=this.sourceName,d=C.sourceName;new Promise(function(I){I(v(C.data))}).then(function(I){E.postMessage({sourceName:l,targetName:d,callback:u.DATA,callbackId:C.callbackId,data:I})},function(I){E.postMessage({sourceName:l,targetName:d,callback:u.ERROR,callbackId:C.callbackId,reason:L(I)})});return}if(C.streamId){Y(this,R,kn).call(this,C);return}v(C.data)},E.addEventListener("message",this._onComObjOnMessage)}on(w,p){const E=this.actionHandler;if(E[w])throw new Error(`There is already an actionName called "${w}"`);E[w]=p}send(w,p,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:w,data:p},E)}sendWithPromise(w,p,E){const P=this.callbackId++,C=new n.PromiseCapability;this.callbackCapabilities[P]=C;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:w,callbackId:P,data:p},E)}catch(v){C.reject(v)}return C.promise}sendWithStream(w,p,E,P){const C=this.streamId++,v=this.sourceName,l=this.targetName,d=this.comObj;return new ReadableStream({start:I=>{const A=new n.PromiseCapability;return this.streamControllers[C]={controller:I,startCall:A,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:v,targetName:l,action:w,streamId:C,data:p,desiredSize:I.desiredSize},P),A.promise},pull:I=>{const A=new n.PromiseCapability;return this.streamControllers[C].pullCall=A,d.postMessage({sourceName:v,targetName:l,stream:$.PULL,streamId:C,desiredSize:I.desiredSize}),A.promise},cancel:I=>{(0,n.assert)(I instanceof Error,"cancel must have a valid reason");const A=new n.PromiseCapability;return this.streamControllers[C].cancelCall=A,this.streamControllers[C].isClosed=!0,d.postMessage({sourceName:v,targetName:l,stream:$.CANCEL,streamId:C,reason:L(I)}),A.promise}},E)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}R=new WeakSet,kn=function(w){const p=w.streamId,E=this.sourceName,P=w.sourceName,C=this.comObj,v=this,l=this.actionHandler[w.action],d={enqueue(I,A=1,c){if(this.isCancelled)return;const F=this.desiredSize;this.desiredSize-=A,F>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),C.postMessage({sourceName:E,targetName:P,stream:$.ENQUEUE,streamId:p,chunk:I},c)},close(){this.isCancelled||(this.isCancelled=!0,C.postMessage({sourceName:E,targetName:P,stream:$.CLOSE,streamId:p}),delete v.streamSinks[p])},error(I){(0,n.assert)(I instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,C.postMessage({sourceName:E,targetName:P,stream:$.ERROR,streamId:p,reason:L(I)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:w.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[p]=d,new Promise(function(I){I(l(w.data,d))}).then(function(){C.postMessage({sourceName:E,targetName:P,stream:$.START_COMPLETE,streamId:p,success:!0})},function(I){C.postMessage({sourceName:E,targetName:P,stream:$.START_COMPLETE,streamId:p,reason:L(I)})})},m=new WeakSet,Fn=function(w){const p=w.streamId,E=this.sourceName,P=w.sourceName,C=this.comObj,v=this.streamControllers[p],l=this.streamSinks[p];switch(w.stream){case $.START_COMPLETE:w.success?v.startCall.resolve():v.startCall.reject(L(w.reason));break;case $.PULL_COMPLETE:w.success?v.pullCall.resolve():v.pullCall.reject(L(w.reason));break;case $.PULL:if(!l){C.postMessage({sourceName:E,targetName:P,stream:$.PULL_COMPLETE,streamId:p,success:!0});break}l.desiredSize<=0&&w.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=w.desiredSize,new Promise(function(d){var I;d((I=l.onPull)==null?void 0:I.call(l))}).then(function(){C.postMessage({sourceName:E,targetName:P,stream:$.PULL_COMPLETE,streamId:p,success:!0})},function(d){C.postMessage({sourceName:E,targetName:P,stream:$.PULL_COMPLETE,streamId:p,reason:L(d)})});break;case $.ENQUEUE:if((0,n.assert)(v,"enqueue should have stream controller"),v.isClosed)break;v.controller.enqueue(w.chunk);break;case $.CLOSE:if((0,n.assert)(v,"close should have stream controller"),v.isClosed)break;v.isClosed=!0,v.controller.close(),Y(this,j,Re).call(this,v,p);break;case $.ERROR:(0,n.assert)(v,"error should have stream controller"),v.controller.error(L(w.reason)),Y(this,j,Re).call(this,v,p);break;case $.CANCEL_COMPLETE:w.success?v.cancelCall.resolve():v.cancelCall.reject(L(w.reason)),Y(this,j,Re).call(this,v,p);break;case $.CANCEL:if(!l)break;new Promise(function(d){var I;d((I=l.onCancel)==null?void 0:I.call(l,L(w.reason)))}).then(function(){C.postMessage({sourceName:E,targetName:P,stream:$.CANCEL_COMPLETE,streamId:p,success:!0})},function(d){C.postMessage({sourceName:E,targetName:P,stream:$.CANCEL_COMPLETE,streamId:p,reason:L(d)})}),l.sinkCapability.reject(L(w.reason)),l.isCancelled=!0,delete this.streamSinks[p];break;default:throw new Error("Unexpected stream case")}},j=new WeakSet,Re=async function(w,p){var E,P,C;await Promise.allSettled([(E=w.startCall)==null?void 0:E.promise,(P=w.pullCall)==null?void 0:P.promise,(C=w.cancelCall)==null?void 0:C.promise]),delete this.streamControllers[p]},e.MessageHandler=rt},(g,e,D)=>{var $,L;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=D(1);class u{constructor({parsedData:R,rawData:y}){H(this,$,void 0);H(this,L,void 0);ot(this,$,R),ot(this,L,y)}getRaw(){return t(this,L)}get(R){return t(this,$).get(R)??null}getAll(){return(0,n.objectFromMap)(t(this,$))}has(R){return t(this,$).has(R)}}$=new WeakMap,L=new WeakMap,e.Metadata=u},(g,e,D)=>{var R,y,m,O,j,k,en;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=D(1),u=D(8);const $=Symbol("INTERNAL");class L{constructor(p,E){H(this,R,!0);this.name=p,this.intent=E}get visible(){return t(this,R)}_setVisible(p,E){p!==$&&(0,n.unreachable)("Internal method `_setVisible` called."),ot(this,R,E)}}R=new WeakMap;class rt{constructor(p){H(this,k);H(this,y,null);H(this,m,new Map);H(this,O,null);H(this,j,null);if(this.name=null,this.creator=null,p!==null){this.name=p.name,this.creator=p.creator,ot(this,j,p.order);for(const E of p.groups)t(this,m).set(E.id,new L(E.name,E.intent));if(p.baseState==="OFF")for(const E of t(this,m).values())E._setVisible($,!1);for(const E of p.on)t(this,m).get(E)._setVisible($,!0);for(const E of p.off)t(this,m).get(E)._setVisible($,!1);ot(this,O,this.getHash())}}isVisible(p){if(t(this,m).size===0)return!0;if(!p)return(0,n.warn)("Optional content group not defined."),!0;if(p.type==="OCG")return t(this,m).has(p.id)?t(this,m).get(p.id).visible:((0,n.warn)(`Optional content group not found: ${p.id}`),!0);if(p.type==="OCMD"){if(p.expression)return Y(this,k,en).call(this,p.expression);if(!p.policy||p.policy==="AnyOn"){for(const E of p.ids){if(!t(this,m).has(E))return(0,n.warn)(`Optional content group not found: ${E}`),!0;if(t(this,m).get(E).visible)return!0}return!1}else if(p.policy==="AllOn"){for(const E of p.ids){if(!t(this,m).has(E))return(0,n.warn)(`Optional content group not found: ${E}`),!0;if(!t(this,m).get(E).visible)return!1}return!0}else if(p.policy==="AnyOff"){for(const E of p.ids){if(!t(this,m).has(E))return(0,n.warn)(`Optional content group not found: ${E}`),!0;if(!t(this,m).get(E).visible)return!0}return!1}else if(p.policy==="AllOff"){for(const E of p.ids){if(!t(this,m).has(E))return(0,n.warn)(`Optional content group not found: ${E}`),!0;if(t(this,m).get(E).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${p.policy}.`),!0}return(0,n.warn)(`Unknown group type ${p.type}.`),!0}setVisibility(p,E=!0){if(!t(this,m).has(p)){(0,n.warn)(`Optional content group not found: ${p}`);return}t(this,m).get(p)._setVisible($,!!E),ot(this,y,null)}get hasInitialVisibility(){return t(this,O)===null||this.getHash()===t(this,O)}getOrder(){return t(this,m).size?t(this,j)?t(this,j).slice():[...t(this,m).keys()]:null}getGroups(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}getGroup(p){return t(this,m).get(p)||null}getHash(){if(t(this,y)!==null)return t(this,y);const p=new u.MurmurHash3_64;for(const[E,P]of t(this,m))p.update(`${E}:${P.visible}`);return ot(this,y,p.hexdigest())}}y=new WeakMap,m=new WeakMap,O=new WeakMap,j=new WeakMap,k=new WeakSet,en=function(p){const E=p.length;if(E<2)return!0;const P=p[0];for(let C=1;C<E;C++){const v=p[C];let l;if(Array.isArray(v))l=Y(this,k,en).call(this,v);else if(t(this,m).has(v))l=t(this,m).get(v).visible;else return(0,n.warn)(`Optional content group not found: ${v}`),!0;switch(P){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return P==="And"},e.OptionalContentConfig=rt},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=D(1),u=D(6);class ${constructor({length:y,initialData:m,progressiveDone:O=!1,contentDispositionFilename:j=null,disableRange:k=!1,disableStream:_=!1},w){if((0,n.assert)(w,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=O,this._contentDispositionFilename=j,(m==null?void 0:m.length)>0){const p=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(p)}this._pdfDataRangeTransport=w,this._isStreamingSupported=!_,this._isRangeSupported=!k,this._contentLength=y,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((p,E)=>{this._onReceiveData({begin:p,chunk:E})}),this._pdfDataRangeTransport.addProgressListener((p,E)=>{this._onProgress({loaded:p,total:E})}),this._pdfDataRangeTransport.addProgressiveReadListener(p=>{this._onReceiveData({chunk:p})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:y,chunk:m}){const O=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(y===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(O):this._queuedChunks.push(O);else{const j=this._rangeReaders.some(function(k){return k._begin!==y?!1:(k._enqueue(O),!0)});(0,n.assert)(j,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}_onProgress(y){var m,O,j,k;y.total===void 0?(O=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||O.call(m,{loaded:y.loaded}):(k=(j=this._fullRequestReader)==null?void 0:j.onProgress)==null||k.call(j,{loaded:y.loaded,total:y.total})}_onProgressiveDone(){var y;(y=this._fullRequestReader)==null||y.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(y){const m=this._rangeReaders.indexOf(y);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const y=this._queuedChunks;return this._queuedChunks=null,new L(this,y,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(y,m){if(m<=this._progressiveDataLength)return null;const O=new rt(this,y,m);return this._pdfDataRangeTransport.requestDataRange(y,m),this._rangeReaders.push(O),O}cancelAllRequests(y){var m;(m=this._fullRequestReader)==null||m.cancel(y);for(const O of this._rangeReaders.slice(0))O.cancel(y);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=$;class L{constructor(y,m,O=!1,j=null){this._stream=y,this._done=O||!1,this._filename=(0,u.isPdfFile)(j)?j:null,this._queuedChunks=m||[],this._loaded=0;for(const k of this._queuedChunks)this._loaded+=k.byteLength;this._requests=[],this._headersReady=Promise.resolve(),y._fullRequestReader=this,this.onProgress=null}_enqueue(y){this._done||(this._requests.length>0?this._requests.shift().resolve({value:y,done:!1}):this._queuedChunks.push(y),this._loaded+=y.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=new n.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class rt{constructor(y,m,O){this._stream=y,this._begin=m,this._end=O,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(y){if(!this._done){if(this._requests.length===0)this._queuedChunk=y;else{this._requests.shift().resolve({value:y,done:!1});for(const O of this._requests)O.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const y=new n.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=D(1),u=D(20);function $(O,j,k){return{method:"GET",headers:O,signal:k.signal,mode:"cors",credentials:j?"include":"same-origin",redirect:"follow"}}function L(O){const j=new Headers;for(const k in O){const _=O[k];_!==void 0&&j.append(k,_)}return j}function rt(O){return O instanceof Uint8Array?O.buffer:O instanceof ArrayBuffer?O:((0,n.warn)(`getArrayBuffer - unexpected data format: ${O}`),new Uint8Array(O).buffer)}class R{constructor(j){this.source=j,this.isHttp=/^https?:/i.test(j.url),this.httpHeaders=this.isHttp&&j.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var j;return((j=this._fullRequestReader)==null?void 0:j._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y(this),this._fullRequestReader}getRangeReader(j,k){if(k<=this._progressiveDataLength)return null;const _=new m(this,j,k);return this._rangeRequestReaders.push(_),_}cancelAllRequests(j){var k;(k=this._fullRequestReader)==null||k.cancel(j);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(j)}}e.PDFFetchStream=R;class y{constructor(j){this._stream=j,this._reader=null,this._loaded=0,this._filename=null;const k=j.source;this._withCredentials=k.withCredentials||!1,this._contentLength=k.length,this._headersCapability=new n.PromiseCapability,this._disableRange=k.disableRange||!1,this._rangeChunkSize=k.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!k.disableStream,this._isRangeSupported=!k.disableRange,this._headers=L(this._stream.httpHeaders);const _=k.url;fetch(_,$(this._headers,this._withCredentials,this._abortController)).then(w=>{if(!(0,u.validateResponseStatus)(w.status))throw(0,u.createResponseStatusError)(w.status,_);this._reader=w.body.getReader(),this._headersCapability.resolve();const p=C=>w.headers.get(C),{allowRangeRequests:E,suggestedLength:P}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=E,this._contentLength=P||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._headersCapability.promise;const{value:j,done:k}=await this._reader.read();return k?{value:j,done:k}:(this._loaded+=j.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded,total:this._contentLength}),{value:rt(j),done:!1})}cancel(j){var k;(k=this._reader)==null||k.cancel(j),this._abortController.abort()}}class m{constructor(j,k,_){this._stream=j,this._reader=null,this._loaded=0;const w=j.source;this._withCredentials=w.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!w.disableStream,this._abortController=new AbortController,this._headers=L(this._stream.httpHeaders),this._headers.append("Range",`bytes=${k}-${_-1}`);const p=w.url;fetch(p,$(this._headers,this._withCredentials,this._abortController)).then(E=>{if(!(0,u.validateResponseStatus)(E.status))throw(0,u.createResponseStatusError)(E.status,p);this._readCapability.resolve(),this._reader=E.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._readCapability.promise;const{value:j,done:k}=await this._reader.read();return k?{value:j,done:k}:(this._loaded+=j.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded}),{value:rt(j),done:!1})}cancel(j){var k;(k=this._reader)==null||k.cancel(j),this._abortController.abort()}}},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=R,e.extractFilenameFromHeader=rt,e.validateRangeRequestCapabilities=L,e.validateResponseStatus=y;var n=D(1),u=D(21),$=D(6);function L({getResponseHeader:m,isHttp:O,rangeChunkSize:j,disableRange:k}){const _={allowRangeRequests:!1,suggestedLength:void 0},w=parseInt(m("Content-Length"),10);return!Number.isInteger(w)||(_.suggestedLength=w,w<=2*j)||k||!O||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(_.allowRangeRequests=!0),_}function rt(m){const O=m("Content-Disposition");if(O){let j=(0,u.getFilenameFromContentDispositionHeader)(O);if(j.includes("%"))try{j=decodeURIComponent(j)}catch{}if((0,$.isPdfFile)(j))return j}return null}function R(m,O){return m===404||m===0&&O.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+O+'".'):new n.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${O}".`,m)}function y(m){return m===200||m===206}},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=u;var n=D(1);function u($){let L=!0,rt=R("filename\\*","i").exec($);if(rt){rt=rt[1];let w=j(rt);return w=unescape(w),w=k(w),w=_(w),m(w)}if(rt=O($),rt){const w=_(rt);return m(w)}if(rt=R("filename","i").exec($),rt){rt=rt[1];let w=j(rt);return w=_(w),m(w)}function R(w,p){return new RegExp("(?:^|;)\\s*"+w+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function y(w,p){if(w){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const E=new TextDecoder(w,{fatal:!0}),P=(0,n.stringToBytes)(p);p=E.decode(P),L=!1}catch{}}return p}function m(w){return L&&/[\x80-\xff]/.test(w)&&(w=y("utf-8",w),L&&(w=y("iso-8859-1",w))),w}function O(w){const p=[];let E;const P=R("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(E=P.exec(w))!==null;){let[,v,l,d]=E;if(v=parseInt(v,10),v in p){if(v===0)break;continue}p[v]=[l,d]}const C=[];for(let v=0;v<p.length&&v in p;++v){let[l,d]=p[v];d=j(d),l&&(d=unescape(d),v===0&&(d=k(d))),C.push(d)}return C.join("")}function j(w){if(w.startsWith('"')){const p=w.slice(1).split('\\"');for(let E=0;E<p.length;++E){const P=p[E].indexOf('"');P!==-1&&(p[E]=p[E].slice(0,P),p.length=E+1),p[E]=p[E].replaceAll(/\\(.)/g,"$1")}w=p.join('"')}return w}function k(w){const p=w.indexOf("'");if(p===-1)return w;const E=w.slice(0,p),C=w.slice(p+1).replace(/^[^']*'/,"");return y(E,C)}function _(w){return!w.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(w)?w:w.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,E,P,C){if(P==="q"||P==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,l){return String.fromCharCode(parseInt(l,16))}),y(E,C);try{C=atob(C)}catch{}return y(E,C)})}return""}},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=D(1),u=D(20);const $=200,L=206;function rt(j){const k=j.response;return typeof k!="string"?k:(0,n.stringToBytes)(k).buffer}class R{constructor(k,_={}){this.url=k,this.isHttp=/^https?:/i.test(k),this.httpHeaders=this.isHttp&&_.httpHeaders||Object.create(null),this.withCredentials=_.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(k,_,w){const p={begin:k,end:_};for(const E in w)p[E]=w[E];return this.request(p)}requestFull(k){return this.request(k)}request(k){const _=new XMLHttpRequest,w=this.currXhrId++,p=this.pendingRequests[w]={xhr:_};_.open("GET",this.url),_.withCredentials=this.withCredentials;for(const E in this.httpHeaders){const P=this.httpHeaders[E];P!==void 0&&_.setRequestHeader(E,P)}return this.isHttp&&"begin"in k&&"end"in k?(_.setRequestHeader("Range",`bytes=${k.begin}-${k.end-1}`),p.expectedStatus=L):p.expectedStatus=$,_.responseType="arraybuffer",k.onError&&(_.onerror=function(E){k.onError(_.status)}),_.onreadystatechange=this.onStateChange.bind(this,w),_.onprogress=this.onProgress.bind(this,w),p.onHeadersReceived=k.onHeadersReceived,p.onDone=k.onDone,p.onError=k.onError,p.onProgress=k.onProgress,_.send(null),w}onProgress(k,_){var p;const w=this.pendingRequests[k];w&&((p=w.onProgress)==null||p.call(w,_))}onStateChange(k,_){var v,l,d;const w=this.pendingRequests[k];if(!w)return;const p=w.xhr;if(p.readyState>=2&&w.onHeadersReceived&&(w.onHeadersReceived(),delete w.onHeadersReceived),p.readyState!==4||!(k in this.pendingRequests))return;if(delete this.pendingRequests[k],p.status===0&&this.isHttp){(v=w.onError)==null||v.call(w,p.status);return}const E=p.status||$;if(!(E===$&&w.expectedStatus===L)&&E!==w.expectedStatus){(l=w.onError)==null||l.call(w,p.status);return}const C=rt(p);if(E===L){const I=p.getResponseHeader("Content-Range"),A=/bytes (\d+)-(\d+)\/(\d+)/.exec(I);w.onDone({begin:parseInt(A[1],10),chunk:C})}else C?w.onDone({begin:0,chunk:C}):(d=w.onError)==null||d.call(w,p.status)}getRequestXhr(k){return this.pendingRequests[k].xhr}isPendingRequest(k){return k in this.pendingRequests}abortRequest(k){const _=this.pendingRequests[k].xhr;delete this.pendingRequests[k],_.abort()}}class y{constructor(k){this._source=k,this._manager=new R(k.url,{httpHeaders:k.httpHeaders,withCredentials:k.withCredentials}),this._rangeChunkSize=k.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(k){const _=this._rangeRequestReaders.indexOf(k);_>=0&&this._rangeRequestReaders.splice(_,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(k,_){const w=new O(this._manager,k,_);return w.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(w),w}cancelAllRequests(k){var _;(_=this._fullRequestReader)==null||_.cancel(k);for(const w of this._rangeRequestReaders.slice(0))w.cancel(k)}}e.PDFNetworkStream=y;class m{constructor(k,_){this._manager=k;const w={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._fullRequestId=k.requestFull(w),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=_.disableRange||!1,this._contentLength=_.length,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const k=this._fullRequestId,_=this._manager.getRequestXhr(k),w=P=>_.getResponseHeader(P),{allowRangeRequests:p,suggestedLength:E}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:w,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});p&&(this._isRangeSupported=!0),this._contentLength=E||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(w),this._isRangeSupported&&this._manager.abortRequest(k),this._headersReceivedCapability.resolve()}_onDone(k){if(k&&(this._requests.length>0?this._requests.shift().resolve({value:k.chunk,done:!1}):this._cachedChunks.push(k.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(k){this._storedError=(0,u.createResponseStatusError)(k,this._url),this._headersReceivedCapability.reject(this._storedError);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(k){var _;(_=this.onProgress)==null||_.call(this,{loaded:k.loaded,total:k.lengthComputable?k.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const k=new n.PromiseCapability;return this._requests.push(k),k.promise}cancel(k){this._done=!0,this._headersReceivedCapability.reject(k);for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class O{constructor(k,_,w){this._manager=k;const p={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=k.url,this._requestId=k.requestRange(_,w,p),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var k;(k=this.onClosed)==null||k.call(this,this)}_onDone(k){const _=k.chunk;this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunk=_,this._done=!0;for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(k){this._storedError=(0,u.createResponseStatusError)(k,this._url);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(k){var _;this.isStreamingSupported||(_=this.onProgress)==null||_.call(this,{loaded:k.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const k=new n.PromiseCapability;return this._requests.push(k),k.promise}cancel(k){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=D(1),u=D(20);const $=/^file:\/\/\/[a-zA-Z]:\//;function L(w){const p=require$$5,E=p.parse(w);return E.protocol==="file:"||E.host?E:/^[a-z]:[/\\]/i.test(w)?p.parse(`file:///${w}`):(E.host||(E.protocol="file:"),E)}class rt{constructor(p){this.source=p,this.url=L(p.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new k(this):new O(this),this._fullRequestReader}getRangeReader(p,E){if(E<=this._progressiveDataLength)return null;const P=this.isFsUrl?new _(this,p,E):new j(this,p,E);return this._rangeRequestReaders.push(P),P}cancelAllRequests(p){var E;(E=this._fullRequestReader)==null||E.cancel(p);for(const P of this._rangeRequestReaders.slice(0))P.cancel(p)}}e.PDFNodeStream=rt;class R{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null;const E=p.source;this._contentLength=E.length,this._loaded=0,this._filename=null,this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=p.length,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",E=>{this._error(E)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class y{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const E=p.source;this._isStreamingSupported=!E.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=p.length,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",E=>{this._error(E)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(w,p){return{protocol:w.protocol,auth:w.auth,host:w.hostname,port:w.port,path:w.path,method:"GET",headers:p}}class O extends R{constructor(p){super(p);const E=P=>{if(P.statusCode===404){const d=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=d,this._headersCapability.reject(d);return}this._headersCapability.resolve(),this._setReadableStream(P);const C=d=>this._readableStream.headers[d.toLowerCase()],{allowRangeRequests:v,suggestedLength:l}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:C,isHttp:p.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=l||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(C)};if(this._request=null,this._url.protocol==="http:"){const P=require$$5;this._request=P.request(m(this._url,p.httpHeaders),E)}else{const P=require$$5;this._request=P.request(m(this._url,p.httpHeaders),E)}this._request.on("error",P=>{this._storedError=P,this._headersCapability.reject(P)}),this._request.end()}}class j extends y{constructor(p,E,P){super(p),this._httpHeaders={};for(const v in p.httpHeaders){const l=p.httpHeaders[v];l!==void 0&&(this._httpHeaders[v]=l)}this._httpHeaders.Range=`bytes=${E}-${P-1}`;const C=v=>{if(v.statusCode===404){const l=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(v)};if(this._request=null,this._url.protocol==="http:"){const v=require$$5;this._request=v.request(m(this._url,this._httpHeaders),C)}else{const v=require$$5;this._request=v.request(m(this._url,this._httpHeaders),C)}this._request.on("error",v=>{this._storedError=v}),this._request.end()}}class k extends R{constructor(p){super(p);let E=decodeURIComponent(this._url.path);$.test(this._url.href)&&(E=E.replace(/^\//,""));const P=require$$5;P.lstat(E,(C,v)=>{if(C){C.code==="ENOENT"&&(C=new n.MissingPDFException(`Missing PDF "${E}".`)),this._storedError=C,this._headersCapability.reject(C);return}this._contentLength=v.size,this._setReadableStream(P.createReadStream(E)),this._headersCapability.resolve()})}}class _ extends y{constructor(p,E,P){super(p);let C=decodeURIComponent(this._url.path);$.test(this._url.href)&&(C=C.replace(/^\//,""));const v=require$$5;this._setReadableStream(v.createReadStream(C,{start:E,end:P-1}))}}},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=D(6),u=D(1);const $={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},L="http://www.w3.org/XML/1998/namespace",rt="http://www.w3.org/1999/xlink",R=["butt","round","square"],y=["miter","round","bevel"],m=function(v,l="",d=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!d)return URL.createObjectURL(new Blob([v],{type:l}));const I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let A=`data:${l};base64,`;for(let c=0,F=v.length;c<F;c+=3){const b=v[c]&255,G=v[c+1]&255,z=v[c+2]&255,S=b>>2,X=(b&3)<<4|G>>4,at=c+1<F?(G&15)<<2|z>>6:64,ct=c+2<F?z&63:64;A+=I[S]+I[X]+I[at]+I[ct]}return A},O=function(){const v=new Uint8Array([137,80,78,71,13,10,26,10]),l=12,d=new Int32Array(256);for(let z=0;z<256;z++){let S=z;for(let X=0;X<8;X++)S=S&1?3988292384^S>>1&2147483647:S>>1&2147483647;d[z]=S}function I(z,S,X){let at=-1;for(let ct=S;ct<X;ct++){const V=(at^z[ct])&255,dt=d[V];at=at>>>8^dt}return at^-1}function A(z,S,X,at){let ct=at;const V=S.length;X[ct]=V>>24&255,X[ct+1]=V>>16&255,X[ct+2]=V>>8&255,X[ct+3]=V&255,ct+=4,X[ct]=z.charCodeAt(0)&255,X[ct+1]=z.charCodeAt(1)&255,X[ct+2]=z.charCodeAt(2)&255,X[ct+3]=z.charCodeAt(3)&255,ct+=4,X.set(S,ct),ct+=S.length;const dt=I(X,at+4,ct);X[ct]=dt>>24&255,X[ct+1]=dt>>16&255,X[ct+2]=dt>>8&255,X[ct+3]=dt&255}function c(z,S,X){let at=1,ct=0;for(let V=S;V<X;++V)at=(at+(z[V]&255))%65521,ct=(ct+at)%65521;return ct<<16|at}function F(z){if(!u.isNodeJS)return b(z);try{const S=parseInt(process.versions.node)>=8?z:Buffer.from(z),X=require$$5.deflateSync(S,{level:9});return X instanceof Uint8Array?X:new Uint8Array(X)}catch(S){(0,u.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+S)}return b(z)}function b(z){let S=z.length;const X=65535,at=Math.ceil(S/X),ct=new Uint8Array(2+S+at*5+4);let V=0;ct[V++]=120,ct[V++]=156;let dt=0;for(;S>X;)ct[V++]=0,ct[V++]=255,ct[V++]=255,ct[V++]=0,ct[V++]=0,ct.set(z.subarray(dt,dt+X),V),V+=X,dt+=X,S-=X;ct[V++]=1,ct[V++]=S&255,ct[V++]=S>>8&255,ct[V++]=~S&65535&255,ct[V++]=(~S&65535)>>8&255,ct.set(z.subarray(dt),V),V+=z.length-dt;const mt=c(z,0,z.length);return ct[V++]=mt>>24&255,ct[V++]=mt>>16&255,ct[V++]=mt>>8&255,ct[V++]=mt&255,ct}function G(z,S,X,at){const ct=z.width,V=z.height;let dt,mt,Et;const wt=z.data;switch(S){case u.ImageKind.GRAYSCALE_1BPP:mt=0,dt=1,Et=ct+7>>3;break;case u.ImageKind.RGB_24BPP:mt=2,dt=8,Et=ct*3;break;case u.ImageKind.RGBA_32BPP:mt=6,dt=8,Et=ct*4;break;default:throw new Error("invalid format")}const M=new Uint8Array((1+Et)*V);let i=0,o=0;for(let W=0;W<V;++W)M[i++]=0,M.set(wt.subarray(o,o+Et),i),o+=Et,i+=Et;if(S===u.ImageKind.GRAYSCALE_1BPP&&at){i=0;for(let W=0;W<V;W++){i++;for(let it=0;it<Et;it++)M[i++]^=255}}const a=new Uint8Array([ct>>24&255,ct>>16&255,ct>>8&255,ct&255,V>>24&255,V>>16&255,V>>8&255,V&255,dt,mt,0,0,0]),h=F(M),f=v.length+l*3+a.length+h.length,T=new Uint8Array(f);let N=0;return T.set(v,N),N+=v.length,A("IHDR",a,T,N),N+=l+a.length,A("IDATA",h,T,N),N+=l+h.length,A("IEND",new Uint8Array(0),T,N),m(T,"image/png",X)}return function(S,X,at){const ct=S.kind===void 0?u.ImageKind.GRAYSCALE_1BPP:S.kind;return G(S,ct,X,at)}}();class j{constructor(){this.fontSizeScale=1,this.fontWeight=$.fontWeight,this.fontSize=0,this.textMatrix=u.IDENTITY_MATRIX,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=u.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=$.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,d){this.x=l,this.y=d}}function k(v){let l=[];const d=[];for(const I of v){if(I.fn==="save"){l.push({fnId:92,fn:"group",items:[]}),d.push(l),l=l.at(-1).items;continue}I.fn==="restore"?l=d.pop():l.push(I)}return l}function _(v){if(Number.isInteger(v))return v.toString();const l=v.toFixed(10);let d=l.length-1;if(l[d]!=="0")return l;do d--;while(l[d]==="0");return l.substring(0,l[d]==="."?d:d+1)}function w(v){if(v[4]===0&&v[5]===0){if(v[1]===0&&v[2]===0)return v[0]===1&&v[3]===1?"":`scale(${_(v[0])} ${_(v[3])})`;if(v[0]===v[3]&&v[1]===-v[2]){const l=Math.acos(v[0])*180/Math.PI;return`rotate(${_(l)})`}}else if(v[0]===1&&v[1]===0&&v[2]===0&&v[3]===1)return`translate(${_(v[4])} ${_(v[5])})`;return`matrix(${_(v[0])} ${_(v[1])} ${_(v[2])} ${_(v[3])} ${_(v[4])} ${_(v[5])})`}let p=0,E=0,P=0;class C{constructor(l,d,I=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new j,this.transformMatrix=u.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=l,this.objs=d,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!I,this._operatorIdMapping=[];for(const A in u.OPS)this._operatorIdMapping[u.OPS[A]]=A}getObject(l,d=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):d}save(){this.transformStack.push(this.transformMatrix);const l=this.current;this.extraStack.push(l),this.current=l.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(l){this.save(),this.executeOpTree(l),this.restore()}loadDependencies(l){const d=l.fnArray,I=l.argsArray;for(let A=0,c=d.length;A<c;A++)if(d[A]===u.OPS.dependency)for(const F of I[A]){const b=F.startsWith("g_")?this.commonObjs:this.objs,G=new Promise(z=>{b.get(F,z)});this.current.dependencies.push(G)}return Promise.all(this.current.dependencies)}transform(l,d,I,A,c,F){const b=[l,d,I,A,c,F];this.transformMatrix=u.Util.transform(this.transformMatrix,b),this.tgrp=null}getSVG(l,d){this.viewport=d;const I=this._initialize(d);return this.loadDependencies(l).then(()=>(this.transformMatrix=u.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(l)),I))}convertOpList(l){const d=this._operatorIdMapping,I=l.argsArray,A=l.fnArray,c=[];for(let F=0,b=A.length;F<b;F++){const G=A[F];c.push({fnId:G,fn:d[G],args:I[F]})}return k(c)}executeOpTree(l){for(const d of l){const I=d.fn,A=d.fnId,c=d.args;switch(A|0){case u.OPS.beginText:this.beginText();break;case u.OPS.dependency:break;case u.OPS.setLeading:this.setLeading(c);break;case u.OPS.setLeadingMoveText:this.setLeadingMoveText(c[0],c[1]);break;case u.OPS.setFont:this.setFont(c);break;case u.OPS.showText:this.showText(c[0]);break;case u.OPS.showSpacedText:this.showText(c[0]);break;case u.OPS.endText:this.endText();break;case u.OPS.moveText:this.moveText(c[0],c[1]);break;case u.OPS.setCharSpacing:this.setCharSpacing(c[0]);break;case u.OPS.setWordSpacing:this.setWordSpacing(c[0]);break;case u.OPS.setHScale:this.setHScale(c[0]);break;case u.OPS.setTextMatrix:this.setTextMatrix(c[0],c[1],c[2],c[3],c[4],c[5]);break;case u.OPS.setTextRise:this.setTextRise(c[0]);break;case u.OPS.setTextRenderingMode:this.setTextRenderingMode(c[0]);break;case u.OPS.setLineWidth:this.setLineWidth(c[0]);break;case u.OPS.setLineJoin:this.setLineJoin(c[0]);break;case u.OPS.setLineCap:this.setLineCap(c[0]);break;case u.OPS.setMiterLimit:this.setMiterLimit(c[0]);break;case u.OPS.setFillRGBColor:this.setFillRGBColor(c[0],c[1],c[2]);break;case u.OPS.setStrokeRGBColor:this.setStrokeRGBColor(c[0],c[1],c[2]);break;case u.OPS.setStrokeColorN:this.setStrokeColorN(c);break;case u.OPS.setFillColorN:this.setFillColorN(c);break;case u.OPS.shadingFill:this.shadingFill(c[0]);break;case u.OPS.setDash:this.setDash(c[0],c[1]);break;case u.OPS.setRenderingIntent:this.setRenderingIntent(c[0]);break;case u.OPS.setFlatness:this.setFlatness(c[0]);break;case u.OPS.setGState:this.setGState(c[0]);break;case u.OPS.fill:this.fill();break;case u.OPS.eoFill:this.eoFill();break;case u.OPS.stroke:this.stroke();break;case u.OPS.fillStroke:this.fillStroke();break;case u.OPS.eoFillStroke:this.eoFillStroke();break;case u.OPS.clip:this.clip("nonzero");break;case u.OPS.eoClip:this.clip("evenodd");break;case u.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case u.OPS.paintImageXObject:this.paintImageXObject(c[0]);break;case u.OPS.paintInlineImageXObject:this.paintInlineImageXObject(c[0]);break;case u.OPS.paintImageMaskXObject:this.paintImageMaskXObject(c[0]);break;case u.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(c[0],c[1]);break;case u.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case u.OPS.closePath:this.closePath();break;case u.OPS.closeStroke:this.closeStroke();break;case u.OPS.closeFillStroke:this.closeFillStroke();break;case u.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case u.OPS.nextLine:this.nextLine();break;case u.OPS.transform:this.transform(c[0],c[1],c[2],c[3],c[4],c[5]);break;case u.OPS.constructPath:this.constructPath(c[0],c[1]);break;case u.OPS.endPath:this.endPath();break;case 92:this.group(d.items);break;default:(0,u.warn)(`Unimplemented operator ${I}`);break}}}setWordSpacing(l){this.current.wordSpacing=l}setCharSpacing(l){this.current.charSpacing=l}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(l,d,I,A,c,F){const b=this.current;b.textMatrix=b.lineMatrix=[l,d,I,A,c,F],b.textMatrixScale=Math.hypot(l,d),b.x=b.lineX=0,b.y=b.lineY=0,b.xcoords=[],b.ycoords=[],b.tspan=this.svgFactory.createElement("svg:tspan"),b.tspan.setAttributeNS(null,"font-family",b.fontFamily),b.tspan.setAttributeNS(null,"font-size",`${_(b.fontSize)}px`),b.tspan.setAttributeNS(null,"y",_(-b.y)),b.txtElement=this.svgFactory.createElement("svg:text"),b.txtElement.append(b.tspan)}beginText(){const l=this.current;l.x=l.lineX=0,l.y=l.lineY=0,l.textMatrix=u.IDENTITY_MATRIX,l.lineMatrix=u.IDENTITY_MATRIX,l.textMatrixScale=1,l.tspan=this.svgFactory.createElement("svg:tspan"),l.txtElement=this.svgFactory.createElement("svg:text"),l.txtgrp=this.svgFactory.createElement("svg:g"),l.xcoords=[],l.ycoords=[]}moveText(l,d){const I=this.current;I.x=I.lineX+=l,I.y=I.lineY+=d,I.xcoords=[],I.ycoords=[],I.tspan=this.svgFactory.createElement("svg:tspan"),I.tspan.setAttributeNS(null,"font-family",I.fontFamily),I.tspan.setAttributeNS(null,"font-size",`${_(I.fontSize)}px`),I.tspan.setAttributeNS(null,"y",_(-I.y))}showText(l){const d=this.current,I=d.font,A=d.fontSize;if(A===0)return;const c=d.fontSizeScale,F=d.charSpacing,b=d.wordSpacing,G=d.fontDirection,z=d.textHScale*G,S=I.vertical,X=S?1:-1,at=I.defaultVMetrics,ct=A*d.fontMatrix[0];let V=0;for(const Et of l){if(Et===null){V+=G*b;continue}else if(typeof Et=="number"){V+=X*Et*A/1e3;continue}const wt=(Et.isSpace?b:0)+F,M=Et.fontChar;let i,o,a=Et.width;if(S){let f;const T=Et.vmetric||at;f=Et.vmetric?T[1]:a*.5,f=-f*ct;const N=T[2]*ct;a=T?-T[0]:a,i=f/c,o=(V+N)/c}else i=V/c,o=0;(Et.isInFont||I.missingFile)&&(d.xcoords.push(d.x+i),S&&d.ycoords.push(-d.y+o),d.tspan.textContent+=M);const h=S?a*ct-wt*G:a*ct+wt*G;V+=h}d.tspan.setAttributeNS(null,"x",d.xcoords.map(_).join(" ")),S?d.tspan.setAttributeNS(null,"y",d.ycoords.map(_).join(" ")):d.tspan.setAttributeNS(null,"y",_(-d.y)),S?d.y-=V:d.x+=V*z,d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${_(d.fontSize)}px`),d.fontStyle!==$.fontStyle&&d.tspan.setAttributeNS(null,"font-style",d.fontStyle),d.fontWeight!==$.fontWeight&&d.tspan.setAttributeNS(null,"font-weight",d.fontWeight);const dt=d.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;if(dt===u.TextRenderingMode.FILL||dt===u.TextRenderingMode.FILL_STROKE?(d.fillColor!==$.fillColor&&d.tspan.setAttributeNS(null,"fill",d.fillColor),d.fillAlpha<1&&d.tspan.setAttributeNS(null,"fill-opacity",d.fillAlpha)):d.textRenderingMode===u.TextRenderingMode.ADD_TO_PATH?d.tspan.setAttributeNS(null,"fill","transparent"):d.tspan.setAttributeNS(null,"fill","none"),dt===u.TextRenderingMode.STROKE||dt===u.TextRenderingMode.FILL_STROKE){const Et=1/(d.textMatrixScale||1);this._setStrokeAttributes(d.tspan,Et)}let mt=d.textMatrix;d.textRise!==0&&(mt=mt.slice(),mt[5]+=d.textRise),d.txtElement.setAttributeNS(null,"transform",`${w(mt)} scale(${_(z)}, -1)`),d.txtElement.setAttributeNS(L,"xml:space","preserve"),d.txtElement.append(d.tspan),d.txtgrp.append(d.txtElement),this._ensureTransformGroup().append(d.txtElement)}setLeadingMoveText(l,d){this.setLeading(-d),this.moveText(l,d)}addFontStyle(l){if(!l.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const d=m(l.data,l.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${l.loadedName}"; src: url(${d}); }
`}setFont(l){const d=this.current,I=this.commonObjs.get(l[0]);let A=l[1];d.font=I,this.embedFonts&&!I.missingFile&&!this.embeddedFonts[I.loadedName]&&(this.addFontStyle(I),this.embeddedFonts[I.loadedName]=I),d.fontMatrix=I.fontMatrix||u.FONT_IDENTITY_MATRIX;let c="normal";I.black?c="900":I.bold&&(c="bold");const F=I.italic?"italic":"normal";A<0?(A=-A,d.fontDirection=-1):d.fontDirection=1,d.fontSize=A,d.fontFamily=I.loadedName,d.fontWeight=c,d.fontStyle=F,d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"y",_(-d.y)),d.xcoords=[],d.ycoords=[]}endText(){var d;const l=this.current;l.textRenderingMode&u.TextRenderingMode.ADD_TO_PATH_FLAG&&((d=l.txtElement)!=null&&d.hasChildNodes())&&(l.element=l.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(l){l>0&&(this.current.lineWidth=l)}setLineCap(l){this.current.lineCap=R[l]}setLineJoin(l){this.current.lineJoin=y[l]}setMiterLimit(l){this.current.miterLimit=l}setStrokeAlpha(l){this.current.strokeAlpha=l}setStrokeRGBColor(l,d,I){this.current.strokeColor=u.Util.makeHexColor(l,d,I)}setFillAlpha(l){this.current.fillAlpha=l}setFillRGBColor(l,d,I){this.current.fillColor=u.Util.makeHexColor(l,d,I),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(l){this.current.strokeColor=this._makeColorN_Pattern(l)}setFillColorN(l){this.current.fillColor=this._makeColorN_Pattern(l)}shadingFill(l){const{width:d,height:I}=this.viewport,A=u.Util.inverseTransform(this.transformMatrix),[c,F,b,G]=u.Util.getAxialAlignedBoundingBox([0,0,d,I],A),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x",c),z.setAttributeNS(null,"y",F),z.setAttributeNS(null,"width",b-c),z.setAttributeNS(null,"height",G-F),z.setAttributeNS(null,"fill",this._makeShadingPattern(l)),this.current.fillAlpha<1&&z.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(z)}_makeColorN_Pattern(l){return l[0]==="TilingPattern"?this._makeTilingPattern(l):this._makeShadingPattern(l)}_makeTilingPattern(l){const d=l[1],I=l[2],A=l[3]||u.IDENTITY_MATRIX,[c,F,b,G]=l[4],z=l[5],S=l[6],X=l[7],at=`shading${P++}`,[ct,V,dt,mt]=u.Util.normalizeRect([...u.Util.applyTransform([c,F],A),...u.Util.applyTransform([b,G],A)]),[Et,wt]=u.Util.singularValueDecompose2dScale(A),M=z*Et,i=S*wt,o=this.svgFactory.createElement("svg:pattern");o.setAttributeNS(null,"id",at),o.setAttributeNS(null,"patternUnits","userSpaceOnUse"),o.setAttributeNS(null,"width",M),o.setAttributeNS(null,"height",i),o.setAttributeNS(null,"x",`${ct}`),o.setAttributeNS(null,"y",`${V}`);const a=this.svg,h=this.transformMatrix,f=this.current.fillColor,T=this.current.strokeColor,N=this.svgFactory.create(dt-ct,mt-V);if(this.svg=N,this.transformMatrix=A,X===2){const W=u.Util.makeHexColor(...d);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(I)),this.svg=a,this.transformMatrix=h,this.current.fillColor=f,this.current.strokeColor=T,o.append(N.childNodes[0]),this.defs.append(o),`url(#${at})`}_makeShadingPattern(l){switch(typeof l=="string"&&(l=this.objs.get(l)),l[0]){case"RadialAxial":const d=`shading${P++}`,I=l[3];let A;switch(l[1]){case"axial":const c=l[4],F=l[5];A=this.svgFactory.createElement("svg:linearGradient"),A.setAttributeNS(null,"id",d),A.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),A.setAttributeNS(null,"x1",c[0]),A.setAttributeNS(null,"y1",c[1]),A.setAttributeNS(null,"x2",F[0]),A.setAttributeNS(null,"y2",F[1]);break;case"radial":const b=l[4],G=l[5],z=l[6],S=l[7];A=this.svgFactory.createElement("svg:radialGradient"),A.setAttributeNS(null,"id",d),A.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),A.setAttributeNS(null,"cx",G[0]),A.setAttributeNS(null,"cy",G[1]),A.setAttributeNS(null,"r",S),A.setAttributeNS(null,"fx",b[0]),A.setAttributeNS(null,"fy",b[1]),A.setAttributeNS(null,"fr",z);break;default:throw new Error(`Unknown RadialAxial type: ${l[1]}`)}for(const c of I){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",c[0]),F.setAttributeNS(null,"stop-color",c[1]),A.append(F)}return this.defs.append(A),`url(#${d})`;case"Mesh":return(0,u.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${l[0]}`)}}setDash(l,d){this.current.dashArray=l,this.current.dashPhase=d}constructPath(l,d){const I=this.current;let A=I.x,c=I.y,F=[],b=0;for(const G of l)switch(G|0){case u.OPS.rectangle:A=d[b++],c=d[b++];const z=d[b++],S=d[b++],X=A+z,at=c+S;F.push("M",_(A),_(c),"L",_(X),_(c),"L",_(X),_(at),"L",_(A),_(at),"Z");break;case u.OPS.moveTo:A=d[b++],c=d[b++],F.push("M",_(A),_(c));break;case u.OPS.lineTo:A=d[b++],c=d[b++],F.push("L",_(A),_(c));break;case u.OPS.curveTo:A=d[b+4],c=d[b+5],F.push("C",_(d[b]),_(d[b+1]),_(d[b+2]),_(d[b+3]),_(A),_(c)),b+=6;break;case u.OPS.curveTo2:F.push("C",_(A),_(c),_(d[b]),_(d[b+1]),_(d[b+2]),_(d[b+3])),A=d[b+2],c=d[b+3],b+=4;break;case u.OPS.curveTo3:A=d[b+2],c=d[b+3],F.push("C",_(d[b]),_(d[b+1]),_(A),_(c),_(A),_(c)),b+=4;break;case u.OPS.closePath:F.push("Z");break}F=F.join(" "),I.path&&l.length>0&&l[0]!==u.OPS.rectangle&&l[0]!==u.OPS.moveTo?F=I.path.getAttributeNS(null,"d")+F:(I.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(I.path)),I.path.setAttributeNS(null,"d",F),I.path.setAttributeNS(null,"fill","none"),I.element=I.path,I.setCurrentPoint(A,c)}endPath(){const l=this.current;if(l.path=null,!this.pendingClip)return;if(!l.element){this.pendingClip=null;return}const d=`clippath${p++}`,I=this.svgFactory.createElement("svg:clipPath");I.setAttributeNS(null,"id",d),I.setAttributeNS(null,"transform",w(this.transformMatrix));const A=l.element.cloneNode(!0);if(this.pendingClip==="evenodd"?A.setAttributeNS(null,"clip-rule","evenodd"):A.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,I.append(A),this.defs.append(I),l.activeClipUrl){l.clipGroup=null;for(const c of this.extraStack)c.clipGroup=null;I.setAttributeNS(null,"clip-path",l.activeClipUrl)}l.activeClipUrl=`url(#${d})`,this.tgrp=null}clip(l){this.pendingClip=l}closePath(){const l=this.current;if(l.path){const d=`${l.path.getAttributeNS(null,"d")}Z`;l.path.setAttributeNS(null,"d",d)}}setLeading(l){this.current.leading=-l}setTextRise(l){this.current.textRise=l}setTextRenderingMode(l){this.current.textRenderingMode=l}setHScale(l){this.current.textHScale=l/100}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[d,I]of l)switch(d){case"LW":this.setLineWidth(I);break;case"LC":this.setLineCap(I);break;case"LJ":this.setLineJoin(I);break;case"ML":this.setMiterLimit(I);break;case"D":this.setDash(I[0],I[1]);break;case"RI":this.setRenderingIntent(I);break;case"FL":this.setFlatness(I);break;case"Font":this.setFont(I);break;case"CA":this.setStrokeAlpha(I);break;case"ca":this.setFillAlpha(I);break;default:(0,u.warn)(`Unimplemented graphic state operator ${d}`);break}}fill(){const l=this.current;l.element&&(l.element.setAttributeNS(null,"fill",l.fillColor),l.element.setAttributeNS(null,"fill-opacity",l.fillAlpha),this.endPath())}stroke(){const l=this.current;l.element&&(this._setStrokeAttributes(l.element),l.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(l,d=1){const I=this.current;let A=I.dashArray;d!==1&&A.length>0&&(A=A.map(function(c){return d*c})),l.setAttributeNS(null,"stroke",I.strokeColor),l.setAttributeNS(null,"stroke-opacity",I.strokeAlpha),l.setAttributeNS(null,"stroke-miterlimit",_(I.miterLimit)),l.setAttributeNS(null,"stroke-linecap",I.lineCap),l.setAttributeNS(null,"stroke-linejoin",I.lineJoin),l.setAttributeNS(null,"stroke-width",_(d*I.lineWidth)+"px"),l.setAttributeNS(null,"stroke-dasharray",A.map(_).join(" ")),l.setAttributeNS(null,"stroke-dashoffset",_(d*I.dashPhase)+"px")}eoFill(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width","1px"),l.setAttributeNS(null,"height","1px"),l.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(l)}paintImageXObject(l){const d=this.getObject(l);if(!d){(0,u.warn)(`Dependent image with object ID ${l} is not ready yet`);return}this.paintInlineImageXObject(d)}paintInlineImageXObject(l,d){const I=l.width,A=l.height,c=O(l,this.forceDataSchema,!!d),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",_(I)),F.setAttributeNS(null,"height",_(A)),this.current.element=F,this.clip("nonzero");const b=this.svgFactory.createElement("svg:image");b.setAttributeNS(rt,"xlink:href",c),b.setAttributeNS(null,"x","0"),b.setAttributeNS(null,"y",_(-A)),b.setAttributeNS(null,"width",_(I)+"px"),b.setAttributeNS(null,"height",_(A)+"px"),b.setAttributeNS(null,"transform",`scale(${_(1/I)} ${_(-1/A)})`),d?d.append(b):this._ensureTransformGroup().append(b)}paintImageMaskXObject(l){const d=this.getObject(l.data,l);if(d.bitmap){(0,u.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const I=this.current,A=d.width,c=d.height,F=I.fillColor;I.maskId=`mask${E++}`;const b=this.svgFactory.createElement("svg:mask");b.setAttributeNS(null,"id",I.maskId);const G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",_(A)),G.setAttributeNS(null,"height",_(c)),G.setAttributeNS(null,"fill",F),G.setAttributeNS(null,"mask",`url(#${I.maskId})`),this.defs.append(b),this._ensureTransformGroup().append(G),this.paintInlineImageXObject(d,b)}paintFormXObjectBegin(l,d){if(Array.isArray(l)&&l.length===6&&this.transform(l[0],l[1],l[2],l[3],l[4],l[5]),d){const I=d[2]-d[0],A=d[3]-d[1],c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",d[0]),c.setAttributeNS(null,"y",d[1]),c.setAttributeNS(null,"width",_(I)),c.setAttributeNS(null,"height",_(A)),this.current.element=c,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(l){const d=this.svgFactory.create(l.width,l.height),I=this.svgFactory.createElement("svg:defs");d.append(I),this.defs=I;const A=this.svgFactory.createElement("svg:g");return A.setAttributeNS(null,"transform",w(l.transform)),d.append(A),this.svg=A,d}_ensureClipGroup(){if(!this.current.clipGroup){const l=this.svgFactory.createElement("svg:g");l.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(l),this.current.clipGroup=l}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",w(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=C},(g,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class D{static textContent(u){const $=[],L={items:$,styles:Object.create(null)};function rt(R){var O;if(!R)return;let y=null;const m=R.name;if(m==="#text")y=R.value;else if(D.shouldBuildText(m))(O=R==null?void 0:R.attributes)!=null&&O.textContent?y=R.attributes.textContent:R.value&&(y=R.value);else return;if(y!==null&&$.push({str:y}),!!R.children)for(const j of R.children)rt(j)}return rt(u),L}static shouldBuildText(u){return!(u==="textarea"||u==="input"||u==="option"||u==="select")}}e.XfaText=D},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=w,e.updateTextLayer=p;var n=D(1),u=D(6);const $=1e5,L=30,rt=.8,R=new Map;function y(E,P){let C;if(P&&n.FeatureTest.isOffscreenCanvasSupported)C=new OffscreenCanvas(E,E).getContext("2d",{alpha:!1});else{const v=document.createElement("canvas");v.width=v.height=E,C=v.getContext("2d",{alpha:!1})}return C}function m(E,P){const C=R.get(E);if(C)return C;const v=y(L,P);v.font=`${L}px ${E}`;const l=v.measureText("");let d=l.fontBoundingBoxAscent,I=Math.abs(l.fontBoundingBoxDescent);if(d){const c=d/(d+I);return R.set(E,c),v.canvas.width=v.canvas.height=0,c}v.strokeStyle="red",v.clearRect(0,0,L,L),v.strokeText("g",0,0);let A=v.getImageData(0,0,L,L).data;I=0;for(let c=A.length-1-3;c>=0;c-=4)if(A[c]>0){I=Math.ceil(c/4/L);break}v.clearRect(0,0,L,L),v.strokeText("A",0,L),A=v.getImageData(0,0,L,L).data,d=0;for(let c=0,F=A.length;c<F;c+=4)if(A[c]>0){d=L-Math.floor(c/4/L);break}if(v.canvas.width=v.canvas.height=0,d){const c=d/(d+I);return R.set(E,c),c}return R.set(E,rt),rt}function O(E,P,C){const v=document.createElement("span"),l={angle:0,canvasWidth:0,hasText:P.str!=="",hasEOL:P.hasEOL,fontSize:0};E._textDivs.push(v);const d=n.Util.transform(E._transform,P.transform);let I=Math.atan2(d[1],d[0]);const A=C[P.fontName];A.vertical&&(I+=Math.PI/2);const c=Math.hypot(d[2],d[3]),F=c*m(A.fontFamily,E._isOffscreenCanvasSupported);let b,G;I===0?(b=d[4],G=d[5]-F):(b=d[4]+F*Math.sin(I),G=d[5]-F*Math.cos(I));const z="calc(var(--scale-factor)*",S=v.style;E._container===E._rootContainer?(S.left=`${(100*b/E._pageWidth).toFixed(2)}%`,S.top=`${(100*G/E._pageHeight).toFixed(2)}%`):(S.left=`${z}${b.toFixed(2)}px)`,S.top=`${z}${G.toFixed(2)}px)`),S.fontSize=`${z}${c.toFixed(2)}px)`,S.fontFamily=A.fontFamily,l.fontSize=c,v.setAttribute("role","presentation"),v.textContent=P.str,v.dir=P.dir,E._fontInspectorEnabled&&(v.dataset.fontName=P.fontName),I!==0&&(l.angle=I*(180/Math.PI));let X=!1;if(P.str.length>1)X=!0;else if(P.str!==" "&&P.transform[0]!==P.transform[3]){const at=Math.abs(P.transform[0]),ct=Math.abs(P.transform[3]);at!==ct&&Math.max(at,ct)/Math.min(at,ct)>1.5&&(X=!0)}X&&(l.canvasWidth=A.vertical?P.height:P.width),E._textDivProperties.set(v,l),E._isReadableStream&&E._layoutText(v)}function j(E){const{div:P,scale:C,properties:v,ctx:l,prevFontSize:d,prevFontFamily:I}=E,{style:A}=P;let c="";if(v.canvasWidth!==0&&v.hasText){const{fontFamily:F}=A,{canvasWidth:b,fontSize:G}=v;(d!==G||I!==F)&&(l.font=`${G*C}px ${F}`,E.prevFontSize=G,E.prevFontFamily=F);const{width:z}=l.measureText(P.textContent);z>0&&(c=`scaleX(${b*C/z})`)}v.angle!==0&&(c=`rotate(${v.angle}deg) ${c}`),c.length>0&&(A.transform=c)}function k(E){if(E._canceled)return;const P=E._textDivs,C=E._capability;if(P.length>$){C.resolve();return}if(!E._isReadableStream)for(const l of P)E._layoutText(l);C.resolve()}class _{constructor({textContentSource:P,container:C,viewport:v,textDivs:l,textDivProperties:d,textContentItemsStr:I,isOffscreenCanvasSupported:A}){var z;this._textContentSource=P,this._isReadableStream=P instanceof ReadableStream,this._container=this._rootContainer=C,this._textDivs=l||[],this._textContentItemsStr=I||[],this._isOffscreenCanvasSupported=A,this._fontInspectorEnabled=!!((z=globalThis.FontInspector)!=null&&z.enabled),this._reader=null,this._textDivProperties=d||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:y(0,A)};const{pageWidth:c,pageHeight:F,pageX:b,pageY:G}=v.rawDims;this._transform=[1,0,0,-1,-b,G+F],this._pageWidth=c,this._pageHeight=F,(0,u.setLayerDimensions)(C,v),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(P,C){for(const v of P){if(v.str===void 0){if(v.type==="beginMarkedContentProps"||v.type==="beginMarkedContent"){const l=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),v.id!==null&&this._container.setAttribute("id",`${v.id}`),l.append(this._container)}else v.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(v.str),O(this,v,C)}}_layoutText(P){const C=this._layoutTextParams.properties=this._textDivProperties.get(P);if(this._layoutTextParams.div=P,j(this._layoutTextParams),C.hasText&&this._container.append(P),C.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(){const P=new n.PromiseCapability;let C=Object.create(null);if(this._isReadableStream){const v=()=>{this._reader.read().then(({value:l,done:d})=>{if(d){P.resolve();return}Object.assign(C,l.styles),this._processItems(l.items,C),v()},P.reject)};this._reader=this._textContentSource.getReader(),v()}else if(this._textContentSource){const{items:v,styles:l}=this._textContentSource;this._processItems(v,l),P.resolve()}else throw new Error('No "textContentSource" parameter specified.');P.promise.then(()=>{C=null,k(this)},this._capability.reject)}}e.TextLayerRenderTask=_;function w(E){!E.textContentSource&&(E.textContent||E.textContentStream)&&((0,u.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),E.textContentSource=E.textContent||E.textContentStream);const{container:P,viewport:C}=E,v=getComputedStyle(P),l=v.getPropertyValue("visibility"),d=parseFloat(v.getPropertyValue("--scale-factor"));l==="visible"&&(!d||Math.abs(d-C.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const I=new _(E);return I._render(),I}function p({container:E,viewport:P,textDivs:C,textDivProperties:v,isOffscreenCanvasSupported:l,mustRotate:d=!0,mustRescale:I=!0}){if(d&&(0,u.setLayerDimensions)(E,{rotation:P.rotation}),I){const A=y(0,l),F={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:A};for(const b of C)F.properties=v.get(b),F.div=b,j(F)}}},(g,e,D)=>{var m,O,j,k,_,w,p,E,P,C,v,nn,d,ke,A,sn,F,rn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=D(1),u=D(4),$=D(28),L=D(33),rt=D(6),R=D(34);const G=class G{constructor({uiManager:S,pageIndex:X,div:at,accessibilityManager:ct,annotationLayer:V,viewport:dt,l10n:mt}){H(this,v);H(this,d);H(this,A);H(this,F);H(this,m,void 0);H(this,O,!1);H(this,j,null);H(this,k,this.pointerup.bind(this));H(this,_,this.pointerdown.bind(this));H(this,w,new Map);H(this,p,!1);H(this,E,!1);H(this,P,!1);H(this,C,void 0);const Et=[$.FreeTextEditor,L.InkEditor,R.StampEditor];if(!G._initialized){G._initialized=!0;for(const wt of Et)wt.initialize(mt)}S.registerEditorTypes(Et),ot(this,C,S),this.pageIndex=X,this.div=at,ot(this,m,ct),ot(this,j,V),this.viewport=dt,t(this,C).addLayer(this)}get isEmpty(){return t(this,w).size===0}updateToolbar(S){t(this,C).updateToolbar(S)}updateMode(S=t(this,C).getMode()){Y(this,F,rn).call(this),S===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),S!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",S===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",S===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",S===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(S){if(!S&&t(this,C).getMode()!==n.AnnotationEditorType.INK)return;if(!S){for(const at of t(this,w).values())if(at.isEmpty()){at.setInBackground();return}}Y(this,d,ke).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(S){t(this,C).setEditingState(S)}addCommands(S){t(this,C).addCommands(S)}enable(){this.div.style.pointerEvents="auto";const S=new Set;for(const at of t(this,w).values())at.enableEditing(),at.annotationElementId&&S.add(at.annotationElementId);if(!t(this,j))return;const X=t(this,j).getEditableAnnotations();for(const at of X){if(at.hide(),t(this,C).isDeletedAnnotationElement(at.data.id)||S.has(at.data.id))continue;const ct=this.deserialize(at);ct&&(this.addOrRebuild(ct),ct.enableEditing())}}disable(){var X;ot(this,P,!0),this.div.style.pointerEvents="none";const S=new Set;for(const at of t(this,w).values()){if(at.disableEditing(),!at.annotationElementId||at.serialize()!==null){S.add(at.annotationElementId);continue}(X=this.getEditableAnnotation(at.annotationElementId))==null||X.show(),at.remove()}if(t(this,j)){const at=t(this,j).getEditableAnnotations();for(const ct of at){const{id:V}=ct.data;S.has(V)||t(this,C).isDeletedAnnotationElement(V)||ct.show()}}Y(this,F,rn).call(this),this.isEmpty&&(this.div.hidden=!0),ot(this,P,!1)}getEditableAnnotation(S){var X;return((X=t(this,j))==null?void 0:X.getEditableAnnotation(S))||null}setActiveEditor(S){t(this,C).getActive()!==S&&t(this,C).setActiveEditor(S)}enableClick(){this.div.addEventListener("pointerdown",t(this,_)),this.div.addEventListener("pointerup",t(this,k))}disableClick(){this.div.removeEventListener("pointerdown",t(this,_)),this.div.removeEventListener("pointerup",t(this,k))}attach(S){t(this,w).set(S.id,S);const{annotationElementId:X}=S;X&&t(this,C).isDeletedAnnotationElement(X)&&t(this,C).removeDeletedAnnotationElement(S)}detach(S){var X;t(this,w).delete(S.id),(X=t(this,m))==null||X.removePointerInTextLayer(S.contentDiv),!t(this,P)&&S.annotationElementId&&t(this,C).addDeletedAnnotationElement(S)}remove(S){this.detach(S),t(this,C).removeEditor(S),S.div.contains(document.activeElement)&&setTimeout(()=>{t(this,C).focusMainContainer()},0),S.div.remove(),S.isAttachedToDOM=!1,t(this,E)||this.addInkEditorIfNeeded(!1)}changeParent(S){var X;S.parent!==this&&(S.annotationElementId&&(t(this,C).addDeletedAnnotationElement(S.annotationElementId),u.AnnotationEditor.deleteAnnotationElement(S),S.annotationElementId=null),this.attach(S),(X=S.parent)==null||X.detach(S),S.setParent(this),S.div&&S.isAttachedToDOM&&(S.div.remove(),this.div.append(S.div)))}add(S){if(this.changeParent(S),t(this,C).addEditor(S),this.attach(S),!S.isAttachedToDOM){const X=S.render();this.div.append(X),S.isAttachedToDOM=!0}S.fixAndSetPosition(),S.onceAdded(),t(this,C).addToAnnotationStorage(S)}moveEditorInDOM(S){var at;if(!S.isAttachedToDOM)return;const{activeElement:X}=document;S.div.contains(X)&&(S._focusEventsAllowed=!1,setTimeout(()=>{S.div.contains(document.activeElement)?S._focusEventsAllowed=!0:(S.div.addEventListener("focusin",()=>{S._focusEventsAllowed=!0},{once:!0}),X.focus())},0)),S._structTreeParentId=(at=t(this,m))==null?void 0:at.moveElementInDOM(this.div,S.div,S.contentDiv,!0)}addOrRebuild(S){S.needsToBeRebuilt()?S.rebuild():this.add(S)}addUndoableEditor(S){const X=()=>S._uiManager.rebuild(S),at=()=>{S.remove()};this.addCommands({cmd:X,undo:at,mustExec:!1})}getNextId(){return t(this,C).getId()}pasteEditor(S,X){t(this,C).updateToolbar(S),t(this,C).updateMode(S);const{offsetX:at,offsetY:ct}=Y(this,A,sn).call(this),V=this.getNextId(),dt=Y(this,v,nn).call(this,{parent:this,id:V,x:at,y:ct,uiManager:t(this,C),isCentered:!0,...X});dt&&this.add(dt)}deserialize(S){switch(S.annotationType??S.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return $.FreeTextEditor.deserialize(S,this,t(this,C));case n.AnnotationEditorType.INK:return L.InkEditor.deserialize(S,this,t(this,C));case n.AnnotationEditorType.STAMP:return R.StampEditor.deserialize(S,this,t(this,C))}return null}addNewEditor(){Y(this,d,ke).call(this,Y(this,A,sn).call(this),!0)}setSelected(S){t(this,C).setSelected(S)}toggleSelected(S){t(this,C).toggleSelected(S)}isSelected(S){return t(this,C).isSelected(S)}unselect(S){t(this,C).unselect(S)}pointerup(S){const{isMac:X}=n.FeatureTest.platform;if(!(S.button!==0||S.ctrlKey&&X)&&S.target===this.div&&t(this,p)){if(ot(this,p,!1),!t(this,O)){ot(this,O,!0);return}if(t(this,C).getMode()===n.AnnotationEditorType.STAMP){t(this,C).unselectAll();return}Y(this,d,ke).call(this,S,!1)}}pointerdown(S){if(t(this,p)){ot(this,p,!1);return}const{isMac:X}=n.FeatureTest.platform;if(S.button!==0||S.ctrlKey&&X||S.target!==this.div)return;ot(this,p,!0);const at=t(this,C).getActive();ot(this,O,!at||at.isEmpty())}findNewParent(S,X,at){const ct=t(this,C).findParent(X,at);return ct===null||ct===this?!1:(ct.changeParent(S),!0)}destroy(){var S,X;((S=t(this,C).getActive())==null?void 0:S.parent)===this&&(t(this,C).commitOrRemove(),t(this,C).setActiveEditor(null));for(const at of t(this,w).values())(X=t(this,m))==null||X.removePointerInTextLayer(at.contentDiv),at.setParent(null),at.isAttachedToDOM=!1,at.div.remove();this.div=null,t(this,w).clear(),t(this,C).removeLayer(this)}render({viewport:S}){this.viewport=S,(0,rt.setLayerDimensions)(this.div,S);for(const X of t(this,C).getEditors(this.pageIndex))this.add(X);this.updateMode()}update({viewport:S}){t(this,C).commitOrRemove(),this.viewport=S,(0,rt.setLayerDimensions)(this.div,{rotation:S.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:S,pageHeight:X}=this.viewport.rawDims;return[S,X]}};m=new WeakMap,O=new WeakMap,j=new WeakMap,k=new WeakMap,_=new WeakMap,w=new WeakMap,p=new WeakMap,E=new WeakMap,P=new WeakMap,C=new WeakMap,v=new WeakSet,nn=function(S){switch(t(this,C).getMode()){case n.AnnotationEditorType.FREETEXT:return new $.FreeTextEditor(S);case n.AnnotationEditorType.INK:return new L.InkEditor(S);case n.AnnotationEditorType.STAMP:return new R.StampEditor(S)}return null},d=new WeakSet,ke=function(S,X){const at=this.getNextId(),ct=Y(this,v,nn).call(this,{parent:this,id:at,x:S.offsetX,y:S.offsetY,uiManager:t(this,C),isCentered:X});return ct&&this.add(ct),ct},A=new WeakSet,sn=function(){const{x:S,y:X,width:at,height:ct}=this.div.getBoundingClientRect(),V=Math.max(0,S),dt=Math.max(0,X),mt=Math.min(window.innerWidth,S+at),Et=Math.min(window.innerHeight,X+ct),wt=(V+mt)/2-S,M=(dt+Et)/2-X,[i,o]=this.viewport.rotation%180===0?[wt,M]:[M,wt];return{offsetX:i,offsetY:o}},F=new WeakSet,rn=function(){ot(this,E,!0);for(const S of t(this,w).values())S.isEmpty()&&S.remove();ot(this,E,!1)},ne(G,"_initialized",!1);let y=G;e.AnnotationEditorLayer=y},(g,e,D)=>{var R,y,m,O,j,k,_,w,p,E,Mn,C,Dn,l,Ln,I,ve,c,an,b,On,z,on;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=D(1),u=D(5),$=D(4),L=D(29);const X=class X extends $.AnnotationEditor{constructor(V){super({...V,name:"freeTextEditor"});H(this,E);H(this,C);H(this,l);H(this,I);H(this,c);H(this,b);H(this,z);H(this,R,this.editorDivBlur.bind(this));H(this,y,this.editorDivFocus.bind(this));H(this,m,this.editorDivInput.bind(this));H(this,O,this.editorDivKeydown.bind(this));H(this,j,void 0);H(this,k,"");H(this,_,`${this.id}-editor`);H(this,w,void 0);H(this,p,null);ot(this,j,V.color||X._defaultColor||$.AnnotationEditor._defaultLineColor),ot(this,w,V.fontSize||X._defaultFontSize)}static get _keyboardManager(){const V=X.prototype,dt=wt=>wt.isEmpty(),mt=u.AnnotationEditorUIManager.TRANSLATE_SMALL,Et=u.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new u.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],V.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],V.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],V._translateEmpty,{args:[-mt,0],checker:dt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],V._translateEmpty,{args:[-Et,0],checker:dt}],[["ArrowRight","mac+ArrowRight"],V._translateEmpty,{args:[mt,0],checker:dt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],V._translateEmpty,{args:[Et,0],checker:dt}],[["ArrowUp","mac+ArrowUp"],V._translateEmpty,{args:[0,-mt],checker:dt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],V._translateEmpty,{args:[0,-Et],checker:dt}],[["ArrowDown","mac+ArrowDown"],V._translateEmpty,{args:[0,mt],checker:dt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],V._translateEmpty,{args:[0,Et],checker:dt}]]))}static initialize(V){$.AnnotationEditor.initialize(V,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const dt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(dt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(V,dt){switch(V){case n.AnnotationEditorParamsType.FREETEXT_SIZE:X._defaultFontSize=dt;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:X._defaultColor=dt;break}}updateParams(V,dt){switch(V){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,E,Mn).call(this,dt);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,C,Dn).call(this,dt);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,X._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,X._defaultColor||$.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,w)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,j)]]}_translateEmpty(V,dt){this._uiManager.translateSelectedEditors(V,dt,!0)}getInitialTranslation(){const V=this.parentScale;return[-X._internalPadding*V,-(X._internalPadding+t(this,w))*V]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,O)),this.editorDiv.addEventListener("focus",t(this,y)),this.editorDiv.addEventListener("blur",t(this,R)),this.editorDiv.addEventListener("input",t(this,m)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,_)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,O)),this.editorDiv.removeEventListener("focus",t(this,y)),this.editorDiv.removeEventListener("blur",t(this,R)),this.editorDiv.removeEventListener("input",t(this,m)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(V){this._focusEventsAllowed&&(super.focusin(V),V.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var V;if(this.width){Y(this,z,on).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(V=this._initialOptions)!=null&&V.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const V=t(this,k),dt=ot(this,k,Y(this,l,Ln).call(this).trimEnd());if(V===dt)return;const mt=Et=>{if(ot(this,k,Et),!Et){this.remove();return}Y(this,c,an).call(this),this._uiManager.rebuild(this),Y(this,I,ve).call(this)};this.addCommands({cmd:()=>{mt(dt)},undo:()=>{mt(V)},mustExec:!1}),Y(this,I,ve).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(V){this.enterInEditMode()}keydown(V){V.target===this.div&&V.key==="Enter"&&(this.enterInEditMode(),V.preventDefault())}editorDivKeydown(V){X._keyboardManager.exec(this,V)}editorDivFocus(V){this.isEditing=!0}editorDivBlur(V){this.isEditing=!1}editorDivInput(V){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let V,dt;this.width&&(V=this.x,dt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,_)),this.enableEditing(),$.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Et=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("aria-label",Et)}),$.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Et=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("default-content",Et)}),this.editorDiv.contentEditable=!0;const{style:mt}=this.editorDiv;if(mt.fontSize=`calc(${t(this,w)}px * var(--scale-factor))`,mt.color=t(this,j),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,u.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Et,wt]=this.parentDimensions;if(this.annotationElementId){const{position:M}=t(this,p);let[i,o]=this.getInitialTranslation();[i,o]=this.pageTranslationToScreen(i,o);const[a,h]=this.pageDimensions,[f,T]=this.pageTranslation;let N,W;switch(this.rotation){case 0:N=V+(M[0]-f)/a,W=dt+this.height-(M[1]-T)/h;break;case 90:N=V+(M[0]-f)/a,W=dt-(M[1]-T)/h,[i,o]=[o,-i];break;case 180:N=V-this.width+(M[0]-f)/a,W=dt-(M[1]-T)/h,[i,o]=[-i,-o];break;case 270:N=V+(M[0]-f-this.height*h)/a,W=dt+(M[1]-T-this.width*a)/h,[i,o]=[-o,i];break}this.setAt(N*Et,W*wt,i,o)}else this.setAt(V*Et,dt*wt,this.width*Et,this.height*wt);Y(this,c,an).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(V,dt,mt){let Et=null;if(V instanceof L.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:M,fontColor:i},rect:o,rotation:a,id:h},textContent:f,textPosition:T,parent:{page:{pageNumber:N}}}=V;if(!f||f.length===0)return null;Et=V={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(i),fontSize:M,value:f.join(`
`),position:T,pageIndex:N-1,rect:o,rotation:a,id:h,deleted:!1}}const wt=super.deserialize(V,dt,mt);return ot(wt,w,V.fontSize),ot(wt,j,n.Util.makeHexColor(...V.color)),ot(wt,k,V.value),wt.annotationElementId=V.id||null,ot(wt,p,Et),wt}serialize(V=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const dt=X._internalPadding*this.parentScale,mt=this.getRect(dt,dt),Et=$.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,j)),wt={annotationType:n.AnnotationEditorType.FREETEXT,color:Et,fontSize:t(this,w),value:t(this,k),pageIndex:this.pageIndex,rect:mt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return V?wt:this.annotationElementId&&!Y(this,b,On).call(this,wt)?null:(wt.id=this.annotationElementId,wt)}};R=new WeakMap,y=new WeakMap,m=new WeakMap,O=new WeakMap,j=new WeakMap,k=new WeakMap,_=new WeakMap,w=new WeakMap,p=new WeakMap,E=new WeakSet,Mn=function(V){const dt=Et=>{this.editorDiv.style.fontSize=`calc(${Et}px * var(--scale-factor))`,this.translate(0,-(Et-t(this,w))*this.parentScale),ot(this,w,Et),Y(this,I,ve).call(this)},mt=t(this,w);this.addCommands({cmd:()=>{dt(V)},undo:()=>{dt(mt)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},C=new WeakSet,Dn=function(V){const dt=t(this,j);this.addCommands({cmd:()=>{ot(this,j,this.editorDiv.style.color=V)},undo:()=>{ot(this,j,this.editorDiv.style.color=dt)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Ln=function(){const V=this.editorDiv.getElementsByTagName("div");if(V.length===0)return this.editorDiv.innerText;const dt=[];for(const mt of V)dt.push(mt.innerText.replace(/\r\n?|\n/,""));return dt.join(`
`)},I=new WeakSet,ve=function(){const[V,dt]=this.parentDimensions;let mt;if(this.isAttachedToDOM)mt=this.div.getBoundingClientRect();else{const{currentLayer:Et,div:wt}=this,M=wt.style.display;wt.style.display="hidden",Et.div.append(this.div),mt=wt.getBoundingClientRect(),wt.remove(),wt.style.display=M}this.rotation%180===this.parentRotation%180?(this.width=mt.width/V,this.height=mt.height/dt):(this.width=mt.height/V,this.height=mt.width/dt),this.fixAndSetPosition()},c=new WeakSet,an=function(){if(this.editorDiv.replaceChildren(),!!t(this,k))for(const V of t(this,k).split(`
`)){const dt=document.createElement("div");dt.append(V?document.createTextNode(V):document.createElement("br")),this.editorDiv.append(dt)}},b=new WeakSet,On=function(V){const{value:dt,fontSize:mt,color:Et,rect:wt,pageIndex:M}=t(this,p);return V.value!==dt||V.fontSize!==mt||V.rect.some((i,o)=>Math.abs(i-wt[o])>=1)||V.color.some((i,o)=>i!==Et[o])||V.pageIndex!==M},z=new WeakSet,on=function(V=!1){if(!this.annotationElementId)return;if(Y(this,I,ve).call(this),!V&&(this.width===0||this.height===0)){setTimeout(()=>Y(this,z,on).call(this,!0),0);return}const dt=X._internalPadding*this.parentScale;t(this,p).rect=this.getRect(dt,dt)},ne(X,"_freeTextDefaultContent",""),ne(X,"_internalPadding",0),ne(X,"_defaultColor",null),ne(X,"_defaultFontSize",10),ne(X,"_type","freetext");let rt=X;e.FreeTextEditor=rt},(g,e,D)=>{var o,h,he,T,In,W,it,tt,et,ht,bt,ut,Ft,Bt,St,Lt,gt,nt,st,pt,Tt,Ct,Ut,Nn,Wt,Fe,Gt,ln,Xt,cn,Z,K,At,vt,ee,te,Q,hn,It,Pt,Nt,jt,jn,yt,dn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=D(1),u=D(6),$=D(3),L=D(30),rt=D(31),R=D(32);const y=1e3,m=9,O=new WeakSet;function j(Ot){return{width:Ot[2]-Ot[0],height:Ot[3]-Ot[1]}}class k{static create(B){switch(B.data.annotationType){case n.AnnotationType.LINK:return new w(B);case n.AnnotationType.TEXT:return new p(B);case n.AnnotationType.WIDGET:switch(B.data.fieldType){case"Tx":return new P(B);case"Btn":return B.data.radioButton?new l(B):B.data.checkBox?new v(B):new d(B);case"Ch":return new I(B);case"Sig":return new C(B)}return new E(B);case n.AnnotationType.POPUP:return new A(B);case n.AnnotationType.FREETEXT:return new F(B);case n.AnnotationType.LINE:return new b(B);case n.AnnotationType.SQUARE:return new G(B);case n.AnnotationType.CIRCLE:return new z(B);case n.AnnotationType.POLYLINE:return new S(B);case n.AnnotationType.CARET:return new at(B);case n.AnnotationType.INK:return new ct(B);case n.AnnotationType.POLYGON:return new X(B);case n.AnnotationType.HIGHLIGHT:return new V(B);case n.AnnotationType.UNDERLINE:return new dt(B);case n.AnnotationType.SQUIGGLY:return new mt(B);case n.AnnotationType.STRIKEOUT:return new Et(B);case n.AnnotationType.STAMP:return new wt(B);case n.AnnotationType.FILEATTACHMENT:return new M(B);default:return new _(B)}}}const a=class a{constructor(B,{isRenderable:s=!1,ignoreBorder:x=!1,createQuadrilaterals:U=!1}={}){H(this,o,!1);this.isRenderable=s,this.data=B.data,this.layer=B.layer,this.linkService=B.linkService,this.downloadManager=B.downloadManager,this.imageResourcesPath=B.imageResourcesPath,this.renderForms=B.renderForms,this.svgFactory=B.svgFactory,this.annotationStorage=B.annotationStorage,this.enableScripting=B.enableScripting,this.hasJSActions=B.hasJSActions,this._fieldObjects=B.fieldObjects,this.parent=B.parent,s&&(this.container=this._createContainer(x)),U&&this._createQuadrilaterals()}static _hasPopupData({titleObj:B,contentsObj:s,richText:x}){return!!(B!=null&&B.str||s!=null&&s.str||x!=null&&x.str)}get hasPopupData(){return a._hasPopupData(this.data)}_createContainer(B){const{data:s,parent:{page:x,viewport:U}}=this,q=document.createElement("section");q.setAttribute("data-annotation-id",s.id),this instanceof E||(q.tabIndex=y),q.style.zIndex=this.parent.zIndex++,this.data.popupRef&&q.setAttribute("aria-haspopup","dialog"),s.noRotate&&q.classList.add("norotate");const{pageWidth:J,pageHeight:lt,pageX:_t,pageY:kt}=U.rawDims;if(!s.rect||this instanceof A){const{rotation:$t}=s;return!s.hasOwnCanvas&&$t!==0&&this.setRotation($t,q),q}const{width:Rt,height:qt}=j(s.rect),Mt=n.Util.normalizeRect([s.rect[0],x.view[3]-s.rect[1]+x.view[1],s.rect[2],x.view[3]-s.rect[3]+x.view[1]]);if(!B&&s.borderStyle.width>0){q.style.borderWidth=`${s.borderStyle.width}px`;const $t=s.borderStyle.horizontalCornerRadius,Yt=s.borderStyle.verticalCornerRadius;if($t>0||Yt>0){const Zt=`calc(${$t}px * var(--scale-factor)) / calc(${Yt}px * var(--scale-factor))`;q.style.borderRadius=Zt}else if(this instanceof l){const Zt=`calc(${Rt}px * var(--scale-factor)) / calc(${qt}px * var(--scale-factor))`;q.style.borderRadius=Zt}switch(s.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:q.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:q.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:q.style.borderBottomStyle="solid";break}const Jt=s.borderColor||null;Jt?(ot(this,o,!0),q.style.borderColor=n.Util.makeHexColor(Jt[0]|0,Jt[1]|0,Jt[2]|0)):q.style.borderWidth=0}q.style.left=`${100*(Mt[0]-_t)/J}%`,q.style.top=`${100*(Mt[1]-kt)/lt}%`;const{rotation:Dt}=s;return s.hasOwnCanvas||Dt===0?(q.style.width=`${100*Rt/J}%`,q.style.height=`${100*qt/lt}%`):this.setRotation(Dt,q),q}setRotation(B,s=this.container){if(!this.data.rect)return;const{pageWidth:x,pageHeight:U}=this.parent.viewport.rawDims,{width:q,height:J}=j(this.data.rect);let lt,_t;B%180===0?(lt=100*q/x,_t=100*J/U):(lt=100*J/x,_t=100*q/U),s.style.width=`${lt}%`,s.style.height=`${_t}%`,s.setAttribute("data-main-rotation",(360-B)%360)}get _commonActions(){const B=(s,x,U)=>{const q=U.detail[s],J=q[0],lt=q.slice(1);U.target.style[x]=L.ColorConverters[`${J}_HTML`](lt),this.annotationStorage.setValue(this.data.id,{[x]:L.ColorConverters[`${J}_rgb`](lt)})};return(0,n.shadow)(this,"_commonActions",{display:s=>{const{display:x}=s.detail,U=x%2===1;this.container.style.visibility=U?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:U,noPrint:x===1||x===2})},print:s=>{this.annotationStorage.setValue(this.data.id,{noPrint:!s.detail.print})},hidden:s=>{const{hidden:x}=s.detail;this.container.style.visibility=x?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:x,noView:x})},focus:s=>{setTimeout(()=>s.target.focus({preventScroll:!1}),0)},userName:s=>{s.target.title=s.detail.userName},readonly:s=>{s.target.disabled=s.detail.readonly},required:s=>{this._setRequired(s.target,s.detail.required)},bgColor:s=>{B("bgColor","backgroundColor",s)},fillColor:s=>{B("fillColor","backgroundColor",s)},fgColor:s=>{B("fgColor","color",s)},textColor:s=>{B("textColor","color",s)},borderColor:s=>{B("borderColor","borderColor",s)},strokeColor:s=>{B("strokeColor","borderColor",s)},rotation:s=>{const x=s.detail.rotation;this.setRotation(x),this.annotationStorage.setValue(this.data.id,{rotation:x})}})}_dispatchEventFromSandbox(B,s){const x=this._commonActions;for(const U of Object.keys(s.detail)){const q=B[U]||x[U];q==null||q(s)}}_setDefaultPropertiesFromJS(B){if(!this.enableScripting)return;const s=this.annotationStorage.getRawValue(this.data.id);if(!s)return;const x=this._commonActions;for(const[U,q]of Object.entries(s)){const J=x[U];if(J){const lt={detail:{[U]:q},target:B};J(lt),delete s[U]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:B}=this.data;if(!B)return;const[s,x,U,q]=this.data.rect;if(B.length===1){const[,{x:Yt,y:Jt},{x:Zt,y:ie}]=B[0];if(U===Yt&&q===Jt&&s===Zt&&x===ie)return}const{style:J}=this.container;let lt;if(t(this,o)){const{borderColor:Yt,borderWidth:Jt}=J;J.borderWidth=0,lt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Yt}" stroke-width="${Jt}">`],this.container.classList.add("hasBorder")}const _t=U-s,kt=q-x,{svgFactory:Rt}=this,qt=Rt.createElement("svg");qt.classList.add("quadrilateralsContainer"),qt.setAttribute("width",0),qt.setAttribute("height",0);const Mt=Rt.createElement("defs");qt.append(Mt);const Dt=Rt.createElement("clipPath"),$t=`clippath_${this.data.id}`;Dt.setAttribute("id",$t),Dt.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(Dt);for(const[,{x:Yt,y:Jt},{x:Zt,y:ie}]of B){const se=Rt.createElement("rect"),re=(Zt-s)/_t,le=(q-Jt)/kt,ce=(Yt-Zt)/_t,yn=(Jt-ie)/kt;se.setAttribute("x",re),se.setAttribute("y",le),se.setAttribute("width",ce),se.setAttribute("height",yn),Dt.append(se),lt==null||lt.push(`<rect vector-effect="non-scaling-stroke" x="${re}" y="${le}" width="${ce}" height="${yn}"/>`)}t(this,o)&&(lt.push("</g></svg>')"),J.backgroundImage=lt.join("")),this.container.append(qt),this.container.style.clipPath=`url(#${$t})`}_createPopup(){const{container:B,data:s}=this;B.setAttribute("aria-haspopup","dialog");const x=new A({data:{color:s.color,titleObj:s.titleObj,modificationDate:s.modificationDate,contentsObj:s.contentsObj,richText:s.richText,parentRect:s.rect,borderStyle:0,id:`popup_${s.id}`,rotation:s.rotation},parent:this.parent,elements:[this]});this.parent.div.append(x.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(B,s=null){const x=[];if(this._fieldObjects){const U=this._fieldObjects[B];if(U)for(const{page:q,id:J,exportValues:lt}of U){if(q===-1||J===s)continue;const _t=typeof lt=="string"?lt:null,kt=document.querySelector(`[data-element-id="${J}"]`);if(kt&&!O.has(kt)){(0,n.warn)(`_getElementsByName - element not allowed: ${J}`);continue}x.push({id:J,exportValue:_t,domElement:kt})}return x}for(const U of document.getElementsByName(B)){const{exportValue:q}=U,J=U.getAttribute("data-element-id");J!==s&&O.has(U)&&x.push({id:J,exportValue:q,domElement:U})}return x}show(){var B;this.container&&(this.container.hidden=!1),(B=this.popup)==null||B.maybeShow()}hide(){var B;this.container&&(this.container.hidden=!0),(B=this.popup)==null||B.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const B=this.getElementsToTriggerPopup();if(Array.isArray(B))for(const s of B)s.classList.add("highlightArea");else B.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:B,data:{id:s}}=this;this.container.addEventListener("dblclick",()=>{var x;(x=this.linkService.eventBus)==null||x.dispatch("switchannotationeditormode",{source:this,mode:B,editId:s})})}};o=new WeakMap;let _=a;class w extends _{constructor(s,x=null){super(s,{isRenderable:!0,ignoreBorder:!!(x!=null&&x.ignoreBorder),createQuadrilaterals:!0});H(this,h);H(this,T);this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:x}=this,U=document.createElement("a");U.setAttribute("data-element-id",s.id);let q=!1;return s.url?(x.addLinkAttributes(U,s.url,s.newWindow),q=!0):s.action?(this._bindNamedAction(U,s.action),q=!0):s.attachment?(this._bindAttachment(U,s.attachment),q=!0):s.setOCGState?(Y(this,T,In).call(this,U,s.setOCGState),q=!0):s.dest?(this._bindLink(U,s.dest),q=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(U,s),q=!0),s.resetForm?(this._bindResetFormAction(U,s.resetForm),q=!0):this.isTooltipOnly&&!q&&(this._bindLink(U,""),q=!0)),this.container.classList.add("linkAnnotation"),q&&this.container.append(U),this.container}_bindLink(s,x){s.href=this.linkService.getDestinationHash(x),s.onclick=()=>(x&&this.linkService.goToDestination(x),!1),(x||x==="")&&Y(this,h,he).call(this)}_bindNamedAction(s,x){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(x),!1),Y(this,h,he).call(this)}_bindAttachment(s,x){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>{var U;return(U=this.downloadManager)==null||U.openOrDownloadData(this.container,x.content,x.filename),!1},Y(this,h,he).call(this)}_bindJSAction(s,x){s.href=this.linkService.getAnchorUrl("");const U=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(x.actions)){const J=U.get(q);J&&(s[J]=()=>{var lt;return(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x.id,name:q}}),!1})}s.onclick||(s.onclick=()=>!1),Y(this,h,he).call(this)}_bindResetFormAction(s,x){const U=s.onclick;if(U||(s.href=this.linkService.getAnchorUrl("")),Y(this,h,he).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),U||(s.onclick=()=>!1);return}s.onclick=()=>{var qt;U==null||U();const{fields:q,refs:J,include:lt}=x,_t=[];if(q.length!==0||J.length!==0){const Mt=new Set(J);for(const Dt of q){const $t=this._fieldObjects[Dt]||[];for(const{id:Yt}of $t)Mt.add(Yt)}for(const Dt of Object.values(this._fieldObjects))for(const $t of Dt)Mt.has($t.id)===lt&&_t.push($t)}else for(const Mt of Object.values(this._fieldObjects))_t.push(...Mt);const kt=this.annotationStorage,Rt=[];for(const Mt of _t){const{id:Dt}=Mt;switch(Rt.push(Dt),Mt.type){case"text":{const Yt=Mt.defaultValue||"";kt.setValue(Dt,{value:Yt});break}case"checkbox":case"radiobutton":{const Yt=Mt.defaultValue===Mt.exportValues;kt.setValue(Dt,{value:Yt});break}case"combobox":case"listbox":{const Yt=Mt.defaultValue||"";kt.setValue(Dt,{value:Yt});break}default:continue}const $t=document.querySelector(`[data-element-id="${Dt}"]`);if($t){if(!O.has($t)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Dt}`);continue}}else continue;$t.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Rt,name:"ResetForm"}})),!1}}}h=new WeakSet,he=function(){this.container.setAttribute("data-internal-link","")},T=new WeakSet,In=function(s,x){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeSetOCGState(x),!1),Y(this,h,he).call(this)};class p extends _{constructor(B){super(B,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const B=document.createElement("img");return B.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",B.alt="[{{type}} Annotation]",B.dataset.l10nId="text_annotation_type",B.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(B),this.container}}class E extends _{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(B){var s;this.data.hasOwnCanvas&&(((s=B.previousSibling)==null?void 0:s.nodeName)==="CANVAS"&&(B.previousSibling.hidden=!0),B.hidden=!1)}_getKeyModifier(B){const{isWin:s,isMac:x}=n.FeatureTest.platform;return s&&B.ctrlKey||x&&B.metaKey}_setEventListener(B,s,x,U,q){x.includes("mouse")?B.addEventListener(x,J=>{var lt;(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(J),shift:J.shiftKey,modifier:this._getKeyModifier(J)}})}):B.addEventListener(x,J=>{var lt;if(x==="blur"){if(!s.focused||!J.relatedTarget)return;s.focused=!1}else if(x==="focus"){if(s.focused)return;s.focused=!0}q&&((lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(J)}}))})}_setEventListeners(B,s,x,U){var q,J,lt;for(const[_t,kt]of x)(kt==="Action"||(q=this.data.actions)!=null&&q[kt])&&((kt==="Focus"||kt==="Blur")&&(s||(s={focused:!1})),this._setEventListener(B,s,_t,kt,U),kt==="Focus"&&!((J=this.data.actions)!=null&&J.Blur)?this._setEventListener(B,s,"blur","Blur",null):kt==="Blur"&&!((lt=this.data.actions)!=null&&lt.Focus)&&this._setEventListener(B,s,"focus","Focus",null))}_setBackgroundColor(B){const s=this.data.backgroundColor||null;B.style.backgroundColor=s===null?"transparent":n.Util.makeHexColor(s[0],s[1],s[2])}_setTextStyle(B){const s=["left","center","right"],{fontColor:x}=this.data.defaultAppearanceData,U=this.data.defaultAppearanceData.fontSize||m,q=B.style;let J;const lt=2,_t=kt=>Math.round(10*kt)/10;if(this.data.multiLine){const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-lt),Rt=Math.round(kt/(n.LINE_FACTOR*U))||1,qt=kt/Rt;J=Math.min(U,_t(qt/n.LINE_FACTOR))}else{const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-lt);J=Math.min(U,_t(kt/n.LINE_FACTOR))}q.fontSize=`calc(${J}px * var(--scale-factor))`,q.color=n.Util.makeHexColor(x[0],x[1],x[2]),this.data.textAlignment!==null&&(q.textAlign=s[this.data.textAlignment])}_setRequired(B,s){s?B.setAttribute("required",!0):B.removeAttribute("required"),B.setAttribute("aria-required",s)}}class P extends E{constructor(B){const s=B.renderForms||!B.data.hasAppearance&&!!B.data.fieldValue;super(B,{isRenderable:s})}setPropertyOnSiblings(B,s,x,U){const q=this.annotationStorage;for(const J of this._getElementsByName(B.name,B.id))J.domElement&&(J.domElement[s]=x),q.setValue(J.id,{[U]:x})}render(){var U,q;const B=this.annotationStorage,s=this.data.id;this.container.classList.add("textWidgetAnnotation");let x=null;if(this.renderForms){const J=B.getValue(s,{value:this.data.fieldValue});let lt=J.value||"";const _t=B.getValue(s,{charLimit:this.data.maxLen}).charLimit;_t&&lt.length>_t&&(lt=lt.slice(0,_t));let kt=J.formattedValue||((U=this.data.textContent)==null?void 0:U.join(`
`))||null;kt&&this.data.comb&&(kt=kt.replaceAll(/\s+/g,""));const Rt={userValue:lt,formattedValue:kt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(x=document.createElement("textarea"),x.textContent=kt??lt,this.data.doNotScroll&&(x.style.overflowY="hidden")):(x=document.createElement("input"),x.type="text",x.setAttribute("value",kt??lt),this.data.doNotScroll&&(x.style.overflowX="hidden")),this.data.hasOwnCanvas&&(x.hidden=!0),O.add(x),x.setAttribute("data-element-id",s),x.disabled=this.data.readOnly,x.name=this.data.fieldName,x.tabIndex=y,this._setRequired(x,this.data.required),_t&&(x.maxLength=_t),x.addEventListener("input",Mt=>{B.setValue(s,{value:Mt.target.value}),this.setPropertyOnSiblings(x,"value",Mt.target.value,"value"),Rt.formattedValue=null}),x.addEventListener("resetform",Mt=>{const Dt=this.data.defaultFieldValue??"";x.value=Rt.userValue=Dt,Rt.formattedValue=null});let qt=Mt=>{const{formattedValue:Dt}=Rt;Dt!=null&&(Mt.target.value=Dt),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){x.addEventListener("focus",Dt=>{if(Rt.focused)return;const{target:$t}=Dt;Rt.userValue&&($t.value=Rt.userValue),Rt.lastCommittedValue=$t.value,Rt.commitKey=1,Rt.focused=!0}),x.addEventListener("updatefromsandbox",Dt=>{this.showElementAndHideCanvas(Dt.target);const $t={value(Yt){Rt.userValue=Yt.detail.value??"",B.setValue(s,{value:Rt.userValue.toString()}),Yt.target.value=Rt.userValue},formattedValue(Yt){const{formattedValue:Jt}=Yt.detail;Rt.formattedValue=Jt,Jt!=null&&Yt.target!==document.activeElement&&(Yt.target.value=Jt),B.setValue(s,{formattedValue:Jt})},selRange(Yt){Yt.target.setSelectionRange(...Yt.detail.selRange)},charLimit:Yt=>{var se;const{charLimit:Jt}=Yt.detail,{target:Zt}=Yt;if(Jt===0){Zt.removeAttribute("maxLength");return}Zt.setAttribute("maxLength",Jt);let ie=Rt.userValue;!ie||ie.length<=Jt||(ie=ie.slice(0,Jt),Zt.value=Rt.userValue=ie,B.setValue(s,{value:ie}),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:ie,willCommit:!0,commitKey:1,selStart:Zt.selectionStart,selEnd:Zt.selectionEnd}}))}};this._dispatchEventFromSandbox($t,Dt)}),x.addEventListener("keydown",Dt=>{var Jt;Rt.commitKey=1;let $t=-1;if(Dt.key==="Escape"?$t=0:Dt.key==="Enter"&&!this.data.multiLine?$t=2:Dt.key==="Tab"&&(Rt.commitKey=3),$t===-1)return;const{value:Yt}=Dt.target;Rt.lastCommittedValue!==Yt&&(Rt.lastCommittedValue=Yt,Rt.userValue=Yt,(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Yt,willCommit:!0,commitKey:$t,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}}))});const Mt=qt;qt=null,x.addEventListener("blur",Dt=>{var Yt;if(!Rt.focused||!Dt.relatedTarget)return;Rt.focused=!1;const{value:$t}=Dt.target;Rt.userValue=$t,Rt.lastCommittedValue!==$t&&((Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:$t,willCommit:!0,commitKey:Rt.commitKey,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}})),Mt(Dt)}),(q=this.data.actions)!=null&&q.Keystroke&&x.addEventListener("beforeinput",Dt=>{var le;Rt.lastCommittedValue=null;const{data:$t,target:Yt}=Dt,{value:Jt,selectionStart:Zt,selectionEnd:ie}=Yt;let se=Zt,re=ie;switch(Dt.inputType){case"deleteWordBackward":{const ce=Jt.substring(0,Zt).match(/\w*[^\w]*$/);ce&&(se-=ce[0].length);break}case"deleteWordForward":{const ce=Jt.substring(Zt).match(/^[^\w]*\w*/);ce&&(re+=ce[0].length);break}case"deleteContentBackward":Zt===ie&&(se-=1);break;case"deleteContentForward":Zt===ie&&(re+=1);break}Dt.preventDefault(),(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Jt,change:$t||"",willCommit:!1,selStart:se,selEnd:re}})}),this._setEventListeners(x,Rt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Dt=>Dt.target.value)}if(qt&&x.addEventListener("blur",qt),this.data.comb){const Dt=(this.data.rect[2]-this.data.rect[0])/_t;x.classList.add("comb"),x.style.letterSpacing=`calc(${Dt}px * var(--scale-factor) - 1ch)`}}else x=document.createElement("div"),x.textContent=this.data.fieldValue,x.style.verticalAlign="middle",x.style.display="table-cell";return this._setTextStyle(x),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class C extends E{constructor(B){super(B,{isRenderable:!!B.data.hasOwnCanvas})}}class v extends E{constructor(B){super(B,{isRenderable:B.renderForms})}render(){const B=this.annotationStorage,s=this.data,x=s.id;let U=B.getValue(x,{value:s.exportValue===s.fieldValue}).value;typeof U=="string"&&(U=U!=="Off",B.setValue(x,{value:U})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const q=document.createElement("input");return O.add(q),q.setAttribute("data-element-id",x),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="checkbox",q.name=s.fieldName,U&&q.setAttribute("checked",!0),q.setAttribute("exportValue",s.exportValue),q.tabIndex=y,q.addEventListener("change",J=>{const{name:lt,checked:_t}=J.target;for(const kt of this._getElementsByName(lt,x)){const Rt=_t&&kt.exportValue===s.exportValue;kt.domElement&&(kt.domElement.checked=Rt),B.setValue(kt.id,{value:Rt})}B.setValue(x,{value:_t})}),q.addEventListener("resetform",J=>{const lt=s.defaultFieldValue||"Off";J.target.checked=lt===s.exportValue}),this.enableScripting&&this.hasJSActions&&(q.addEventListener("updatefromsandbox",J=>{const lt={value(_t){_t.target.checked=_t.detail.value!=="Off",B.setValue(x,{value:_t.target.checked})}};this._dispatchEventFromSandbox(lt,J)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)),this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class l extends E{constructor(B){super(B,{isRenderable:B.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const B=this.annotationStorage,s=this.data,x=s.id;let U=B.getValue(x,{value:s.fieldValue===s.buttonValue}).value;typeof U=="string"&&(U=U!==s.buttonValue,B.setValue(x,{value:U}));const q=document.createElement("input");if(O.add(q),q.setAttribute("data-element-id",x),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="radio",q.name=s.fieldName,U&&q.setAttribute("checked",!0),q.tabIndex=y,q.addEventListener("change",J=>{const{name:lt,checked:_t}=J.target;for(const kt of this._getElementsByName(lt,x))B.setValue(kt.id,{value:!1});B.setValue(x,{value:_t})}),q.addEventListener("resetform",J=>{const lt=s.defaultFieldValue;J.target.checked=lt!=null&&lt===s.buttonValue}),this.enableScripting&&this.hasJSActions){const J=s.buttonValue;q.addEventListener("updatefromsandbox",lt=>{const _t={value:kt=>{const Rt=J===kt.detail.value;for(const qt of this._getElementsByName(kt.target.name)){const Mt=Rt&&qt.id===x;qt.domElement&&(qt.domElement.checked=Mt),B.setValue(qt.id,{value:Mt})}}};this._dispatchEventFromSandbox(_t,lt)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],lt=>lt.target.checked)}return this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class d extends w{constructor(B){super(B,{ignoreBorder:B.data.hasAppearance})}render(){const B=super.render();B.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(B.title=this.data.alternativeText);const s=B.lastChild;return this.enableScripting&&this.hasJSActions&&s&&(this._setDefaultPropertiesFromJS(s),s.addEventListener("updatefromsandbox",x=>{this._dispatchEventFromSandbox({},x)})),B}}class I extends E{constructor(B){super(B,{isRenderable:B.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const B=this.annotationStorage,s=this.data.id,x=B.getValue(s,{value:this.data.fieldValue}),U=document.createElement("select");O.add(U),U.setAttribute("data-element-id",s),U.disabled=this.data.readOnly,this._setRequired(U,this.data.required),U.name=this.data.fieldName,U.tabIndex=y;let q=this.data.combo&&this.data.options.length>0;this.data.combo||(U.size=this.data.options.length,this.data.multiSelect&&(U.multiple=!0)),U.addEventListener("resetform",Rt=>{const qt=this.data.defaultFieldValue;for(const Mt of U.options)Mt.selected=Mt.value===qt});for(const Rt of this.data.options){const qt=document.createElement("option");qt.textContent=Rt.displayValue,qt.value=Rt.exportValue,x.value.includes(Rt.exportValue)&&(qt.setAttribute("selected",!0),q=!1),U.append(qt)}let J=null;if(q){const Rt=document.createElement("option");Rt.value=" ",Rt.setAttribute("hidden",!0),Rt.setAttribute("selected",!0),U.prepend(Rt),J=()=>{Rt.remove(),U.removeEventListener("input",J),J=null},U.addEventListener("input",J)}const lt=Rt=>{const qt=Rt?"value":"textContent",{options:Mt,multiple:Dt}=U;return Dt?Array.prototype.filter.call(Mt,$t=>$t.selected).map($t=>$t[qt]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][qt]};let _t=lt(!1);const kt=Rt=>{const qt=Rt.target.options;return Array.prototype.map.call(qt,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(U.addEventListener("updatefromsandbox",Rt=>{const qt={value(Mt){J==null||J();const Dt=Mt.detail.value,$t=new Set(Array.isArray(Dt)?Dt:[Dt]);for(const Yt of U.options)Yt.selected=$t.has(Yt.value);B.setValue(s,{value:lt(!0)}),_t=lt(!1)},multipleSelection(Mt){U.multiple=!0},remove(Mt){const Dt=U.options,$t=Mt.detail.remove;Dt[$t].selected=!1,U.remove($t),Dt.length>0&&Array.prototype.findIndex.call(Dt,Jt=>Jt.selected)===-1&&(Dt[0].selected=!0),B.setValue(s,{value:lt(!0),items:kt(Mt)}),_t=lt(!1)},clear(Mt){for(;U.length!==0;)U.remove(0);B.setValue(s,{value:null,items:[]}),_t=lt(!1)},insert(Mt){const{index:Dt,displayValue:$t,exportValue:Yt}=Mt.detail.insert,Jt=U.children[Dt],Zt=document.createElement("option");Zt.textContent=$t,Zt.value=Yt,Jt?Jt.before(Zt):U.append(Zt),B.setValue(s,{value:lt(!0),items:kt(Mt)}),_t=lt(!1)},items(Mt){const{items:Dt}=Mt.detail;for(;U.length!==0;)U.remove(0);for(const $t of Dt){const{displayValue:Yt,exportValue:Jt}=$t,Zt=document.createElement("option");Zt.textContent=Yt,Zt.value=Jt,U.append(Zt)}U.options.length>0&&(U.options[0].selected=!0),B.setValue(s,{value:lt(!0),items:kt(Mt)}),_t=lt(!1)},indices(Mt){const Dt=new Set(Mt.detail.indices);for(const $t of Mt.target.options)$t.selected=Dt.has($t.index);B.setValue(s,{value:lt(!0)}),_t=lt(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(qt,Rt)}),U.addEventListener("input",Rt=>{var Mt;const qt=lt(!0);B.setValue(s,{value:qt}),Rt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:_t,changeEx:qt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(U,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Rt=>Rt.target.value)):U.addEventListener("input",function(Rt){B.setValue(s,{value:lt(!0)})}),this.data.combo&&this._setTextStyle(U),this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class A extends _{constructor(B){const{data:s,elements:x}=B;super(B,{isRenderable:_._hasPopupData(s)}),this.elements=x}render(){this.container.classList.add("popupAnnotation");const B=new c({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const x of this.elements)x.popup=B,s.push(x.data.id),x.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(x=>`${n.AnnotationPrefix}${x}`).join(",")),this.container}}class c{constructor({container:B,color:s,elements:x,titleObj:U,modificationDate:q,contentsObj:J,richText:lt,parent:_t,rect:kt,parentRect:Rt,open:qt}){H(this,Ut);H(this,Wt);H(this,Gt);H(this,Xt);H(this,W,null);H(this,it,Y(this,Ut,Nn).bind(this));H(this,tt,Y(this,Xt,cn).bind(this));H(this,et,Y(this,Gt,ln).bind(this));H(this,ht,Y(this,Wt,Fe).bind(this));H(this,bt,null);H(this,ut,null);H(this,Ft,null);H(this,Bt,null);H(this,St,null);H(this,Lt,null);H(this,gt,!1);H(this,nt,null);H(this,st,null);H(this,pt,null);H(this,Tt,null);H(this,Ct,!1);var Dt;ot(this,ut,B),ot(this,Tt,U),ot(this,Ft,J),ot(this,pt,lt),ot(this,St,_t),ot(this,bt,s),ot(this,st,kt),ot(this,Lt,Rt),ot(this,Bt,x);const Mt=u.PDFDateString.toDateObject(q);Mt&&ot(this,W,_t.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=x.flatMap($t=>$t.getElementsToTriggerPopup());for(const $t of this.trigger)$t.addEventListener("click",t(this,ht)),$t.addEventListener("mouseenter",t(this,et)),$t.addEventListener("mouseleave",t(this,tt)),$t.classList.add("popupTriggerArea");for(const $t of x)(Dt=$t.container)==null||Dt.addEventListener("keydown",t(this,it));t(this,ut).hidden=!0,qt&&Y(this,Wt,Fe).call(this)}render(){if(t(this,nt))return;const{page:{view:B},viewport:{rawDims:{pageWidth:s,pageHeight:x,pageX:U,pageY:q}}}=t(this,St),J=ot(this,nt,document.createElement("div"));if(J.className="popup",t(this,bt)){const se=J.style.outlineColor=n.Util.makeHexColor(...t(this,bt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?J.style.backgroundColor=`color-mix(in srgb, ${se} 30%, white)`:J.style.backgroundColor=n.Util.makeHexColor(...t(this,bt).map(le=>Math.floor(.7*(255-le)+le)))}const lt=document.createElement("span");lt.className="header";const _t=document.createElement("h1");if(lt.append(_t),{dir:_t.dir,str:_t.textContent}=t(this,Tt),J.append(lt),t(this,W)){const se=document.createElement("span");se.classList.add("popupDate"),t(this,W).then(re=>{se.textContent=re}),lt.append(se)}const kt=t(this,Ft),Rt=t(this,pt);if(Rt!=null&&Rt.str&&(!(kt!=null&&kt.str)||kt.str===Rt.str))R.XfaLayer.render({xfaHtml:Rt.html,intent:"richText",div:J}),J.lastChild.classList.add("richText","popupContent");else{const se=this._formatContents(kt);J.append(se)}let qt=!!t(this,Lt),Mt=qt?t(this,Lt):t(this,st);for(const se of t(this,Bt))if(!Mt||n.Util.intersect(se.data.rect,Mt)!==null){Mt=se.data.rect,qt=!0;break}const Dt=n.Util.normalizeRect([Mt[0],B[3]-Mt[1]+B[1],Mt[2],B[3]-Mt[3]+B[1]]),$t=5,Yt=qt?Mt[2]-Mt[0]+$t:0,Jt=Dt[0]+Yt,Zt=Dt[1],{style:ie}=t(this,ut);ie.left=`${100*(Jt-U)/s}%`,ie.top=`${100*(Zt-q)/x}%`,t(this,ut).append(J)}_formatContents({str:B,dir:s}){const x=document.createElement("p");x.classList.add("popupContent"),x.dir=s;const U=B.split(/(?:\r\n?|\n)/);for(let q=0,J=U.length;q<J;++q){const lt=U[q];x.append(document.createTextNode(lt)),q<J-1&&x.append(document.createElement("br"))}return x}forceHide(){ot(this,Ct,this.isVisible),t(this,Ct)&&(t(this,ut).hidden=!0)}maybeShow(){t(this,Ct)&&(ot(this,Ct,!1),t(this,ut).hidden=!1)}get isVisible(){return t(this,ut).hidden===!1}}W=new WeakMap,it=new WeakMap,tt=new WeakMap,et=new WeakMap,ht=new WeakMap,bt=new WeakMap,ut=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,St=new WeakMap,Lt=new WeakMap,gt=new WeakMap,nt=new WeakMap,st=new WeakMap,pt=new WeakMap,Tt=new WeakMap,Ct=new WeakMap,Ut=new WeakSet,Nn=function(B){B.altKey||B.shiftKey||B.ctrlKey||B.metaKey||(B.key==="Enter"||B.key==="Escape"&&t(this,gt))&&Y(this,Wt,Fe).call(this)},Wt=new WeakSet,Fe=function(){ot(this,gt,!t(this,gt)),t(this,gt)?(Y(this,Gt,ln).call(this),t(this,ut).addEventListener("click",t(this,ht)),t(this,ut).addEventListener("keydown",t(this,it))):(Y(this,Xt,cn).call(this),t(this,ut).removeEventListener("click",t(this,ht)),t(this,ut).removeEventListener("keydown",t(this,it)))},Gt=new WeakSet,ln=function(){t(this,nt)||this.render(),this.isVisible?t(this,gt)&&t(this,ut).classList.add("focused"):(t(this,ut).hidden=!1,t(this,ut).style.zIndex=parseInt(t(this,ut).style.zIndex)+1e3)},Xt=new WeakSet,cn=function(){t(this,ut).classList.remove("focused"),!(t(this,gt)||!this.isVisible)&&(t(this,ut).hidden=!0,t(this,ut).style.zIndex=parseInt(t(this,ut).style.zIndex)-1e3)};class F extends _{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0}),this.textContent=B.data.textContent,this.textPosition=B.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const B=document.createElement("div");B.classList.add("annotationTextContent"),B.setAttribute("role","comment");for(const s of this.textContent){const x=document.createElement("span");x.textContent=s,B.append(x)}this.container.append(B)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=F;class b extends _{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,Z,null)}render(){this.container.classList.add("lineAnnotation");const s=this.data,{width:x,height:U}=j(s.rect),q=this.svgFactory.create(x,U,!0),J=ot(this,Z,this.svgFactory.createElement("svg:line"));return J.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),J.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),J.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),J.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),J.setAttribute("stroke-width",s.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),q.append(J),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Z)}addHighlightArea(){this.container.classList.add("highlightArea")}}Z=new WeakMap;class G extends _{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,K,null)}render(){this.container.classList.add("squareAnnotation");const s=this.data,{width:x,height:U}=j(s.rect),q=this.svgFactory.create(x,U,!0),J=s.borderStyle.width,lt=ot(this,K,this.svgFactory.createElement("svg:rect"));return lt.setAttribute("x",J/2),lt.setAttribute("y",J/2),lt.setAttribute("width",x-J),lt.setAttribute("height",U-J),lt.setAttribute("stroke-width",J||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap;class z extends _{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,At,null)}render(){this.container.classList.add("circleAnnotation");const s=this.data,{width:x,height:U}=j(s.rect),q=this.svgFactory.create(x,U,!0),J=s.borderStyle.width,lt=ot(this,At,this.svgFactory.createElement("svg:ellipse"));return lt.setAttribute("cx",x/2),lt.setAttribute("cy",U/2),lt.setAttribute("rx",x/2-J/2),lt.setAttribute("ry",U/2-J/2),lt.setAttribute("stroke-width",J||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,At)}addHighlightArea(){this.container.classList.add("highlightArea")}}At=new WeakMap;class S extends _{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,vt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:x,height:U}=j(s.rect),q=this.svgFactory.create(x,U,!0);let J=[];for(const _t of s.vertices){const kt=_t.x-s.rect[0],Rt=s.rect[3]-_t.y;J.push(kt+","+Rt)}J=J.join(" ");const lt=ot(this,vt,this.svgFactory.createElement(this.svgElementName));return lt.setAttribute("points",J),lt.setAttribute("stroke-width",s.borderStyle.width||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,vt)}addHighlightArea(){this.container.classList.add("highlightArea")}}vt=new WeakMap;class X extends S{constructor(B){super(B),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class at extends _{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ct extends _{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,ee,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:x,height:U}=j(s.rect),q=this.svgFactory.create(x,U,!0);for(const J of s.inkLists){let lt=[];for(const kt of J){const Rt=kt.x-s.rect[0],qt=s.rect[3]-kt.y;lt.push(`${Rt},${qt}`)}lt=lt.join(" ");const _t=this.svgFactory.createElement(this.svgElementName);t(this,ee).push(_t),_t.setAttribute("points",lt),_t.setAttribute("stroke-width",s.borderStyle.width||1),_t.setAttribute("stroke","transparent"),_t.setAttribute("fill","transparent"),!s.popupRef&&this.hasPopupData&&this._createPopup(),q.append(_t)}return this.container.append(q),this.container}getElementsToTriggerPopup(){return t(this,ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}ee=new WeakMap,e.InkAnnotationElement=ct;class V extends _{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class dt extends _{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class mt extends _{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Et extends _{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class wt extends _{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=wt;class M extends _{constructor(s){var q;super(s,{isRenderable:!0});H(this,Q);H(this,te,null);const{filename:x,content:U}=this.data.file;this.filename=(0,u.getFilenameFromUrl)(x,!0),this.content=U,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,filename:x,content:U})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:s,data:x}=this;let U;x.hasAppearance||x.fillAlpha===0?U=document.createElement("div"):(U=document.createElement("img"),U.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(x.name)?"paperclip":"pushpin"}.svg`,x.fillAlpha&&x.fillAlpha<1&&(U.style=`filter: opacity(${Math.round(x.fillAlpha*100)}%);`)),U.addEventListener("dblclick",Y(this,Q,hn).bind(this)),ot(this,te,U);const{isMac:q}=n.FeatureTest.platform;return s.addEventListener("keydown",J=>{J.key==="Enter"&&(q?J.metaKey:J.ctrlKey)&&Y(this,Q,hn).call(this)}),!x.popupRef&&this.hasPopupData?this._createPopup():U.classList.add("popupTriggerArea"),s.append(U),s}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,Q=new WeakSet,hn=function(){var s;(s=this.downloadManager)==null||s.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:B,accessibilityManager:s,annotationCanvasMap:x,l10n:U,page:q,viewport:J}){H(this,jt);H(this,yt);H(this,It,null);H(this,Pt,null);H(this,Nt,new Map);this.div=B,ot(this,It,s),ot(this,Pt,x),this.l10n=U,this.page=q,this.viewport=J,this.zIndex=0,this.l10n||(this.l10n=rt.NullL10n)}async render(B){const{annotations:s}=B,x=this.div;(0,u.setLayerDimensions)(x,this.viewport);const U=new Map,q={data:null,layer:x,linkService:B.linkService,downloadManager:B.downloadManager,imageResourcesPath:B.imageResourcesPath||"",renderForms:B.renderForms!==!1,svgFactory:new u.DOMSVGFactory,annotationStorage:B.annotationStorage||new $.AnnotationStorage,enableScripting:B.enableScripting===!0,hasJSActions:B.hasJSActions,fieldObjects:B.fieldObjects,parent:this,elements:null};for(const J of s){if(J.noHTML)continue;const lt=J.annotationType===n.AnnotationType.POPUP;if(lt){const Rt=U.get(J.id);if(!Rt)continue;q.elements=Rt}else{const{width:Rt,height:qt}=j(J.rect);if(Rt<=0||qt<=0)continue}q.data=J;const _t=k.create(q);if(!_t.isRenderable)continue;if(!lt&&J.popupRef){const Rt=U.get(J.popupRef);Rt?Rt.push(_t):U.set(J.popupRef,[_t])}_t.annotationEditorType>0&&t(this,Nt).set(_t.data.id,_t);const kt=_t.render();J.hidden&&(kt.style.visibility="hidden"),Y(this,jt,jn).call(this,kt,J.id)}Y(this,yt,dn).call(this),await this.l10n.translate(x)}update({viewport:B}){const s=this.div;this.viewport=B,(0,u.setLayerDimensions)(s,{rotation:B.rotation}),Y(this,yt,dn).call(this),s.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Nt).values())}getEditableAnnotation(B){return t(this,Nt).get(B)}}It=new WeakMap,Pt=new WeakMap,Nt=new WeakMap,jt=new WeakSet,jn=function(B,s){var U;const x=B.firstChild||B;x.id=`${n.AnnotationPrefix}${s}`,this.div.append(B),(U=t(this,It))==null||U.moveElementInDOM(this.div,B,x,!1)},yt=new WeakSet,dn=function(){if(!t(this,Pt))return;const B=this.div;for(const[s,x]of t(this,Pt)){const U=B.querySelector(`[data-annotation-id="${s}"]`);if(!U)continue;const{firstChild:q}=U;q?q.nodeName==="CANVAS"?q.replaceWith(x):q.before(x):U.append(x)}t(this,Pt).clear()},e.AnnotationLayer=i},(g,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function D($){return Math.floor(Math.max(0,Math.min(1,$))*255).toString(16).padStart(2,"0")}function n($){return Math.max(0,Math.min(255,255*$))}class u{static CMYK_G([L,rt,R,y]){return["G",1-Math.min(1,.3*L+.59*R+.11*rt+y)]}static G_CMYK([L]){return["CMYK",0,0,0,1-L]}static G_RGB([L]){return["RGB",L,L,L]}static G_rgb([L]){return L=n(L),[L,L,L]}static G_HTML([L]){const rt=D(L);return`#${rt}${rt}${rt}`}static RGB_G([L,rt,R]){return["G",.3*L+.59*rt+.11*R]}static RGB_rgb(L){return L.map(n)}static RGB_HTML(L){return`#${L.map(D).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([L,rt,R,y]){return["RGB",1-Math.min(1,L+y),1-Math.min(1,R+y),1-Math.min(1,rt+y)]}static CMYK_rgb([L,rt,R,y]){return[n(1-Math.min(1,L+y)),n(1-Math.min(1,R+y)),n(1-Math.min(1,rt+y))]}static CMYK_HTML(L){const rt=this.CMYK_RGB(L).slice(1);return this.RGB_HTML(rt)}static RGB_CMYK([L,rt,R]){const y=1-L,m=1-rt,O=1-R,j=Math.min(y,m,O);return["CMYK",y,m,O,j]}}e.ColorConverters=u},(g,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const D={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};D.print_progress_percent="{{progress}}%";function n(L,rt){switch(L){case"find_match_count":L=`find_match_count[${rt.total===1?"one":"other"}]`;break;case"find_match_count_limit":L=`find_match_count_limit[${rt.limit===1?"one":"other"}]`;break}return D[L]||""}function u(L,rt){return rt?L.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(R,y)=>y in rt?rt[y]:"{{"+y+"}}"):L}const $={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(L,rt=null,R=n(L,rt)){return u(R,rt)},async translate(L){}};e.NullL10n=$},(g,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=D(25);class u{static setupStorage(L,rt,R,y,m){const O=y.getValue(rt,{value:null});switch(R.name){case"textarea":if(O.value!==null&&(L.textContent=O.value),m==="print")break;L.addEventListener("input",j=>{y.setValue(rt,{value:j.target.value})});break;case"input":if(R.attributes.type==="radio"||R.attributes.type==="checkbox"){if(O.value===R.attributes.xfaOn?L.setAttribute("checked",!0):O.value===R.attributes.xfaOff&&L.removeAttribute("checked"),m==="print")break;L.addEventListener("change",j=>{y.setValue(rt,{value:j.target.checked?j.target.getAttribute("xfaOn"):j.target.getAttribute("xfaOff")})})}else{if(O.value!==null&&L.setAttribute("value",O.value),m==="print")break;L.addEventListener("input",j=>{y.setValue(rt,{value:j.target.value})})}break;case"select":if(O.value!==null){L.setAttribute("value",O.value);for(const j of R.children)j.attributes.value===O.value?j.attributes.selected=!0:j.attributes.hasOwnProperty("selected")&&delete j.attributes.selected}L.addEventListener("input",j=>{const k=j.target.options,_=k.selectedIndex===-1?"":k[k.selectedIndex].value;y.setValue(rt,{value:_})});break}}static setAttributes({html:L,element:rt,storage:R=null,intent:y,linkService:m}){const{attributes:O}=rt,j=L instanceof HTMLAnchorElement;O.type==="radio"&&(O.name=`${O.name}-${y}`);for(const[k,_]of Object.entries(O))if(_!=null)switch(k){case"class":_.length&&L.setAttribute(k,_.join(" "));break;case"dataId":break;case"id":L.setAttribute("data-element-id",_);break;case"style":Object.assign(L.style,_);break;case"textContent":L.textContent=_;break;default:(!j||k!=="href"&&k!=="newWindow")&&L.setAttribute(k,_)}j&&m.addLinkAttributes(L,O.href,O.newWindow),R&&O.dataId&&this.setupStorage(L,O.dataId,rt,R)}static render(L){var w;const rt=L.annotationStorage,R=L.linkService,y=L.xfaHtml,m=L.intent||"display",O=document.createElement(y.name);y.attributes&&this.setAttributes({html:O,element:y,intent:m,linkService:R});const j=[[y,-1,O]],k=L.div;if(k.append(O),L.viewport){const p=`matrix(${L.viewport.transform.join(",")})`;k.style.transform=p}m!=="richText"&&k.setAttribute("class","xfaLayer xfaFont");const _=[];for(;j.length>0;){const[p,E,P]=j.at(-1);if(E+1===p.children.length){j.pop();continue}const C=p.children[++j.at(-1)[1]];if(C===null)continue;const{name:v}=C;if(v==="#text"){const d=document.createTextNode(C.value);_.push(d),P.append(d);continue}const l=(w=C==null?void 0:C.attributes)!=null&&w.xmlns?document.createElementNS(C.attributes.xmlns,v):document.createElement(v);if(P.append(l),C.attributes&&this.setAttributes({html:l,element:C,storage:rt,intent:m,linkService:R}),C.children&&C.children.length>0)j.push([C,-1,l]);else if(C.value){const d=document.createTextNode(C.value);n.XfaText.shouldBuildText(v)&&_.push(d),l.append(d)}}for(const p of k.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:_}}static update(L){const rt=`matrix(${L.viewport.transform.join(",")})`;L.div.style.transform=rt,L.div.hidden=!1}}e.XfaLayer=u},(g,e,D)=>{var y,m,O,j,k,_,w,p,E,P,C,v,l,d,I,Bn,c,Un,b,Wn,z,Hn,X,un,ct,$n,dt,fn,Et,Gn,M,Vn,o,zn,h,Xn,T,qn,W,oe,tt,pn,ht,Me,ut,De,Bt,pe,Lt,gn,nt,Le,pt,Yn,Ct,mn,Vt,Kn,zt,Jn,Ht,bn,ft,Oe,K,ge;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=D(1),u=D(4),$=D(29),L=D(6),rt=D(5);const vt=class vt extends u.AnnotationEditor{constructor(Q){super({...Q,name:"inkEditor"});H(this,I);H(this,c);H(this,b);H(this,z);H(this,X);H(this,ct);H(this,dt);H(this,Et);H(this,M);H(this,o);H(this,h);H(this,T);H(this,W);H(this,tt);H(this,ht);H(this,ut);H(this,Bt);H(this,Lt);H(this,nt);H(this,zt);H(this,Ht);H(this,ft);H(this,K);H(this,y,0);H(this,m,0);H(this,O,this.canvasPointermove.bind(this));H(this,j,this.canvasPointerleave.bind(this));H(this,k,this.canvasPointerup.bind(this));H(this,_,this.canvasPointerdown.bind(this));H(this,w,new Path2D);H(this,p,!1);H(this,E,!1);H(this,P,!1);H(this,C,null);H(this,v,0);H(this,l,0);H(this,d,null);this.color=Q.color||null,this.thickness=Q.thickness||null,this.opacity=Q.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Q){u.AnnotationEditor.initialize(Q,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Q,xt){switch(Q){case n.AnnotationEditorParamsType.INK_THICKNESS:vt._defaultThickness=xt;break;case n.AnnotationEditorParamsType.INK_COLOR:vt._defaultColor=xt;break;case n.AnnotationEditorParamsType.INK_OPACITY:vt._defaultOpacity=xt/100;break}}updateParams(Q,xt){switch(Q){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,I,Bn).call(this,xt);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,c,Un).call(this,xt);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,b,Wn).call(this,xt);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,vt._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,vt._defaultColor||u.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(vt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||vt._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||vt._defaultColor||u.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??vt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,ht,Me).call(this),Y(this,ut,De).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,Bt,pe).call(this)),Y(this,K,ge).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,C).disconnect(),ot(this,C,null),super.remove())}setParent(Q){!this.parent&&Q?this._uiManager.removeShouldRescale(this):this.parent&&Q===null&&this._uiManager.addShouldRescale(this),super.setParent(Q)}onScaleChanging(){const[Q,xt]=this.parentDimensions,It=this.width*Q,Pt=this.height*xt;this.setDimensions(It,Pt)}enableEditMode(){t(this,p)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,_)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,_)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,p)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ot(this,p,!0),this.div.classList.add("disabled"),Y(this,K,ge).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Q){this._focusEventsAllowed&&(super.focusin(Q),this.enableEditMode())}canvasPointerdown(Q){Q.button!==0||!this.isInEditMode()||t(this,p)||(this.setInForeground(),Q.preventDefault(),Q.type!=="mouse"&&this.div.focus(),Y(this,ct,$n).call(this,Q.offsetX,Q.offsetY))}canvasPointermove(Q){Q.preventDefault(),Y(this,dt,fn).call(this,Q.offsetX,Q.offsetY)}canvasPointerup(Q){Q.preventDefault(),Y(this,tt,pn).call(this,Q)}canvasPointerleave(Q){Y(this,tt,pn).call(this,Q)}get isResizable(){return!this.isEmpty()&&t(this,p)}render(){if(this.div)return this.div;let Q,xt;this.width&&(Q=this.x,xt=this.y),super.render(),u.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Qt=>{var yt;return(yt=this.div)==null?void 0:yt.setAttribute("aria-label",Qt)});const[It,Pt,Nt,jt]=Y(this,z,Hn).call(this);if(this.setAt(It,Pt,0,0),this.setDims(Nt,jt),Y(this,ht,Me).call(this),this.width){const[Qt,yt]=this.parentDimensions;this.setAspectRatio(this.width*Qt,this.height*yt),this.setAt(Q*Qt,xt*yt,this.width*Qt,this.height*yt),ot(this,P,!0),Y(this,Bt,pe).call(this),this.setDims(this.width*Qt,this.height*yt),Y(this,W,oe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,ut,De).call(this),this.div}setDimensions(Q,xt){const It=Math.round(Q),Pt=Math.round(xt);if(t(this,v)===It&&t(this,l)===Pt)return;ot(this,v,It),ot(this,l,Pt),this.canvas.style.visibility="hidden";const[Nt,jt]=this.parentDimensions;this.width=Q/Nt,this.height=xt/jt,this.fixAndSetPosition(),t(this,p)&&Y(this,Lt,gn).call(this,Q,xt),Y(this,Bt,pe).call(this),Y(this,W,oe).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Q,xt,It){var q,J,lt;if(Q instanceof $.InkAnnotationElement)return null;const Pt=super.deserialize(Q,xt,It);Pt.thickness=Q.thickness,Pt.color=n.Util.makeHexColor(...Q.color),Pt.opacity=Q.opacity;const[Nt,jt]=Pt.pageDimensions,Qt=Pt.width*Nt,yt=Pt.height*jt,Kt=Pt.parentScale,Ot=Q.thickness/2;ot(Pt,p,!0),ot(Pt,v,Math.round(Qt)),ot(Pt,l,Math.round(yt));const{paths:B,rect:s,rotation:x}=Q;for(let{bezier:_t}of B){_t=Y(q=vt,Vt,Kn).call(q,_t,s,x);const kt=[];Pt.paths.push(kt);let Rt=Kt*(_t[0]-Ot),qt=Kt*(_t[1]-Ot);for(let Dt=2,$t=_t.length;Dt<$t;Dt+=6){const Yt=Kt*(_t[Dt]-Ot),Jt=Kt*(_t[Dt+1]-Ot),Zt=Kt*(_t[Dt+2]-Ot),ie=Kt*(_t[Dt+3]-Ot),se=Kt*(_t[Dt+4]-Ot),re=Kt*(_t[Dt+5]-Ot);kt.push([[Rt,qt],[Yt,Jt],[Zt,ie],[se,re]]),Rt=se,qt=re}const Mt=Y(this,pt,Yn).call(this,kt);Pt.bezierPath2D.push(Mt)}const U=Y(J=Pt,Ht,bn).call(J);return ot(Pt,m,Math.max(u.AnnotationEditor.MIN_SIZE,U[2]-U[0])),ot(Pt,y,Math.max(u.AnnotationEditor.MIN_SIZE,U[3]-U[1])),Y(lt=Pt,Lt,gn).call(lt,Qt,yt),Pt}serialize(){if(this.isEmpty())return null;const Q=this.getRect(0,0),xt=u.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:xt,thickness:this.thickness,opacity:this.opacity,paths:Y(this,zt,Jn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Q),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};y=new WeakMap,m=new WeakMap,O=new WeakMap,j=new WeakMap,k=new WeakMap,_=new WeakMap,w=new WeakMap,p=new WeakMap,E=new WeakMap,P=new WeakMap,C=new WeakMap,v=new WeakMap,l=new WeakMap,d=new WeakMap,I=new WeakSet,Bn=function(Q){const xt=this.thickness;this.addCommands({cmd:()=>{this.thickness=Q,Y(this,K,ge).call(this)},undo:()=>{this.thickness=xt,Y(this,K,ge).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},c=new WeakSet,Un=function(Q){const xt=this.color;this.addCommands({cmd:()=>{this.color=Q,Y(this,W,oe).call(this)},undo:()=>{this.color=xt,Y(this,W,oe).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},b=new WeakSet,Wn=function(Q){Q/=100;const xt=this.opacity;this.addCommands({cmd:()=>{this.opacity=Q,Y(this,W,oe).call(this)},undo:()=>{this.opacity=xt,Y(this,W,oe).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},z=new WeakSet,Hn=function(){const{parentRotation:Q,parentDimensions:[xt,It]}=this;switch(Q){case 90:return[0,It,It,xt];case 180:return[xt,It,xt,It];case 270:return[xt,0,It,xt];default:return[0,0,xt,It]}},X=new WeakSet,un=function(){const{ctx:Q,color:xt,opacity:It,thickness:Pt,parentScale:Nt,scaleFactor:jt}=this;Q.lineWidth=Pt*Nt/jt,Q.lineCap="round",Q.lineJoin="round",Q.miterLimit=10,Q.strokeStyle=`${xt}${(0,rt.opacityToHex)(It)}`},ct=new WeakSet,$n=function(Q,xt){this.canvas.addEventListener("contextmenu",L.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,j)),this.canvas.addEventListener("pointermove",t(this,O)),this.canvas.addEventListener("pointerup",t(this,k)),this.canvas.removeEventListener("pointerdown",t(this,_)),this.isEditing=!0,t(this,P)||(ot(this,P,!0),Y(this,Bt,pe).call(this),this.thickness||(this.thickness=vt._defaultThickness),this.color||(this.color=vt._defaultColor||u.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=vt._defaultOpacity)),this.currentPath.push([Q,xt]),ot(this,E,!1),Y(this,X,un).call(this),ot(this,d,()=>{Y(this,o,zn).call(this),t(this,d)&&window.requestAnimationFrame(t(this,d))}),window.requestAnimationFrame(t(this,d))},dt=new WeakSet,fn=function(Q,xt){const[It,Pt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Q===It&&xt===Pt)return;const Nt=this.currentPath;let jt=t(this,w);if(Nt.push([Q,xt]),ot(this,E,!0),Nt.length<=2){jt.moveTo(...Nt[0]),jt.lineTo(Q,xt);return}Nt.length===3&&(ot(this,w,jt=new Path2D),jt.moveTo(...Nt[0])),Y(this,h,Xn).call(this,jt,...Nt.at(-3),...Nt.at(-2),Q,xt)},Et=new WeakSet,Gn=function(){if(this.currentPath.length===0)return;const Q=this.currentPath.at(-1);t(this,w).lineTo(...Q)},M=new WeakSet,Vn=function(Q,xt){ot(this,d,null),Q=Math.min(Math.max(Q,0),this.canvas.width),xt=Math.min(Math.max(xt,0),this.canvas.height),Y(this,dt,fn).call(this,Q,xt),Y(this,Et,Gn).call(this);let It;if(this.currentPath.length!==1)It=Y(this,T,qn).call(this);else{const yt=[Q,xt];It=[[yt,yt.slice(),yt.slice(),yt]]}const Pt=t(this,w),Nt=this.currentPath;this.currentPath=[],ot(this,w,new Path2D);const jt=()=>{this.allRawPaths.push(Nt),this.paths.push(It),this.bezierPath2D.push(Pt),this.rebuild()},Qt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,ht,Me).call(this),Y(this,ut,De).call(this)),Y(this,K,ge).call(this))};this.addCommands({cmd:jt,undo:Qt,mustExec:!0})},o=new WeakSet,zn=function(){if(!t(this,E))return;ot(this,E,!1);const Q=Math.ceil(this.thickness*this.parentScale),xt=this.currentPath.slice(-3),It=xt.map(jt=>jt[0]),Pt=xt.map(jt=>jt[1]);Math.min(...It)-Q,Math.max(...It)+Q,Math.min(...Pt)-Q,Math.max(...Pt)+Q;const{ctx:Nt}=this;Nt.save(),Nt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const jt of this.bezierPath2D)Nt.stroke(jt);Nt.stroke(t(this,w)),Nt.restore()},h=new WeakSet,Xn=function(Q,xt,It,Pt,Nt,jt,Qt){const yt=(xt+Pt)/2,Kt=(It+Nt)/2,Ot=(Pt+jt)/2,B=(Nt+Qt)/2;Q.bezierCurveTo(yt+2*(Pt-yt)/3,Kt+2*(Nt-Kt)/3,Ot+2*(Pt-Ot)/3,B+2*(Nt-B)/3,Ot,B)},T=new WeakSet,qn=function(){const Q=this.currentPath;if(Q.length<=2)return[[Q[0],Q[0],Q.at(-1),Q.at(-1)]];const xt=[];let It,[Pt,Nt]=Q[0];for(It=1;It<Q.length-2;It++){const[s,x]=Q[It],[U,q]=Q[It+1],J=(s+U)/2,lt=(x+q)/2,_t=[Pt+2*(s-Pt)/3,Nt+2*(x-Nt)/3],kt=[J+2*(s-J)/3,lt+2*(x-lt)/3];xt.push([[Pt,Nt],_t,kt,[J,lt]]),[Pt,Nt]=[J,lt]}const[jt,Qt]=Q[It],[yt,Kt]=Q[It+1],Ot=[Pt+2*(jt-Pt)/3,Nt+2*(Qt-Nt)/3],B=[yt+2*(jt-yt)/3,Kt+2*(Qt-Kt)/3];return xt.push([[Pt,Nt],Ot,B,[yt,Kt]]),xt},W=new WeakSet,oe=function(){if(this.isEmpty()){Y(this,nt,Le).call(this);return}Y(this,X,un).call(this);const{canvas:Q,ctx:xt}=this;xt.setTransform(1,0,0,1,0,0),xt.clearRect(0,0,Q.width,Q.height),Y(this,nt,Le).call(this);for(const It of this.bezierPath2D)xt.stroke(It)},tt=new WeakSet,pn=function(Q){this.canvas.removeEventListener("pointerleave",t(this,j)),this.canvas.removeEventListener("pointermove",t(this,O)),this.canvas.removeEventListener("pointerup",t(this,k)),this.canvas.addEventListener("pointerdown",t(this,_)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",L.noContextMenu)},10),Y(this,M,Vn).call(this,Q.offsetX,Q.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ht=new WeakSet,Me=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",u.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Q=>{var xt;return(xt=this.canvas)==null?void 0:xt.setAttribute("aria-label",Q)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ut=new WeakSet,De=function(){ot(this,C,new ResizeObserver(Q=>{const xt=Q[0].contentRect;xt.width&&xt.height&&this.setDimensions(xt.width,xt.height)})),t(this,C).observe(this.div)},Bt=new WeakSet,pe=function(){if(!t(this,P))return;const[Q,xt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Q),this.canvas.height=Math.ceil(this.height*xt),Y(this,nt,Le).call(this)},Lt=new WeakSet,gn=function(Q,xt){const It=Y(this,ft,Oe).call(this),Pt=(Q-It)/t(this,m),Nt=(xt-It)/t(this,y);this.scaleFactor=Math.min(Pt,Nt)},nt=new WeakSet,Le=function(){const Q=Y(this,ft,Oe).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Q,this.translationY*this.scaleFactor+Q)},pt=new WeakSet,Yn=function(Q){const xt=new Path2D;for(let It=0,Pt=Q.length;It<Pt;It++){const[Nt,jt,Qt,yt]=Q[It];It===0&&xt.moveTo(...Nt),xt.bezierCurveTo(jt[0],jt[1],Qt[0],Qt[1],yt[0],yt[1])}return xt},Ct=new WeakSet,mn=function(Q,xt,It){const[Pt,Nt,jt,Qt]=xt;switch(It){case 0:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]+=Pt,Q[yt+1]=Qt-Q[yt+1];break;case 90:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=Q[yt+1]+Pt,Q[yt+1]=Ot+Nt}break;case 180:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]=jt-Q[yt],Q[yt+1]+=Nt;break;case 270:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=jt-Q[yt+1],Q[yt+1]=Qt-Ot}break;default:throw new Error("Invalid rotation")}return Q},Vt=new WeakSet,Kn=function(Q,xt,It){const[Pt,Nt,jt,Qt]=xt;switch(It){case 0:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]-=Pt,Q[yt+1]=Qt-Q[yt+1];break;case 90:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=Q[yt+1]-Nt,Q[yt+1]=Ot-Pt}break;case 180:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]=jt-Q[yt],Q[yt+1]-=Nt;break;case 270:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=Qt-Q[yt+1],Q[yt+1]=jt-Ot}break;default:throw new Error("Invalid rotation")}return Q},zt=new WeakSet,Jn=function(Q,xt,It,Pt){var Kt,Ot;const Nt=[],jt=this.thickness/2,Qt=Q*xt+jt,yt=Q*It+jt;for(const B of this.paths){const s=[],x=[];for(let U=0,q=B.length;U<q;U++){const[J,lt,_t,kt]=B[U],Rt=Q*J[0]+Qt,qt=Q*J[1]+yt,Mt=Q*lt[0]+Qt,Dt=Q*lt[1]+yt,$t=Q*_t[0]+Qt,Yt=Q*_t[1]+yt,Jt=Q*kt[0]+Qt,Zt=Q*kt[1]+yt;U===0&&(s.push(Rt,qt),x.push(Rt,qt)),s.push(Mt,Dt,$t,Yt,Jt,Zt),x.push(Mt,Dt),U===q-1&&x.push(Jt,Zt)}Nt.push({bezier:Y(Kt=vt,Ct,mn).call(Kt,s,Pt,this.rotation),points:Y(Ot=vt,Ct,mn).call(Ot,x,Pt,this.rotation)})}return Nt},Ht=new WeakSet,bn=function(){let Q=1/0,xt=-1/0,It=1/0,Pt=-1/0;for(const Nt of this.paths)for(const[jt,Qt,yt,Kt]of Nt){const Ot=n.Util.bezierBoundingBox(...jt,...Qt,...yt,...Kt);Q=Math.min(Q,Ot[0]),It=Math.min(It,Ot[1]),xt=Math.max(xt,Ot[2]),Pt=Math.max(Pt,Ot[3])}return[Q,It,xt,Pt]},ft=new WeakSet,Oe=function(){return t(this,p)?Math.ceil(this.thickness*this.parentScale):0},K=new WeakSet,ge=function(Q=!1){if(this.isEmpty())return;if(!t(this,p)){Y(this,W,oe).call(this);return}const xt=Y(this,Ht,bn).call(this),It=Y(this,ft,Oe).call(this);ot(this,m,Math.max(u.AnnotationEditor.MIN_SIZE,xt[2]-xt[0])),ot(this,y,Math.max(u.AnnotationEditor.MIN_SIZE,xt[3]-xt[1]));const Pt=Math.ceil(It+t(this,m)*this.scaleFactor),Nt=Math.ceil(It+t(this,y)*this.scaleFactor),[jt,Qt]=this.parentDimensions;this.width=Pt/jt,this.height=Nt/Qt,this.setAspectRatio(Pt,Nt);const yt=this.translationX,Kt=this.translationY;this.translationX=-xt[0],this.translationY=-xt[1],Y(this,Bt,pe).call(this),Y(this,W,oe).call(this),ot(this,v,Pt),ot(this,l,Nt),this.setDims(Pt,Nt);const Ot=Q?It/this.scaleFactor/2:0;this.translate(yt-this.translationX-Ot,Kt-this.translationY-Ot)},H(vt,pt),H(vt,Ct),H(vt,Vt),ne(vt,"_defaultColor",null),ne(vt,"_defaultOpacity",1),ne(vt,"_defaultThickness",1),ne(vt,"_type","ink");let R=vt;e.InkEditor=R},(g,e,D)=>{var R,y,m,O,j,k,_,w,p,E,P,Ee,v,Se,d,Ie,A,_n,F,Qn,G,Zn,S,An,at,Ne,V,ts;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=D(1),u=D(4),$=D(6),L=D(29);const mt=class mt extends u.AnnotationEditor{constructor(M){super({...M,name:"stampEditor"});H(this,P);H(this,v);H(this,d);H(this,A);H(this,F);H(this,G);H(this,S);H(this,at);H(this,V);H(this,R,null);H(this,y,null);H(this,m,null);H(this,O,null);H(this,j,null);H(this,k,null);H(this,_,null);H(this,w,null);H(this,p,!1);H(this,E,!1);ot(this,O,M.bitmapUrl),ot(this,j,M.bitmapFile)}static initialize(M){u.AnnotationEditor.initialize(M)}static get supportedTypes(){const M=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",M.map(i=>`image/${i}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(M){return this.supportedTypes.includes(M)}static paste(M,i){i.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:M.getAsFile()})}remove(){var M,i;t(this,y)&&(ot(this,R,null),this._uiManager.imageManager.deleteId(t(this,y)),(M=t(this,k))==null||M.remove(),ot(this,k,null),(i=t(this,_))==null||i.disconnect(),ot(this,_,null)),super.remove()}rebuild(){if(!this.parent){t(this,y)&&Y(this,d,Ie).call(this);return}super.rebuild(),this.div!==null&&(t(this,y)&&Y(this,d,Ie).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,m)||t(this,R)||t(this,O)||t(this,j))}get isResizable(){return!0}render(){if(this.div)return this.div;let M,i;if(this.width&&(M=this.x,i=this.y),super.render(),this.div.hidden=!0,t(this,R)?Y(this,A,_n).call(this):Y(this,d,Ie).call(this),this.width){const[o,a]=this.parentDimensions;this.setAt(M*o,i*a,this.width*o,this.height*a)}return this.div}static deserialize(M,i,o){if(M instanceof L.StampAnnotationElement)return null;const a=super.deserialize(M,i,o),{rect:h,bitmapUrl:f,bitmapId:T,isSvg:N,accessibilityData:W}=M;T&&o.imageManager.isValidId(T)?ot(a,y,T):ot(a,O,f),ot(a,p,N);const[it,tt]=a.pageDimensions;return a.width=(h[2]-h[0])/it,a.height=(h[3]-h[1])/tt,W&&(a.altTextData=W),a}serialize(M=!1,i=null){if(this.isEmpty())return null;const o={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,y),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,p),structTreeParentId:this._structTreeParentId};if(M)return o.bitmapUrl=Y(this,at,Ne).call(this,!0),o.accessibilityData=this.altTextData,o;const{decorative:a,altText:h}=this.altTextData;if(!a&&h&&(o.accessibilityData={type:"Figure",alt:h}),i===null)return o;i.stamps||(i.stamps=new Map);const f=t(this,p)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!i.stamps.has(t(this,y)))i.stamps.set(t(this,y),{area:f,serialized:o}),o.bitmap=Y(this,at,Ne).call(this,!1);else if(t(this,p)){const T=i.stamps.get(t(this,y));f>T.area&&(T.area=f,T.serialized.bitmap.close(),T.serialized.bitmap=Y(this,at,Ne).call(this,!1))}return o}};R=new WeakMap,y=new WeakMap,m=new WeakMap,O=new WeakMap,j=new WeakMap,k=new WeakMap,_=new WeakMap,w=new WeakMap,p=new WeakMap,E=new WeakMap,P=new WeakSet,Ee=function(M,i=!1){if(!M){this.remove();return}ot(this,R,M.bitmap),i||(ot(this,y,M.id),ot(this,p,M.isSvg)),Y(this,A,_n).call(this)},v=new WeakSet,Se=function(){ot(this,m,null),this._uiManager.enableWaiting(!1),t(this,k)&&this.div.focus()},d=new WeakSet,Ie=function(){if(t(this,y)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,y)).then(i=>Y(this,P,Ee).call(this,i,!0)).finally(()=>Y(this,v,Se).call(this));return}if(t(this,O)){const i=t(this,O);ot(this,O,null),this._uiManager.enableWaiting(!0),ot(this,m,this._uiManager.imageManager.getFromUrl(i).then(o=>Y(this,P,Ee).call(this,o)).finally(()=>Y(this,v,Se).call(this)));return}if(t(this,j)){const i=t(this,j);ot(this,j,null),this._uiManager.enableWaiting(!0),ot(this,m,this._uiManager.imageManager.getFromFile(i).then(o=>Y(this,P,Ee).call(this,o)).finally(()=>Y(this,v,Se).call(this)));return}const M=document.createElement("input");M.type="file",M.accept=mt.supportedTypesStr,ot(this,m,new Promise(i=>{M.addEventListener("change",async()=>{if(!M.files||M.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(M.files[0]);Y(this,P,Ee).call(this,o)}i()}),M.addEventListener("cancel",()=>{this.remove(),i()})}).finally(()=>Y(this,v,Se).call(this))),M.click()},A=new WeakSet,_n=function(){const{div:M}=this;let{width:i,height:o}=t(this,R);const[a,h]=this.pageDimensions,f=.75;if(this.width)i=this.width*a,o=this.height*h;else if(i>f*a||o>f*h){const it=Math.min(f*a/i,f*h/o);i*=it,o*=it}const[T,N]=this.parentDimensions;this.setDims(i*T/a,o*N/h),this._uiManager.enableWaiting(!1);const W=ot(this,k,document.createElement("canvas"));M.append(W),M.hidden=!1,Y(this,S,An).call(this,i,o),Y(this,V,ts).call(this),t(this,E)||(this.parent.addUndoableEditor(this),ot(this,E,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},F=new WeakSet,Qn=function(M,i){var f;const[o,a]=this.parentDimensions;this.width=M/o,this.height=i/a,this.setDims(M,i),(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,w)!==null&&clearTimeout(t(this,w)),ot(this,w,setTimeout(()=>{ot(this,w,null),Y(this,S,An).call(this,M,i)},200))},G=new WeakSet,Zn=function(M,i){const{width:o,height:a}=t(this,R);let h=o,f=a,T=t(this,R);for(;h>2*M||f>2*i;){const N=h,W=f;h>2*M&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2)),f>2*i&&(f=f>=16384?Math.floor(f/2)-1:Math.ceil(f/2));const it=new OffscreenCanvas(h,f);it.getContext("2d").drawImage(T,0,0,N,W,0,0,h,f),T=it.transferToImageBitmap()}return T},S=new WeakSet,An=function(M,i){M=Math.ceil(M),i=Math.ceil(i);const o=t(this,k);if(!o||o.width===M&&o.height===i)return;o.width=M,o.height=i;const a=t(this,p)?t(this,R):Y(this,G,Zn).call(this,M,i),h=o.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(a,0,0,a.width,a.height,0,0,M,i)},at=new WeakSet,Ne=function(M){if(M){if(t(this,p)){const a=this._uiManager.imageManager.getSvgUrl(t(this,y));if(a)return a}const i=document.createElement("canvas");return{width:i.width,height:i.height}=t(this,R),i.getContext("2d").drawImage(t(this,R),0,0),i.toDataURL()}if(t(this,p)){const[i,o]=this.pageDimensions,a=Math.round(this.width*i*$.PixelsPerInch.PDF_TO_CSS_UNITS),h=Math.round(this.height*o*$.PixelsPerInch.PDF_TO_CSS_UNITS),f=new OffscreenCanvas(a,h);return f.getContext("2d").drawImage(t(this,R),0,0,t(this,R).width,t(this,R).height,0,0,a,h),f.transferToImageBitmap()}return structuredClone(t(this,R))},V=new WeakSet,ts=function(){ot(this,_,new ResizeObserver(M=>{const i=M[0].contentRect;i.width&&i.height&&Y(this,F,Qn).call(this,i.width,i.height)})),t(this,_).observe(this.div)},ne(mt,"_type","stamp");let rt=mt;e.StampEditor=rt}],__webpack_module_cache__={};function __w_pdfjs_require__(g){var e=__webpack_module_cache__[g];if(e!==void 0)return e.exports;var D=__webpack_module_cache__[g]={exports:{}};return __webpack_modules__[g](D,D.exports,__w_pdfjs_require__),D.exports}var __webpack_exports__={};return(()=>{var g=__webpack_exports__;Object.defineProperty(g,"__esModule",{value:!0}),Object.defineProperty(g,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(g,"AnnotationEditorLayer",{enumerable:!0,get:function(){return $.AnnotationEditorLayer}}),Object.defineProperty(g,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(g,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(g,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return L.AnnotationEditorUIManager}}),Object.defineProperty(g,"AnnotationLayer",{enumerable:!0,get:function(){return rt.AnnotationLayer}}),Object.defineProperty(g,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(g,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(g,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(g,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(g,"GlobalWorkerOptions",{enumerable:!0,get:function(){return R.GlobalWorkerOptions}}),Object.defineProperty(g,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(g,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(g,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(g,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(g,"PDFDataRangeTransport",{enumerable:!0,get:function(){return D.PDFDataRangeTransport}}),Object.defineProperty(g,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(g,"PDFWorker",{enumerable:!0,get:function(){return D.PDFWorker}}),Object.defineProperty(g,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(g,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(g,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(g,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(g,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(g,"SVGGraphics",{enumerable:!0,get:function(){return D.SVGGraphics}}),Object.defineProperty(g,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(g,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(g,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(g,"XfaLayer",{enumerable:!0,get:function(){return y.XfaLayer}}),Object.defineProperty(g,"build",{enumerable:!0,get:function(){return D.build}}),Object.defineProperty(g,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(g,"getDocument",{enumerable:!0,get:function(){return D.getDocument}}),Object.defineProperty(g,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(g,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(g,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(g,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(g,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(g,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(g,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(g,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(g,"renderTextLayer",{enumerable:!0,get:function(){return u.renderTextLayer}}),Object.defineProperty(g,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(g,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(g,"updateTextLayer",{enumerable:!0,get:function(){return u.updateTextLayer}}),Object.defineProperty(g,"version",{enumerable:!0,get:function(){return D.version}});var e=__w_pdfjs_require__(1),D=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),u=__w_pdfjs_require__(26),$=__w_pdfjs_require__(27),L=__w_pdfjs_require__(5),rt=__w_pdfjs_require__(29),R=__w_pdfjs_require__(14),y=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;var __spreadArray=globalThis&&globalThis.__spreadArray||function(g,e,D){if(D||arguments.length===2)for(var n=0,u=e.length,$;n<u;n++)($||!(n in e))&&($||($=Array.prototype.slice.call(e,0,n)),$[n]=e[n]);return g.concat($||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(g,e){var D={};return allEvents.forEach(function(n){var u=g[n];u&&(e?D[n]=function($){return u($,e(n))}:D[n]=u)}),D}function makeCancellablePromise(g){var e=!1,D=new Promise(function(n,u){g.then(function($){return!e&&n($)}).catch(function($){return!e&&u($)})});return{promise:D,cancel:function(){e=!0}}}function r(g){var e,D,n="";if(typeof g=="string"||typeof g=="number")n+=g;else if(typeof g=="object")if(Array.isArray(g))for(e=0;e<g.length;e++)g[e]&&(D=r(g[e]))&&(n&&(n+=" "),n+=D);else for(e in g)g[e]&&(n&&(n+=" "),n+=e);return n}function clsx(){for(var g,e,D=0,n="";D<arguments.length;)(g=arguments[D++])&&(e=r(g))&&(n&&(n+=" "),n+=e);return n}const DocumentContext=reactExports.createContext(null);function Message({children:g,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},g)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(D=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(e,"Destination is not specified."),typeof e=="string"?this.pdfDocument.getDestination(e).then(D):Array.isArray(e)?D(e):e.then(D)}).then(D=>{invariant(Array.isArray(D),`"${D}" is not a valid destination array.`);const n=D[0];new Promise(u=>{invariant(this.pdfDocument,"PDF document not loaded."),n instanceof Object?this.pdfDocument.getPageIndex(n).then($=>{u($)}).catch(()=>{invariant(!1,`"${n}" is not a valid page reference.`)}):typeof n=="number"?u(n):invariant(!1,`"${n}" is not a valid destination reference.`)}).then(u=>{const $=u+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant($>=1&&$<=this.pagesCount,`"${$}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:D,pageIndex:u,pageNumber:$})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const D=e-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(e>=1&&e<=this.pagesCount,`"${e}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:D,pageNumber:e})}addLinkAttributes(e,D,n){e.href=D,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(g){return typeof g<"u"}function isProvided(g){return isDefined(g)&&g!==null}function isString(g){return typeof g=="string"}function isArrayBuffer(g){return g instanceof ArrayBuffer}function isBlob(g){return invariant(isBrowser,"isBlob can only be used in a browser environment"),g instanceof Blob}function isDataURI(g){return isString(g)&&/^data:/.test(g)}function dataURItoByteString(g){invariant(isDataURI(g),"Invalid data URI.");const[e="",D=""]=g.split(",");return e.split(";").indexOf("base64")!==-1?atob(D):unescape(D)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(g){g&&g.cancel&&g.cancel()}function makePageCallback(g,e){return Object.defineProperty(g,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(g,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(g,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(g,"originalHeight",{get(){return this.view[3]},configurable:!0}),g}function isCancelException(g){return g.name==="RenderingCancelledException"}function loadFromFile(g){return new Promise((e,D)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return D(new Error("Error while reading a file."));e(n.result)},n.onerror=u=>{if(!u.target)return D(new Error("Error while reading a file."));const{error:$}=u.target;if(!$)return D(new Error("Error while reading a file."));switch($.code){case $.NOT_FOUND_ERR:return D(new Error("Error while reading a file: File not found."));case $.SECURITY_ERR:return D(new Error("Error while reading a file: Security error."));case $.ABORT_ERR:return D(new Error("Error while reading a file: Aborted."));default:return D(new Error("Error while reading a file."))}},n.readAsArrayBuffer(g)})}function reducer(g,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return g}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs$1,eventProps=(()=>{const g={};return allEvents.forEach(e=>{g[e]=_pt.func}),g})(),isTypedArray=_pt.oneOfType([_pt.instanceOf(Int8Array),_pt.instanceOf(Uint8Array),_pt.instanceOf(Uint8ClampedArray),_pt.instanceOf(Int16Array),_pt.instanceOf(Uint16Array),_pt.instanceOf(Int32Array),_pt.instanceOf(Uint32Array),_pt.instanceOf(Float32Array),_pt.instanceOf(Float64Array)]),fileTypes=[_pt.string,_pt.instanceOf(ArrayBuffer),_pt.shape({data:_pt.oneOfType([_pt.string,_pt.instanceOf(ArrayBuffer),_pt.arrayOf(_pt.number.isRequired),isTypedArray]).isRequired}),_pt.shape({range:_pt.instanceOf(PDFDataRangeTransport$1).isRequired}),_pt.shape({url:_pt.string.isRequired})];typeof Blob<"u"&&fileTypes.push(_pt.instanceOf(Blob));const isClassName=_pt.oneOfType([_pt.string,_pt.arrayOf(_pt.string)]),isFile=_pt.oneOfType(fileTypes);_pt.instanceOf(LinkService);_pt.oneOf(["_self","_blank","_parent","_top"]);_pt.shape({commonObjs:_pt.shape({}).isRequired,getAnnotations:_pt.func.isRequired,getTextContent:_pt.func.isRequired,getViewport:_pt.func.isRequired,render:_pt.func.isRequired});const isPageIndex=function g(e,D,n){const{[D]:u,pageNumber:$,pdf:L}=e;if(!isDefined(L))return null;if(isDefined(u)){if(typeof u!="number")return new Error(`\`${D}\` of type \`${typeof u}\` supplied to \`${n}\`, expected \`number\`.`);if(u<0)return new Error(`Expected \`${D}\` to be greater or equal to 0.`);const{numPages:rt}=L;if(u+1>rt)return new Error(`Expected \`${D}\` to be less or equal to ${rt-1}.`)}else if(!isDefined($))return new Error(`\`${D}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPageNumber=function g(e,D,n){const{[D]:u,pageIndex:$,pdf:L}=e;if(!isDefined(L))return null;if(isDefined(u)){if(typeof u!="number")return new Error(`\`${D}\` of type \`${typeof u}\` supplied to \`${n}\`, expected \`number\`.`);if(u<1)return new Error(`Expected \`${D}\` to be greater or equal to 1.`);const{numPages:rt}=L;if(u>rt)return new Error(`Expected \`${D}\` to be less or equal to ${rt}.`)}else if(!isDefined($))return new Error(`\`${D}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPdf=_pt.oneOfType([_pt.any,_pt.oneOf([!1])]),isRef=_pt.oneOfType([_pt.func,_pt.exact({current:_pt.any})]),isRenderMode=_pt.oneOf(["canvas","custom","none","svg"]),isRotate=_pt.oneOf([0,90,180,270]);var __awaiter=globalThis&&globalThis.__awaiter||function(g,e,D,n){function u($){return $ instanceof D?$:new D(function(L){L($)})}return new(D||(D=Promise))(function($,L){function rt(m){try{y(n.next(m))}catch(O){L(O)}}function R(m){try{y(n.throw(m))}catch(O){L(O)}}function y(m){m.done?$(m.value):u(m.value).then(rt,R)}y((n=n.apply(g,e||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(g,e){var D={};for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&e.indexOf(n)<0&&(D[n]=g[n]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(g);u<n.length;u++)e.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(g,n[u])&&(D[n[u]]=g[n[u]]);return D};const{PDFDataRangeTransport}=pdfjs$1,defaultOnPassword=(g,e)=>{switch(e){case PasswordResponses$1.NEED_PASSWORD:{const D=prompt("Enter the password to open this PDF file.");g(D);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const D=prompt("Invalid password. Please try again.");g(D);break}}},Document=reactExports.forwardRef(function g(e,D){var{children:n,className:u,error:$="Failed to load PDF file.",externalLinkRel:L,externalLinkTarget:rt,file:R,inputRef:y,imageResourcesPath:m,loading:O="Loading PDF…",noData:j="No PDF file specified.",onItemClick:k,onLoadError:_,onLoadProgress:w,onLoadSuccess:p,onPassword:E=defaultOnPassword,onSourceError:P,onSourceSuccess:C,options:v,renderMode:l,rotate:d}=e,I=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[A,c]=useResolver(),{value:F,error:b}=A,[G,z]=useResolver(),{value:S,error:X}=G,at=reactExports.useRef(new LinkService),ct=reactExports.useRef([]),V=reactExports.useRef({scrollPageIntoView:et=>{const{dest:ht,pageNumber:bt,pageIndex:ut=bt-1}=et;if(k){k({dest:ht,pageIndex:ut,pageNumber:bt});return}const Ft=ct.current[ut];if(Ft){Ft.scrollIntoView();return}warning(!1,`An internal link leading to page ${bt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(D,()=>({linkService:at,pages:ct,viewer:V}),[]);function dt(){C&&C()}function mt(){b&&(warning(!1,b.toString()),P&&P(b))}function Et(){c({type:"RESET"})}reactExports.useEffect(Et,[R,c]);const wt=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!R)return null;if(typeof R=="string")return isDataURI(R)?{data:dataURItoByteString(R)}:(displayCORSWarning(),{url:R});if(R instanceof PDFDataRangeTransport)return{range:R};if(isArrayBuffer(R))return{data:R};if(isBrowser&&isBlob(R))return{data:yield loadFromFile(R)};if(invariant(typeof R=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant("data"in R||"range"in R||"url"in R,"Invalid parameter object: need either .data, .range or .url"),"url"in R&&typeof R.url=="string"){if(isDataURI(R.url)){const{url:et}=R,ht=__rest$1(R,["url"]),bt=dataURItoByteString(et);return Object.assign({data:bt},ht)}displayCORSWarning()}return R}),[R]);reactExports.useEffect(()=>{const et=makeCancellablePromise(wt());return et.promise.then(ht=>{c({type:"RESOLVE",value:ht})}).catch(ht=>{c({type:"REJECT",error:ht})}),()=>{cancelRunningTask(et)}},[wt,c]),reactExports.useEffect(()=>{if(!(typeof F>"u")){if(F===!1){mt();return}dt()}},[F]);function M(){S&&(p&&p(S),ct.current=new Array(S.numPages),at.current.setDocument(S))}function i(){X&&(warning(!1,X.toString()),_&&_(X))}function o(){z({type:"RESET"})}reactExports.useEffect(o,[z,F]);function a(){if(!F)return;const et=v?Object.assign(Object.assign({},F),v):F,ht=pdfjs$1.getDocument(et);w&&(ht.onProgress=w),E&&(ht.onPassword=E);const bt=ht;return bt.promise.then(ut=>{z({type:"RESOLVE",value:ut})}).catch(ut=>{bt.destroyed||z({type:"REJECT",error:ut})}),()=>{bt.destroy()}}reactExports.useEffect(a,[v,z,F]),reactExports.useEffect(()=>{if(!(typeof S>"u")){if(S===!1){i();return}M()}},[S]);function h(){at.current.setViewer(V.current),at.current.setExternalLinkRel(L),at.current.setExternalLinkTarget(rt)}reactExports.useEffect(h,[L,rt]);function f(et,ht){ct.current[et]=ht}function T(et){delete ct.current[et]}const N=reactExports.useMemo(()=>({imageResourcesPath:m,linkService:at.current,onItemClick:k,pdf:S,registerPage:f,renderMode:l,rotate:d,unregisterPage:T}),[m,k,S,l,d]),W=reactExports.useMemo(()=>makeEventProps(I,()=>S),[I,S]);function it(){return React.createElement(DocumentContext.Provider,{value:N},n)}function tt(){return R?S==null?React.createElement(Message,{type:"loading"},typeof O=="function"?O():O):S===!1?React.createElement(Message,{type:"error"},typeof $=="function"?$():$):it():React.createElement(Message,{type:"no-data"},typeof j=="function"?j():j)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",u),ref:y,style:{"--scale-factor":"1"}},W),tt())}),isFunctionOrNode$1=_pt.oneOfType([_pt.func,_pt.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:_pt.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:_pt.string,externalLinkTarget:_pt.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:_pt.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:_pt.func,onLoadError:_pt.func,onLoadProgress:_pt.func,onLoadSuccess:_pt.func,onPassword:_pt.func,onSourceError:_pt.func,onSourceSuccess:_pt.func,options:_pt.shape({canvasFactory:_pt.any,canvasMaxAreaInBytes:_pt.number,cMapPacked:_pt.bool,CMapReaderFactory:_pt.any,cMapUrl:_pt.string,disableAutoFetch:_pt.bool,disableFontFace:_pt.bool,disableRange:_pt.bool,disableStream:_pt.bool,docBaseUrl:_pt.string,enableXfa:_pt.bool,filterFactory:_pt.any,fontExtraProperties:_pt.bool,httpHeaders:_pt.object,isEvalSupported:_pt.bool,isOffscreenCanvasSupported:_pt.bool,length:_pt.number,maxImageSize:_pt.number,ownerDocument:_pt.any,password:_pt.string,pdfBug:_pt.bool,rangeChunkSize:_pt.number,StandardFontDataFactory:_pt.any,standardFontDataUrl:_pt.string,stopAtErrors:_pt.bool,useSystemFonts:_pt.bool,useWorkerFetch:_pt.bool,verbosity:_pt.number,withCredentials:_pt.bool,worker:_pt.any}),rotate:_pt.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var g=[],e=0;e<arguments.length;e++)g[e]=arguments[e];var D=g.filter(Boolean);if(D.length<=1){var n=D[0];return n||null}return function($){D.forEach(function(L){typeof L=="function"?L($):L&&(L.current=$)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(g){return g in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(g){return"children"in g}function isStructTreeNodeWithOnlyContentChild(g){return isStructTreeNode(g)?g.children.length===1&&0 in g.children&&"id"in g.children[0]:!1}function getRoleAttributes(g){const e={};if(isStructTreeNode(g)){const{role:D}=g,n=D.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(D)){const u=PDF_ROLE_TO_HTML_ROLE[D];u&&(e.role=u)}}return e}function getBaseAttributes(g){const e={};if(isStructTreeNode(g)){if(g.alt!==void 0&&(e["aria-label"]=g.alt),g.lang!==void 0&&(e.lang=g.lang),isStructTreeNodeWithOnlyContentChild(g)){const[D]=g.children;if(D){const n=getBaseAttributes(D);return Object.assign(Object.assign({},e),n)}}}else"id"in g&&(e["aria-owns"]=g.id);return e}function getAttributes(g){return g?Object.assign(Object.assign({},getRoleAttributes(g)),getBaseAttributes(g)):null}function StructTreeItem({className:g,node:e}){const D=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((u,$)=>React.createElement(StructTreeItem,{key:$,node:u})),[e]);return React.createElement("span",Object.assign({className:g},D),n)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const g=usePageContext();invariant(g,"Unable to find Page context.");const{onGetStructTreeError:e,onGetStructTreeSuccess:D}=g,[n,u]=useResolver(),{value:$,error:L}=n,{customTextRenderer:rt,page:R}=g;function y(){$&&D&&D($)}function m(){L&&(warning(!1,L.toString()),e&&e(L))}function O(){u({type:"RESET"})}reactExports.useEffect(O,[u,R]);function j(){if(rt||!R)return;const k=makeCancellablePromise(R.getStructTree()),_=k;return k.promise.then(w=>{u({type:"RESOLVE",value:w})}).catch(w=>{u({type:"REJECT",error:w})}),()=>cancelRunningTask(_)}return reactExports.useEffect(j,[rt,R,u]),reactExports.useEffect(()=>{if($!==void 0){if($===!1){m();return}y()}},[$]),$?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:$}):null}const ANNOTATION_MODE=pdfjs$1.AnnotationMode;function PageCanvas(g){const e=usePageContext();invariant(e,"Unable to find Page context.");const D=Object.assign(Object.assign({},e),g),{_className:n,canvasBackground:u,devicePixelRatio:$=getDevicePixelRatio(),onRenderError:L,onRenderSuccess:rt,page:R,renderForms:y,renderTextLayer:m,rotate:O,scale:j}=D,{canvasRef:k}=g;invariant(R,"Attempted to render page canvas, but no page was specified.");const _=reactExports.useRef(null);function w(){R&&rt&&rt(makePageCallback(R,j))}function p(l){isCancelException(l)||(warning(!1,l.toString()),L&&L(l))}const E=reactExports.useMemo(()=>R.getViewport({scale:j*$,rotation:O}),[$,R,O,j]),P=reactExports.useMemo(()=>R.getViewport({scale:j,rotation:O}),[R,O,j]);function C(){if(!R)return;R.cleanup();const{current:l}=_;if(!l)return;l.width=E.width,l.height=E.height,l.style.width=`${Math.floor(P.width)}px`,l.style.height=`${Math.floor(P.height)}px`,l.style.visibility="hidden";const d={annotationMode:y?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:l.getContext("2d",{alpha:!1}),viewport:E};u&&(d.background=u);const I=R.render(d),A=I;return I.promise.then(()=>{l.style.visibility="",w()}).catch(p),()=>cancelRunningTask(A)}reactExports.useEffect(C,[u,_,$,R,y,E,P]);const v=reactExports.useCallback(()=>{const{current:l}=_;l&&(l.width=0,l.height=0)},[_]);return reactExports.useEffect(()=>v,[v]),React.createElement("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(k,_),style:{display:"block",userSelect:"none"}},m?React.createElement(StructTree,null):null)}function PageSVG(){const g=usePageContext();invariant(g,"Unable to find Page context.");const{_className:e,onRenderSuccess:D,onRenderError:n,page:u,rotate:$,scale:L}=g;invariant(u,"Attempted to render page SVG, but no page was specified.");const[rt,R]=useResolver(),{value:y,error:m}=rt;function O(){u&&D&&D(makePageCallback(u,L))}function j(){m&&(isCancelException(m)||(warning(!1,m.toString()),n&&n(m)))}const k=reactExports.useMemo(()=>u.getViewport({scale:L,rotation:$}),[u,$,L]);function _(){R({type:"RESET"})}reactExports.useEffect(_,[u,R,k]);function w(){if(!u)return;const C=makeCancellablePromise(u.getOperatorList());return C.promise.then(v=>{new pdfjs$1.SVGGraphics(u.commonObjs,u.objs).getSVG(v,k).then(d=>{if(!(d instanceof SVGElement))throw new Error("getSVG returned unexpected result.");R({type:"RESOLVE",value:d})}).catch(d=>{R({type:"REJECT",error:d})})}).catch(v=>{R({type:"REJECT",error:v})}),()=>cancelRunningTask(C)}reactExports.useEffect(w,[u,R,k]),reactExports.useEffect(()=>{if(y!==void 0){if(y===!1){j();return}O()}},[y]);function p(C){if(!C||!y)return;C.firstElementChild||C.appendChild(y);const{width:v,height:l}=k;y.setAttribute("width",`${v}`),y.setAttribute("height",`${l}`)}const{width:E,height:P}=k;return React.createElement("div",{className:`${e}__svg`,ref:C=>p(C),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:E,height:P,userSelect:"none"}})}function isTextItem(g){return"str"in g}function TextLayer$1(){const g=usePageContext();invariant(g,"Unable to find Page context.");const{customTextRenderer:e,onGetTextError:D,onGetTextSuccess:n,onRenderTextLayerError:u,onRenderTextLayerSuccess:$,page:L,pageIndex:rt,pageNumber:R,rotate:y,scale:m}=g;invariant(L,"Attempted to load page text content, but no page was specified.");const[O,j]=useResolver(),{value:k,error:_}=O,w=reactExports.useRef(null),p=reactExports.useRef();warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function E(){k&&n&&n(k)}function P(){_&&(warning(!1,_.toString()),D&&D(_))}function C(){j({type:"RESET"})}reactExports.useEffect(C,[L,j]);function v(){if(!L)return;const b=makeCancellablePromise(L.getTextContent()),G=b;return b.promise.then(z=>{j({type:"RESOLVE",value:z})}).catch(z=>{j({type:"REJECT",error:z})}),()=>cancelRunningTask(G)}reactExports.useEffect(v,[L,j]),reactExports.useEffect(()=>{if(k!==void 0){if(k===!1){P();return}E()}},[k]);const l=reactExports.useCallback(()=>{$&&$()},[$]),d=reactExports.useCallback(b=>{warning(!1,b.toString()),u&&u(b)},[u]);function I(){const b=p.current;b&&b.classList.add("active")}function A(){const b=p.current;b&&b.classList.remove("active")}const c=reactExports.useMemo(()=>L.getViewport({scale:m,rotation:y}),[L,y,m]);function F(){if(!L||!k)return;const{current:b}=w;if(!b)return;b.innerHTML="";const G=L.streamTextContent({includeMarkedContent:!0}),z={container:b,textContentSource:G,viewport:c},S=pdfjs$1.renderTextLayer(z),X=S;return S.promise.then(()=>{const at=document.createElement("div");at.className="endOfContent",b.append(at),p.current=at;const ct=b.querySelectorAll('[role="presentation"]');if(e){let V=0;k.items.forEach((dt,mt)=>{if(!isTextItem(dt))return;const Et=ct[V];if(!Et)return;const wt=e(Object.assign({pageIndex:rt,pageNumber:R,itemIndex:mt},dt));Et.innerHTML=wt,V+=dt.str&&dt.hasEOL?2:1})}l()}).catch(d),()=>cancelRunningTask(X)}return reactExports.useLayoutEffect(F,[e,d,l,L,rt,R,k,c]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:A,onMouseDown:I,ref:w})}function AnnotationLayer$1(){const g=useDocumentContext();invariant(g,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const e=usePageContext();invariant(e,"Unable to find Page context.");const D=Object.assign(Object.assign({},g),e),{imageResourcesPath:n,linkService:u,onGetAnnotationsError:$,onGetAnnotationsSuccess:L,onRenderAnnotationLayerError:rt,onRenderAnnotationLayerSuccess:R,page:y,pdf:m,renderForms:O,rotate:j,scale:k=1}=D;invariant(y,"Attempted to load page annotations, but no page was specified.");const[_,w]=useResolver(),{value:p,error:E}=_,P=reactExports.useRef(null);warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function C(){p&&L&&L(p)}function v(){E&&(warning(!1,E.toString()),$&&$(E))}function l(){w({type:"RESET"})}reactExports.useEffect(l,[w,y]);function d(){if(!y)return;const b=makeCancellablePromise(y.getAnnotations()),G=b;return b.promise.then(z=>{w({type:"RESOLVE",value:z})}).catch(z=>{w({type:"REJECT",error:z})}),()=>{cancelRunningTask(G)}}reactExports.useEffect(d,[w,y,O]),reactExports.useEffect(()=>{if(p!==void 0){if(p===!1){v();return}C()}},[p]);function I(){R&&R()}function A(b){warning(!1,`${b}`),rt&&rt(b)}const c=reactExports.useMemo(()=>y.getViewport({scale:k,rotation:j}),[y,j,k]);function F(){if(!m||!y||!p)return;const{current:b}=P;if(!b)return;const G=c.clone({dontFlip:!0}),z={accessibilityManager:null,annotationCanvasMap:null,div:b,l10n:null,page:y,viewport:G},S={annotations:p,annotationStorage:m.annotationStorage,div:b,downloadManager:null,imageResourcesPath:n,linkService:u,page:y,renderForms:O,viewport:G};b.innerHTML="";try{new pdfjs$1.AnnotationLayer(z).render(S),I()}catch(X){A(X)}return()=>{}}return reactExports.useEffect(F,[p,n,u,y,O,c]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:P})}var __rest=globalThis&&globalThis.__rest||function(g,e){var D={};for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&e.indexOf(n)<0&&(D[n]=g[n]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(g);u<n.length;u++)e.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(g,n[u])&&(D[n[u]]=g[n[u]]);return D};const defaultScale=1,Page=function g(e){const D=useDocumentContext();invariant(D,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const n=Object.assign(Object.assign({},D),e),{_className:u="react-pdf__Page",_enableRegisterUnregisterPage:$=!0,canvasBackground:L,canvasRef:rt,children:R,className:y,customRenderer:m,customTextRenderer:O,devicePixelRatio:j,error:k="Failed to load the page.",height:_,inputRef:w,loading:p="Loading page…",noData:E="No page specified.",onGetAnnotationsError:P,onGetAnnotationsSuccess:C,onGetStructTreeError:v,onGetStructTreeSuccess:l,onGetTextError:d,onGetTextSuccess:I,onLoadError:A,onLoadSuccess:c,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:b,onRenderError:G,onRenderSuccess:z,onRenderTextLayerError:S,onRenderTextLayerSuccess:X,pageIndex:at,pageNumber:ct,pdf:V,registerPage:dt,renderAnnotationLayer:mt=!0,renderForms:Et=!1,renderMode:wt="canvas",renderTextLayer:M=!0,rotate:i,scale:o=defaultScale,unregisterPage:a,width:h}=n,f=__rest(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[T,N]=useResolver(),{value:W,error:it}=T,tt=reactExports.useRef(null);invariant(V,"Attempted to load a page, but no document was specified.");const et=isProvided(ct)?ct-1:at??null,ht=ct??(isProvided(at)?at+1:null),bt=i??(W?W.rotate:null),ut=reactExports.useMemo(()=>{if(!W)return null;let Gt=1;const Ht=o??defaultScale;if(h||_){const Xt=W.getViewport({scale:1,rotation:bt});h?Gt=h/Xt.width:_&&(Gt=_/Xt.height)}return Ht*Gt},[_,W,bt,o,h]);function Ft(){return()=>{isProvided(et)&&$&&a&&a(et)}}reactExports.useEffect(Ft,[$,V,et,a]);function Bt(){if(c){if(!W||!ut)return;c(makePageCallback(W,ut))}if($&&dt){if(!isProvided(et)||!tt.current)return;dt(et,tt.current)}}function St(){it&&(warning(!1,it.toString()),A&&A(it))}function Lt(){N({type:"RESET"})}reactExports.useEffect(Lt,[N,V,et]);function gt(){if(!V||!ht)return;const Gt=makeCancellablePromise(V.getPage(ht)),Ht=Gt;return Gt.promise.then(Xt=>{N({type:"RESOLVE",value:Xt})}).catch(Xt=>{N({type:"REJECT",error:Xt})}),()=>cancelRunningTask(Ht)}reactExports.useEffect(gt,[N,V,et,ht,dt]),reactExports.useEffect(()=>{if(W!==void 0){if(W===!1){St();return}Bt()}},[W,ut]);const nt=reactExports.useMemo(()=>W&&isProvided(et)&&ht&&isProvided(bt)&&isProvided(ut)?{_className:u,canvasBackground:L,customTextRenderer:O,devicePixelRatio:j,onGetAnnotationsError:P,onGetAnnotationsSuccess:C,onGetStructTreeError:v,onGetStructTreeSuccess:l,onGetTextError:d,onGetTextSuccess:I,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:b,onRenderError:G,onRenderSuccess:z,onRenderTextLayerError:S,onRenderTextLayerSuccess:X,page:W,pageIndex:et,pageNumber:ht,renderForms:Et,renderTextLayer:M,rotate:bt,scale:ut}:null,[u,L,O,j,P,C,v,l,d,I,F,b,G,z,S,X,W,et,ht,Et,M,bt,ut]),st=reactExports.useMemo(()=>makeEventProps(f,()=>W&&(ut?makePageCallback(W,ut):void 0)),[f,W,ut]),pt=`${et}@${ut}/${bt}`,Tt=`${et}/${bt}`;function Ct(){switch(wt){case"custom":return invariant(m,'renderMode was set to "custom", but no customRenderer was passed.'),React.createElement(m,{key:`${pt}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${Tt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${pt}_canvas`,canvasRef:rt})}}function Ut(){return M?React.createElement(TextLayer$1,{key:`${pt}_text`}):null}function Vt(){return mt?React.createElement(AnnotationLayer$1,{key:`${pt}_annotations`}):null}function Wt(){return React.createElement(PageContext.Provider,{value:nt},Ct(),Ut(),Vt(),R)}function zt(){return ht?V===null||W===void 0||W===null?React.createElement(Message,{type:"loading"},typeof p=="function"?p():p):V===!1||W===!1?React.createElement(Message,{type:"error"},typeof k=="function"?k():k):Wt():React.createElement(Message,{type:"no-data"},typeof E=="function"?E():E)}return React.createElement("div",Object.assign({className:clsx(u,y),"data-page-number":ht,ref:mergeRefs(w,tt),style:{"--scale-factor":`${ut}`,backgroundColor:L||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},st),zt())},isFunctionOrNode=_pt.oneOfType([_pt.func,_pt.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:_pt.string,canvasRef:isRef,children:_pt.node,className:isClassName,customRenderer:_pt.func,customTextRenderer:_pt.func,devicePixelRatio:_pt.number,error:isFunctionOrNode,height:_pt.number,imageResourcesPath:_pt.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:_pt.func,onGetTextSuccess:_pt.func,onLoadError:_pt.func,onLoadSuccess:_pt.func,onRenderError:_pt.func,onRenderSuccess:_pt.func,onRenderTextLayerError:_pt.func,onRenderTextLayerSuccess:_pt.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:_pt.bool,renderForms:_pt.bool,renderMode:isRenderMode,renderTextLayer:_pt.bool,rotate:isRotate,scale:_pt.number,width:_pt.number});const Page$1=Page;displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(g){if(g==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(g)}function shouldUseNative(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de",Object.getOwnPropertyNames(g)[0]==="5")return!1;for(var e={},D=0;D<10;D++)e["_"+String.fromCharCode(D)]=D;var n=Object.getOwnPropertyNames(e).map(function($){return e[$]});if(n.join("")!=="0123456789")return!1;var u={};return"abcdefghijklmnopqrst".split("").forEach(function($){u[$]=$}),Object.keys(Object.assign({},u)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var objectAssign=shouldUseNative()?Object.assign:function(g,e){for(var D,n=toObject(g),u,$=1;$<arguments.length;$++){D=Object(arguments[$]);for(var L in D)hasOwnProperty.call(D,L)&&(n[L]=D[L]);if(getOwnPropertySymbols){u=getOwnPropertySymbols(D);for(var rt=0;rt<u.length;rt++)propIsEnumerable.call(D,u[rt])&&(n[u[rt]]=D[u[rt]])}}return n};const objectAssign$1=getDefaultExportFromCjs(objectAssign),Iframe=({url:g,allowFullScreen:e,position:D,display:n,height:u,width:$,overflow:L,styles:rt,onLoad:R,onMouseOver:y,onMouseOut:m,scrolling:O,id:j,frameBorder:k,ariaHidden:_,sandbox:w,allow:p,className:E,title:P,ariaLabel:C,ariaLabelledby:v,name:l,target:d,loading:I,importance:A,referrerpolicy:c,allowpaymentrequest:F,src:b,key:G})=>{const z=objectAssign$1({src:b||g,target:d||null,style:{position:D||null,display:n||"initial",overflow:L||null},scrolling:O||null,allowpaymentrequest:F||null,importance:A||null,sandbox:w&&[...w].join(" ")||null,loading:I||null,styles:rt||null,name:l||null,className:E||null,allowFullScreen:"allowFullScreen",referrerpolicy:c||null,title:P||null,allow:p||null,id:j||null,"aria-labelledby":v||null,"aria-hidden":_||null,"aria-label":C||null,width:$||null,height:u||null,onLoad:R||null,onMouseOver:y||null,onMouseOut:m||null,key:G||"iframe"});let S=Object.create(null);for(let X of Object.keys(z))z[X]!=null&&(S[X]=z[X]);for(let X of Object.keys(S.style))S.style[X]==null&&delete S.style[X];if(S.styles)for(let X of Object.keys(S.styles))S.styles.hasOwnProperty(X)&&(S.style[X]=S.styles[X]),Object.keys(S.styles).pop()==X&&delete S.styles;if(e)if("allow"in S){const X=S.allow.replace("fullscreen","");S.allow=`fullscreen ${X.trim()}`.trim()}else S.allow="fullscreen";return k>=0&&(S.style.hasOwnProperty("border")||(S.style.border=k)),React.createElement("iframe",Object.assign({},S))},AnnotationLayer="",TextLayer="";pdfjs$1.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs$1.version}/pdf.worker.js`;const DocumentViewer=({url:g})=>{const[e,D]=reactExports.useState(null),n=["pdf","jpg","jpeg","png","gif"],u=g.split(".").pop();reactExports.useEffect(()=>{u&&(console.log({fileExtension:u}),n.includes(u.toLowerCase())&&D(u.toLowerCase()))},[g]),reactExports.useEffect(()=>{console.log({fileType:e,url:g})},[e]);const $=e==="jpg"||e==="png"||e==="jpeg"||e==="gif";return jsxRuntimeExports.jsxs("div",{className:"document-viewer",children:[e==="pdf"&&jsxRuntimeExports.jsx(PDFViewer,{url:g}),$&&jsxRuntimeExports.jsx(ImageViewer,{imageUrl:g}),!e&&jsxRuntimeExports.jsx(IframeViewer,{url:g})]})},PDFViewer=({url:g})=>{const[e,D]=reactExports.useState(null);reactExports.useState(1);const[n,u]=reactExports.useState(null),$=({numPages:rt})=>{D(rt)},L=rt=>{u(rt)};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Document$1,{file:{url:g},onLoadSuccess:$,onLoadError:L,children:jsxRuntimeExports.jsx(Page$1,{pageNumber:1})}),jsxRuntimeExports.jsx("style",{children:`
            .react-pdf__Page .react-pdf__Page__canvas{
              width: 100% !important;
              height: 100% !important;
            }
      `})]})},ImageViewer=({imageUrl:g})=>jsxRuntimeExports.jsx("img",{src:g,alt:"Document"}),IframeViewer=({url:g})=>jsxRuntimeExports.jsx(Iframe,{url:g,width:"100%",height:"500px"});injectReducer("crmTaskDetails",reducer$1);const TaskDetail=()=>{const g=useAppDispatch(),e=useParams(),{id:D}=e,n=useAppSelector(_=>{var w,p;return(p=(w=_==null?void 0:_.crmTaskDetails)==null?void 0:w.data)==null?void 0:p.task}),[u,$]=reactExports.useState([]),L=n==null?void 0:n.data,rt=useAppSelector(_=>_.crmTaskDetails.data.loading),R=useCheckEditUpdate("tasks","canModify");reactExports.useEffect(()=>{if(L!=null&&L.taskNotes){const _=[...L==null?void 0:L.taskNotes];_==null||_.sort((w,p)=>new Date(p.createdAt).getTime()-new Date(w.createdAt).getTime()),$(_)}},[L]),reactExports.useEffect(()=>(y(),()=>{g(setFirstTimeLoad(!0))}),[]);const y=async()=>{D&&g(getTaskById(D))},m=_=>{g(toggleAddForm(!0)),g(setSelectedNote(_)),g(setDialogMode("Edit"))},O=_=>{g(setSelectedNote(_)),g(toggleDeleteConfirmation(!0))},j=()=>{g(toggleAddForm(!0)),g(setDialogMode("Add"))},k=()=>{window.history.back()};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"15px"},children:[jsxRuntimeExports.jsx("span",{className:"cursor-pointer hover:text-indigo-500 items-center lg mr-2 mt-0",style:{fontSize:"2.5rem",fontWeight:"bold",color:"black"},onClick:k,children:jsxRuntimeExports.jsx(IoIosArrowRoundBack,{})}),jsxRuntimeExports.jsx("h3",{children:"Task Details"})]}),jsxRuntimeExports.jsxs(Container,{className:"h-full",children:[jsxRuntimeExports.jsx(Loading,{loading:rt,children:!isEmpty(L)&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(TaskProfile,{data:L}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 lg:grid-cols-4 gap-4 mt-2",children:[jsxRuntimeExports.jsxs(AdaptableCard,{className:"col-span-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between mb-2",children:[jsxRuntimeExports.jsx("h5",{children:"Notes"}),R&&jsxRuntimeExports.jsx(Button,{size:"xs",type:"button",className:"!px-2 !text-lg",onClick:j,children:jsxRuntimeExports.jsx(BiSolidMessageSquareAdd,{})})]}),jsxRuntimeExports.jsx(NoteTimeline,{notes:u||[],canEdit:R,onEdit:m,onDelete:O})]}),(L==null?void 0:L.attachments)&&jsxRuntimeExports.jsxs(AdaptableCard,{className:"col-span-1 select-none",children:[jsxRuntimeExports.jsx("h5",{className:"mb-2",children:"Attachments"}),jsxRuntimeExports.jsx(DocumentViewer,{url:(L==null?void 0:L.attachments)||""})]}),jsxRuntimeExports.jsxs(AdaptableCard,{className:"col-span-1",children:[jsxRuntimeExports.jsx("h5",{children:"Task Activity"}),jsxRuntimeExports.jsx(LeadActivity,{activity:(L==null?void 0:L.taskActivities)||[]})]})]})]})}),!rt&&isEmpty(L)&&jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx(DoubleSidedImage,{src:"/img/others/img-2.png",darkModeSrc:"/img/others/img-2-dark.png",alt:"No user found!"}),jsxRuntimeExports.jsx("h3",{className:"mt-8",children:"No user found!"})]}),jsxRuntimeExports.jsx(NotesAddFormTask,{}),jsxRuntimeExports.jsx(NotesDeleteConfirmationTask,{})]})]})};export{TaskDetail as default};
