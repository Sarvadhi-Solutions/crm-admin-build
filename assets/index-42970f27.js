import{a as k,j as e,r as j,al as ue,aq as xe}from"./index-afeb99dd.js";import{A as ge}from"./AdaptableCard-01cd8827.js";import{F as K}from"./FormDesription-e86e128e.js";import{D as he}from"./DataTable-3d6ba875.js";import"./Alert-abc01096.js";import"./index-08720d19.js";import"./Badge-57260147.js";import{B as J}from"./Button-5e9321cd.js";import"./RangeCalendar-c8e5e23d.js";import"./Card-a25bc86a.js";import"./index-646ce73f.js";import"./index-71f17666.js";import"./Dialog-b0478122.js";import{D as fe}from"./Drawer-6021c63b.js";import"./index-29936284.js";import{a as I,F as Ce}from"./FormItem-2a151033.js";import"./toString-79dd21b9.js";import{I as A}from"./Input-fe5fc582.js";import"./index-ed8cb66a.js";import"./index-cf176bc9.js";import"./index-8145753b.js";import{t as Q,N as X}from"./toast-b57ee67d.js";import"./Pagination-46eefec6.js";import"./Progress-65192619.js";import"./index-fde04e31.js";import"./ScrollBar-93cfd3f9.js";import"./index-b82cade4.js";import{S as W}from"./Select-2984c046.js";import"./Skeleton-1c4e4b72.js";import"./index-a70c7a57.js";import"./Switcher-83e7e292.js";import"./index-45766b4b.js";import{T as ae}from"./index-b8a0c8d7.js";import"./Tag-f3e28a4c.js";import"./index-53e11fec.js";import"./index-16b82756.js";import{T as U}from"./Tooltip-46e989ae.js";import"./Upload-1e962b58.js";import{T as je}from"./TagsList-5727ee94.js";import{T as B}from"./TextTruncate-73a85fed.js";import{u as P}from"./checkEditUpdate-9f459668.js";import{u as Ne}from"./useThemeClass-a6e6a15d.js";import{c as H}from"./cloneDeep-f2528b95.js";import{a as ye}from"./index.esm-726f6b92.js";import{N as be,O as we,P as Ie,b as ve}from"./index.esm-f4f10cf9.js";import{u as w,t as Y,d as De,g as G,b as se,c as Se,e as Te,h as Me,i as Ae,j as Fe,k as re,f as oe,a as ne,l as Ee,m as ze,n as ie,s as Z,o as _,p as ce,r as Le}from"./index-20eff79d.js";import{C as $e}from"./ConfirmDialog-16c69999.js";import{b as T,u as ke,F as qe,a as Oe}from"./formik.esm-e70cf2ce.js";import{c as Re,a as v,e as _e}from"./index.esm-639db9d4.js";/* empty css              */import{T as Ve,e as Be}from"./index.esm-013efa08.js";import{G as le}from"./index.esm-ef32d13b.js";import{B as ee}from"./index.esm-be0e54d4.js";import{B as Ke}from"./index.esm-44e5e467.js";import{F as We}from"./index.esm-a56f1c0a.js";import{F as te}from"./index.esm-65117561.js";import{M as Ze}from"./index.esm-1b054edb.js";import{C as Pe}from"./react-select-creatable.esm-ec2ba8d2.js";import{u as He}from"./useGetModule-41dd94e6.js";import{d as Ge}from"./debounce-6c864594.js";import"./index-535d7f05.js";import"./useTimeout-682d9172.js";import"./CloseButton-217fbce9.js";import"./StatusIcon-47182631.js";import"./Views-f7a9b898.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-8021c4d2.js";import"./_baseIsEqual-879f4f25.js";import"./_MapCache-d7aaf9c0.js";import"./get-a5b2ed65.js";import"./useRootClose-d6d9b544.js";import"./usePopper-996565a6.js";import"./TimeInput-a38fa8f0.js";import"./useUniqueId-6aef0ec3.js";import"./useDidUpdate-f2162ffc.js";import"./index-a4e43560.js";import"./useUncertainRef-8a988cd5.js";import"./isNil-e2aeddd7.js";import"./index-07932842.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-fe25a6b5.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-b3b9a0e8.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-4a1cd053.js";import"./index.esm-e1783cee.js";import"./moment-fbc5633a.js";import"./_getPrototype-c53836d9.js";import"./CrmService-80eafdff.js";const Ue=()=>{const s=k(),l=w(m=>m.crmContact.data.deleteConfirmation),t=w(m=>m.crmContact.data.selectedContact),c=()=>{s(Y(!1))},g=async()=>{var h,f,N;s(Y(!1));const m=await s(De(t==null?void 0:t.id));(h=m==null?void 0:m.payload)!=null&&h.success?Q.push(e.jsx(X,{title:"Successfuly Deleted",type:"success",duration:2500,children:(f=m==null?void 0:m.payload)==null?void 0:f.message}),{placement:"top-end"}):Q.push(e.jsx(X,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(N=m==null?void 0:m.error)==null?void 0:N.message}),{placement:"top-end"}),await s(G()),await s(se())};return e.jsx($e,{isOpen:l,type:"danger",title:"Delete Contact",confirmButtonColor:"red-600",onClose:c,onRequestClose:c,onCancel:c,onConfirm:g,children:e.jsx("p",{children:"Are you sure you want to delete this Contact? All record related to this contact will be deleted as well. This action cannot be undone."})})},Je=({data:s,handleTagChange:l})=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(t=>e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:t.categoryName.toLowerCase().replace(/(^\w{1})|(\s{1}\w{1})/g,c=>c.toUpperCase()),children:e.jsx(T,{isClearable:!0,isMulti:!0,type:"text",autoComplete:"off",name:`tagId_${t.id}`,placeholder:`Select ${t.categoryName} tags`,component:W,options:t.tags.map(c=>({label:c.tagName,value:c.id})),prefix:e.jsx(le,{className:"text-xl"}),closeMenuOnSelect:!1,onChange:c=>l(c,t.id)})})},t.id))}),Qe=s=>{const{touched:l,errors:t,values:c,setFieldValue:g,customFieldData:m}=s,h=k(),[f,N]=j.useState([]),[L,F]=j.useState(null),[$,q]=j.useState(!1),D=w(a=>{var i;return(i=a.crmContact.data)==null?void 0:i.customField});w(a=>a.crmContact.data.contactList);const E=w(a=>a.crmContact.data.companyList),u=w(a=>a.crmContact.data.sources),n=w(a=>a.crmContact.data.states);w(a=>a.crmContact.data.cities);const d=j.useMemo(()=>E==null?void 0:E.map(a=>({value:a.id,label:a.companyName})),[E]),b=j.useMemo(()=>n==null?void 0:n.map(a=>({value:a.id,label:a.stateName})),[n]),S=j.useMemo(()=>{var i;const a=n==null?void 0:n.find(C=>C.id===c.stateId);return((i=a==null?void 0:a.cities)==null?void 0:i.map(C=>({value:C.id,label:C.cityName})))||[]},[n,L]),z=j.useMemo(()=>u==null?void 0:u.map(i=>({label:i.sources,value:i.id})),[u]),O={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},R=async()=>{var a,i;try{const{payload:C}=await h(oe()),V=(a=C==null?void 0:C.data)==null?void 0:a.find(M=>(M==null?void 0:M.moduleName)==="contacts");if(V){const{payload:M}=await h(ne({id:(i=V==null?void 0:V.id)==null?void 0:i.toString()}));N(M==null?void 0:M.data)}}catch(C){console.error("Error fetching module data:",C)}},{getModule:x}=He();j.useEffect(()=>{(async()=>{const i=await x("contacts");await R(),await h(Se()),await h(Te()),await h(Me(i)),await h(Ae())})()},[h]);const r=ke(),p=async(a,i)=>{await r.setFieldValue(`tagId_${i}`,a),q(!$)},y=async(a,i)=>{const C={sources:a==null?void 0:a.label};switch(i.action){case"create-option":await h(Fe(C)),await h(re());break;case"select-option":g("sourceId",a);break;case"clear":g("sourceId",null);break}},o=async()=>{const a=new Set;f==null||f.forEach(C=>{c&&c[`tagId_${C.id}`]&&c[`tagId_${C.id}`].length&&c[`tagId_${C.id}`].map(M=>M.value).forEach(M=>{a.add(M)})});const i=[...a];await r.setFieldValue("tagId",i)};return j.useMemo(()=>{o()},[$,f]),e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Contact Basic Information",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"First Name *",invalid:t.firstName&&l.firstName,errorMessage:t.firstName,children:e.jsx(T,{type:"text",autoComplete:"off",name:"firstName",placeholder:"First Name",component:A,prefix:e.jsx(te,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Last Name *",invalid:t.lastName&&l.lastName,errorMessage:t.lastName,children:e.jsx(T,{type:"text",autoComplete:"off",name:"lastName",placeholder:"Last Name",component:A,prefix:e.jsx(te,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Email *",invalid:t.email&&l.email,errorMessage:t.email,children:e.jsx(T,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:A,prefix:e.jsx(be,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Contact Number *",invalid:t.contactNumber&&l.contactNumber,errorMessage:t.contactNumber,children:e.jsx(T,{type:"tel",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:A,prefix:e.jsx(Ke,{className:"text-xl"})})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Designation",invalid:t.title&&l.title,errorMessage:t.title,children:e.jsx(T,{type:"text",autoComplete:"off",name:"title",placeholder:"Designation",component:A,prefix:e.jsx(Ze,{className:"text-xl"})})})})}),e.jsx(I,{label:"Notes",invalid:t.description&&l.description,errorMessage:t.description,children:e.jsx(T,{textArea:!0,type:"text",autoComplete:"off",name:"description",placeholder:"Notes",component:A,prefix:e.jsx(Ve,{className:"text-xl"})})}),e.jsx(K,{title:"Address",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Address",invalid:t.address&&l.address,errorMessage:t.address,children:e.jsx(T,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:A,prefix:e.jsx(We,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"State",invalid:t.stateId&&l.stateId,errorMessage:t.stateId,children:e.jsx(W,{name:"stateId",placeholder:"Select State",options:b,id:"stateId",value:b==null?void 0:b.find(a=>(a==null?void 0:a.value)==(c==null?void 0:c.stateId)),onChange:a=>{const i=a.value;c.stateId!==i&&g("cityId",""),g("stateId",i||""),F(i)}})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"City",invalid:t.cityId&&l.cityId,errorMessage:t.cityId,children:e.jsx(W,{name:"cityId",placeholder:"Select City",options:S,id:"cityId",value:(S==null?void 0:S.find(a=>(a==null?void 0:a.value)===(c==null?void 0:c.cityId)))||{value:"",label:"Select City"},onChange:a=>{const i=a.value;i!==c.cityId&&g("cityId",i||"")}})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{style:{position:"relative"},children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"ZipCode",invalid:t.zipcode&&l.zipcode,errorMessage:t.zipcode,children:e.jsx(T,{type:"text",autoComplete:"off",name:"zipcode",placeholder:"ZipCode",component:A,prefix:e.jsx(Be,{className:"text-xl"})})})})})})]}),e.jsx(K,{title:"Contact Others Details",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Company Name",invalid:t.companiesId&&l.companiesId,errorMessage:t.companiesId,children:e.jsx(W,{name:"companiesId",placeholder:"Company Name",options:d,id:"companiesId",value:d==null?void 0:d.find(a=>(a==null?void 0:a.value)==(c==null?void 0:c.companiesId)),onChange:a=>{const i=a.value;g("companiesId",i||"")}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Contact Source",invalid:t.source&&l.source,errorMessage:t.source,children:e.jsx(T,{isClearable:!0,type:"text",autoComplete:"off",name:"sourceId",placeholder:"Contact Source",component:W,componentAs:Pe,options:z,prefix:e.jsx(le,{className:"text-xl"}),onChange:y})})})]}),e.jsx(Je,{data:f,handleTagChange:p}),(D==null?void 0:D.length)>0?e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Additional Details",desc:"",className:"mb-2"}),e.jsx("div",{style:O,children:D==null?void 0:D.map(a=>e.jsx("div",{children:e.jsx(I,{label:a==null?void 0:a.label,children:a.inputType==="textArea"?e.jsx(T,{textArea:!0,type:"text",autoComplete:"off",name:a.name,placeholder:a==null?void 0:a.label,defaultValue:a==null?void 0:a.defaultValue,component:A,prefix:e.jsx(ee,{className:"text-xl"})}):e.jsx(T,{type:a.inputType,autoComplete:"off",name:a.name,placeholder:a==null?void 0:a.label,defaultValue:a==null?void 0:a.defaultValue,component:A,prefix:e.jsx(ee,{className:"text-xl"})})})},a.id))})]}):null]})},Xe=Re().shape({firstName:v().required("First Name is required"),lastName:v().required("Last Name is required"),title:v(),contactNumber:v().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",s=>!isNaN(s)).test("is-ten-digits","Contact must be exactly 10 digits",s=>{if(s){const l=Number(s);return/^\d{10}$/.test(l.toString())}return!0}).test("is-ten-digits","Contact number cannot start with 0",s=>s?!s.startsWith("0"):!0),email:v().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),address:v(),stateId:v(),cityId:v(),zipcode:v().test("is-number","ZipCode must be a number",s=>!(s&&isNaN(Number(s)))).test("is-six-digits","ZipCode must be exactly 6 digits",s=>!(s&&s.length!==6)),companiesId:v().nullable(),companyName:v(),source:v().nullable(),description:v(),tagId:_e()}),{TabNav:Ye,TabList:et,TabContent:tt}=ae,de=j.forwardRef((s,l)=>{var F,$,q,D,E;const t=w(u=>{var n,d;return(d=(n=u.crmContact)==null?void 0:n.data)==null?void 0:d.selectedContact});(F=t==null?void 0:t.tags)==null||F.reduce((u,n)=>(u[`tagId_${n.id}`]=[],u),{});const c=j.useMemo(()=>{var u;return(u=t==null?void 0:t.tags)==null?void 0:u.reduce((n,d)=>{const b=d.tagCategoryId;return n[`tagId_${b}`]||(n[`tagId_${b}`]=[]),n[`tagId_${b}`].push({label:d.tagName,value:d.id}),n},{})},[t.tags]),g=w(u=>{var n;return(n=u.crmContact.data)==null?void 0:n.customField}),m=w(u=>{var n,d;return(d=(n=u.crmContact)==null?void 0:n.data)==null?void 0:d.sources}),h=j.useMemo(()=>m.map(n=>({label:n.sources,value:n.id})),[m]),f=!!t.id,N=k(),L=j.useMemo(()=>g==null?void 0:g.reduce((n,d)=>{var S;const b=(S=t==null?void 0:t.contactFields)==null?void 0:S.find(z=>(z==null?void 0:z.name)===(d==null?void 0:d.name));return n[d==null?void 0:d.name]=b?b==null?void 0:b.value:d!=null&&d.defaultValue?d==null?void 0:d.defaultValue:"",n},{}),[g]);return e.jsx(qe,{innerRef:l,initialValues:{firstName:(t==null?void 0:t.firstName)||"",lastName:(t==null?void 0:t.lastName)||"",title:(t==null?void 0:t.title)||"",email:(t==null?void 0:t.email)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",description:(t==null?void 0:t.description)||"",companyName:(($=t==null?void 0:t.company)==null?void 0:$.companyName)||"",sourceId:t!=null&&t.sourceId?h.find(u=>u.value===(t==null?void 0:t.sourceId)):null,address:(t==null?void 0:t.address)||"",stateId:(t==null?void 0:t.stateId)||"",cityId:(t==null?void 0:t.cityId)||"",zipcode:(t==null?void 0:t.zipcode)||"",tagName:((D=(q=t==null?void 0:t.tags)==null?void 0:q[0])==null?void 0:D.tagName)||"",tagId:((E=t==null?void 0:t.tags)==null?void 0:E.map(u=>({label:u.tagName,value:u.id})))||[],companiesId:(t==null?void 0:t.companiesId)||"",...L,...c},validationSchema:Xe,onSubmit:async(u,{setSubmitting:n})=>{var d,b,S,z,O,R,x;try{const{tagName:r,...p}=u,y={...p,sourceId:(d=p==null?void 0:p.sourceId)==null?void 0:d.value,tagId:p==null?void 0:p.tagId},o=f?await N(Ee({contactId:(t==null?void 0:t.id)||"",updatedData:y})):await N(ze(y)),a=(b=o==null?void 0:o.payload)!=null&&b.success?"Successfully Added":"Something went wrong !!!",i=(S=o==null?void 0:o.payload)!=null&&S.success?"success":"danger",C=(z=o==null?void 0:o.payload)!=null&&z.success?(O=o==null?void 0:o.payload)==null?void 0:O.message:(R=o==null?void 0:o.error)==null?void 0:R.message;Q.push(e.jsx(X,{title:a,type:i,duration:2500,children:C}),{placement:"top-end"}),(x=o==null?void 0:o.payload)!=null&&x.success&&N(ie()),await N(G()),await N(se())}catch(r){console.error(r)}finally{n(!1)}},children:({touched:u,errors:n,values:d,setFieldValue:b})=>e.jsx(Oe,{children:e.jsx(Ce,{children:e.jsxs(ae,{defaultValue:"personalInfo",children:[e.jsx(et,{children:e.jsx(Ye,{value:"personalInfo",children:"Contact Details"})}),e.jsx("div",{className:"p-6",children:e.jsx(tt,{value:"personalInfo",children:e.jsx(Qe,{touched:u,errors:n,values:d,setFieldValue:b})})})]})})})})});de.displayName="ContactForm";const me=j.forwardRef((s,l)=>{k();const t=w(g=>{var m,h;return(h=(m=g.crmContact)==null?void 0:m.data)==null?void 0:h.selectedContact});w(g=>g.crmContact.data.contactList);const c=async g=>{};return e.jsx(de,{ref:l,contact:t,onFormSubmit:c})});me.displayName="ContactEditContent";const at=({onSaveClick:s,onCancel:l})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(J,{size:"sm",className:"mr-2",onClick:l,children:"Cancel"}),e.jsx(J,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),st=()=>{const s=k(),[l,t]=j.useState(window.innerWidth/2),c=w(N=>{var L,F;return(F=(L=N.crmContact)==null?void 0:L.data)==null?void 0:F.drawerOpen}),g=()=>{s(ie()),s(Z({}))},m=j.useRef(null),h=()=>{var N;(N=m.current)==null||N.submitForm()},f=()=>{t(window.innerWidth/2)};return j.useEffect(()=>(window.addEventListener("resize",f),()=>{window.removeEventListener("resize",f)}),[]),e.jsx(fe,{isOpen:c,closable:!1,bodyClass:"p-0",width:l,footer:e.jsx(at,{onCancel:g,onSaveClick:h}),onClose:g,onRequestClose:g,children:e.jsx(me,{ref:m})})},rt=()=>{const s=k(),[l,t]=j.useState([]),c=w(x=>x.crmContact.data.displayedContactList),g=w(x=>x.crmContact.data.tableData),m=P("contacts","canModify"),h=P("contacts","canDelete"),f=P("contacts","canView"),N=w(x=>x.crmContact.data.loading),L=ue(),{pageIndex:F,pageSize:$,sort:q,query:D,total:E}=w(x=>x.crmContact.data.tableData),u=j.useCallback(()=>{b(),s(G()),s(re())},[s]);j.useEffect(()=>(u(),()=>{window.location.pathname.includes("contact")||s(_({...g,query:""}))}),[]);const n=j.useMemo(()=>({pageIndex:F,pageSize:$,sort:q,query:D,total:E}),[F,$,q,D,E]),d=({row:x})=>{const r=k();Ne();const p=()=>{r(ce()),r(Z(x))},y=async()=>{r(Z(x)),r(Y(!0))},o=()=>{r(Z(x));const a=`/app/crm/contact-details/${x.id}`;L(a)};return e.jsxs("div",{className:"flex text-base items-center",children:[m&&e.jsx("span",{className:"cursor-pointer hover:text-indigo-500 circle items-center",onClick:p,children:e.jsx(we,{})}),h&&e.jsx("span",{className:"cursor-pointer hover:text-red-500 circle mx-1 items-center",onClick:y,children:e.jsx(Ie,{})}),f&&e.jsx("span",{className:"cursor-pointer hover:text-green-500 circle items-center text-lg",onClick:o,children:e.jsx(ye,{})})]})},b=async()=>{var x,r;try{const{payload:p}=await s(oe()),y=(x=p==null?void 0:p.data)==null?void 0:x.find(o=>(o==null?void 0:o.moduleName)==="contacts");if(y){const{payload:o}=await s(ne({id:(r=y==null?void 0:y.id)==null?void 0:r.toString()}));t(o==null?void 0:o.data)}}catch(p){console.error("Error fetching module data:",p)}},S=j.useMemo(()=>{const x=[{header:"Action",id:"action",cell:r=>e.jsx(d,{row:r.row.original})},{header:"Name",accessorKey:"firstName",cell:r=>{const{firstName:p,lastName:y}=r.row.original,o=`${p} ${y}`;return e.jsx(U,{title:o,children:e.jsx(B,{text:o,maxLength:15})},o)}},{header:"email",accessorKey:"email",cell:r=>r.row.original.email},{header:"Number",accessorKey:"contactNumber",cell:r=>r.row.original.contactNumber},{header:"source",accessorKey:"sourceId",cell:r=>{var y,o,a,i;const p=(o=(y=r.row.original)==null?void 0:y.source)!=null&&o.sources?(i=(a=r.row.original)==null?void 0:a.source)==null?void 0:i.sources:"-";return e.jsx(B,{text:p,maxLength:15})}},{header:"designation",accessorKey:"title",cell:r=>{const p=r.row.original.title?r.row.original.title:"-";return e.jsx(U,{title:p,children:e.jsx(B,{text:p,maxLength:15})},p)}},{header:"Company",accessorKey:"companyName",cell:r=>{const p=r.row.original.company?r.row.original.company.companyName:"-";return e.jsx(B,{text:p,maxLength:15})}},{header:"Address",accessorKey:"address",cell:r=>{const{address:p,cityData:y,stateData:o,zipcode:a}=r.row.original,i=[p,y==null?void 0:y.cityName,o==null?void 0:o.stateName,a].filter(C=>C!=null).join(" ");return e.jsx(U,{title:i||"-",children:e.jsx(B,{text:i||"-",maxLength:20})},i)}}];return l.map((r,p)=>{const y={header:r.categoryName,id:r.id,accessorKey:"tagCategory.categoryName",cell:o=>{var i;const a=(i=o.row.original.tags)==null?void 0:i.filter(C=>(C==null?void 0:C.tagCategoryId)===r.id);return a&&a.length?e.jsx(je,{tags:a}):"-"}};x.splice(p+6,0,y)}),x},[m,h,l]),z=x=>{const r=H(n);r.pageIndex=x,s(_(r))},O=x=>{const r=H(n);r.pageSize=Number(x),r.pageIndex=1,s(_(r))},R=x=>{const r=H(n);r.sort=x,s(_(r))};return e.jsxs("div",{children:[e.jsx(he,{columns:S,data:c,loading:N,pagingData:{total:n.total,pageIndex:n.pageIndex,pageSize:n.pageSize},onPaginationChange:z,onSelectChange:O,onSort:R}),e.jsx(st,{}),e.jsx(Ue,{})]})},pe=j.forwardRef((s,l)=>{const{onInputChange:t}=s,c=Ge(g,500);function g(h){t==null||t(h)}const m=h=>{c(h.target.value)};return e.jsx(A,{ref:l,className:"max-w-md md:w-56 mb-4",size:"sm",placeholder:"Search by name or email",prefix:e.jsx(ve,{className:"text-lg"}),onChange:m})});pe.displayName="ContactTableSearch";const ot=()=>{const s=k(),l=j.useRef(null),t=w(f=>f.crmContact.data.tableData),c=P("contacts","canCreate"),g=f=>{const N=H(t);N.query=f,N.pageIndex=1,typeof f=="string"&&f.length>1&&m(N),typeof f=="string"&&f.length===0&&m(N)},m=f=>{s(f?_(f):G())},h=()=>{s(ce()),s(Z({}))};return j.useEffect(()=>{l.current&&(l.current.value=t.query||"",s(_(t)))},[t==null?void 0:t.query]),e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(pe,{ref:l,onInputChange:g})}),e.jsx("div",{className:"mb-4",children:c&&e.jsx(J,{size:"sm",onClick:h,children:"Add New"})})]})};xe("crmContact",Le);const nt=()=>{const s=w(l=>l.crmContact.data.tableData);return e.jsx(e.Fragment,{children:e.jsxs(ge,{bodyClass:"h-full",children:[e.jsx(K,{title:`Contacts (${(s==null?void 0:s.total)||0})`,desc:"",className:"mb-2"}),e.jsx(ot,{}),e.jsx(rt,{})]})})},Ba=nt;export{Ba as default};
