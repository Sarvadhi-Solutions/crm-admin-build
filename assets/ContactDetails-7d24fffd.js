import{al as M,am as R,an as _,ao as q,j as t,a as A,r as f,ap as K,aq as B,at as O,ah as W}from"./index-4b23f9f2.js";import{C as G,i as I}from"./Views-6ea63120.js";import{f as H}from"./CrmService-4928d825.js";import{A as X}from"./AdaptableCard-6d843750.js";import"./Badge-84757ba5.js";import"./chart.constant-e5b42e8e.js";import"./GrowShrinkTag-4a2dab3f.js";import{A as Y}from"./index-e9d5fe85.js";import{B as U}from"./Button-a87a2e46.js";import"./Dialog-3deb7f0e.js";import{D as V}from"./DataTable-c4a099e3.js";import"./Input-6deb6f13.js";import"./Skeleton-d609680e.js";import"./react-tooltip.min-5c2bc2f7.js";import"./RichTextEditor-e2c2794d.js";import"./SegmentItemOption-7aac1a34.js";import"./SvgIcon-9da97fd4.js";import{T as b}from"./Tooltip-7118406c.js";import{I as J}from"./index.esm-bde461f3.js";import{u as P,d as Q,g as S,s as Z}from"./index-4e94c065.js";import{C as ee}from"./ConfirmDialog-f33448c6.js";import{C as te}from"./Card-74d89d1e.js";import{t as L,N as k}from"./toast-01acb463.js";import{T as se}from"./TagsList-d496cf7d.js";import{P as oe}from"./index.esm-e8a4d9e3.js";import{S as ie}from"./StatusCapsule-a6df76e5.js";import{T as D}from"./TextTruncate-42abfbdd.js";import{c as w}from"./cloneDeep-7f7711f3.js";import"./Alert-fa9d0487.js";import"./RangeCalendar-208190e3.js";import"./index-5f058379.js";import"./index-8d3acbcc.js";import"./Drawer-7cb84764.js";import"./index-61dfa989.js";import"./FormItem-83b1322c.js";import"./toString-808a232b.js";import"./index-f452e3c1.js";import"./index-16ecbf84.js";import"./index-c20d3f97.js";import"./Pagination-b7445f7d.js";import"./Progress-26519a5b.js";import"./index-61b07bb6.js";import"./ScrollBar-9c634026.js";import"./index-b2764899.js";import"./Select-4aee735d.js";import"./index-de1abaee.js";import"./Switcher-031290dc.js";import"./index-1a8e49e3.js";import"./index-61e0f5b7.js";import"./Tag-31cf62c8.js";import"./index-a6566abb.js";import"./index-c6827dae.js";import"./Upload-75447e1c.js";import{r as re,u as y,a as ne,m as N}from"./index-e81c0409.js";import"./useMergeRef-788c4cb0.js";import"./index-5589af6a.js";import"./CloseButton-53cc5777.js";import"./index-0aa0f43b.js";import"./isNil-6d05c28f.js";import"./get-5fd819d1.js";import"./_MapCache-8ec314e0.js";import"./floating-ui.dom-bef9cea3.js";import"./_baseIsEqual-7357c66b.js";import"./useThemeClass-2218883f.js";import"./usePopper-6b55e4c5.js";import"./index.esm-b757f9d5.js";import"./index-4fdc30db.js";import"./useTimeout-13bed03b.js";import"./StatusIcon-e1b59b5e.js";import"./chainedFunction-070f832c.js";import"./_getPrototype-67c3ae2d.js";import"./useControllableState-7c2b4a82.js";import"./useRootClose-274cbb20.js";import"./TimeInput-3b99d073.js";import"./useUniqueId-05e6e2ef.js";import"./useDidUpdate-88eea7c0.js";import"./useUncertainRef-182c539d.js";import"./slicedToArray-41477189.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-8b0e89b6.js";import"./mapCloneElement-d4d7b003.js";import"./index.esm-1840726c.js";import"./index.esm-43ba8e56.js";const z="crmContactDetails",le={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ce={loading:!0,contact:{},tableData:le},v=M(`${z}/getContactById`,async e=>{var s,l;try{return await H(e)}catch(n){throw new Error((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)}}),ae=R({name:`${z}/state`,initialState:ce,reducers:{},extraReducers:e=>{e.addCase(v.fulfilled,(s,l)=>{var n,p,c,m;s.loading=!1,s.contact=l==null?void 0:l.payload.data,s.tableData.total=(m=(c=(p=(n=l.payload)==null?void 0:n.data)==null?void 0:p.data)==null?void 0:c.leadModels)==null?void 0:m.length}).addCase(v.pending,s=>{s.loading=!0})}}),me=ae.reducer,pe=_({data:me}),E=q,h=({title:e,value:s})=>{const n=(c,m)=>(c==null?void 0:c.length)>m?`${c.slice(0,m)}
${n(c.slice(m),m)}`:c,p=(s==null?void 0:s.length)>80?n(s,80):s;return t.jsxs("div",{children:[t.jsx("span",{children:e}),t.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",style:{maxWidth:"500px",wordWrap:"break-word"},children:p})]})},xe=e=>{const s=P(i=>{var a,g;return(g=(a=i.crmContact)==null?void 0:a.data)==null?void 0:g.selectedContact}),l=A(),[n,p]=f.useState(!1),c=K(),m=()=>{p(!1)},u=()=>{p(!0)},x=async()=>{var a,g,C;p(!1);const i=await l(Q(s.id));await l(S()),(a=i==null?void 0:i.payload)!=null&&a.success?(L.push(t.jsx(k,{title:"Successfuly Deleted",type:"success",duration:2500,children:(g=i==null?void 0:i.payload)==null?void 0:g.message}),{placement:"top-end"}),c("/app/crm/contacts"),l(Z({}))):L.push(t.jsx(k,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(C=i==null?void 0:i.error)==null?void 0:C.message}),{placement:"top-end"}),await l(S())};return t.jsxs(t.Fragment,{children:[t.jsx(U,{block:!0,icon:t.jsx(oe,{}),variant:"solid",onClick:u,children:"Delete"}),t.jsx(ee,{isOpen:n,type:"danger",title:"Delete Contact",confirmButtonColor:"red-600",onClose:m,onRequestClose:m,onCancel:m,onConfirm:x,children:t.jsx("p",{children:"Are you sure you want to delete this Contact? All record related to this Contact will be deleted as well. This action cannot be undone."})})]})},ue=e=>{var l,n;const s=[e==null?void 0:e.address,(l=e==null?void 0:e.cityData)==null?void 0:l.cityName,(n=e==null?void 0:e.stateData)==null?void 0:n.stateName,e==null?void 0:e.zipcode].filter(Boolean).join(", ");return s.length>0?s:"Location not provided"},de=({data:e={}})=>{var p,c,m;const s=P(u=>{var x,i;return(i=(x=u.crmContact)==null?void 0:x.data)==null?void 0:i.selectedContact}),n=((u,x)=>{const i=u.charAt(0).toUpperCase(),a=x.charAt(0).toUpperCase();return`${i}${a}`})(e.firstName||"",e.lastName||"");return t.jsx(te,{className:"w-1/3 h-fit max-h-fit",children:t.jsxs("div",{className:"flex flex-col xl:justify-between ",children:[t.jsxs("div",{className:"flex xl:flex-col items-center gap-2",children:[t.jsx(Y,{style:{width:"60px",height:"60px",alignItems:"center",justifyContent:"center"},shape:"circle",children:t.jsx("span",{style:{fontSize:"24px",marginTop:20},children:n})}),t.jsx("h4",{className:"font-bold",children:e.name})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:[t.jsx("div",{className:"col-span-1",children:t.jsx(h,{title:"First Name",value:e.firstName})}),t.jsx("div",{className:"col-span-1",children:t.jsx(h,{title:"Last Name",value:e.lastName})}),e.title&&t.jsx("div",{className:"col-span-1",children:t.jsx(h,{title:"Title",value:e.title})}),e.email&&t.jsx(h,{title:"Email",value:e.email}),e!=null&&e.address||e!=null&&e.cityData||e!=null&&e.stateData||e!=null&&e.zipcode?t.jsx("div",{className:"col-span-1",children:t.jsx(h,{title:"Location",value:ue(e)})}):null,(e==null?void 0:e.contactNumber)&&t.jsx(h,{title:"Phone",value:e==null?void 0:e.contactNumber}),(s==null?void 0:s.cityData)&&t.jsx("div",{className:"col-span-1",children:t.jsx(h,{title:"City",value:s==null?void 0:s.cityData.cityName})}),(s==null?void 0:s.stateData)&&t.jsx("div",{className:"col-span-1",children:t.jsx(h,{title:"State",value:(p=s==null?void 0:s.stateData)==null?void 0:p.stateName})}),(e==null?void 0:e.description)&&t.jsx("div",{className:"col-span-1",children:t.jsx(h,{title:"Description",value:e==null?void 0:e.description})}),(e==null?void 0:e.tags.length)>0?t.jsxs("div",{className:"col-span-1",children:[t.jsx(h,{title:"Tags",value:""}),t.jsx(se,{fullDisplay:!0,tags:(e==null?void 0:e.tags)||[]})]}):null,((c=e==null?void 0:e.contactFields)==null?void 0:c.length)>0?t.jsx(t.Fragment,{children:(m=e==null?void 0:e.contactFields)==null?void 0:m.map((u,x)=>{var i;return t.jsxs("div",{className:"col-span-1",children:[u.value&&t.jsx(h,{title:(i=u.customKey)==null?void 0:i.name,value:u.value}),x<e.contactFields.length-1&&u.value&&t.jsx("br",{})]})})}):null]}),t.jsx("div",{className:"mt-4 flex flex-col xl:flex-row gap-2",children:t.jsx(xe,{data:e})})]})})};B("crmLeads",re);const he=()=>{const e=A(),s=y(d=>{var o,r,j,T;return(T=(j=(r=(o=d.crmContactDetails)==null?void 0:o.data)==null?void 0:r.contact)==null?void 0:j.data)==null?void 0:T.leadModels}),l=y(d=>{var o,r;return(r=(o=d.crmContactDetails)==null?void 0:o.data)==null?void 0:r.loading}),n=y(d=>{var o,r;return(r=(o=d.crmContactDetails)==null?void 0:o.data)==null?void 0:r.tableData}),{pageIndex:p,pageSize:c,sort:m,query:u,total:x}=y(d=>{var o,r;return(r=(o=d.crmContactDetails)==null?void 0:o.data)==null?void 0:r.tableData}),i=f.useCallback(()=>{e(ne())},[e]);f.useEffect(()=>(i(),()=>{window.location.pathname.includes("lead")||e(N({...n,query:""}))}),[i]);const a=f.useMemo(()=>({pageIndex:p,pageSize:c,sort:m,query:u,total:x}),[p,c,m,u,x]),g=f.useMemo(()=>[{header:"Title",accessorKey:"title",cell:o=>{const r=o.row.original.title;return t.jsx(b,{title:r,children:t.jsx(D,{text:r,maxLength:20})},r)}},{header:"Budget",accessorKey:"budget",cell:o=>{const r=o.row.original;return t.jsx(D,{text:r.budget,maxLength:20})}},{header:"Status",accessorKey:"status",cell:o=>{const r=o.row.original;return t.jsx(ie,{status:r.status})}},{header:"Reason",accessorKey:"reason",cell:o=>{var j;const r=(j=o.row.original)==null?void 0:j.reason;return r?t.jsx(b,{title:r,children:t.jsx(D,{text:r,maxLength:20})},r):t.jsx(b,{title:r,children:t.jsx(D,{text:"NA",maxLength:20})},r)}}],[]),C=d=>{const o=w(a);o.pageIndex=d,e(N(o))},$=d=>{const o=w(a);o.pageSize=Number(d),o.pageIndex=1,e(N(o))},F=d=>{const o=w(a);o.sort=d,e(N(o))};return t.jsx("div",{children:t.jsx(V,{columns:g,data:s,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:l,pagingData:{total:a.total,pageIndex:a.pageIndex,pageSize:a.pageSize},onPaginationChange:C,onSelectChange:$,onSort:F})})};B("crmContactDetails",pe);const Gt=()=>{const e=A(),s=O(),{id:l}=s,n=E(x=>{var i,a;return(a=(i=x==null?void 0:x.crmContactDetails)==null?void 0:i.data)==null?void 0:a.contact}),p=n==null?void 0:n.data,c=E(x=>{var i,a;return(a=(i=x.crmContactDetails)==null?void 0:i.data)==null?void 0:a.loading});f.useEffect(()=>{m()},[]);const m=()=>{l&&e(v(l)),e(S())},u=()=>{window.history.back()};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"15px"},children:[t.jsx("span",{className:"cursor-pointer hover:text-indigo-500 items-center lg mr-2 mt-0",style:{fontSize:"2.5rem",fontWeight:"bold",color:"black"},onClick:u,children:t.jsx(J,{})}),t.jsx("h3",{children:"Contact Details"})]}),t.jsxs(G,{className:"h-full",children:[t.jsx(W,{loading:c,children:!I(p)&&t.jsxs("div",{className:"flex flex-col xl:flex-row gap-4",children:[t.jsx(de,{data:p}),t.jsx("div",{className:"w-full",children:t.jsxs(X,{children:[t.jsx("h4",{className:"mb-3",children:"Connected Leads"}),t.jsx(he,{})]})})]})}),!c&&I(p)&&t.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:t.jsx("h3",{className:"mt-8",children:"No user found!"})})]})]})};export{Gt as default};
