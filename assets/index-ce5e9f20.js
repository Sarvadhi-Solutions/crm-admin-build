import{am as N,an as L,ao as J,ap as R,j as e,aq as A,r as n,a as D,ai as y,ar as F}from"./index-a9c93031.js";import{a as G,b as O}from"./CrmService-dbb90e89.js";import{C as h}from"./Card-6b8166bd.js";import{A as p}from"./index-7cf9b27e.js";import{F as B,a as E,b as z,c as M}from"./index.esm-be5dd2a6.js";import{B as H}from"./Button-47bf58f7.js";import{T}from"./index-10dbbba6.js";import{S as I}from"./StatusCapsule-fc455ca4.js";import{T as V}from"./TagsList-fa5ab452.js";import{T as v}from"./TextTruncate-5e1b0616.js";import{c as $,u as q,f as C,g as W}from"./index-b8d32cfc.js";import{S as g}from"./index-34112b0a.js";import{B as k}from"./Badge-c9ada007.js";import{C as S}from"./Chart-ee4379b3.js";import{C as j}from"./chart.constant-f0010f88.js";import{i as _}from"./Views-0c5423a6.js";import"./useMergeRef-788c4cb0.js";import"./Tooltip-4f11c588.js";import"./usePopper-0066ca78.js";import"./index.esm-2eb9a221.js";import"./index-0b68a97f.js";import"./context-6d5d8fe5.js";import"./index.esm-556fe943.js";import"./Alert-5526c2c4.js";import"./useTimeout-3babeb43.js";import"./index.esm-37c3564c.js";import"./CloseButton-ef1c868b.js";import"./StatusIcon-b453f46b.js";import"./Calendar-163be9bf.js";import"./useControllableState-0bc3ffd1.js";import"./index-f4f34168.js";import"./cloneDeep-fd7929db.js";import"./_Uint8Array-64cf78a6.js";import"./_MapCache-83d2f18f.js";import"./_getPrototype-71e29649.js";import"./_baseIsEqual-5cfefaa3.js";import"./get-0157bd52.js";import"./toString-60f65c59.js";import"./index-998e4641.js";import"./Input-b2bc5b3e.js";import"./isNil-f7d4f3b6.js";import"./useRootClose-6d54f280.js";import"./RangeCalendar-6b212005.js";import"./TimeInput-e8071d5e.js";import"./useUniqueId-b18fc966.js";import"./useDidUpdate-578d5c1c.js";import"./Dialog-5ef978d2.js";import"./index-0569d7d3.js";import"./Drawer-0a33fe5a.js";import"./index-137f6e4f.js";import"./useUncertainRef-762e062e.js";import"./chainedFunction-070f832c.js";import"./index-4104c7c5.js";import"./FormItem-493c2060.js";import"./index-34c577ad.js";import"./index-9de29f90.js";import"./toast-53c71514.js";import"./Pagination-acf3b7e4.js";import"./Progress-065bbc0b.js";import"./index-803b614c.js";import"./ScrollBar-ad1c4e83.js";import"./Select-90b6020d.js";import"./slicedToArray-be8619ee.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-ccb51e40.js";import"./floating-ui.dom-bef9cea3.js";import"./Skeleton-772a6f71.js";import"./index-cfb9e54d.js";import"./mapCloneElement-d91bf257.js";import"./Switcher-631d0666.js";import"./index-cbfb4a92.js";import"./Tag-624637b7.js";import"./index-2600a77d.js";import"./index-4aad4bac.js";import"./Upload-1dc8ae7e.js";import"./index.esm-c8841de1.js";import"./chart.config-18c927a4.js";const K="crmDashboard",b=N("crmDashboard/data/dashboard",async()=>(await G()).data),P=N("crmDashboard/data/dashboard/tasks",async a=>(await O(a)).data),Q={loading:!0,dashboardData:{}},U=L({name:`${K}/state`,initialState:Q,reducers:{},extraReducers:a=>{a.addCase(b.fulfilled,(s,t)=>{s.dashboardData=t.payload.crmDashboardData,s.loading=!1}).addCase(b.pending,s=>{s.loading=!0})}}),X=U.reducer,Y=J({data:X}),f=R,Z=({type:a})=>{switch(a){case"newLeads":return e.jsx(p,{size:55,className:"bg-indigo-100 text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-100",icon:e.jsx(M,{})});case"company":return e.jsx(p,{size:55,className:"bg-cyan-100 text-cyan-600 dark:bg-cyan-500/20 dark:text-cyan-100",icon:e.jsx(z,{})});case"clients":return e.jsx(p,{size:55,className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100",icon:e.jsx(E,{})});case"task":return e.jsx(p,{size:55,className:"bg-amber-100 text-amber-600 dark:bg-amber-500/20 dark:text-amber-100",icon:e.jsx(B,{})});default:return e.jsx("div",{})}},ee=({data:a={}})=>e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Z,{type:a.key}),e.jsx("div",{children:e.jsxs("div",{className:"flex gap-1.5 items-end mb-2",children:[e.jsx("h3",{className:"font-bold leading-none",children:a.value}),e.jsx("p",{className:"font-semibold",children:a.label})]})})]})}),ae=({data:a=[]})=>e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4",children:a.map(s=>e.jsx(ee,{data:s},s.key))}),{Tr:w,Td:se,TBody:te,THead:re,Th:ie}=T,m=$(),oe=[m.accessor("associatedContact",{header:"Associated Contact",cell:a=>a.row.original.contactData.firstName+" "+a.row.original.contactData.lastName}),m.accessor("details",{header:"Details",cell:a=>{const s=a.row.original;return e.jsx(v,{text:s.details,maxLength:30})}}),m.accessor("status",{header:"Status",cell:a=>{const s=a.row.original;return e.jsx(I,{status:s.status})}}),m.accessor("tags",{header:"Tags",cell:a=>{const s=a.row.original;return e.jsx(V,{tags:s.tags})}}),m.accessor("notes",{header:"Notes",cell:a=>{const s=a.row.original.notes;return e.jsx(v,{text:s,maxLength:30})}})],ne=({data:a=[],className:s})=>{const t=A(),r=q({data:a,columns:oe,getCoreRowModel:W()}),d=()=>{t("/app/crm/leads")};return e.jsxs(h,{className:s,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{children:"Leads"}),e.jsx(H,{size:"sm",onClick:d,children:"View All Leads"})]}),e.jsxs(T,{children:[e.jsx(re,{children:r.getHeaderGroups().map(o=>e.jsx(w,{children:o.headers.map(i=>e.jsx(ie,{colSpan:i.colSpan,children:C(i.column.columnDef.header,i.getContext())},i.id))},o.id))}),e.jsx(te,{children:r.getRowModel().rows.map(o=>e.jsx(w,{children:o.getVisibleCells().map(i=>e.jsx(se,{children:C(i.column.columnDef.cell,i.getContext())},i.id))},o.id))})]})]})},u=({label:a,value:s,badgeClass:t,showBadge:r=!0})=>e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx(k,{className:"mt-2.5",innerClass:t}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold",children:s}),e.jsx("p",{children:a})]})]}),ce={chart:{daily:{onGoing:13,finished:9,total:21,series:[{name:"On Going",data:[20,19,18,14,12,10]},{name:"Finished",data:[1,4,8,15,16,18]}],range:["6:00am","9:00am","12:00pm","03:00pm","06:00pm","09:00pm"]},weekly:{onGoing:126,finished:87,total:213,series:[{name:"On Going",data:[45,52,68,84,103,112,126]},{name:"Finished",data:[35,41,62,62,75,81,87]}],range:["21 Jan","22 Jan","23 Jan","24 Jan","25 Jan","26 Jan","27 Jan"]},monthly:{onGoing:270,finished:113,total:383,series:[{name:"On Going",data:[28,52,91,154,227,256,270]},{name:"Finished",data:[22,31,74,88,97,107,113]}],range:["01 Jan","05 Jan","10 Jan","15 Jan","20 Jan","25 Jan","27 Jan"]}}},le=({className:a})=>{const[s,t]=n.useState(["weekly"]),[r,d]=n.useState(ce),[o,i]=n.useState(!1),x=f(c=>c.theme.layout.sideNavCollapse);n.useEffect(()=>{i(!0);const c=setTimeout(()=>i(!1),300);return()=>{clearTimeout(c)}},[r,x]);const l=D();return n.useEffect(()=>{l(P({selectedDate:"month"}))},[s]),e.jsxs(h,{className:a,children:[e.jsxs("div",{className:"flex sm:flex-row flex-col md:items-center justify-between mb-6 gap-4",children:[e.jsx("h4",{children:"Tasks Overview"}),e.jsxs(g,{value:s,size:"sm",onChange:c=>t(c),children:[e.jsx(g.Item,{value:"monthly",children:"Monthly"}),e.jsx(g.Item,{value:"weekly",children:"Weekly"})]})]}),!_(r)&&!o&&r.chart&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{children:e.jsx(u,{showBadge:!1,label:"Total Tasks",value:r.chart[s[0]].total})}),e.jsxs("div",{className:"flex gap-x-6",children:[e.jsx(u,{badgeClass:"bg-indigo-600",label:r.chart[s[0]].series[0].name,value:r.chart[s[0]].onGoing}),e.jsx(u,{badgeClass:"bg-emerald-500",label:r.chart[s[0]].series[1].name,value:r.chart[s[0]].finished})]})]}),e.jsx("div",{children:e.jsx(S,{series:r.chart[s[0]].series,xAxis:r.chart[s[0]].range,type:"bar",customOptions:{colors:[j[0],j[2]],legend:{show:!1}}})})]}),e.jsx(y,{loading:o,type:"cover",children:o&&e.jsx("div",{className:"h-[300px]"})})]})},me=({data:a={labels:[],data:[]}})=>e.jsxs(h,{children:[e.jsx("h4",{children:"Leads"}),e.jsx("div",{className:"mt-6",children:a.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{donutTitle:`${a.data.reduce((s,t)=>s+t,0)}`,donutText:"Leads",series:a.data,customOptions:{labels:a.labels},type:"donut"}),a.data.length===a.labels.length&&e.jsx("div",{className:"mt-6 grid grid-cols-2 gap-4 max-w-[180px] mx-auto",children:a.labels.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{badgeStyle:{backgroundColor:j[t]}}),e.jsx("span",{className:"font-semibold",children:s})]},s))})]})})]});F("crmDashboard",Y);const de=()=>{const a=D(),{statisticData:s,recentLeadsData:t}=f(i=>i.crmDashboard.data.dashboardData),r=f(i=>i.crmDashboard.data.loading);n.useEffect(()=>{d()},[]);const d=()=>{a(b())},o=n.useMemo(()=>{const i=(t==null?void 0:t.filter(l=>l.status==="active").length)||0,x=(t==null?void 0:t.filter(l=>l.status==="deactive").length)||0;return{labels:["Active","Deactive"],data:[i,x]}},[t]);return e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs(y,{loading:r,children:[e.jsx(ae,{data:s}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx(le,{className:"col-span-2"}),e.jsx(me,{data:o})]}),e.jsx(ne,{data:t})]})})},Ea=de;export{Ea as default};
