import{a as N,r as h,j as e,ar as de}from"./index-b09faefa.js";import{A as pe}from"./AdaptableCard-9a87f3ff.js";import{F as H}from"./FormDesription-3c84f725.js";import{D as ue}from"./DataTable-ca158282.js";import{u as f,a as xe,f as he,b as fe,e as ge,s as P,g as $,c as Z,d as Ce,h as U,t as _,i as be,j as V,k as Y,l as ee,r as je}from"./index-36def105.js";import{u as te}from"./useThemeClass-ee0e86a7.js";import{B as K}from"./Button-3bdf4581.js";import{D as Ne}from"./Drawer-1ea16c4a.js";import{T as ae}from"./index-addd5e63.js";import{a as b,F as ye}from"./FormItem-cdcc11d5.js";import{u as we,b as y,F as De,a as ve}from"./formik.esm-93e44345.js";import{c as Se,a as j,b as Te}from"./index.esm-333232d6.js";import{t as k,N as L}from"./toast-2c9f9fcf.js";import{I as w}from"./Input-8c731b0c.js";import{D as Ie,t as Fe,c as Ae}from"./tagAndCategory-2dd74600.js";/* empty css              */import{A as ke}from"./index.esm-ef7b0069.js";import{aa as Le,a7 as Q,b as Ee,d as Me}from"./index.esm-2c67faf2.js";import{b as B,a as Oe,T as qe}from"./index.esm-aece8080.js";import"./Alert-a515d81f.js";import"./index-2f1f758f.js";import{B as se}from"./Badge-d1515062.js";import"./Calendar-6959847d.js";import"./Card-33431fc8.js";import"./index-c173cf47.js";import"./index-82bb2b50.js";import"./Dialog-a2bd00be.js";import"./index-96409d01.js";import"./toString-9cef9a7f.js";import"./index-c886a512.js";import"./index-056a1440.js";import"./index-ae319e32.js";import"./Pagination-d71ebe95.js";import"./Progress-a1e68dcb.js";import"./index-bc0f434c.js";import"./RangeCalendar-b4e9e88f.js";import"./ScrollBar-a256ec53.js";import"./index-d106a35e.js";import{S as oe,c as ze}from"./Select-71db8857.js";import"./Skeleton-5bf82d8e.js";import"./index-975733af.js";import"./Switcher-e643b9c6.js";import"./index-a157bc37.js";import"./Tag-0d544e3b.js";import"./index-ba770d43.js";import"./index-dd0b5a15.js";import"./Tooltip-5b8c5fcd.js";import"./Upload-8f332031.js";import{c as R}from"./cloneDeep-de9ec659.js";import{T as Re}from"./TagsList-a530de63.js";import{u as W}from"./checkEditUpdate-cffc7ae3.js";import{C as $e}from"./ConfirmDialog-1096cdd6.js";import{T as A}from"./TextTruncate-222d0204.js";import{d as Ve}from"./debounce-24a9e0ff.js";import"./TableRowSkeleton-a83d3c9d.js";import"./index-e08096fb.js";import"./CrmService-5f2f53bd.js";import"./context-80e77f1b.js";import"./index-8c214619.js";import"./Views-57e82c67.js";import"./CloseButton-13cd4a8c.js";import"./useControllableState-5d01e6b9.js";import"./index-62df96f3.js";import"./useTimeout-68d097ea.js";import"./StatusIcon-b02f9bab.js";import"./chainedFunction-070f832c.js";import"./isNil-f81aee01.js";import"./get-263a9377.js";import"./_MapCache-a97510fd.js";import"./useMergeRef-788c4cb0.js";import"./_Uint8Array-b1a93c95.js";import"./_baseIsEqual-77ddc906.js";import"./useRootClose-3c97a09c.js";import"./usePopper-29fe3cd5.js";import"./TimeInput-23ce06d7.js";import"./useUniqueId-6d806f5c.js";import"./useDidUpdate-ec3bfb81.js";import"./useUncertainRef-b762bd82.js";import"./slicedToArray-00fbfd7c.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-f69b773e.js";import"./floating-ui.dom-bef9cea3.js";import"./mapCloneElement-ef910f8e.js";import"./index.esm-dbc068f5.js";import"./index.esm-7a963ea9.js";import"./index.esm-a78f5b32.js";import"./_getPrototype-3540f1e6.js";const z=[],Ke=a=>{const{touched:s,errors:t,values:o,setFieldValue:i}=a,n=N(),[m,g]=h.useState(!1),[l,u]=h.useState(!1),[D,C]=h.useState([]),[E,v]=h.useState([]),S=()=>{g(!m),u(!1)},T=f(x=>x.crmContact.data.companyList);z.length=0,T.forEach(x=>{z.push({value:x.id,label:x.companyName})});const[d,r]=h.useState("");h.useEffect(()=>{(async()=>{var I,J;try{const{payload:O}=await n(he()),q=(I=O==null?void 0:O.data)==null?void 0:I.find(F=>(F==null?void 0:F.moduleName)==="contacts");if(r(q.id),q){const{payload:F}=await n(fe({id:(J=q==null?void 0:q.id)==null?void 0:J.toString()})),le=Fe(F.data),me=Ae(F.data);v(me),C(le)}}catch(O){console.error("Error fetching module data:",O)}})(),n(xe())},[n]);const p=f(x=>x.crmContact.data.selectedContact),[M,c]=h.useState(p?p.tags||[]:[]),G=we(),ce=x=>{c(x);const I=[x.value];G.setFieldValue("tagId",I)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Contact Basic Information",desc:"",className:"mb-2"}),e.jsx(b,{label:"First Name *",invalid:t.firstName&&s.firstName,errorMessage:t.firstName,children:e.jsx(y,{type:"text",autoComplete:"off",name:"firstName",placeholder:"First Name",component:w,prefix:e.jsx(Le,{className:"text-xl"})})}),e.jsx(b,{label:"Last Name *",invalid:t.lastName&&s.lastName,errorMessage:t.lastName,children:e.jsx(y,{type:"text",autoComplete:"off",name:"lastName",placeholder:"Last Name",component:w,prefix:e.jsx(Q,{className:"text-xl"})})}),e.jsx(b,{label:"Title",invalid:t.title&&s.title,errorMessage:t.title,children:e.jsx(y,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:w,prefix:e.jsx(Q,{className:"text-xl"})})}),e.jsx(b,{label:"Email *",invalid:t.email&&s.email,errorMessage:t.email,children:e.jsx(y,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:w,prefix:e.jsx(B,{className:"text-xl"})})}),e.jsx(b,{label:"Contact Number *",invalid:t.contactNumber&&s.contactNumber,errorMessage:t.contactNumber,children:e.jsx(y,{type:"text",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:w,prefix:e.jsx(ke,{className:"text-xl"})})}),e.jsx(b,{label:"Description",invalid:t.description&&s.description,errorMessage:t.description,children:e.jsx(y,{type:"text",autoComplete:"off",name:"description",placeholder:"Description",component:w,prefix:e.jsx(Oe,{className:"text-xl"})})}),e.jsx(H,{title:"Contact Others Details",desc:"",className:"mb-2"}),e.jsx(b,{label:"Company Name",invalid:t.companiesId&&s.companiesId,errorMessage:t.companiesId,children:e.jsx(oe,{name:"companiesId",placeholder:"Company Name",options:z,id:"companiesId",value:z.find(x=>(x==null?void 0:x.value)==(o==null?void 0:o.companiesId)),onChange:x=>{const I=x.value;i("companiesId",I||"")}})}),e.jsx(b,{label:"Source",invalid:t.source&&s.source,errorMessage:t.source,children:e.jsx(y,{type:"text",autoComplete:"off",name:"source",placeholder:"Source",component:w,prefix:e.jsx(B,{className:"text-xl"})})}),e.jsx(b,{label:"Address",invalid:t.address&&s.address,errorMessage:t.address,children:e.jsx(y,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:w,prefix:e.jsx(B,{className:"text-xl"})})}),e.jsx("div",{style:{position:"relative"},children:e.jsx(b,{label:"Tag",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(y,{name:"tagId",component:Ie,options:D,placeholder:"Select a Tag",value:G.initialValues.tagName,onChange:ce}),e.jsx(qe,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{S(),u(!0)}})]})})})]})},Be=Se().shape({firstName:j().required("First Name is required"),lastName:j().required("Last Name is required"),title:j(),contactNumber:j().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",a=>!isNaN(a)).test("is-ten-digits"," Contact must be exactly 10 digits",a=>{if(a){const s=Number(a);return/^\d{10}$/.test(s.toString())}return!0}).test("is-not-more-than-ten-digits","Contact must not exceed 10 digits",a=>a?Number(a).toString().length<=10:!0),email:j().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),address:j(),companiesId:j().nullable(),companyName:j(),source:j(),description:j(),tagId:Te()});console.log(z,"company optionsssssssss");const{TabNav:He,TabList:Pe,TabContent:Ze}=ae,re=h.forwardRef((a,s)=>{var n,m,g,l;const t=f(u=>u.crmContact.data.selectedContact),o=!!t.id,i=N();return e.jsx(De,{innerRef:s,initialValues:{firstName:(t==null?void 0:t.firstName)||"",lastName:(t==null?void 0:t.lastName)||"",title:(t==null?void 0:t.title)||"",email:(t==null?void 0:t.email)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",description:(t==null?void 0:t.description)||"",companyName:((n=t==null?void 0:t.company)==null?void 0:n.companyName)||"",source:(t==null?void 0:t.source)||"",address:(t==null?void 0:t.address)||"",tagName:((g=(m=t==null?void 0:t.tags)==null?void 0:m[0])==null?void 0:g.tagName)||"",tagId:((l=t==null?void 0:t.tags)==null?void 0:l.map(u=>u.id))||[],companiesId:(t==null?void 0:t.companiesId)||""},validationSchema:Be,onSubmit:async(u,{setSubmitting:D})=>{var S,T,d,r,p,M;const{colorName:C,tagName:E,...v}=u;if(o===!0){const c=await i(ge({contactId:(t==null?void 0:t.id)||"",updatedData:v}));(S=c==null?void 0:c.payload)!=null&&S.success?k.push(e.jsx(L,{title:"Successfully Added",type:"success",duration:2500,children:(T=c==null?void 0:c.payload)==null?void 0:T.message}),{placement:"top-end"}):k.push(e.jsx(L,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(d=c==null?void 0:c.error)==null?void 0:d.message}),{placement:"top-end"}),i(P()),await i($()),await i(Z())}else{const c=await i(Ce(v));(r=c==null?void 0:c.payload)!=null&&r.success?k.push(e.jsx(L,{title:"Successfully Added",type:"success",duration:2500,children:(p=c==null?void 0:c.payload)==null?void 0:p.message}),{placement:"top-end"}):k.push(e.jsx(L,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(M=c==null?void 0:c.error)==null?void 0:M.message}),{placement:"top-end"}),i(P()),await i($()),await i(Z())}D(!1)},children:({touched:u,errors:D,values:C,setFieldValue:E})=>e.jsx(ve,{children:e.jsx(ye,{children:e.jsxs(ae,{defaultValue:"personalInfo",children:[e.jsx(Pe,{children:e.jsx(He,{value:"personalInfo",children:"Contact Details"})}),e.jsx("div",{className:"p-6",children:e.jsx(Ze,{value:"personalInfo",children:e.jsx(Ke,{touched:u,errors:D,values:C,setFieldValue:E})})})]})})})})});re.displayName="ContactForm";const ne=h.forwardRef((a,s)=>{N();const t=f(i=>i.crmContact.data.selectedContact);f(i=>i.crmContact.data.contactList);const o=async i=>{};return e.jsx(re,{ref:s,contact:t,onFormSubmit:o})});ne.displayName="ContactEditContent";const _e=({onSaveClick:a,onCancel:s})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(K,{size:"sm",className:"mr-2",onClick:s,children:"Cancel"}),e.jsx(K,{size:"sm",variant:"solid",onClick:a,children:"Save"})]}),We=()=>{const a=N(),s=f(n=>n.crmContact.data.drawerOpen),t=()=>{a(P()),a(U({}))},o=h.useRef(null),i=()=>{var n,m;console.log("formSubmit function called",(n=o.current)==null?void 0:n.values),(m=o.current)==null||m.submitForm()};return e.jsx(Ne,{isOpen:s,closable:!1,bodyClass:"p-0",footer:e.jsx(_e,{onCancel:t,onSaveClick:i}),onClose:t,onRequestClose:t,children:e.jsx(ne,{ref:o})})},Ue=()=>{const a=N(),s=f(n=>n.crmContact.data.deleteConfirmation),t=f(n=>n.crmContact.data.selectedContact),o=()=>{a(_(!1))},i=async()=>{var m,g,l;a(_(!1));const n=await a(be(t==null?void 0:t.id));(m=n==null?void 0:n.payload)!=null&&m.success?k.push(e.jsx(L,{title:"Successfuly Deleted",type:"success",duration:2500,children:(g=n==null?void 0:n.payload)==null?void 0:g.message}),{placement:"top-end"}):k.push(e.jsx(L,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(l=n==null?void 0:n.error)==null?void 0:l.message}),{placement:"top-end"}),await a($()),await a(Z())};return e.jsx($e,{isOpen:s,type:"danger",title:"Delete Contact",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this Contact? All record related to this contact will be deleted as well. This action cannot be undone."})})},Ge=({row:a})=>{const{textTheme:s}=te(),t=N(),o=()=>{t(Y()),t(U(a))};return e.jsx("div",{className:`${s} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},Je=({row:a})=>{const{textTheme:s}=te(),t=N(),o=async()=>{t(U(a)),t(_(!0))};return e.jsx("div",{className:`${s} cursor-pointer select-none font-semibold text-red-500`,onClick:o,children:"Delete"})},Qe=()=>{const a=N(),s=f(d=>d.crmContact.data.displayedContactList),t=W("contacts","canModify"),o=W("contacts","canDelete"),i=f(d=>d.crmContact.data.loading),{pageIndex:n,pageSize:m,sort:g,query:l,total:u}=f(d=>d.crmContact.data.tableData),D=h.useCallback(()=>{a($())},[a]);h.useEffect(()=>{D()},[D]);const C=h.useMemo(()=>({pageIndex:n,pageSize:m,sort:g,query:l,total:u}),[n,m,g,l,u]),E=h.useMemo(()=>{const d=[{header:"Name",accessorKey:"firstName",cell:r=>{const{firstName:p,lastName:M}=r.row.original,c=`${p} ${M}`;return e.jsx(A,{text:c,maxLength:100})}},{header:"email",accessorKey:"email",cell:r=>r.row.original.email},{header:"Number",accessorKey:"contactNumber",cell:r=>r.row.original.contactNumber},{header:"source",accessorKey:"source",cell:r=>{const p=r.row.original.source;return e.jsx(A,{text:p,maxLength:15})}},{header:"Tags",accessorKey:"tagName",cell:r=>{const p=r.row.original.tags||[];return e.jsx(Re,{tags:p})}},{header:"Title",accessorKey:"title",cell:r=>{const p=r.row.original.title;return e.jsx(A,{text:p,maxLength:20})}},{header:"Company",accessorKey:"companyName",cell:r=>{const p=r.row.original.company?r.row.original.company.companyName:"";return e.jsx(A,{text:p,maxLength:25})}},{header:"address",accessorKey:"address",cell:r=>{const p=r.row.original.address;return e.jsx(A,{text:p,maxLength:20})}},{header:"description",accessorKey:"description",cell:r=>{const p=r.row.original.description;return e.jsx(A,{text:p,maxLength:20})}}];return o&&d.unshift({header:"Delete",id:"action",cell:r=>e.jsx(Je,{row:r.row.original})}),t&&d.unshift({header:"Edit",id:"action",cell:r=>e.jsx(Ge,{row:r.row.original})}),d},[t,o]),v=d=>{const r=R(C);r.pageIndex=d,a(V(r))},S=d=>{const r=R(C);r.pageSize=Number(d),r.pageIndex=1,a(V(r))},T=d=>{const r=R(C);r.sort=d,a(V(r))};return e.jsxs("div",{children:[e.jsx(ue,{columns:E,data:s,loading:i,pagingData:{total:C.total,pageIndex:C.pageIndex,pageSize:C.pageSize},onPaginationChange:v,onSelectChange:S,onSort:T}),e.jsx(We,{}),e.jsx(Ue,{})]})},ie=h.forwardRef((a,s)=>{const{onInputChange:t}=a,o=Ve(i,500);function i(m){t==null||t(m)}const n=m=>{o(m.target.value)};return e.jsx(w,{ref:s,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(Ee,{className:"text-lg"}),onChange:n})});ie.displayName="ContactTableSearch";const{Control:Xe}=ze,X=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],Ye=({innerProps:a,label:s,data:t,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...a,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{innerClass:t.color}),e.jsx("span",{children:s})]}),o&&e.jsx(Me,{className:"text-emerald-500 text-xl"})]}),et=({children:a,...s})=>{const t=s.getValue()[0];return e.jsxs(Xe,{...s,children:[t&&e.jsx(se,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),a]})},tt=()=>{const a=N(),{status:s}=f(o=>o.crmContact.data.filterData),t=o=>{a(ee({status:o==null?void 0:o.value}))};return e.jsx(oe,{options:X,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:Ye,Control:et},value:X.filter(o=>o.value===s),onChange:t})},at=()=>{const a=N(),s=h.useRef(null),t=f(l=>l.crmContact.data.tableData),o=W("contacts","canCreate"),i=l=>{const u=R(t);u.query=l,u.pageIndex=1,typeof l=="string"&&l.length>1&&n(u),typeof l=="string"&&l.length===0&&n(u)},n=l=>{a(V(l)),a($())},m=()=>{const l=R(t);l.query="",s.current&&(s.current.value=""),a(ee({status:""})),n(l)},g=()=>{a(Y())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(ie,{ref:s,onInputChange:i}),e.jsx(tt,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(K,{size:"sm",className:"me-2",onClick:m,children:"Clear All"}),o&&e.jsx(K,{size:"sm",onClick:g,children:"Add New"})]})]})};de("crmContact",je);const st=()=>{const a=f(s=>s.crmContact.data.tableData);return e.jsx(e.Fragment,{children:e.jsxs(pe,{bodyClass:"h-full",children:[e.jsx(H,{title:`Contacts (${a==null?void 0:a.total})`,desc:"",className:"mb-2"}),e.jsx(at,{}),e.jsx(Qe,{})]})})},$a=st;export{$a as default};
