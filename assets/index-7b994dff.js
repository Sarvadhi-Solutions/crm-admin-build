import{a as b,r as u,j as e,ai as me,ar as de}from"./index-4bd6b7b3.js";import{A as pe}from"./AdaptableCard-4c3d12d7.js";import{D as ue}from"./DataTable-8887d7ed.js";import{u as h,a as xe,f as he,b as ge,e as fe,g as K,s as B,c as H,d as Ce,h as Z,t as U,i as je,j as $,k as Y,l as ee,r as Ne}from"./index-645bdb95.js";import{u as te}from"./useThemeClass-b8c9a717.js";import{B as P}from"./Button-39d85f08.js";import{D as be}from"./Drawer-71237173.js";import{T as ae}from"./index-00b89123.js";import{a as f,F as ye}from"./FormItem-e2a22149.js";import{u as we,b as C,F as De,a as ve}from"./formik.esm-a048d78e.js";import{c as Se,a as N,f as Te,b as Ae}from"./index.esm-3518a165.js";import{t as E,N as M}from"./toast-88ff7e3e.js";import{I as j}from"./Input-1462fe73.js";import{a6 as Ie,a7 as Fe,a8 as _,b as ke,d as qe,m as Le,a9 as Ee}from"./index.esm-0cdca32a.js";import{A as G}from"./index.esm-24d8aaa0.js";import{a as Me,T as Oe,b as z}from"./index.esm-54d5fc4e.js";import{D as J,A as ze,t as Re,c as Ke}from"./AdditionalTag-1f0b69bf.js";/* empty css              */import{c as R}from"./cloneDeep-9b3959e9.js";import{a as v,T as Ve}from"./TextTruncate-9217c160.js";import{u as W}from"./checkEditUpdate-fe7a3157.js";import{C as $e}from"./ConfirmDialog-5a804371.js";import{d as He}from"./debounce-1894c673.js";import{S as Pe,c as Be}from"./Select-938bf375.js";import{B as se}from"./Badge-80e10abc.js";import{C as Ue}from"./Card-526fc8df.js";import{A as We}from"./index-875ce0f2.js";import{M as Ze}from"./MediaSkeleton-6059d4e5.js";import{N as _e}from"./react-number-format.es-61c35378.js";import"./index-2d18d6c2.js";import"./index.esm-9d1f44b1.js";import"./Pagination-22ec60b1.js";import"./index-e9ce1b4a.js";import"./_Uint8Array-04aa9e28.js";import"./_MapCache-9c7f01dc.js";import"./Views-d9a5bf10.js";import"./_baseIsEqual-a094f75a.js";import"./get-2d6f452a.js";import"./toString-a7228545.js";import"./TableRowSkeleton-f238368d.js";import"./Skeleton-e8e73738.js";import"./index-030d990e.js";import"./CrmService-6ced694a.js";import"./context-a8cf3940.js";import"./index-8b930c29.js";import"./CloseButton-6e2e0ec5.js";import"./useControllableState-259714d7.js";import"./index-06706b89.js";import"./useTimeout-f676b9da.js";import"./StatusIcon-8490d43a.js";import"./chainedFunction-070f832c.js";import"./isNil-ae028dac.js";import"./Alert-7657f3d7.js";import"./Calendar-c92b9cfd.js";import"./index-20aa5a1a.js";import"./useMergeRef-788c4cb0.js";import"./useRootClose-5ed82cf8.js";import"./usePopper-ea474854.js";import"./RangeCalendar-0a16d493.js";import"./TimeInput-05c24087.js";import"./useUniqueId-a782b7b3.js";import"./useDidUpdate-f7d2ff2b.js";import"./Dialog-974a1028.js";import"./index-10374e44.js";import"./useUncertainRef-4756ae3b.js";import"./index-5ed9ba61.js";import"./index-f24b5e4f.js";import"./index-6ca15321.js";import"./Progress-4167b7c4.js";import"./index-b212dc1a.js";import"./ScrollBar-c9c4e4cf.js";import"./index-5de84849.js";import"./index-6080bacd.js";import"./mapCloneElement-bf192649.js";import"./Switcher-83573e00.js";import"./Tag-bcb5cf48.js";import"./index-b945cf70.js";import"./index-f4634923.js";import"./Tooltip-0c11394e.js";import"./index.esm-07747377.js";import"./Upload-a4e0db34.js";import"./index.esm-4ed14753.js";import"./_getPrototype-715b1198.js";import"./slicedToArray-e2770cb7.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-3723ed4f.js";import"./floating-ui.dom-bef9cea3.js";const Ge=s=>{const{touched:a,errors:t}=s,o=b(),[i,n]=u.useState(!1),[c,g]=u.useState(!1),[l,x]=u.useState([]),[S,A]=u.useState([]),D=()=>{n(!i),g(!1)},[I,F]=u.useState([]);u.useEffect(()=>{(async()=>{try{const{payload:w}=await o(xe()),V=w.data.map(T=>({value:T.id,label:T.companyName}));F(V)}catch(w){console.error("Error fetching company data:",w)}})()},[o]);const[k,q]=u.useState("");u.useEffect(()=>{(async()=>{var w,V;try{const{payload:T}=await o(he()),O=(w=T==null?void 0:T.data)==null?void 0:w.find(L=>(L==null?void 0:L.moduleName)==="contacts");if(q(O.id),O){const{payload:L}=await o(ge({id:(V=O==null?void 0:O.id)==null?void 0:V.toString()})),ce=Re(L.data),le=Ke(L.data);A(le),x(ce)}}catch(T){console.error("Error fetching module data:",T)}})()},[o]);const p=h(y=>y.crmContact.data.selectedContact),[r,m]=u.useState(p?p.tags||[]:[]),d=we(),ie=y=>{m(y);const w=[y.value];d.setFieldValue("tagId",w)};return e.jsxs(e.Fragment,{children:[e.jsx(f,{label:"Name",invalid:t.name&&a.name,errorMessage:t.name,children:e.jsx(C,{type:"text",autoComplete:"off",name:"name",placeholder:"Name",component:j,prefix:e.jsx(Ie,{className:"text-xl"})})}),e.jsx(f,{label:"First Name",invalid:t.firstName&&a.firstName,errorMessage:t.firstName,children:e.jsx(C,{type:"text",autoComplete:"off",name:"firstName",placeholder:"First Name",component:j,prefix:e.jsx(Fe,{className:"text-xl"})})}),e.jsx(f,{label:"Last Name",invalid:t.lastName&&a.lastName,errorMessage:t.lastName,children:e.jsx(C,{type:"text",autoComplete:"off",name:"lastName",placeholder:"Last Name",component:j,prefix:e.jsx(_,{className:"text-xl"})})}),e.jsx(f,{label:"Title",invalid:t.title&&a.title,errorMessage:t.title,children:e.jsx(C,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:j,prefix:e.jsx(_,{className:"text-xl"})})}),e.jsx(f,{label:"Description",invalid:t.description&&a.description,errorMessage:t.description,children:e.jsx(C,{type:"text",autoComplete:"off",name:"description",placeholder:"Description",component:j,prefix:e.jsx(Me,{className:"text-xl"})})}),e.jsx(f,{label:"Contact Number",invalid:t.contactNumber&&a.contactNumber,errorMessage:t.contactNumber,children:e.jsx(C,{type:"text",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:j,prefix:e.jsx(G,{className:"text-xl"})})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(f,{label:"Tag",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(C,{name:"tagId",component:J,options:l,placeholder:"Select a Tag",value:d.initialValues.tagName,onChange:ie}),e.jsx(Oe,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{D(),g(!0)}})]})}),e.jsx(ze,{isOpen:i,categoryList:S,moduleName:k,onOpenChange:y=>n(y)})]}),e.jsx(f,{label:"Email",invalid:t.email&&a.email,errorMessage:t.email,children:e.jsx(C,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:j,prefix:e.jsx(z,{className:"text-xl"})})}),e.jsx(f,{label:"Address",invalid:t.address&&a.address,errorMessage:t.address,children:e.jsx(C,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:j,prefix:e.jsx(z,{className:"text-xl"})})}),e.jsx(f,{label:"Company Name",children:e.jsx(C,{type:"text",autoComplete:"off",name:"companyName",placeholder:"Company Name",options:I,value:d.initialValues.companyName,component:J,prefix:e.jsx(G,{className:"text-xl"}),onChange:y=>{const w=y.value;d.setFieldValue("companiesId",w)}})}),e.jsx(f,{label:"Position",invalid:t.position&&a.position,errorMessage:t.position,children:e.jsx(C,{type:"text",autoComplete:"off",name:"position",placeholder:"Position",component:j,prefix:e.jsx(z,{className:"text-xl"})})}),e.jsx(f,{label:"Source",invalid:t.source&&a.source,errorMessage:t.source,children:e.jsx(C,{type:"text",autoComplete:"off",name:"source",placeholder:"Source",component:j,prefix:e.jsx(z,{className:"text-xl"})})}),e.jsx(f,{label:"Notes",invalid:t.notes&&a.notes,errorMessage:t.notes,children:e.jsx(C,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:j,prefix:e.jsx(z,{className:"text-xl"})})})]})},Je=Se().shape({name:N().required("Name is required"),firstName:N().required("First Name is required"),lastName:N().required("Last Name is required"),title:N().required("Title is required"),contactNumber:Te().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",s=>!isNaN(s)).test("is-ten-digits"," Contact must be exactly 10 digits",s=>{if(s){const a=Number(s);return/^\d{10}$/.test(a.toString())}return!0}).test("is-not-more-than-ten-digits","Contact must not exceed 10 digits",s=>s?Number(s).toString().length<=10:!0),email:N().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),address:N().required("Address is required"),companiesId:N(),position:N().required("Position is required"),source:N().required("Source is required"),description:N().required("Description Is Required"),notes:N(),tagId:Ae()}),{TabNav:Qe,TabList:Xe,TabContent:Ye}=ae,oe=u.forwardRef((s,a)=>{var n,c,g,l;const t=h(x=>x.crmContact.data.selectedContact),o=!!t.id,i=b();return e.jsx(De,{innerRef:a,initialValues:{name:(t==null?void 0:t.name)||"",firstName:(t==null?void 0:t.firstName)||"",lastName:(t==null?void 0:t.lastName)||"",title:(t==null?void 0:t.title)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",companyName:((n=t==null?void 0:t.company)==null?void 0:n.companyName)||"",tagName:((g=(c=t==null?void 0:t.tags)==null?void 0:c[0])==null?void 0:g.tagName)||"",email:(t==null?void 0:t.email)||"",address:(t==null?void 0:t.address)||"",companiesId:(t==null?void 0:t.companiesId)||null,position:(t==null?void 0:t.position)||"",source:(t==null?void 0:t.source)||"",description:(t==null?void 0:t.description)||"",notes:(t==null?void 0:t.notes)||"",tagId:((l=t==null?void 0:t.tags)==null?void 0:l.map(x=>x.id))||[]},validationSchema:Je,onSubmit:async(x,{setSubmitting:S})=>{var F,k,q,p,r,m;const{colorName:A,tagName:D,...I}=x;if(console.log(A),o===!0){const d=await i(fe({contactId:(t==null?void 0:t.id)||"",updatedData:I}));(F=d==null?void 0:d.payload)!=null&&F.success?E.push(e.jsx(M,{title:"Successfully Added",type:"success",duration:2500,children:(k=d==null?void 0:d.payload)==null?void 0:k.message}),{placement:"top-center"}):E.push(e.jsx(M,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(q=d==null?void 0:d.payload)==null?void 0:q.message}),{placement:"top-center"}),await i(K()),await i(B()),await i(H())}else{const d=await i(Ce(I));(p=d==null?void 0:d.payload)!=null&&p.success?E.push(e.jsx(M,{title:"Successfully Added",type:"success",duration:2500,children:(r=d==null?void 0:d.payload)==null?void 0:r.message}),{placement:"top-center"}):E.push(e.jsx(M,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(m=d==null?void 0:d.payload)==null?void 0:m.message}),{placement:"top-center"}),await i(K()),await i(B()),await i(H())}S(!1)},children:({touched:x,errors:S})=>e.jsx(ve,{children:e.jsx(ye,{children:e.jsxs(ae,{defaultValue:"personalInfo",children:[e.jsx(Xe,{children:e.jsx(Qe,{value:"personalInfo",children:"Contact Detail"})}),e.jsx("div",{className:"p-6",children:e.jsx(Ye,{value:"personalInfo",children:e.jsx(Ge,{touched:x,errors:S})})})]})})})})});oe.displayName="ContactForm";const re=u.forwardRef((s,a)=>{b();const t=h(n=>n.crmContact.data.selectedContact),o=h(n=>n.crmContact.data.contactList);console.log(o,"Here Is The Data");const i=async n=>{try{console.log("Edited Content Change")}catch(c){console.error("Error updating contact:",c)}};return e.jsx(oe,{ref:a,contact:t,onFormSubmit:i})});re.displayName="ContactEditContent";const et=({onSaveClick:s,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(P,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(P,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),tt=()=>{const s=b(),a=h(n=>n.crmContact.data.drawerOpen),t=()=>{s(B()),s(Z({}))},o=u.useRef(null),i=()=>{var n,c;console.log("formSubmit function called",(n=o.current)==null?void 0:n.values),(c=o.current)==null||c.submitForm()};return e.jsx(be,{isOpen:a,closable:!1,bodyClass:"p-0",footer:e.jsx(et,{onCancel:t,onSaveClick:i}),onClose:t,onRequestClose:t,children:e.jsx(re,{ref:o})})},at=()=>{const s=b(),a=h(n=>n.crmContact.data.deleteConfirmation),t=h(n=>n.crmContact.data.selectedContact);console.log(t,"selectedContact");const o=()=>{s(U(!1))},i=async()=>{var c,g,l;s(U(!1));const n=await s(je(t==null?void 0:t.id));(c=n==null?void 0:n.payload)!=null&&c.success?E.push(e.jsx(M,{title:"Successfuly Deleted",type:"success",duration:2500,children:(g=n==null?void 0:n.payload)==null?void 0:g.message}),{placement:"top-center"}):E.push(e.jsx(M,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(l=n==null?void 0:n.payload)==null?void 0:l.message}),{placement:"top-center"}),await s(K()),await s(H())};return e.jsx($e,{isOpen:a,type:"danger",title:"Delete Contact",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this Contact? All record related to this contact will be deleted as well. This action cannot be undone."})})},st=({row:s})=>{const{textTheme:a}=te(),t=b(),o=()=>{t(Y()),t(Z(s))};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},ot=({row:s})=>{const{textTheme:a}=te(),t=b(),o=async()=>{console.log(s),t(Z(s)),t(U(!0))};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold text-red-500`,onClick:o,children:"Delete"})},rt=()=>{const s=b(),a=h(p=>p.crmContact.data.contactList),t=W("contacts","canModify"),o=W("contacts","canDelete"),i=h(p=>p.crmContact.data.loading),n=h(p=>p.crmContact.data.filterData),{pageIndex:c,pageSize:g,sort:l,query:x,total:S}=h(p=>p.crmContact.data.tableData),A=u.useCallback(()=>{s(K())},[s]);u.useEffect(()=>{A()},[A,c,g,l,n]);const D=u.useMemo(()=>({pageIndex:c,pageSize:g,sort:l,query:x,total:S}),[c,g,l,x,S]),I=u.useMemo(()=>{const p=[{header:"Name",accessorKey:"name",cell:r=>{const m=r.row.original.name;return e.jsx(v,{text:m,maxLength:20})}},{header:"firstName",accessorKey:"firstName",cell:r=>{const m=r.row.original.firstName;return e.jsx(v,{text:m,maxLength:20})}},{header:"lastName",accessorKey:"lastName",cell:r=>{const m=r.row.original.lastName;return e.jsx(v,{text:m,maxLength:20})}},{header:"title",accessorKey:"title",cell:r=>{const m=r.row.original.title;return e.jsx(v,{text:m,maxLength:20})}},{header:"description",accessorKey:"description",cell:r=>{const m=r.row.original.description;return e.jsx(v,{text:m,maxLength:20})}},{header:"contact Number",accessorKey:"contactNumber",cell:r=>r.row.original.contactNumber},{header:"Tag Name",accessorKey:"tagName",cell:r=>{const m=r.row.original.tags||[];return e.jsx(Ve,{tags:m})}},{header:"email",accessorKey:"email",cell:r=>r.row.original.email},{header:"address",accessorKey:"address",cell:r=>{const m=r.row.original.address;return e.jsx(v,{text:m,maxLength:20})}},{header:"Company Name",accessorKey:"companyName",cell:r=>r.row.original.company?r.row.original.company.companyName:""},{header:"position",accessorKey:"position",cell:r=>{const m=r.row.original.position;return e.jsx(v,{text:m,maxLength:20})}},{header:"source",accessorKey:"source",cell:r=>{const m=r.row.original.source;return e.jsx(v,{text:m,maxLength:20})}},{header:"Notes",accessorKey:"notes",cell:r=>{const m=r.row.original.notes;return e.jsx(v,{text:m,maxLength:20})}}];return o&&p.unshift({header:"Delete",id:"action",cell:r=>e.jsx(ot,{row:r.row.original})}),t&&p.unshift({header:"Edit",id:"action",cell:r=>e.jsx(st,{row:r.row.original})}),p},[t,o]),F=p=>{const r=R(D);r.pageIndex=p,s($(r))},k=p=>{const r=R(D);r.pageSize=Number(p),r.pageIndex=1,s($(r))},q=p=>{const r=R(D);r.sort=p,s($(r))};return e.jsxs("div",{children:[e.jsx(ue,{columns:I,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:i,pagingData:{total:D.total,pageIndex:D.pageIndex,pageSize:D.pageSize},onPaginationChange:F,onSelectChange:k,onSort:q}),e.jsx(tt,{}),e.jsx(at,{})]})},ne=u.forwardRef((s,a)=>{const{onInputChange:t}=s,o=He(i,500);function i(c){t==null||t(c)}const n=c=>{o(c.target.value)};return e.jsx(j,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(ke,{className:"text-lg"}),onChange:n})});ne.displayName="ContactTableSearch";const{Control:nt}=Be,Q=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],it=({innerProps:s,label:a,data:t,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{innerClass:t.color}),e.jsx("span",{children:a})]}),o&&e.jsx(qe,{className:"text-emerald-500 text-xl"})]}),ct=({children:s,...a})=>{const t=a.getValue()[0];return e.jsxs(nt,{...a,children:[t&&e.jsx(se,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),s]})},lt=()=>{const s=b(),{status:a}=h(o=>o.crmContact.data.filterData),t=o=>{s(ee({status:o==null?void 0:o.value}))};return e.jsx(Pe,{options:Q,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:it,Control:ct},value:Q.filter(o=>o.value===a),onChange:t})},mt=()=>{const s=b(),a=u.useRef(null),t=h(l=>l.crmContact.data.tableData),o=W("contacts","canCreate"),i=l=>{const x=R(t);x.query=l,x.pageIndex=1,typeof l=="string"&&l.length>1&&n(x),typeof l=="string"&&l.length===0&&n(x)},n=l=>{s($(l)),s(K())},c=()=>{const l=R(t);l.query="",a.current&&(a.current.value=""),s(ee({status:""})),n(l)},g=()=>{s(Y())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(ne,{ref:a,onInputChange:i}),e.jsx(lt,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(P,{size:"sm",className:"me-2",onClick:c,children:"Clear All"}),o&&e.jsx(P,{size:"sm",onClick:g,children:"Add New"})]})]})},X=s=>{const{icon:a,avatarClass:t,label:o,value:i,loading:n}=s,c=55;return e.jsx(Ue,{bordered:!0,children:e.jsx(me,{loading:n,customLoader:e.jsx(Ze,{avatarProps:{className:"rounded",width:c,height:c}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(We,{className:t,size:c,icon:a}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(_e,{thousandSeparator:!0,displayType:"text",value:i})})]})]})})})})},dt=()=>{const s=b(),a=h(o=>o.crmContact.data.statisticData),t=h(o=>o.crmContact.data.statisticLoading);return u.useEffect(()=>{s(H())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(X,{icon:e.jsx(Le,{}),avatarClass:"!bg-indigo-600",label:"Total Contact",value:a.totalContacts,growthRate:a==null?void 0:a.totalContacts,loading:t}),e.jsx(X,{icon:e.jsx(Ee,{}),avatarClass:"!bg-blue-500",label:"This Week's New Contacts",value:a.newContacts,growthRate:a.newContacts,loading:t})]})};de("crmContact",Ne);const pt=()=>e.jsxs(e.Fragment,{children:[e.jsx(dt,{}),e.jsxs(pe,{bodyClass:"h-full",children:[e.jsx(mt,{}),e.jsx(rt,{})]})]}),_a=pt;export{_a as default};
