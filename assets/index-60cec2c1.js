import{am as b,an as de,ao as me,ap as pe,a as w,r as d,j as e,ai as ue,ar as xe}from"./index-7a16719d.js";import{A as ge}from"./AdaptableCard-13b794a2.js";import{D as he}from"./DataTable-8d28e201.js";import{c as fe,d as je,e as Ce,f as Le,g as be,h as we,i as ye,j as J,k as De}from"./CrmService-a924234d.js";import{u as Q}from"./useThemeClass-fd0ad3b7.js";import{B as z}from"./Button-796af526.js";import{D as ve}from"./Drawer-8ba2eb60.js";import{T as W}from"./index-63d9e088.js";import{u as Ne,c as C,d as L,F as Se,a as ke,b as Ie}from"./formik.esm-e41f31d6.js";import{c as Te,a as E,b as Fe}from"./index.esm-d14b6227.js";import{I as v}from"./Input-67ca38c6.js";import{A as X}from"./index-a6767bf5.js";import{U as Ae}from"./Upload-43f1cdd5.js";import{I as Oe,a7 as Re,a6 as Ee,a8 as G,z as Me,B as ze,d as Be,a9 as Ue,r as Ve}from"./index.esm-a0bff864.js";import{D as U,A as He,t as $e,c as Pe}from"./AdditionalTag-d9d972e5.js";/* empty css              */import{T as qe}from"./index.esm-a9630cba.js";import{B as Ge,a as Ke,b as _e,c as Je}from"./index.esm-1010dceb.js";import{c as A}from"./cloneDeep-b8051bc5.js";import{C as Qe}from"./Card-1701bbfb.js";import"./Views-6f74b325.js";import{B as Y}from"./Badge-1281613d.js";import"./chart.constant-5281a9f6.js";import"./chart.config-58aa9b75.js";import{C as We}from"./ConfirmDialog-eba886ee.js";import"./GrowShrinkTag-37fffd2e.js";import"./Skeleton-37e417fd.js";import"./react-tooltip.min-a9924b1b.js";import"./RichTextEditor-5911068e.js";import"./SegmentItemOption-7241e2fb.js";import"./SvgIcon-453c12ee.js";import"./Tooltip-d9375ea6.js";import{d as Xe}from"./debounce-581daf1a.js";import{S as Ye,c as Ze}from"./Select-9b097dd7.js";import{M as ea}from"./MediaSkeleton-be71f6da.js";import{N as aa}from"./react-number-format.es-51238e39.js";import"./index-0e21c6e2.js";import"./index.esm-5d9ef8bc.js";import"./Pagination-48201899.js";import"./index-b0ca69aa.js";import"./_Uint8Array-cc34f89d.js";import"./_MapCache-4c25b116.js";import"./_baseIsEqual-2f7f19c2.js";import"./get-d062fc7e.js";import"./toString-8f2f6138.js";import"./TableRowSkeleton-7731763d.js";import"./index-f8af83e9.js";import"./context-0b7be94f.js";import"./index-d79d31fc.js";import"./CloseButton-a0a179ae.js";import"./useControllableState-a386f254.js";import"./index-7ccc27ab.js";import"./isNil-e31eb1ef.js";import"./useMergeRef-788c4cb0.js";import"./index.esm-4e1ebe60.js";import"./toast-88b8cde7.js";import"./useTimeout-322537e2.js";import"./StatusIcon-d7c666ad.js";import"./chainedFunction-070f832c.js";import"./Alert-30cff1b8.js";import"./Calendar-d980fa99.js";import"./index-a27a5065.js";import"./useRootClose-846e7f72.js";import"./usePopper-f1e01f1f.js";import"./RangeCalendar-5a8bf6cb.js";import"./TimeInput-f92c5fbf.js";import"./useUniqueId-8e6b0c76.js";import"./useDidUpdate-c40d1f95.js";import"./Dialog-6329901c.js";import"./index-c8ec40dc.js";import"./useUncertainRef-cc932849.js";import"./index-8ce6c613.js";import"./index-4b73696b.js";import"./index-2891c22c.js";import"./Progress-eccc530b.js";import"./index-ec94b59a.js";import"./ScrollBar-c40790ee.js";import"./index-f369fb39.js";import"./index-ad91be40.js";import"./mapCloneElement-cd5ba71d.js";import"./Switcher-9edb53af.js";import"./Tag-35e609cf.js";import"./index-a7fd7ac6.js";import"./index-1fd6ab15.js";import"./_getPrototype-af9a5f7c.js";import"./floating-ui.dom-bef9cea3.js";import"./toConsumableArray-f36ee3dc.js";import"./objectWithoutPropertiesLoose-df62547b.js";const ta="crmLeads",H=b("crmLeads/data/getLeadsStatistic",async()=>(await fe()).data),N=b("crmLeads/data/getLeads",async()=>(await je()).data),$=b("crmContact/data/getContact",async()=>(await Ce()).data),sa=b("crmLeads/data/editLeads",async({leadsId:s,updatedData:a})=>(await Le(s,a)).data),oa=b("crmLeads/data/deleteLeads",async s=>await be(s)),ra=b("crmLeads/data/createLeads",async s=>(await we(s)).data),na=b("crmLeads/data/module",async()=>(await ye()).data),ia=b("tag-category",async({id:s})=>(await J(s)).data);b("crmLeads/data/fetchTag",async({id:s})=>(await J(s)).data);b("crmLeads/data/createTag",async({masterId:s,colorName:a,tagName:t,tagCategoryId:o})=>(await De({colorName:a,tagName:t,masterId:s,tagCategoryId:o})).data);const la={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ca={status:""},da={loading:!1,statisticLoading:!1,leadsList:[],statisticData:{},tableData:la,filterData:ca,drawerOpen:!1,selectedLeads:{}},Z=de({name:`${ta}/state`,initialState:da,reducers:{setTableData:(s,a)=>{s.tableData=a.payload},setLeadsList:(s,a)=>{s.leadsList=a.payload},setFilterData:(s,a)=>{s.filterData=a.payload},setSelectedLeads:(s,a)=>{s.selectedLeads=a.payload},setDrawerOpen:s=>{s.drawerOpen=!0},setDrawerClose:s=>{s.drawerOpen=!1}},extraReducers:s=>{s.addCase(N.fulfilled,(a,t)=>{a.leadsList=t.payload.data,a.loading=!1}).addCase(N.pending,a=>{a.loading=!0}).addCase(H.fulfilled,(a,t)=>{a.statisticData=t.payload,a.statisticLoading=!1}).addCase(H.pending,a=>{a.statisticLoading=!0}).addCase($.fulfilled,(a,t)=>{a.contactList=t.payload.data,a.loading=!1}).addCase($.pending,a=>{a.loading=!0})}}),{setTableData:M,setLeadsList:ds,setFilterData:ee,setSelectedLeads:ae,setDrawerOpen:te,setDrawerClose:P}=Z.actions,ma=Z.reducer,pa=me({data:ma}),h=pe,ua=s=>{const{touched:a,errors:t}=s,o=w(),r=Ne(),[i,l]=d.useState(!1),[c,x]=d.useState(!1),[u,g]=d.useState([]),[I,O]=d.useState([]),R=()=>{l(!i),x(!1)},y=["active","deactive"],[n,f]=d.useState([]);d.useEffect(()=>{(async()=>{try{const{payload:p}=await o($()),S=p.data.map(j=>({value:j.id,label:j.name}));f(S)}catch(p){console.error(p)}})()},[o]);const[B,T]=d.useState("");d.useEffect(()=>{(async()=>{var p,S;try{const{payload:j}=await o(na()),F=(p=j==null?void 0:j.data)==null?void 0:p.find(k=>(k==null?void 0:k.moduleName)==="leads");if(T(F.id),F){const{payload:k}=await o(ia({id:(S=F==null?void 0:F.id)==null?void 0:S.toString()})),le=$e(k.data),ce=Pe(k.data);O(ce),g(le)}}catch(j){console.error("Error fetching module data:",j)}})()},[o]);const D=h(m=>m.crmLeads.data.selectedLeads),[q,ne]=d.useState(D?D.tags||[]:[]),ie=m=>{ne(m);const p=[m.value];r.setFieldValue("tagId",p)};return e.jsxs(e.Fragment,{children:[e.jsx(C,{invalid:t.upload&&a.upload,errorMessage:t.upload,children:e.jsx(L,{name:"img",children:({field:m,form:p})=>{const S=m.value?{src:m.value}:{};return e.jsx("div",{className:"flex justify-center",children:e.jsx(Ae,{className:"cursor-pointer",showList:!1,uploadLimit:1,onChange:j=>p.setFieldValue(m.name,URL.createObjectURL(j[0])),onFileRemove:j=>p.setFieldValue(m.name,URL.createObjectURL(j[0])),children:e.jsx(X,{className:"border-2 border-white dark:border-gray-800 shadow-lg",size:100,shape:"circle",icon:e.jsx(Oe,{}),...S})})})}})}),e.jsx(C,{label:"Contact Name",children:e.jsx(L,{autoComplete:"off",name:"contactsDataId",placeholder:"Contact Name",options:n,id:"contactsDataId",value:r.initialValues.name,component:U,prefix:e.jsx(Re,{className:"text-xl"}),onChange:m=>{const p=m.value;r.setFieldValue("contactsDataId",p)}})}),e.jsx(C,{label:"Details",invalid:t.details&&a.details,errorMessage:t.details,children:e.jsx(L,{type:"text",autoComplete:"off",name:"details",placeholder:"Details",component:v,prefix:e.jsx(Ee,{className:"text-xl"})})}),e.jsx(C,{label:"Status",invalid:t.status&&a.status,errorMessage:t.status,children:e.jsx(L,{type:"text",autoComplete:"off",name:"status",placeholder:"Status",component:U,options:y,id:"status",value:r.initialValues.status,prefix:e.jsx(G,{className:"text-xl"}),onChange:m=>{const p=m.value;r.setFieldValue("status",p)}})}),e.jsx(C,{label:"notes",invalid:t.notes&&a.notes,errorMessage:t.notes,children:e.jsx(L,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:v,prefix:e.jsx(G,{className:"text-xl"})})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(C,{label:"Tag",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(L,{name:"Tag",component:U,value:r.initialValues.tagName,options:u,placeholder:"Select a Tag",onChange:ie}),e.jsx(qe,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{R(),x(!0)}})]})}),e.jsx(He,{isOpen:i,categoryList:I,moduleName:B,onOpenChange:m=>l(m)})]})]})},xa=s=>{const{touched:a,errors:t}=s;return e.jsxs(e.Fragment,{children:[e.jsx(C,{label:"Facebook link",invalid:t.facebook&&a.facebook,errorMessage:t.facebook,children:e.jsx(L,{type:"text",autoComplete:"off",name:"facebook",placeholder:"URL",component:v,prefix:e.jsx(Ge,{className:"text-xl text-[#1773ea]"})})}),e.jsx(C,{label:"Twitter link",invalid:t.twitter&&a.twitter,errorMessage:t.twitter,children:e.jsx(L,{type:"text",autoComplete:"off",name:"twitter",placeholder:"URL",component:v,prefix:e.jsx(Ke,{className:"text-xl text-[#1da1f3]"})})}),e.jsx(C,{label:"Pinterest link",invalid:t.pinterest&&a.pinterest,errorMessage:t.pinterest,children:e.jsx(L,{type:"text",autoComplete:"off",name:"pinterest",placeholder:"URL",component:v,prefix:e.jsx(_e,{className:"text-xl text-[#df0018]"})})}),e.jsx(C,{label:"LinkedIn link",invalid:t.linkedIn&&a.linkedIn,errorMessage:t.linkedIn,children:e.jsx(L,{type:"text",autoComplete:"off",name:"linkedIn",placeholder:"URL",component:v,prefix:e.jsx(Je,{className:"text-xl text-[#0077b5]"})})})]})},ga=Te().shape({details:E().required("Details are required"),status:E().required("Status is required"),contactsDataId:E(),notes:E(),tagId:Fe()}),{TabNav:ha,TabList:fa,TabContent:K}=W,se=d.forwardRef((s,a)=>{var i,l,c,x;const t=h(u=>u.crmLeads.data.selectedLeads),o=!!t.id;console.log(o,"Editing Done");const r=w();return e.jsx(Se,{innerRef:a,initialValues:{contactsDataId:t.contactsDataId||null,details:(t==null?void 0:t.details)||"",status:(t==null?void 0:t.status)||"",notes:(t==null?void 0:t.notes)||"",tagName:((l=(i=t==null?void 0:t.tags)==null?void 0:i[0])==null?void 0:l.tagName)||"",name:((c=t==null?void 0:t.contactData)==null?void 0:c.name)||"",tagId:((x=t==null?void 0:t.tags)==null?void 0:x.map(u=>u.id))||[]},validationSchema:ga,onSubmit:async(u,{setSubmitting:g})=>{const{colorName:I,name:O,tagName:R,...y}=u;console.log(I),o===!0?(console.log(u,"Bhai testing kar"),await r(sa({leadsId:(t==null?void 0:t.id)||"",updatedData:y})),await r(N()),await r(P())):(console.log(y,"Maat Aa"),await r(ra(y)),await r(N()),await r(P())),g(!1)},children:({touched:u,errors:g})=>e.jsx(ke,{children:e.jsx(Ie,{children:e.jsxs(W,{defaultValue:"personalInfo",children:[e.jsx(fa,{children:e.jsx(ha,{value:"personalInfo",children:"Custometer Detail"})}),e.jsxs("div",{className:"p-6",children:[e.jsx(K,{value:"personalInfo",children:e.jsx(ua,{touched:u,errors:g})}),e.jsx(K,{value:"social",children:e.jsx(xa,{touched:u,errors:g})})]})]})})})})});se.displayName="LeadsForm";const oe=d.forwardRef((s,a)=>{w();const t=h(i=>i.crmLeads.data.selectedLeads),o=h(i=>i.crmLeads.data.leadsList);console.log(o,"Here Is The Data");const r=async i=>{try{console.log("Edited Content Change")}catch(l){console.error("Error updating leads:",l)}};return e.jsx(se,{ref:a,leads:t,onFormSubmit:r})});oe.displayName="LeadsEditContent";const ja=({onSaveClick:s,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(z,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(z,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),Ca=()=>{const s=w(),a=h(i=>i.crmLeads.data.drawerOpen),t=()=>{s(P()),s(ae({}))},o=d.useRef(null),r=()=>{var i,l;console.log("formSubmit function called",(i=o.current)==null?void 0:i.values),(l=o.current)==null||l.submitForm()};return e.jsx(ve,{isOpen:a,closable:!1,bodyClass:"p-0",footer:e.jsx(ja,{onCancel:t,onSaveClick:r}),onClose:t,onRequestClose:t,children:e.jsx(oe,{ref:o})})},La=({row:s})=>{const{textTheme:a}=Q(),t=w(),o=()=>{t(te()),t(ae(s))};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},ba=({row:s})=>{const{textTheme:a}=Q(),t=w(),[o,r]=d.useState(!1),i=()=>{r(!0)},l=async()=>{await t(oa(s.id)),r(!1),await t(N())},c=()=>{r(!1)};return e.jsxs("div",{children:[e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold text-red-500`,onClick:i,children:"Delete"}),o&&e.jsx(We,{type:"danger",title:"Confirm Deletion",isOpen:o,onCancel:c,onConfirm:l,children:"Are you sure you want to delete this item?"})]})},wa=()=>{const s=w(),a=h(n=>n.crmLeads.data.leadsList);console.log("Getting Leads List",a);const t=h(n=>n.crmLeads.data.loading),o=h(n=>n.crmLeads.data.filterData),{pageIndex:r,pageSize:i,sort:l,query:c,total:x}=h(n=>n.crmLeads.data.tableData),u=d.useCallback(()=>{s(N())},[s]);d.useEffect(()=>{u()},[u,r,i,l,o]);const g=d.useMemo(()=>({pageIndex:r,pageSize:i,sort:l,query:c,total:x}),[r,i,l,c,x]),I=d.useMemo(()=>[{header:"Details",accessorKey:"details",cell:n=>n.row.original.details,width:200},{header:"Contact Name",accessorKey:"contactName",cell:n=>n.row.original.contactData.name,width:200},{header:"Status",accessorKey:"status",cell:n=>n.row.original.status,width:200},{header:"Tag Name",accessorKey:"tagName",width:200,cell:n=>{const B=(n.row.original.tags||[]).map(T=>{const D=T.colorName||"#000000",q={backgroundColor:`rgba(${parseInt(D.slice(1,3),16)}, ${parseInt(D.slice(3,5),16)}, ${parseInt(D.slice(5,7),16)}, 0.2)`,color:D,padding:"4px 8px",borderRadius:"4px",marginRight:"4px",marginBottom:"4px"};return e.jsx("div",{style:q,children:T.tagName},T.id)});return e.jsx("div",{children:B})}},{header:"Notes",accessorKey:"notes",cell:n=>n.row.original.notes,width:200},{header:"Edit",id:"action",cell:n=>e.jsx(La,{row:n.row.original})},{header:"Delete",id:"action",cell:n=>e.jsx(ba,{row:n.row.original})}],[]),O=n=>{const f=A(g);f.pageIndex=n,s(M(f))},R=n=>{const f=A(g);f.pageSize=Number(n),f.pageIndex=1,s(M(f))},y=n=>{const f=A(g);f.sort=n,s(M(f))};return e.jsxs("div",{children:[e.jsx(he,{columns:I,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:g.total,pageIndex:g.pageIndex,pageSize:g.pageSize},onPaginationChange:O,onSelectChange:R,onSort:y}),e.jsx(Ca,{})]})},re=d.forwardRef((s,a)=>{const{onInputChange:t}=s,o=Xe(r,500);function r(l){t==null||t(l)}const i=l=>{o(l.target.value)};return e.jsx(v,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(Me,{className:"text-lg"}),onChange:i})});re.displayName="LeadsTableSearch";const{Control:ya}=Ze,_=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],Da=({innerProps:s,label:a,data:t,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{innerClass:t.color}),e.jsx("span",{children:a})]}),o&&e.jsx(ze,{className:"text-emerald-500 text-xl"})]}),va=({children:s,...a})=>{const t=a.getValue()[0];return e.jsxs(ya,{...a,children:[t&&e.jsx(Y,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),s]})},Na=()=>{const s=w(),{status:a}=h(o=>o.crmLeads.data.filterData),t=o=>{s(ee({status:o==null?void 0:o.value}))};return e.jsx(Ye,{options:_,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:Da,Control:va},value:_.filter(o=>o.value===a),onChange:t})},Sa=()=>{const s=w(),a=d.useRef(null),t=h(c=>c.crmLeads.data.tableData),o=c=>{const x=A(t);x.query=c,x.pageIndex=1,typeof c=="string"&&c.length>1&&r(x),typeof c=="string"&&c.length===0&&r(x)},r=c=>{s(M(c)),s(N())},i=()=>{const c=A(t);c.query="",a.current&&(a.current.value=""),s(ee({status:""})),r(c)},l=()=>{s(te())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(re,{ref:a,onInputChange:o}),e.jsx(Na,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(z,{size:"sm",className:"me-2",onClick:i,children:"Clear All"}),e.jsx(z,{size:"sm",onClick:l,children:"Add New"})]})]})},V=s=>{const{icon:a,avatarClass:t,label:o,value:r,loading:i}=s,l=55;return e.jsx(Qe,{bordered:!0,children:e.jsx(ue,{loading:i,customLoader:e.jsx(ea,{avatarProps:{className:"rounded",width:l,height:l}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(X,{className:t,size:l,icon:a}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(aa,{thousandSeparator:!0,displayType:"text",value:r})})]})]})})})})},ka=()=>{const s=w(),a=h(o=>o.crmLeads.data.statisticData);console.log(a.totalLeads,"Araha Hai Bhai");const t=h(o=>o.crmLeads.data.statisticLoading);return d.useEffect(()=>{s(H())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(V,{icon:e.jsx(Be,{}),avatarClass:"!bg-indigo-600",label:"Total Leads",value:a.totalLeads,growthRate:a==null?void 0:a.totalLeads,loading:t}),e.jsx(V,{icon:e.jsx(Ue,{}),avatarClass:"!bg-blue-500",label:"Active Leads",value:a.activeLeads,growthRate:a.activeLeads,loading:t}),e.jsx(V,{icon:e.jsx(Ve,{}),avatarClass:"!bg-emerald-500",label:"New Leads",value:a==null?void 0:a.newLeads,growthRate:a==null?void 0:a.newLeads,loading:t})]})};xe("crmLeads",pa);const Ia=()=>e.jsxs(e.Fragment,{children:[e.jsx(ka,{}),e.jsxs(ge,{bodyClass:"h-full",children:[e.jsx(Sa,{}),e.jsx(wa,{})]})]}),ms=Ia;export{ms as default};
