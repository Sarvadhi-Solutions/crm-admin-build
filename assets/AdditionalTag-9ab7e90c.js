import{r as q,a_ as ne,m as oe,am as g,an as ie,ao as le,ap as ce,a as ue,j as m}from"./index-a75c2214.js";import{F as de,a as pe,b as k}from"./formik.esm-3c1d58de.js";import"./Alert-a3186a3f.js";import"./index-3aa09f20.js";import"./Badge-03bb3502.js";import{B as z}from"./Button-13333fa1.js";import"./Calendar-527cd69e.js";import"./Card-f8be7cf5.js";import"./index-4e44d9bc.js";import"./index-28e44be9.js";import"./Dialog-093c796b.js";import"./Drawer-4be8ac77.js";import"./index-04ed9e3c.js";import{a as j}from"./FormItem-e7510cc7.js";import"./toString-a311c7f9.js";import{I as me}from"./Input-8164dacf.js";import"./index-d65d54e7.js";import"./index-ce1976e4.js";import"./index-24cfecab.js";import"./toast-9ba48d0f.js";import"./Pagination-d83ae71e.js";import"./Progress-17d38890.js";import"./index-63ca2c3a.js";import"./RangeCalendar-e6435c7c.js";import"./ScrollBar-da9f6718.js";import"./index-916893a5.js";import{S as fe}from"./Select-e3c4e091.js";import"./Skeleton-d2cdaf3e.js";import"./index-191a7578.js";import"./Switcher-5b991065.js";import"./index-00cb4b16.js";import"./index-1e228cad.js";import"./Tag-9c9d82f1.js";import"./index-4c7d26f9.js";import"./index-3499d56e.js";import"./Tooltip-b12e8e28.js";import"./Upload-b697435a.js";import{c as he,d as ye}from"./index.esm-f6b05d17.js";import{J as ve,K as ge,n as Ce,m as be,L as we,i as Oe,j as U,k as De}from"./CrmService-4f2387c5.js";var $={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=N(q),i=c(ne);function c(t){return t&&t.__esModule?t:{default:t}}function f(){if(typeof WeakMap!="function")return null;var t=new WeakMap;return f=function(){return t},t}function N(t){if(t&&t.__esModule)return t;if(t===null||C(t)!=="object"&&typeof t!="function")return{default:t};var s=f();if(s&&s.has(t))return s.get(t);var r={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var l=e?Object.getOwnPropertyDescriptor(t,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=t[o]}return r.default=t,s&&s.set(t,r),r}function C(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?C=function(r){return typeof r}:C=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},C(t)}function v(){return v=Object.assign||function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}return t},v.apply(this,arguments)}function b(t,s){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);s&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,e)}return r}function w(t){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?b(r,!0).forEach(function(e){u(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function u(t,s,r){return s in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,t}function x(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function T(t,s){for(var r=0;r<s.length;r++){var e=s[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function B(t,s,r){return s&&T(t.prototype,s),r&&T(t,r),t}function J(t,s){return s&&(C(s)==="object"||typeof s=="function")?s:E(t)}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},S(t)}function E(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function K(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),s&&P(t,s)}function P(t,s){return P=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e},P(t,s)}var L="Select...",M=function(t){K(s,t);function s(r){var e;return x(this,s),e=J(this,S(s).call(this,r)),e.state={selected:e.parseValue(r.value,r.options)||{label:typeof r.placeholder>"u"?L:r.placeholder,value:""},isOpen:!1},e.dropdownRef=(0,a.createRef)(),e.mounted=!0,e.handleDocumentClick=e.handleDocumentClick.bind(E(e)),e.fireChangeEvent=e.fireChangeEvent.bind(E(e)),e}return B(s,[{key:"componentDidUpdate",value:function(e){if(this.props.value!==e.value)if(this.props.value){var o=this.parseValue(this.props.value,this.props.options);o!==this.state.selected&&this.setState({selected:o})}else this.setState({selected:{label:typeof this.props.placeholder>"u"?L:this.props.placeholder,value:""}})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocumentClick,!1),document.addEventListener("touchend",this.handleDocumentClick,!1)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,document.removeEventListener("click",this.handleDocumentClick,!1),document.removeEventListener("touchend",this.handleDocumentClick,!1)}},{key:"handleMouseDown",value:function(e){this.props.onFocus&&typeof this.props.onFocus=="function"&&this.props.onFocus(this.state.isOpen),!(e.type==="mousedown"&&e.button!==0)&&(e.stopPropagation(),e.preventDefault(),this.props.disabled||this.setState({isOpen:!this.state.isOpen}))}},{key:"parseValue",value:function(e,o){var l;if(typeof e=="string")for(var d=0,h=o.length;d<h;d++)if(o[d].type==="group"){var p=o[d].items.filter(function(y){return y.value===e});p.length&&(l=p[0])}else typeof o[d].value<"u"&&o[d].value===e&&(l=o[d]);return l||e}},{key:"setValue",value:function(e,o){var l={selected:{value:e,label:o},isOpen:!1};this.fireChangeEvent(l),this.setState(l)}},{key:"fireChangeEvent",value:function(e){e.selected!==this.state.selected&&this.props.onChange&&this.props.onChange(e.selected)}},{key:"renderOption",value:function(e){var o,l=e.value;typeof l>"u"&&(l=e.label||e);var d=e.label||e.value||e,h=l===this.state.selected.value||l===this.state.selected,p=(o={},u(o,"".concat(this.props.baseClassName,"-option"),!0),u(o,e.className,!!e.className),u(o,"is-selected",h),o),y=(0,i.default)(p),O=Object.keys(e.data||{}).reduce(function(D,_){return w({},D,u({},"data-".concat(_),e.data[_]))},{});return a.default.createElement("div",v({key:l,className:y,onMouseDown:this.setValue.bind(this,l,d),onClick:this.setValue.bind(this,l,d),role:"option","aria-selected":h?"true":"false"},O),d)}},{key:"buildMenu",value:function(){var e=this,o=this.props,l=o.options,d=o.baseClassName,h=l.map(function(p){if(p.type==="group"){var y=a.default.createElement("div",{className:"".concat(d,"-title")},p.name),O=p.items.map(function(D){return e.renderOption(D)});return a.default.createElement("div",{className:"".concat(d,"-group"),key:p.name,role:"listbox",tabIndex:"-1"},y,O)}else return e.renderOption(p)});return h.length?h:a.default.createElement("div",{className:"".concat(d,"-noresults")},"No options found")}},{key:"handleDocumentClick",value:function(e){this.mounted&&(this.dropdownRef.current.contains(e.target)||this.state.isOpen&&this.setState({isOpen:!1}))}},{key:"isValueSelected",value:function(){return typeof this.state.selected=="string"||this.state.selected.value!==""}},{key:"render",value:function(){var e,o,l,d,h,p=this.props,y=p.baseClassName,O=p.controlClassName,D=p.placeholderClassName,_=p.menuClassName,R=p.arrowClassName,F=p.arrowClosed,V=p.arrowOpen,I=p.className,A=this.props.disabled?"Dropdown-disabled":"",X=typeof this.state.selected=="string"?this.state.selected:this.state.selected.label,Y=(0,i.default)((e={},u(e,"".concat(y,"-root"),!0),u(e,I,!!I),u(e,"is-open",this.state.isOpen),e)),Z=(0,i.default)((o={},u(o,"".concat(y,"-control"),!0),u(o,O,!!O),u(o,A,!!A),o)),ee=(0,i.default)((l={},u(l,"".concat(y,"-placeholder"),!0),u(l,D,!!D),u(l,"is-selected",this.isValueSelected()),l)),te=(0,i.default)((d={},u(d,"".concat(y,"-menu"),!0),u(d,_,!!_),d)),ae=(0,i.default)((h={},u(h,"".concat(y,"-arrow"),!0),u(h,R,!!R),h)),re=a.default.createElement("div",{className:ee},X),se=this.state.isOpen?a.default.createElement("div",{className:te,"aria-expanded":"true"},this.buildMenu()):null;return a.default.createElement("div",{ref:this.dropdownRef,className:Y},a.default.createElement("div",{className:Z,onMouseDown:this.handleMouseDown.bind(this),onTouchEnd:this.handleMouseDown.bind(this),"aria-haspopup":"listbox"},re,a.default.createElement("div",{className:"".concat(y,"-arrow-wrapper")},V&&F?this.state.isOpen?V:F:a.default.createElement("span",{className:ae}))),se)}}]),s}(a.Component);M.defaultProps={baseClassName:"Dropdown"};var Q=M;n.default=Q})($);const yt=oe($);function vt(n){return n.map(i=>({type:"group",name:i.categoryName,items:i.tags.map(c=>({value:c.id,label:c.tagName}))}))}function gt(n){return n.map(a=>({value:a.id,label:a.categoryName}))}const _e="crmCustomers",W=g("crmCustomers/data/getCustomerStatistic",async()=>(await ve()).data),G=g("crmCustomers/data/getCustomers",async()=>(await ge()).data),Ct=g("crmCustomers/data/editCustomer",async({customerId:n,updatedData:a})=>{var i,c;try{return(await Ce(n,a)).data}catch(f){throw new Error((c=(i=f==null?void 0:f.response)==null?void 0:i.data)==null?void 0:c.message)}}),bt=g("crmCustomers/data/deleteCustomer",async n=>{var a,i;try{return await be(n)}catch(c){throw new Error((i=(a=c==null?void 0:c.response)==null?void 0:a.data)==null?void 0:i.message)}}),wt=g("crmCustomers/data/createCustomer",async n=>{var a,i;try{return(await we(n)).data}catch(c){throw new Error((i=(a=c==null?void 0:c.response)==null?void 0:a.data)==null?void 0:i.message)}}),Ot=g("crmCustomers/data/module",async()=>{const n=await Oe();return console.log(n.data,"response"),n.data}),Dt=g("tag-category",async({id:n})=>{const a=await U(n);return console.log(a.data,"Getting Data"),a.data});g("crmCustomers/data/fetchTag",async({id:n})=>(await U(n)).data);const Ne=g("crmCustomers/data/createTag",async({masterId:n,colorName:a,tagName:i,tagCategoryId:c})=>(await De({colorName:a,tagName:i,masterId:n,tagCategoryId:c})).data),xe={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Se={status:""},Ee={loading:!1,statisticLoading:!1,customerList:[],displayedCustomersList:[],statisticData:{},tableData:xe,filterData:Se,drawerOpen:!1,selectedCustomer:{},deleteConfirmation:!1},H=ie({name:`${_e}/state`,initialState:Ee,reducers:{setTableData:(n,a)=>{n.tableData=a.payload,n.displayedCustomersList=n.customerList.slice(a.payload.pageSize*(a.payload.pageIndex-1),a.payload.pageSize*a.payload.pageIndex)},setCustomerList:(n,a)=>{n.customerList=a.payload},setFilterData:(n,a)=>{n.filterData=a.payload},setSelectedCustomer:(n,a)=>{n.selectedCustomer=a.payload},setDrawerOpen:n=>{n.drawerOpen=!0},setDrawerClose:n=>{n.drawerOpen=!1},toggleDeleteConfirmation:(n,a)=>{n.deleteConfirmation=a.payload}},extraReducers:n=>{n.addCase(G.fulfilled,(a,i)=>{a.customerList=i.payload.data,a.tableData.total=i.payload.data.length,a.displayedCustomersList=i.payload.data.slice(0,10),a.loading=!1}).addCase(G.pending,a=>{a.loading=!0}).addCase(W.fulfilled,(a,i)=>{a.statisticData=i.payload,a.statisticLoading=!1}).addCase(W.pending,a=>{a.statisticLoading=!0})}}),{setTableData:_t,setCustomerList:Nt,setFilterData:xt,setSelectedCustomer:St,setDrawerOpen:Et,setDrawerClose:Pt,toggleDeleteConfirmation:kt}=H.actions,Pe=H.reducer,jt=le({data:Pe}),Tt=ce,ke=({onCancel:n,onSave:a})=>m.jsxs("div",{className:"text-right w-full",children:[m.jsx(z,{size:"sm",className:"mr-2",onClick:n,children:"Cancel"}),m.jsx(z,{size:"sm",variant:"solid",type:"button",onClick:a,children:"Save"})]}),Lt=({isOpen:n,onOpenChange:a,categoryList:i,moduleName:c})=>{const f=q.useRef(null),N=ue(),C=async()=>{var v,b,w,u;if(c){const x=c.toString();await N(Ne({masterId:x,tagName:(v=f.current)==null?void 0:v.values.tag,colorName:(b=f.current)==null?void 0:b.values.tagColor,tagCategoryId:(w=f.current)==null?void 0:w.values.category.value})),a(!1),console.log((u=f.current)==null?void 0:u.values)}};return m.jsx("div",{className:`${n?"flex":"hidden"} justify-center items-center top-16 left-0 z-10 bg-white p-4 border border-gray-300 w-full absolute rounded-8`,children:n&&m.jsx(de,{innerRef:f,initialValues:{category:"",tag:"",tagColor:"#808080"},onSubmit:v=>{console.log("values",v," ==== > Here The Value Is Prinitng")},children:({values:v,setFieldValue:b})=>m.jsxs(pe,{children:[m.jsx(m.Fragment,{children:m.jsx(j,{label:"Category",children:m.jsx(k,{type:"text",autoComplete:"off",name:"category",placeholder:"Category",options:i,component:fe,prefix:m.jsx(he,{className:"text-xl"}),onChange:w=>{b("category",w)}})})}),m.jsxs("div",{className:"flex items-center justify-center",children:[m.jsx(j,{label:"Tag Name",children:m.jsx(k,{type:"text",autoComplete:"off",name:"tag",placeholder:"Additional Tag Name",component:me,prefix:m.jsx(ye,{className:"text-xl"})})}),m.jsx(j,{children:m.jsx(k,{type:"color",name:"tagColor",className:"w-8 ml-2 p-2 rounded-full h-8 mt-6"})})]}),m.jsx(ke,{onCancel:()=>a(!1),onSave:C})]})})})};export{Lt as A,yt as D,St as a,kt as b,gt as c,bt as d,W as e,_t as f,G as g,Et as h,xt as i,Ot as j,Dt as k,Ct as l,wt as m,jt as r,Pt as s,vt as t,Tt as u};
