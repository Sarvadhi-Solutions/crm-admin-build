import{a as j,r as f,j as e,ai as re,p as oe,ar as ie}from"./index-4bd6b7b3.js";import{A as ne}from"./AdaptableCard-4c3d12d7.js";import{u as p,a as le,s as J,b as I,g as P,p as Q,c as H,d as ce,e as L,t as $,f as me,h as z,i as de,j as pe,r as ue}from"./index-4c6f915a.js";import{M as fe}from"./MediaSkeleton-6059d4e5.js";import{A as xe}from"./index-875ce0f2.js";import{C as he}from"./Card-526fc8df.js";import{m as ge,a9 as be,A as K,b as je,d as Ce,a6 as V}from"./index.esm-0cdca32a.js";import{N as ve}from"./react-number-format.es-61c35378.js";import{B}from"./Button-39d85f08.js";import{c as v}from"./cloneDeep-9b3959e9.js";import{I as N}from"./Input-1462fe73.js";import{d as we}from"./debounce-1894c673.js";import{S as Ne,c as ye,a as Y}from"./Select-938bf375.js";import{B as X}from"./Badge-80e10abc.js";import{D as Ue}from"./DataTable-8887d7ed.js";import{u as W}from"./useThemeClass-b8c9a717.js";import{D as De}from"./Drawer-71237173.js";import{i as Se}from"./Views-d9a5bf10.js";import{T as ee}from"./index-00b89123.js";import{a as C,F as Ie}from"./FormItem-e2a22149.js";import{b as D,F as Fe,a as Te}from"./formik.esm-a048d78e.js";import{c as ke,a as w}from"./index.esm-3518a165.js";/* empty css              */import{j as Ee}from"./index.esm-a57ce33c.js";import{v as Ae}from"./index.esm-07747377.js";import{t as F,N as T}from"./toast-88ff7e3e.js";import"./Alert-7657f3d7.js";import"./Calendar-c92b9cfd.js";import"./index-e9ce1b4a.js";import"./index-20aa5a1a.js";import"./Dialog-974a1028.js";import"./index-10374e44.js";import"./toString-a7228545.js";import"./index-f24b5e4f.js";import"./index-6ca15321.js";import"./index-5ed9ba61.js";import"./Pagination-22ec60b1.js";import"./Progress-4167b7c4.js";import"./index-b212dc1a.js";import"./RangeCalendar-0a16d493.js";import"./ScrollBar-c9c4e4cf.js";import"./index-5de84849.js";import"./Skeleton-e8e73738.js";import"./index-6080bacd.js";import"./Switcher-83573e00.js";import"./index-2d18d6c2.js";import{T as Z}from"./Tag-bcb5cf48.js";import"./index-b945cf70.js";import"./index-f4634923.js";import"./Tooltip-0c11394e.js";import"./Upload-a4e0db34.js";import{g as Re}from"./index-3ec2fa36.js";import{C as qe}from"./ConfirmDialog-5a804371.js";import{u as _}from"./checkEditUpdate-fe7a3157.js";import"./CrmService-6ced694a.js";import"./useMergeRef-788c4cb0.js";import"./context-a8cf3940.js";import"./_Uint8Array-04aa9e28.js";import"./_MapCache-9c7f01dc.js";import"./_getPrototype-715b1198.js";import"./isNil-ae028dac.js";import"./get-2d6f452a.js";import"./slicedToArray-e2770cb7.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-3723ed4f.js";import"./floating-ui.dom-bef9cea3.js";import"./TableRowSkeleton-f238368d.js";import"./index-030d990e.js";import"./index-8b930c29.js";import"./CloseButton-6e2e0ec5.js";import"./useControllableState-259714d7.js";import"./index-06706b89.js";import"./useTimeout-f676b9da.js";import"./StatusIcon-8490d43a.js";import"./chainedFunction-070f832c.js";import"./_baseIsEqual-a094f75a.js";import"./useRootClose-5ed82cf8.js";import"./usePopper-ea474854.js";import"./TimeInput-05c24087.js";import"./useUniqueId-a782b7b3.js";import"./useDidUpdate-f7d2ff2b.js";import"./useUncertainRef-4756ae3b.js";import"./mapCloneElement-bf192649.js";import"./index.esm-9d1f44b1.js";import"./index.esm-4ed14753.js";const S=t=>{const{icon:o,avatarClass:s,label:a,value:m,growthRate:r,loading:i}=t,c=55;return e.jsx(he,{bordered:!0,children:e.jsx(re,{loading:i,customLoader:e.jsx(fe,{avatarProps:{className:"rounded",width:c,height:c}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(xe,{className:s,size:c,icon:o}),e.jsxs("div",{children:[e.jsx("span",{children:a}),e.jsx("h3",{children:e.jsx(ve,{thousandSeparator:!0,displayType:"text",value:m})})]})]})})})})},Me=()=>{const t=j(),o=p(a=>a.crmUsers.data.statisticData),s=p(a=>a.crmUsers.data.statisticLoading);return f.useEffect(()=>{t(le())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4 mb-6",children:[e.jsx(S,{icon:e.jsx(ge,{}),avatarClass:"!bg-indigo-600",label:"Total Users",value:o==null?void 0:o.totalUser,loading:s}),e.jsx(S,{icon:e.jsx(be,{}),avatarClass:"!bg-blue-500",label:"Active Users",value:o==null?void 0:o.activeUser,loading:s}),e.jsx(S,{icon:e.jsx(K,{}),avatarClass:"!bg-emerald-500",label:"Inactivate Users",value:o==null?void 0:o.deactiveUser,loading:s}),e.jsx(S,{icon:e.jsx(K,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Users",value:o==null?void 0:o.newUser,loading:s})]})},se=f.forwardRef((t,o)=>{const{onInputChange:s}=t,a=we(m,500);function m(i){s==null||s(i)}const r=i=>{a(i.target.value)};return e.jsx(N,{ref:o,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(je,{className:"text-lg"}),onChange:r})});se.displayName="UsersTableSearch";const{Control:Oe}=ye,G=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],ze=({innerProps:t,label:o,data:s,isSelected:a})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${a?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...t,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{innerClass:s.color}),e.jsx("span",{children:o})]}),a&&e.jsx(Ce,{className:"text-emerald-500 text-xl"})]}),Le=({children:t,...o})=>{const s=o.getValue()[0];return e.jsxs(Oe,{...o,children:[s&&e.jsx(X,{className:"ltr:ml-4 rtl:mr-4",innerClass:s.color}),t]})},$e=()=>{const t=j(),{status:o}=p(a=>a.crmUsers.data.filterData),s=a=>{t(J({status:a==null?void 0:a.value}))};return e.jsx(Ne,{options:G,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:ze,Control:Le},value:G.filter(a=>a.value===o),onChange:s})},Be=()=>{const t=j(),o=f.useRef(null),s=p(i=>i.crmUsers.data.tableData),a=i=>{const c=v(s);c.query=i,c.pageIndex=1,typeof i=="string"&&i.length>1&&m(c),typeof i=="string"&&i.length===0&&m(c)},m=i=>{t(I(i)),t(P())},r=()=>{const i=v(s);i.query="",o.current&&(o.current.value=""),t(J({status:""})),m(i)};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(se,{ref:o,onInputChange:a}),e.jsx($e,{})]}),e.jsx("div",{className:"mb-4",children:e.jsx(B,{size:"sm",className:"me-2",onClick:r,children:"Clear All"})})]})},Pe=t=>{const{touched:o,errors:s,setFieldValue:a,values:m}=t;p(l=>l.crmUsers.data.selectedUser);const i=p(l=>l.crmUsers.data.rolesList).map(l=>({label:l.roleName,value:l.id})),c=[{label:"active",value:"active"},{label:"inactive",value:"inactive"}];return e.jsxs(e.Fragment,{children:[e.jsx(C,{label:"First Name",children:e.jsx(D,{disabled:!0,type:"text",autoComplete:"off",name:"firstName",component:N,prefix:e.jsx(V,{className:"text-xl"})})}),e.jsx(C,{label:"Last Name",children:e.jsx(D,{disabled:!0,type:"text",autoComplete:"off",name:"lastName",component:N,prefix:e.jsx(V,{className:"text-xl"})})}),e.jsx(C,{label:"Email",children:e.jsx(D,{disabled:!0,type:"text",autoComplete:"off",name:"email",component:N,prefix:e.jsx(Ee,{className:"text-xl"})})}),e.jsx(C,{label:"Phone",children:e.jsx(D,{disabled:!0,type:"text",autoComplete:"off",name:"phone",component:N,prefix:e.jsx(Ae,{className:"text-xl"})})}),e.jsx(C,{label:"Role",children:e.jsx(Y,{name:"roleId",id:"roleId",value:i.find(l=>(l==null?void 0:l.value)===(m==null?void 0:m.roleId)),options:i,onChange:l=>{a("roleId",l.value||"")}})}),e.jsx(C,{label:"Status",children:e.jsx(Y,{name:"status",id:"status",value:c.find(l=>(l==null?void 0:l.value)===(m==null?void 0:m.status)),options:c,onChange:l=>{a("status",l.value||"")}})})]})},He=ke().shape({firstName:w().required("First name is required"),lastName:w().required("Last name is required"),email:w().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),phone:w().matches(/^\d{10}$/,"Phone number must be 10 digits").required("Phone is required"),status:w().required("Status is required").oneOf(["active","inactive"])}),{TabNav:Ke,TabList:Ve,TabContent:Ye}=ee,te=f.forwardRef((t,o)=>{const s=p(r=>r.crmUsers.data.selectedUser),a=p(r=>r.crmUsers.data.drawerMode),m=j();return console.log(a),e.jsx(Fe,{innerRef:o,initialValues:{firstName:a==="Edit"&&(s==null?void 0:s.firstName)||"",lastName:a==="Edit"&&(s==null?void 0:s.lastName)||"",email:a==="Edit"&&(s==null?void 0:s.email)||"",phone:a==="Edit"&&(s==null?void 0:s.phone)||"",status:a==="Add"?"inactive":(s==null?void 0:s.status)||"",roleId:a==="Edit"&&(s==null?void 0:s.roleId)||""},validationSchema:He,onSubmit:async(r,{setSubmitting:i})=>{var c,l,g;if(a==="Edit"){const u=await m(Q({id:s.id,data:r}));(c=u==null?void 0:u.payload)!=null&&c.success?F.push(e.jsx(T,{title:"Successfully Update",type:"success",duration:2500,children:(l=u==null?void 0:u.payload)==null?void 0:l.message}),{placement:"top-center"}):F.push(e.jsx(T,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(g=u==null?void 0:u.payload)==null?void 0:g.message}),{placement:"top-center"}),await m(H()),await m(P())}i(!1)},children:({touched:r,errors:i,setFieldValue:c,values:l})=>e.jsx(Te,{children:e.jsx(Ie,{children:e.jsxs(ee,{defaultValue:"usersInfo",children:[e.jsx(Ve,{children:e.jsx(Ke,{value:"usersInfo",children:"Users Info"})}),e.jsx("div",{className:"p-6",children:e.jsx(Ye,{value:"usersInfo",children:e.jsx(Pe,{touched:r,errors:i,setFieldValue:c,values:l})})})]})})})})});te.displayName="UsersForm";const ae=f.forwardRef((t,o)=>{const s=j(),a=p(c=>c.crmUsers.data.selectedUser),m=p(c=>c.crmUsers.data.usersList),{id:r}=a,i=c=>{const{name:l,birthday:g,email:u,img:y,location:U,title:b,phoneNumber:k,facebook:E,twitter:A,pinterest:R,linkedIn:q}=c,M={name:l,email:u,img:y},d={location:U,title:b,birthday:oe(g).format("DD/MM/YYYY"),phoneNumber:k,facebook:E,twitter:A,pinterest:R,linkedIn:q};let n=v(m),x={};n=n.map(h=>(h.id===r&&(h={...h,...M},h.personalInfo={...h.personalInfo,...d},x=h),h)),Se(x)||s(Q(x)),s(H()),s(ce(n))};return e.jsx(te,{ref:o,users:a,onFormSubmit:i})});ae.displayName="UsersEditContent";const We=({onSaveClick:t,onCancel:o})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(B,{size:"sm",className:"mr-2",onClick:o,children:"Cancel"}),e.jsx(B,{size:"sm",variant:"solid",onClick:t,children:"Save"})]}),Ze=()=>{const t=j(),o=p(r=>r.crmUsers.data.drawerOpen);p(r=>r.crmUsers.data.drawerMode),p(r=>r.crmUsers.data.selectedUser);const s=()=>{t(H()),t(L({}))},a=f.useRef(null),m=async()=>{var r,i;(r=a.current)==null||r.values,(i=a.current)==null||i.submitForm()};return e.jsx(De,{isOpen:o,closable:!1,bodyClass:"p-0",footer:e.jsx(We,{onCancel:s,onSaveClick:m}),onClose:s,onRequestClose:s,children:e.jsx(ae,{ref:a})})},_e=()=>{const t=j(),o=p(r=>r.crmUsers.data.deleteConfirmation),s=p(r=>r.crmUsers.data.selectedUser),a=()=>{t($(!1))},m=async()=>{var i,c,l;t($(!1)),console.log(s,"selectedRole");const r=await t(me(s.id));await t(z()),(i=r==null?void 0:r.payload)!=null&&i.success?(F.push(e.jsx(T,{title:"Successfuly Deleted",type:"success",duration:2500,children:(c=r==null?void 0:r.payload)==null?void 0:c.message}),{placement:"top-center"}),await t(z())):(F.push(e.jsx(T,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(l=r==null?void 0:r.payload)==null?void 0:l.message}),{placement:"top-center"}),await t(z()))};return e.jsx(qe,{isOpen:o,type:"danger",title:"Delete User",confirmButtonColor:"red-600",onClose:a,onRequestClose:a,onCancel:a,onConfirm:m,children:e.jsx("p",{children:"Are you sure you want to delete this user? All record related to this user will be deleted as well. This action cannot be undone."})})},Ge=({status:t})=>{switch(t){case"active":return e.jsx(Z,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100  border-0 rounded",children:"Active"});case"inactive":return e.jsx(Z,{className:"text-amber-600 bg-amber-100 dark:text-amber-100 dark:bg-amber-500/20  border-0 rounded",children:"Inactive"});default:return e.jsx(e.Fragment,{})}},Je=()=>{const t=j(),o=p(d=>d.crmUsers.data.usersList),s=p(d=>d.crmUsers.data.loading),a=p(d=>d.crmUsers.data.filterData),m=p(d=>d.crmUsers.data.rolesList),r=_("users","canModify"),i=_("users","canDelete");f.useEffect(()=>{async function d(){await t(Re())}d()},[t]);const{pageIndex:c,pageSize:l,sort:g,query:u,total:y}=p(d=>d.crmUsers.data.tableData),U=f.useCallback(()=>{t(P())},[c,l,g,u,a,t]);f.useEffect(()=>{U()},[U,c,l,g,a]);const b=f.useMemo(()=>({pageIndex:c,pageSize:l,sort:g,query:u,total:y}),[c,l,g,u,y]),k=({row:d})=>{const{textTheme:n}=W(),x=()=>{t(de()),t(L(d)),t(pe("Edit"))};return e.jsx("div",{className:`${n} cursor-pointer select-none font-semibold`,onClick:x,children:"Edit"})},E=({row:d})=>{const{textTheme:n}=W(),x=async()=>{await t(L(d)),t($(!0))};return e.jsx("div",{className:`${n} cursor-pointer select-none font-semibold text-red-500`,onClick:x,children:"Delete"})},A=f.useMemo(()=>{const d=[{header:"First Name",accessorKey:"firstName",cell:n=>n.row.original.firstName},{header:"Last Name",accessorKey:"lastName",cell:n=>n.row.original.lastName},{header:"Role",accessorKey:"role",cell:n=>{var h;return((h=m==null?void 0:m.find(O=>(O==null?void 0:O.id)===(n==null?void 0:n.row.original.roleId)))==null?void 0:h.roleName)||"-"}},{header:"Email",accessorKey:"email",cell:n=>n.row.original.email},{header:"Phone",accessorKey:"phone",cell:n=>n.row.original.phone},{header:"Status",accessorKey:"status",cell:n=>{const x=n.row.original;return e.jsx(Ge,{status:x.status})}}];return i&&d.unshift({header:"Delete",id:"delete",cell:n=>e.jsx(E,{row:n.row.original})}),r&&d.unshift({header:"Edit",id:"action",cell:n=>e.jsx(k,{row:n.row.original})}),d},[r,i,m]),R=d=>{const n=v(b);n.pageIndex=d,t(I(n))},q=d=>{const n=v(b);n.pageSize=Number(d),n.pageIndex=1,t(I(n))},M=d=>{const n=v(b);n.sort=d,t(I(n))};return e.jsxs("div",{children:[e.jsx(Ue,{columns:A,data:o,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:s,pagingData:{total:b.total,pageIndex:b.pageIndex,pageSize:b.pageSize},onPaginationChange:R,onSelectChange:q,onSort:M}),e.jsx(Ze,{}),e.jsx(_e,{})]})};ie("crmUsers",ue);const kt=()=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{}),e.jsxs(ne,{bodyClass:"h-full",children:[e.jsx(Be,{}),e.jsx(Je,{})]})]});export{kt as default};
