import{r as g,a as L,j as e,al as Ce,aq as je}from"./index-f0c7b593.js";import{A as Ne}from"./AdaptableCard-af2a9d2e.js";import{F as Z}from"./FormDesription-d6834b2f.js";import{D as ye}from"./DataTable-b0d71643.js";import"./Alert-6365923a.js";import"./index-e46ae74f.js";import"./Badge-eb9394bd.js";import{B as Q}from"./Button-7f5aeb19.js";import"./RangeCalendar-4446a681.js";import"./Card-d2bb7bb1.js";import"./index-3454c4af.js";import"./index-7fb568e6.js";import"./Dialog-863f25dc.js";import{D as be}from"./Drawer-3213f845.js";import"./index-096ca5d8.js";import{a as I,F as we}from"./FormItem-39c4f499.js";import"./toString-15315b0c.js";import{I as F}from"./Input-b0936f40.js";import"./index-cae4e5da.js";import"./index-cd4a639d.js";import"./index-e9f2e738.js";import{t as te,N as ae}from"./toast-98ab077b.js";import"./Pagination-4451079e.js";import"./Progress-c215b6a7.js";import"./index-aa5943b4.js";import"./ScrollBar-af66e651.js";import"./index-2d35600c.js";import{S as H}from"./Select-20b819a9.js";import"./Skeleton-3fb87948.js";import"./index-681acbb6.js";import"./Switcher-52adaf57.js";import"./index-b0e56b87.js";import{T as re}from"./index-0fbd5995.js";import"./Tag-c0e1c031.js";import"./index-11547d1a.js";import"./index-ff0fc04f.js";import{T as ee}from"./Tooltip-c002e367.js";import"./Upload-652ef9c2.js";import{T as Ie}from"./TagsList-b3e5bee2.js";import{T as W}from"./TextTruncate-a320edf5.js";import{u as G}from"./checkEditUpdate-a8d8ed64.js";import{u as ve}from"./useThemeClass-a90261c9.js";import{c as U}from"./cloneDeep-a7f8bdaf.js";import{a as De}from"./index.esm-08433e05.js";import{N as Se,O as Te,P as ne,b as Me}from"./index.esm-e5bc54ff.js";import{u as C,t as X,b as Ae,d as Fe,c as ce,e as J,g as Y,h as ie,i as Re,j as Ee,k as ke,l as ze,m as Le,n as le,f as de,a as me,o as $e,p as qe,q as pe,s as P,r as K,v as Be,w as Oe,x as ue,y as _e}from"./index-fc80bde3.js";import{C as Ve}from"./ConfirmDialog-a2f5c181.js";import{u as Ke,b as A,F as We,a as Ze}from"./formik.esm-251b655f.js";import{c as Pe,a as v,e as He}from"./index.esm-36ab1692.js";/* empty css              */import{T as Ge,e as Ue}from"./index.esm-648d214b.js";import{D as Je}from"./DynamicDropDown-021caa73.js";import{B as se}from"./index.esm-b8b882c0.js";import{B as Qe}from"./index.esm-6eb7bfab.js";import{F as Xe}from"./index.esm-7aedf532.js";import{F as oe}from"./index.esm-669ef0e3.js";import{G as Ye}from"./index.esm-e9a42a23.js";import{M as et}from"./index.esm-6d11550f.js";import{C as tt}from"./react-select-creatable.esm-3da9a25c.js";import{u as at}from"./useGetModule-0613f8e4.js";import{d as st}from"./debounce-cfdc19d0.js";import"./index-d3141ad9.js";import"./useTimeout-dc84f5ca.js";import"./CloseButton-0049a26a.js";import"./StatusIcon-ee78f8c3.js";import"./Views-f075be69.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-2e915fdc.js";import"./_baseIsEqual-cd068756.js";import"./_MapCache-0e9047d5.js";import"./get-f1462f52.js";import"./useRootClose-30d78bea.js";import"./usePopper-a15905d1.js";import"./TimeInput-3420c0cd.js";import"./useUniqueId-b4c9cc1b.js";import"./useDidUpdate-99adc2ba.js";import"./index-3b8a3b80.js";import"./useUncertainRef-d24e847b.js";import"./isNil-f2b7492f.js";import"./index-18282a3b.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-4d193841.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-4b0cd007.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-4930eeca.js";import"./index.esm-cdcdcd5a.js";import"./moment-fbc5633a.js";import"./_getPrototype-0af54c7c.js";import"./CrmService-dbe6e33f.js";const xe=g.forwardRef((s,n)=>{const a=L(),u=C(p=>p.crmContact.data.deleteConfirmation),m=C(p=>p.crmContact.data.selectedContact),b=C(p=>p.crmContact.data.selectedRows),f=C(p=>p.crmContact.data.deleteMode),y=()=>{a(X(!1))},h=async()=>{var D,T,R,w;a(X(!1));const p=f==="batch"?await a(Ae({id:b})):await a(Fe(m==null?void 0:m.id));await a(ce("")),await a(J([])),(D=p==null?void 0:p.payload)!=null&&D.success?te.push(e.jsx(ae,{title:"Successfuly Deleted",type:"success",duration:2500,children:(T=p==null?void 0:p.payload)==null?void 0:T.message}),{placement:"top-end"}):te.push(e.jsx(ae,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(R=p==null?void 0:p.error)==null?void 0:R.message}),{placement:"top-end"}),(w=n==null?void 0:n.current)==null||w.resetSelected(),await a(Y()),await a(ie())};return e.jsx(Ve,{isOpen:u,type:"danger",title:"Delete Contact",confirmButtonColor:"red-600",onClose:y,onRequestClose:y,onCancel:y,onConfirm:h,children:e.jsx("p",{children:"Are you sure you want to delete this Contact? All record related to this contact will be deleted as well. This action cannot be undone."})})});xe.displayName="ContactDeleteConfirmation";const ot=s=>{const{touched:n,errors:a,values:u,setFieldValue:m,customFieldData:b}=s,f=L(),[y,h]=g.useState([]),[p,D]=g.useState(null),[T,R]=g.useState(!1),w=C(t=>{var r;return(r=t.crmContact.data)==null?void 0:r.customField});C(t=>t.crmContact.data.contactList);const E=C(t=>t.crmContact.data.companyList),x=C(t=>t.crmContact.data.sources),l=C(t=>t.crmContact.data.states);C(t=>t.crmContact.data.cities);const c=g.useMemo(()=>E==null?void 0:E.map(t=>({value:t.id,label:t.companyName})),[E]),N=g.useMemo(()=>l==null?void 0:l.map(t=>({value:t.id,label:t.stateName})),[l]),S=g.useMemo(()=>{var r;const t=l==null?void 0:l.find(i=>i.id===u.stateId);return((r=t==null?void 0:t.cities)==null?void 0:r.map(i=>({value:i.id,label:i.cityName})))||[]},[l,p]),k=g.useMemo(()=>x==null?void 0:x.map(r=>({label:r.sources,value:r.id})),[x]),B={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},O=async()=>{var t,r;try{const{payload:i}=await f(de()),d=(t=i==null?void 0:i.data)==null?void 0:t.find(j=>(j==null?void 0:j.moduleName)==="contacts");if(d){const{payload:j}=await f(me({id:(r=d==null?void 0:d.id)==null?void 0:r.toString()}));h(j==null?void 0:j.data)}}catch(i){console.error("Error fetching module data:",i)}},{getModule:_}=at();g.useEffect(()=>{(async()=>{const r=await _("contacts");await O(),await f(Re()),await f(Ee()),await f(ke(r)),await f(ze())})()},[f]);const q=Ke(),M=async(t,r)=>{await q.setFieldValue(`tagId_${r}`,t),R(!T)},$=async(t,r)=>{const i={sources:t==null?void 0:t.label};switch(r.action){case"create-option":await f(Le(i)),await f(le());break;case"select-option":m("sourceId",t);break;case"clear":m("sourceId",null);break}},o=async()=>{const t=new Set;y==null||y.forEach(i=>{u&&u[`tagId_${i.id}`]&&u[`tagId_${i.id}`].length&&u[`tagId_${i.id}`].map(j=>j.value).forEach(j=>{t.add(j)})});const r=[...t];await q.setFieldValue("tagId",r)};return g.useMemo(()=>{o()},[T,y]),e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:"Contact Basic Information",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"First Name *",invalid:a.firstName&&n.firstName,errorMessage:a.firstName,children:e.jsx(A,{type:"text",autoComplete:"off",name:"firstName",placeholder:"First Name",component:F,prefix:e.jsx(oe,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Last Name *",invalid:a.lastName&&n.lastName,errorMessage:a.lastName,children:e.jsx(A,{type:"text",autoComplete:"off",name:"lastName",placeholder:"Last Name",component:F,prefix:e.jsx(oe,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Email *",invalid:a.email&&n.email,errorMessage:a.email,children:e.jsx(A,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:F,prefix:e.jsx(Se,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Contact Number *",invalid:a.contactNumber&&n.contactNumber,errorMessage:a.contactNumber,children:e.jsx(A,{type:"tel",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:F,prefix:e.jsx(Qe,{className:"text-xl"})})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Designation",invalid:a.title&&n.title,errorMessage:a.title,children:e.jsx(A,{type:"text",autoComplete:"off",name:"title",placeholder:"Designation",component:F,prefix:e.jsx(et,{className:"text-xl"})})})})}),e.jsx(I,{label:"Notes",invalid:a.description&&n.description,errorMessage:a.description,children:e.jsx(A,{textArea:!0,type:"text",autoComplete:"off",name:"description",placeholder:"Notes",component:F,prefix:e.jsx(Ge,{className:"text-xl"})})}),e.jsx(Z,{title:"Address",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Address",invalid:a.address&&n.address,errorMessage:a.address,children:e.jsx(A,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:F,prefix:e.jsx(Xe,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"State",invalid:a.stateId&&n.stateId,errorMessage:a.stateId,children:e.jsx(H,{name:"stateId",placeholder:"Select State",options:N,id:"stateId",value:N==null?void 0:N.find(t=>(t==null?void 0:t.value)==(u==null?void 0:u.stateId)),onChange:t=>{const r=t.value;u.stateId!==r&&m("cityId",""),m("stateId",r||""),D(r)}})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"City",invalid:a.cityId&&n.cityId,errorMessage:a.cityId,children:e.jsx(H,{name:"cityId",placeholder:"Select City",options:S,id:"cityId",value:(S==null?void 0:S.find(t=>(t==null?void 0:t.value)===(u==null?void 0:u.cityId)))||{value:"",label:"Select City"},onChange:t=>{const r=t.value;r!==u.cityId&&m("cityId",r||"")}})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{style:{position:"relative"},children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"ZipCode",invalid:a.zipcode&&n.zipcode,errorMessage:a.zipcode,children:e.jsx(A,{type:"text",autoComplete:"off",name:"zipcode",placeholder:"ZipCode",component:F,prefix:e.jsx(Ue,{className:"text-xl"})})})})})})]}),e.jsx(Z,{title:"Contact Others Details",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Company Name",invalid:a.companiesId&&n.companiesId,errorMessage:a.companiesId,children:e.jsx(H,{name:"companiesId",placeholder:"Company Name",options:c,id:"companiesId",value:c==null?void 0:c.find(t=>(t==null?void 0:t.value)==(u==null?void 0:u.companiesId)),onChange:t=>{const r=t.value;m("companiesId",r||"")}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Contact Source",invalid:a.source&&n.source,errorMessage:a.source,children:e.jsx(A,{isClearable:!0,type:"text",autoComplete:"off",name:"sourceId",placeholder:"Contact Source",component:H,componentAs:tt,options:k,prefix:e.jsx(Ye,{className:"text-xl"}),onChange:$})})})]}),e.jsx(Je,{data:y,handleTagChange:M}),(w==null?void 0:w.length)>0?e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:"Additional Details",desc:"",className:"mb-2"}),e.jsx("div",{style:B,children:w==null?void 0:w.map(t=>e.jsx("div",{children:e.jsx(I,{label:t==null?void 0:t.label,children:t.inputType==="textArea"?e.jsx(A,{textArea:!0,type:"text",autoComplete:"off",name:t.name,placeholder:t==null?void 0:t.label,defaultValue:t==null?void 0:t.defaultValue,component:F,prefix:e.jsx(se,{className:"text-xl"})}):e.jsx(A,{type:t.inputType,autoComplete:"off",name:t.name,placeholder:t==null?void 0:t.label,defaultValue:t==null?void 0:t.defaultValue,component:F,prefix:e.jsx(se,{className:"text-xl"})})})},t.id))})]}):null]})},rt=Pe().shape({firstName:v().required("First Name is required"),lastName:v().required("Last Name is required"),title:v(),contactNumber:v().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",s=>!isNaN(s)).test("is-ten-digits","Contact must be exactly 10 digits",s=>{if(s){const n=Number(s);return/^\d{10}$/.test(n.toString())}return!0}).test("is-ten-digits","Contact number cannot start with 0",s=>s?!s.startsWith("0"):!0),email:v().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),address:v(),stateId:v(),cityId:v(),zipcode:v().test("is-number","ZipCode must be a number",s=>!(s&&isNaN(Number(s)))).test("is-six-digits","ZipCode must be exactly 6 digits",s=>!(s&&s.length!==6)),companiesId:v().nullable(),companyName:v(),source:v().nullable(),description:v(),tagId:He()}),{TabNav:nt,TabList:ct,TabContent:it}=re,he=g.forwardRef((s,n)=>{var D,T,R,w,E;const a=C(x=>{var l,c;return(c=(l=x.crmContact)==null?void 0:l.data)==null?void 0:c.selectedContact});(D=a==null?void 0:a.tags)==null||D.reduce((x,l)=>(x[`tagId_${l.id}`]=[],x),{});const u=g.useMemo(()=>{var x;return(x=a==null?void 0:a.tags)==null?void 0:x.reduce((l,c)=>{const N=c.tagCategoryId;return l[`tagId_${N}`]||(l[`tagId_${N}`]=[]),l[`tagId_${N}`].push({label:c.tagName,value:c.id}),l},{})},[a.tags]),m=C(x=>{var l;return(l=x.crmContact.data)==null?void 0:l.customField}),b=C(x=>{var l,c;return(c=(l=x.crmContact)==null?void 0:l.data)==null?void 0:c.sources}),f=g.useMemo(()=>b.map(l=>({label:l.sources,value:l.id})),[b]),y=!!a.id,h=L(),p=g.useMemo(()=>m==null?void 0:m.reduce((l,c)=>{var S;const N=(S=a==null?void 0:a.contactFields)==null?void 0:S.find(k=>(k==null?void 0:k.name)===(c==null?void 0:c.name));return l[c==null?void 0:c.name]=N?N==null?void 0:N.value:c!=null&&c.defaultValue?c==null?void 0:c.defaultValue:"",l},{}),[m]);return e.jsx(We,{innerRef:n,initialValues:{firstName:(a==null?void 0:a.firstName)||"",lastName:(a==null?void 0:a.lastName)||"",title:(a==null?void 0:a.title)||"",email:(a==null?void 0:a.email)||"",contactNumber:(a==null?void 0:a.contactNumber)||"",description:(a==null?void 0:a.description)||"",companyName:((T=a==null?void 0:a.company)==null?void 0:T.companyName)||"",sourceId:a!=null&&a.sourceId?f.find(x=>x.value===(a==null?void 0:a.sourceId)):null,address:(a==null?void 0:a.address)||"",stateId:(a==null?void 0:a.stateId)||"",cityId:(a==null?void 0:a.cityId)||"",zipcode:(a==null?void 0:a.zipcode)||"",tagName:((w=(R=a==null?void 0:a.tags)==null?void 0:R[0])==null?void 0:w.tagName)||"",tagId:((E=a==null?void 0:a.tags)==null?void 0:E.map(x=>({label:x.tagName,value:x.id})))||[],companiesId:(a==null?void 0:a.companiesId)||"",...p,...u},validationSchema:rt,onSubmit:async(x,{setSubmitting:l})=>{var c,N,S,k,B,O,_;try{const{tagName:q,...M}=x,$={...M,sourceId:(c=M==null?void 0:M.sourceId)==null?void 0:c.value,tagId:M==null?void 0:M.tagId},o=y?await h($e({contactId:(a==null?void 0:a.id)||"",updatedData:$})):await h(qe($)),t=(N=o==null?void 0:o.payload)!=null&&N.success?"Successfully Added":"Something went wrong !!!",r=(S=o==null?void 0:o.payload)!=null&&S.success?"success":"danger",i=(k=o==null?void 0:o.payload)!=null&&k.success?(B=o==null?void 0:o.payload)==null?void 0:B.message:(O=o==null?void 0:o.error)==null?void 0:O.message;te.push(e.jsx(ae,{title:t,type:r,duration:2500,children:i}),{placement:"top-end"}),(_=o==null?void 0:o.payload)!=null&&_.success&&h(pe()),await h(Y()),await h(ie())}catch(q){console.error(q)}finally{l(!1)}},children:({touched:x,errors:l,values:c,setFieldValue:N})=>e.jsx(Ze,{children:e.jsx(we,{children:e.jsxs(re,{defaultValue:"personalInfo",children:[e.jsx(ct,{children:e.jsx(nt,{value:"personalInfo",children:"Contact Details"})}),e.jsx("div",{className:"p-6",children:e.jsx(it,{value:"personalInfo",children:e.jsx(ot,{touched:x,errors:l,values:c,setFieldValue:N})})})]})})})})});he.displayName="ContactForm";const ge=g.forwardRef((s,n)=>{L();const a=C(m=>{var b,f;return(f=(b=m.crmContact)==null?void 0:b.data)==null?void 0:f.selectedContact});C(m=>m.crmContact.data.contactList);const u=async m=>{};return e.jsx(he,{ref:n,contact:a,onFormSubmit:u})});ge.displayName="ContactEditContent";const lt=({onSaveClick:s,onCancel:n})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(Q,{size:"sm",className:"mr-2",onClick:n,children:"Cancel"}),e.jsx(Q,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),dt=()=>{const s=L(),[n,a]=g.useState(window.innerWidth/2),u=C(h=>{var p,D;return(D=(p=h.crmContact)==null?void 0:p.data)==null?void 0:D.drawerOpen}),m=()=>{s(pe()),s(P({}))},b=g.useRef(null),f=()=>{var h;(h=b.current)==null||h.submitForm()},y=()=>{a(window.innerWidth/2)};return g.useEffect(()=>(window.addEventListener("resize",y),()=>{window.removeEventListener("resize",y)}),[]),e.jsx(be,{isOpen:u,closable:!1,bodyClass:"p-0",width:n,footer:e.jsx(lt,{onCancel:m,onSaveClick:f}),onClose:m,onRequestClose:m,children:e.jsx(ge,{ref:b})})},mt=()=>{const s=L(),[n,a]=g.useState([]),u=C(o=>o.crmContact.data.displayedContactList),m=C(o=>o.crmContact.data.tableData),b=C(o=>o.crmContact.data.selectedRows),f=G("contacts","canModify"),y=G("contacts","canDelete"),h=G("contacts","canView"),p=C(o=>o.crmContact.data.loading),D=Ce(),{pageIndex:T,pageSize:R,sort:w,query:E,total:x}=C(o=>o.crmContact.data.tableData),l=g.useCallback(()=>{S(),s(Y()),s(le())},[s]);g.useEffect(()=>(l(),()=>{window.location.pathname.includes("contact")||s(K({...m,query:""}))}),[]);const c=g.useMemo(()=>({pageIndex:T,pageSize:R,sort:w,query:E,total:x}),[T,R,w,E,x]),N=({row:o})=>{const t=L();ve();const r=()=>{t(ue()),t(P(o))},i=async()=>{t(P(o)),t(X(!0))},d=()=>{t(P(o));const j=`/app/crm/contact-details/${o.id}`;D(j)};return e.jsxs("div",{className:"flex text-base items-center",children:[f&&e.jsx("span",{className:"cursor-pointer hover:text-indigo-500 circle items-center",onClick:r,children:e.jsx(Te,{})}),y&&e.jsx("span",{className:"cursor-pointer hover:text-red-500 circle mx-1 items-center",onClick:i,children:e.jsx(ne,{})}),h&&e.jsx("span",{className:"cursor-pointer hover:text-green-500 circle items-center text-lg",onClick:d,children:e.jsx(De,{})})]})},S=async()=>{var o,t;try{const{payload:r}=await s(de()),i=(o=r==null?void 0:r.data)==null?void 0:o.find(d=>(d==null?void 0:d.moduleName)==="contacts");if(i){const{payload:d}=await s(me({id:(t=i==null?void 0:i.id)==null?void 0:t.toString()}));a(d==null?void 0:d.data)}}catch(r){console.error("Error fetching module data:",r)}},k=g.useMemo(()=>{const o=[{header:"Action",id:"action",cell:t=>e.jsx(N,{row:t.row.original})},{header:"Name",accessorKey:"firstName",cell:t=>{const{firstName:r,lastName:i}=t.row.original,d=`${r} ${i}`;return e.jsx(ee,{title:d,children:e.jsx(W,{text:d,maxLength:15})},d)}},{header:"email",accessorKey:"email",cell:t=>t.row.original.email},{header:"Number",accessorKey:"contactNumber",cell:t=>t.row.original.contactNumber},{header:"source",accessorKey:"sourceId",cell:t=>{var i,d,j,z;const r=(d=(i=t.row.original)==null?void 0:i.source)!=null&&d.sources?(z=(j=t.row.original)==null?void 0:j.source)==null?void 0:z.sources:"-";return e.jsx(W,{text:r,maxLength:15})}},{header:"designation",accessorKey:"title",cell:t=>{const r=t.row.original.title?t.row.original.title:"-";return e.jsx(ee,{title:r,children:e.jsx(W,{text:r,maxLength:15})},r)}},{header:"Company",accessorKey:"companyName",cell:t=>{const r=t.row.original.company?t.row.original.company.companyName:"-";return e.jsx(W,{text:r,maxLength:15})}},{header:"Address",accessorKey:"address",cell:t=>{const{address:r,cityData:i,stateData:d,zipcode:j}=t.row.original,z=[r,i==null?void 0:i.cityName,d==null?void 0:d.stateName,j].filter(V=>V!=null).join(" ");return e.jsx(ee,{title:z||"-",children:e.jsx(W,{text:z||"-",maxLength:20})},z)}}];return n.map((t,r)=>{const i={header:t.categoryName,id:t.id,accessorKey:"tagCategory.categoryName",cell:d=>{var z;const j=(z=d.row.original.tags)==null?void 0:z.filter(V=>(V==null?void 0:V.tagCategoryId)===t.id);return j&&j.length?e.jsx(Ie,{tags:j}):"-"}};o.splice(r+6,0,i)}),o},[f,y,n]),B=o=>{const t=U(c);t.pageIndex=o,s(K(t))},O=(o,t)=>{s(o?Be([t.id]):Oe(t.id))},_=g.useCallback((o,t)=>{if(o){const r=t.map(d=>d.original),i=[];r.forEach(d=>{i.push(d.id)}),s(J(i))}else s(J([]))},[s,b]),q=o=>{const t=U(c);t.pageSize=Number(o),t.pageIndex=1,s(K(t))},M=o=>{const t=U(c);t.sort=o,s(K(t))},$=g.useRef(null);return g.useEffect(()=>{var o;(o=$.current)==null||o.resetSelected(),s(J([]))},[m]),e.jsxs("div",{children:[e.jsx(ye,{ref:$,selectable:!0,columns:k,data:u,loading:p,pagingData:{total:c.total,pageIndex:c.pageIndex,pageSize:c.pageSize},onPaginationChange:B,onCheckBoxChange:O,onIndeterminateCheckBoxChange:_,onSelectChange:q,onSort:M}),e.jsx(dt,{}),e.jsx(xe,{ref:$})]})},fe=g.forwardRef((s,n)=>{const{onInputChange:a}=s,u=st(m,500);function m(f){a==null||a(f)}const b=f=>{u(f.target.value)};return e.jsx(F,{ref:n,className:"max-w-md md:w-56 mb-4",size:"sm",placeholder:"Search by name or email",prefix:e.jsx(Me,{className:"text-lg"}),onChange:b})});fe.displayName="ContactTableSearch";const pt=()=>{const s=L(),n=()=>{s(ce("batch")),s(X(!0))};return e.jsx(Q,{variant:"solid",color:"red-600",size:"sm",icon:e.jsx(ne,{}),onClick:n,children:"Bulk Delete"})},ut=()=>{const s=L(),n=g.useRef(null),a=C(h=>h.crmContact.data.tableData),u=C(h=>h.crmContact.data.selectedRows),m=G("contacts","canCreate"),b=h=>{const p=U(a);p.query=h,p.pageIndex=1,typeof h=="string"&&h.length>1&&f(p),typeof h=="string"&&h.length===0&&f(p)},f=h=>{s(h?K(h):Y())},y=()=>{s(ue()),s(P({}))};return g.useEffect(()=>{n.current&&(n.current.value=a.query||"",s(K(a)))},[a==null?void 0:a.query]),e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(fe,{ref:n,onInputChange:b})}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[u.length>0&&e.jsx(pt,{}),m&&e.jsx(Q,{size:"sm",onClick:y,children:"Add New"})]})]})};je("crmContact",_e);const xt=()=>{const s=C(n=>n.crmContact.data.tableData);return e.jsx(e.Fragment,{children:e.jsxs(Ne,{bodyClass:"h-full",children:[e.jsx(Z,{title:`Contacts (${(s==null?void 0:s.total)||0})`,desc:"",className:"mb-2"}),e.jsx(ut,{}),e.jsx(mt,{})]})})},Qa=xt;export{Qa as default};
