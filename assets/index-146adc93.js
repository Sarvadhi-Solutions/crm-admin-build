import{r as u,a as g,j as e,ai as K,ar as H}from"./index-04de45f1.js";import{A as L}from"./AdaptableCard-b66d711f.js";import{D as q}from"./DataTable-26a56396.js";import{u as m,s as M,a as S,g as N,b,c as D,d as P,e as k,f as U,r as G}from"./AdditionalTag-04d8fd06.js";import{u as A}from"./useThemeClass-d6175223.js";import{B as j}from"./Button-c014eb4a.js";import{D as V}from"./Drawer-a2e296b0.js";import{C as _}from"./CustomerForm-635ad948.js";import{c as x}from"./cloneDeep-9e3b0d5b.js";import{I as J}from"./Input-177911dc.js";import{z as Q,B as W,d as X,a7 as Y,r as Z}from"./index.esm-dece01db.js";import{d as ee}from"./debounce-72f24c40.js";import{S as te,c as se}from"./Select-8dd681ec.js";import{B as T}from"./Badge-fd219ce7.js";import{C as re}from"./Card-5dadf163.js";import{A as oe}from"./index-d960fe16.js";import{M as ae}from"./MediaSkeleton-345b1161.js";import{N as ie}from"./react-number-format.es-042f37c4.js";import"./index-f4f40370.js";import"./index.esm-bec52084.js";import"./Pagination-d7bd87b8.js";import"./index-746fa18b.js";import"./_Uint8Array-51fedccd.js";import"./_MapCache-593c8f28.js";import"./Views-9d427d6f.js";import"./_baseIsEqual-aab3701d.js";import"./get-e02c019e.js";import"./toString-85ae3482.js";import"./TableRowSkeleton-b8809059.js";import"./Skeleton-74d23b60.js";import"./index-57d63c42.js";import"./formik.esm-21613a47.js";import"./context-3f43d22b.js";import"./index-5206a52a.js";import"./Alert-b77365f1.js";import"./useTimeout-352435f8.js";import"./CloseButton-c81f3a7a.js";import"./StatusIcon-43cda077.js";import"./Calendar-3ea43322.js";import"./useControllableState-517757cf.js";import"./index-688929a7.js";import"./useMergeRef-788c4cb0.js";import"./useRootClose-9c807e39.js";import"./usePopper-301f1b7b.js";import"./RangeCalendar-31722222.js";import"./TimeInput-89c18d58.js";import"./useUniqueId-d1553e7a.js";import"./useDidUpdate-be24419c.js";import"./Dialog-94528cff.js";import"./index-ce7a2c9a.js";import"./index-34afd70e.js";import"./useUncertainRef-83c88a9e.js";import"./isNil-2d09164b.js";import"./chainedFunction-070f832c.js";import"./index-18e79e75.js";import"./index-0dfb4b3d.js";import"./index-4e807dfb.js";import"./toast-5c5a7d02.js";import"./Progress-500b53ea.js";import"./index-5445ceea.js";import"./ScrollBar-9c40bad5.js";import"./index-eb3ec0a1.js";import"./index-7626a7a3.js";import"./mapCloneElement-022773c2.js";import"./Switcher-51151d96.js";import"./index-d856057f.js";import"./Tag-b89b8728.js";import"./index-8639ecda.js";import"./index-b1e5b8b7.js";import"./Tooltip-8263a1ca.js";import"./index.esm-86efb1ff.js";import"./Upload-8284d175.js";import"./index.esm-31d11ed9.js";import"./index.esm-eee56358.js";import"./CrmService-1cd24b67.js";import"./index.esm-7ed3d02a.js";import"./index.esm-af77fe4a.js";/* empty css              */import"./_getPrototype-c53c6c29.js";import"./toConsumableArray-c4879a90.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";const I=u.forwardRef((s,t)=>{g();const r=m(n=>n.crmCustomers.data.selectedCustomer);m(n=>n.crmCustomers.data.customerList);const o=async n=>{};return e.jsx(_,{ref:t,customer:r,onFormSubmit:o})});I.displayName="CustomerEditContent";const ne=({onSaveClick:s,onCancel:t})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(j,{size:"sm",className:"mr-2",onClick:t,children:"Cancel"}),e.jsx(j,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),le=()=>{const s=g(),t=m(c=>c.crmCustomers.data.drawerOpen),r=()=>{s(M()),s(S({}))},o=u.useRef(null),n=()=>{var c,l;console.log("formSubmit function called",(c=o.current)==null?void 0:c.values),(l=o.current)==null||l.submitForm()};return e.jsx(V,{isOpen:t,closable:!1,bodyClass:"p-0",footer:e.jsx(ne,{onCancel:r,onSaveClick:n}),onClose:r,onRequestClose:r,children:e.jsx(I,{ref:o})})},ce=({row:s})=>{const{textTheme:t}=A(),r=g(),o=()=>{r(D()),r(S(s))};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},me=({row:s})=>{const{textTheme:t}=A(),r=g(),o=async()=>{console.log(s,"Bhai Agaya"),await r(P(s.id)),await r(N())};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold`,onClick:o,children:"Delete"})},de=()=>{const s=g(),t=m(a=>a.crmCustomers.data.customerList),r=m(a=>a.crmCustomers.data.loading),o=m(a=>a.crmCustomers.data.filterData),{pageIndex:n,pageSize:c,sort:l,query:i,total:d}=m(a=>a.crmCustomers.data.tableData),h=u.useCallback(()=>{s(N())},[s]);u.useEffect(()=>{h()},[h,n,c,l,o]);const C=u.useMemo(()=>({pageIndex:n,pageSize:c,sort:l,query:i,total:d}),[n,c,l,i,d]),z=u.useMemo(()=>[{header:"Customer Name",accessorKey:"clientName",cell:a=>a.row.original.clientName,width:200},{header:"Contact Number",accessorKey:"contactInfo",cell:a=>a.row.original.contactInfo,width:200},{header:"Address",accessorKey:"address",cell:a=>a.row.original.address,width:200},{header:"Billing Details",accessorKey:"billingDetails",cell:a=>a.row.original.billingDetails,width:200},{header:"History",accessorKey:"history",cell:a=>a.row.original.history,width:200},{header:"Notes",accessorKey:"notes",cell:a=>a.row.original.notes,width:200},{header:"Tag Name",accessorKey:"tagName",width:200,cell:a=>{const B=(a.row.original.tags||[]).map(w=>{const f=w.colorName||"#000000",$={backgroundColor:`rgba(${parseInt(f.slice(1,3),16)}, ${parseInt(f.slice(3,5),16)}, ${parseInt(f.slice(5,7),16)}, 0.2)`,color:f,padding:"4px 8px",borderRadius:"4px",marginRight:"4px",marginBottom:"4px"};return e.jsx("div",{style:$,children:w.tagName},w.id)});return e.jsx("div",{children:B})}},{header:"Edit",id:"action",cell:a=>e.jsx(ce,{row:a.row.original})},{header:"Delete",id:"action",cell:a=>e.jsx(me,{row:a.row.original})}],[]),E=a=>{const p=x(C);p.pageIndex=a,s(b(p))},F=a=>{const p=x(C);p.pageSize=Number(a),p.pageIndex=1,s(b(p))},O=a=>{const p=x(C);p.sort=a,s(b(p))};return e.jsxs("div",{children:[e.jsx(q,{columns:z,data:t,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:r,pagingData:{total:C.total,pageIndex:C.pageIndex,pageSize:C.pageSize},onPaginationChange:E,onSelectChange:F,onSort:O}),e.jsx(le,{})]})},R=u.forwardRef((s,t)=>{const{onInputChange:r}=s,o=ee(n,500);function n(l){r==null||r(l)}const c=l=>{o(l.target.value)};return e.jsx(J,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(Q,{className:"text-lg"}),onChange:c})});R.displayName="CustomerTableSearch";const{Control:pe}=se,y=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],ue=({innerProps:s,label:t,data:r,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{innerClass:r.color}),e.jsx("span",{children:t})]}),o&&e.jsx(W,{className:"text-emerald-500 text-xl"})]}),ge=({children:s,...t})=>{const r=t.getValue()[0];return e.jsxs(pe,{...t,children:[r&&e.jsx(T,{className:"ltr:ml-4 rtl:mr-4",innerClass:r.color}),s]})},he=()=>{const s=g(),{status:t}=m(o=>o.crmCustomers.data.filterData),r=o=>{s(k({status:o==null?void 0:o.value}))};return e.jsx(te,{options:y,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:ue,Control:ge},value:y.filter(o=>o.value===t),onChange:r})},Ce=()=>{const s=g(),t=u.useRef(null),r=m(i=>i.crmCustomers.data.tableData),o=i=>{const d=x(r);d.query=i,d.pageIndex=1,typeof i=="string"&&i.length>1&&n(d),typeof i=="string"&&i.length===0&&n(d)},n=i=>{s(b(i)),s(N())},c=()=>{const i=x(r);i.query="",t.current&&(t.current.value=""),s(k({status:""})),n(i)},l=()=>{s(D())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(R,{ref:t,onInputChange:o}),e.jsx(he,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(j,{size:"sm",className:"me-2",onClick:c,children:"Clear All"}),e.jsx(j,{size:"sm",onClick:l,children:"Add New"})]})]})},v=s=>{const{icon:t,avatarClass:r,label:o,value:n,growthRate:c,loading:l}=s,i=55;return e.jsx(re,{bordered:!0,children:e.jsx(K,{loading:l,customLoader:e.jsx(ae,{avatarProps:{className:"rounded",width:i,height:i}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(oe,{className:r,size:i,icon:t}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(ie,{thousandSeparator:!0,displayType:"text",value:n})})]})]})})})})},xe=()=>{var o,n,c,l,i,d;const s=g(),t=m(h=>h.crmCustomers.data.statisticData),r=m(h=>h.crmCustomers.data.statisticLoading);return u.useEffect(()=>{s(U())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(v,{icon:e.jsx(X,{}),avatarClass:"!bg-indigo-600",label:"Total Customers",value:(o=t==null?void 0:t.totalCustomers)==null?void 0:o.value,growthRate:(n=t==null?void 0:t.totalCustomers)==null?void 0:n.growShrink,loading:r}),e.jsx(v,{icon:e.jsx(Y,{}),avatarClass:"!bg-blue-500",label:"Active Customers",value:(c=t==null?void 0:t.activeCustomers)==null?void 0:c.value,growthRate:(l=t==null?void 0:t.activeCustomers)==null?void 0:l.growShrink,loading:r}),e.jsx(v,{icon:e.jsx(Z,{}),avatarClass:"!bg-emerald-500",label:"New Customers",value:(i=t==null?void 0:t.newCustomers)==null?void 0:i.value,growthRate:(d=t==null?void 0:t.newCustomers)==null?void 0:d.growShrink,loading:r})]})};H("crmCustomers",G);const fe=()=>e.jsxs(e.Fragment,{children:[e.jsx(xe,{}),e.jsxs(L,{bodyClass:"h-full",children:[e.jsx(Ce,{}),e.jsx(de,{})]})]}),_t=fe;export{_t as default};
