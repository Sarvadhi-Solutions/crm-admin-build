import{am as D,an as ae,ao as te,ap as re,a as U,r as u,j as e,ai as oe,B as ie,ar as ne}from"./index-6767ac81.js";import{A as le}from"./AdaptableCard-1cecc9da.js";import{J as ce,K as de,F as me,L as pe,M as ue}from"./CrmService-e70a4be4.js";import{C as xe}from"./Card-da872ceb.js";import{A as fe}from"./index-688b9e70.js";import{M as he}from"./MediaSkeleton-4528ed7e.js";import{d as ge,a7 as be,r as B,z as je,B as Ue,a6 as P}from"./index.esm-107f547f.js";import{N as ve}from"./react-number-format.es-3a1aae10.js";import{B as O}from"./Button-edcd26d9.js";import{c as w}from"./cloneDeep-028f7085.js";import{I as y}from"./Input-736c9e0d.js";import{d as Ce}from"./debounce-7fa991f6.js";import{S as we,c as Ne,e as K}from"./Select-3d321c37.js";import{B as Z}from"./Badge-1f68c9c2.js";import{D as ye}from"./DataTable-7c33a6e6.js";import{u as H}from"./useThemeClass-a62e85dc.js";import{D as De}from"./Drawer-95c21b15.js";import{i as Se}from"./Views-e5205a91.js";import{T as _}from"./index-149a53e8.js";import{c as v,d as S,F as Ie,a as Fe,b as Te}from"./formik.esm-35003a33.js";import{c as ke,a as C}from"./index.esm-a1939a1a.js";/* empty css              */import{j as Le}from"./index.esm-bbc04dde.js";import{v as Ae}from"./index.esm-52ddd804.js";import"./Alert-c9b22c70.js";import"./Calendar-defcfa74.js";import"./index-5c02b9f9.js";import"./index-6bf19af2.js";import"./Dialog-b04dbbb3.js";import"./index-787c9736.js";import"./toString-5f976032.js";import"./index-5e02ae30.js";import"./index-375da5f6.js";import"./index-9fee79d2.js";import"./toast-33e99923.js";import"./Pagination-3af44538.js";import"./Progress-b13c43d8.js";import"./index-18c6d586.js";import"./RangeCalendar-2da4f4e1.js";import"./ScrollBar-e8750282.js";import"./index-bf30d0ca.js";import"./Skeleton-f6501194.js";import"./index-8c6f1de1.js";import"./Switcher-becc3d78.js";import"./index-d5eb49a4.js";import{T as G}from"./Tag-28e3c136.js";import"./index-d9614e75.js";import"./index-70261eaf.js";import"./Tooltip-777f9f9c.js";import"./Upload-1c01a3b3.js";import{g as Ee}from"./index-9a89468f.js";import"./useMergeRef-788c4cb0.js";import"./context-cdfa92ed.js";import"./_Uint8Array-81109713.js";import"./_MapCache-5db605d8.js";import"./_getPrototype-48c0ebaa.js";import"./isNil-1a1387e3.js";import"./get-582c28e3.js";import"./toConsumableArray-af8bf1ee.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";import"./TableRowSkeleton-6125f39f.js";import"./index-43da21b1.js";import"./index-1bb56c96.js";import"./CloseButton-5ef937e0.js";import"./useControllableState-dba48cec.js";import"./index-fb02f18d.js";import"./useTimeout-395cc71e.js";import"./StatusIcon-33312305.js";import"./_baseIsEqual-98c979d7.js";import"./useRootClose-6563c421.js";import"./usePopper-ba5004dc.js";import"./TimeInput-030e16c6.js";import"./useUniqueId-1387b982.js";import"./useDidUpdate-c5cefb65.js";import"./useUncertainRef-e1544d29.js";import"./chainedFunction-070f832c.js";import"./mapCloneElement-3589bfd8.js";import"./index.esm-ad20eb15.js";import"./index.esm-3da06225.js";const Re="crmUsers",q=D("crmUsers/data/getUsersStatistic",async()=>(await ce()).data),N=D("crmUsers/data/getUsers",async()=>(await de()).data),V=D("crmRoles/data/getRoles",async()=>(await me()).data),J=D("crmUser/data/putUser",async({id:s,data:a})=>(await pe(s,a)).data),Me=D("crmUser/data/deleteUser",async s=>(await ue(s)).data),Oe={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},qe={status:""},ze={loading:!1,statisticLoading:!1,usersList:[],statisticData:{},tableData:Oe,filterData:qe,drawerOpen:!1,selectedUser:{},rolesList:[],drawerMode:"Add"},Q=ae({name:`${Re}/state`,initialState:ze,reducers:{setTableData:(s,a)=>{s.tableData=a.payload},setUsersList:(s,a)=>{s.usersList=a.payload},setFilterData:(s,a)=>{s.filterData=a.payload},setSelectedUser:(s,a)=>{s.selectedUser=a.payload},setDrawerOpen:s=>{s.drawerOpen=!0},setRolesList:(s,a)=>{s.rolesList=a.payload},setDrawerClose:s=>{s.drawerOpen=!1},setDrawerMode:(s,a)=>{s.drawerMode=a.payload}},extraReducers:s=>{s.addCase(N.fulfilled,(a,t)=>{a.usersList=t.payload.data,a.tableData.total=t.payload.total,a.loading=!1}).addCase(V.fulfilled,(a,t)=>{a.rolesList=t.payload.data,a.loading=!1}).addCase(N.pending,a=>{a.loading=!0}).addCase(V.pending,a=>{a.loading=!0}).addCase(q.fulfilled,(a,t)=>{a.statisticData=t.payload,a.statisticLoading=!1}).addCase(q.pending,a=>{a.statisticLoading=!0})}}),{setTableData:F,setUsersList:$e,setFilterData:W,setSelectedUser:z,setDrawerOpen:Be,setDrawerClose:$,setDrawerMode:Pe,setRolesList:La}=Q.actions,Ke=Q.reducer,He=te({data:Ke}),p=re,I=s=>{const{icon:a,avatarClass:t,label:o,value:n,growthRate:d,loading:i}=s,c=55;return e.jsx(xe,{bordered:!0,children:e.jsx(oe,{loading:i,customLoader:e.jsx(he,{avatarProps:{className:"rounded",width:c,height:c}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(fe,{className:t,size:c,icon:a}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(ve,{thousandSeparator:!0,displayType:"text",value:n})})]})]})})})})},Ge=()=>{const s=U(),a=p(o=>o.crmUsers.data.statisticData),t=p(o=>o.crmUsers.data.statisticLoading);return u.useEffect(()=>{s(q())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(I,{icon:e.jsx(ge,{}),avatarClass:"!bg-indigo-600",label:"Total Users",value:a==null?void 0:a.totalUser,loading:t}),e.jsx(I,{icon:e.jsx(be,{}),avatarClass:"!bg-blue-500",label:"Active Users",value:a==null?void 0:a.activeUser,loading:t}),e.jsx(I,{icon:e.jsx(B,{}),avatarClass:"!bg-emerald-500",label:"Deactivate Users",value:a==null?void 0:a.deactiveUser,loading:t}),e.jsx(I,{icon:e.jsx(B,{}),avatarClass:"!bg-emerald-500",label:"New Users",value:a==null?void 0:a.newUser,loading:t})]})},X=u.forwardRef((s,a)=>{const{onInputChange:t}=s,o=Ce(n,500);function n(i){t==null||t(i)}const d=i=>{o(i.target.value)};return e.jsx(y,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(je,{className:"text-lg"}),onChange:d})});X.displayName="UsersTableSearch";const{Control:Ve}=Ne,Y=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],Ye=({innerProps:s,label:a,data:t,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{innerClass:t.color}),e.jsx("span",{children:a})]}),o&&e.jsx(Ue,{className:"text-emerald-500 text-xl"})]}),Ze=({children:s,...a})=>{const t=a.getValue()[0];return e.jsxs(Ve,{...a,children:[t&&e.jsx(Z,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),s]})},_e=()=>{const s=U(),{status:a}=p(o=>o.crmUsers.data.filterData),t=o=>{s(W({status:o==null?void 0:o.value}))};return e.jsx(we,{options:Y,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:Ye,Control:Ze},value:Y.filter(o=>o.value===a),onChange:t})},Je=()=>{const s=U(),a=u.useRef(null),t=p(i=>i.crmUsers.data.tableData),o=i=>{const c=w(t);c.query=i,c.pageIndex=1,typeof i=="string"&&i.length>1&&n(c),typeof i=="string"&&i.length===0&&n(c)},n=i=>{s(F(i)),s(N(i))},d=()=>{const i=w(t);i.query="",a.current&&(a.current.value=""),s(W({status:""})),n(i)};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(X,{ref:a,onInputChange:o}),e.jsx(_e,{})]}),e.jsx("div",{className:"mb-4",children:e.jsx(O,{size:"sm",className:"me-2",onClick:d,children:"Clear All"})})]})},Qe=s=>{const{touched:a,errors:t,setFieldValue:o,values:n}=s;U(),u.useState(""),p(l=>l.crmUsers.data.selectedUser);const d=p(l=>l.crmUsers.data.rolesList);console.log(d);const i=d.map(l=>({label:l.roleName,value:l.id})),c=[{label:"active",value:"active"},{label:"inactive",value:"inactive"}];return e.jsxs(e.Fragment,{children:[e.jsx(v,{label:"First Name",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"firstName",placeholder:"Customer Name",component:y,prefix:e.jsx(P,{className:"text-xl"})})}),e.jsx(v,{label:"Last Name",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"lastName",component:y,prefix:e.jsx(P,{className:"text-xl"})})}),e.jsx(v,{label:"Email",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"email",component:y,prefix:e.jsx(Le,{className:"text-xl"})})}),e.jsx(v,{label:"Phone",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"phone",component:y,prefix:e.jsx(Ae,{className:"text-xl"})})}),e.jsx(v,{label:"Role",children:e.jsx(K,{name:"roleId",id:"roleId",value:i.find(l=>(l==null?void 0:l.value)===(n==null?void 0:n.roleId)),onChange:l=>{o("roleId",l.value||"")},options:i})}),e.jsx(v,{label:"Status",children:e.jsx(K,{name:"status",id:"status",value:c.find(l=>(l==null?void 0:l.value)===(n==null?void 0:n.status)),onChange:l=>{o("status",l.value||"")},options:c})})]})},We=ke().shape({firstName:C().required("First name is required"),lastName:C().required("Last name is required"),email:C().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),phone:C().matches(/^\d{10}$/,"Phone number must be 10 digits").required("Phone is required"),status:C().required("Status is required").oneOf(["active","inactive"]),roleId:C().required()}),{TabNav:Xe,TabList:es,TabContent:ss}=_,ee=u.forwardRef(()=>{const s=p(t=>t.crmUsers.data.selectedUser),a=p(t=>t.crmUsers.data.drawerMode);return console.log(a),e.jsx(Ie,{initialValues:{firstName:a==="Edit"&&(s==null?void 0:s.firstName)||"",lastName:a==="Edit"&&(s==null?void 0:s.lastName)||"",email:a==="Edit"&&(s==null?void 0:s.email)||"",phone:a==="Edit"&&(s==null?void 0:s.phone)||"",status:a==="Add"?"inactive":(s==null?void 0:s.status)||"",roleId:a==="Edit"&&(s==null?void 0:s.roleId)||""},validationSchema:We,onSubmit:(t,{setSubmitting:o})=>{console.log(t,"fromikvalues"),console.log("on submit called "),o(!1)},children:({touched:t,errors:o,setFieldValue:n,values:d})=>e.jsx(Fe,{children:e.jsx(Te,{children:e.jsxs(_,{defaultValue:"usersInfo",children:[e.jsx(es,{children:e.jsx(Xe,{value:"usersInfo",children:"Users Info"})}),e.jsx("div",{className:"p-6",children:e.jsx(ss,{value:"usersInfo",children:e.jsx(Qe,{touched:t,errors:o,setFieldValue:n,values:d})})})]})})})})});ee.displayName="UsersForm";const se=u.forwardRef((s,a)=>{const t=U(),o=p(c=>c.crmUsers.data.selectedUser),n=p(c=>c.crmUsers.data.usersList),{id:d}=o,i=c=>{const{name:l,birthday:h,email:g,img:x,location:T,title:k,phoneNumber:L,facebook:A,twitter:E,pinterest:R,linkedIn:r}=c,m={name:l,email:g,img:x},f={location:T,title:k,birthday:ie(h).format("DD/MM/YYYY"),phoneNumber:L,facebook:A,twitter:E,pinterest:R,linkedIn:r};let b=w(n),M={};b=b.map(j=>(j.id===d&&(j={...j,...m},j.personalInfo={...j.personalInfo,...f},M=j),j)),Se(M)||t(J(M)),t($()),t($e(b))};return e.jsx(ee,{ref:a,users:o,onFormSubmit:i})});se.displayName="UsersEditContent";const as=({onSaveClick:s,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(O,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(O,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),ts=()=>{const s=U(),a=p(i=>i.crmUsers.data.drawerOpen);p(i=>i.crmUsers.data.drawerMode);const t=p(i=>i.crmUsers.data.selectedUser),o=()=>{s($()),s(z({}))},n=u.useRef(null),d=async()=>{var h,g;const i=(h=n.current)==null?void 0:h.values,c=t.id,l=await s(J({id:c,data:i}));console.log(l,"response"),await s($()),await s(N()),(g=n.current)==null||g.submitForm()};return e.jsx(De,{isOpen:a,closable:!1,bodyClass:"p-0",footer:e.jsx(as,{onCancel:o,onSaveClick:d}),onClose:o,onRequestClose:o,children:e.jsx(se,{ref:n})})},rs=({status:s})=>{switch(s){case"active":return e.jsx(G,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100  border-0 rounded",children:"Active"});case"inactive":return e.jsx(G,{className:"text-amber-600 bg-amber-100 dark:text-amber-100 dark:bg-amber-500/20  border-0 rounded",children:"Inactive"});default:return e.jsx(e.Fragment,{})}},os=()=>{const s=U(),a=p(r=>r.crmUsers.data.usersList),t=p(r=>r.crmUsers.data.loading),o=p(r=>r.crmUsers.data.filterData),n=p(r=>r.crmUsers.data.rolesList);u.useEffect(()=>{async function r(){await s(Ee())}r()},[s]);const{pageIndex:d,pageSize:i,sort:c,query:l,total:h}=p(r=>r.crmUsers.data.tableData),g=u.useCallback(()=>{s(N())},[d,i,c,l,o,s]);u.useEffect(()=>{g()},[g,d,i,c,o]);const x=u.useMemo(()=>({pageIndex:d,pageSize:i,sort:c,query:l,total:h}),[d,i,c,l,h]),T=({row:r})=>{const{textTheme:m}=H(),f=()=>{s(Be()),s(z(r)),s(Pe("Edit"))};return e.jsx("div",{className:`${m} cursor-pointer select-none font-semibold`,onClick:f,children:"Edit"})},k=({row:r})=>{const{textTheme:m}=H(),f=async()=>{s(z(r)),await s(Me(r.id)),await s(N())};return e.jsx("div",{className:`${m} cursor-pointer select-none font-semibold text-red-500`,onClick:f,children:"Delete"})},L=u.useMemo(()=>[{header:"First Name",accessorKey:"firstName",cell:r=>r.row.original.firstName,width:200},{header:"Last Name",accessorKey:"lastName",cell:r=>r.row.original.lastName,width:200},{header:"Role",accessorKey:"role",cell:r=>{var f;return((f=n==null?void 0:n.find(b=>(b==null?void 0:b.id)===(r==null?void 0:r.row.original.roleId)))==null?void 0:f.roleName)||"-"},width:200},{header:"Email",accessorKey:"email",cell:r=>r.row.original.email,width:200},{header:"Phone",accessorKey:"phone",cell:r=>r.row.original.phone,width:200},{header:"Status",accessorKey:"status",cell:r=>{const m=r.row.original;return e.jsx(rs,{status:m.status})},width:200},{header:"Edit",id:"action",cell:r=>e.jsx(T,{row:r.row.original})},{header:"Delet",id:"action",cell:r=>e.jsx(k,{row:r.row.original})}],[n]),A=r=>{const m=w(x);m.pageIndex=r,s(F(m))},E=r=>{const m=w(x);m.pageSize=Number(r),m.pageIndex=1,s(F(m))},R=r=>{const m=w(x);m.sort=r,s(F(m))};return e.jsxs("div",{children:[e.jsx(ye,{columns:L,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:x.total,pageIndex:x.pageIndex,pageSize:x.pageSize},onPaginationChange:A,onSelectChange:E,onSort:R}),e.jsx(ts,{})]})};ne("crmUsers",He);const Aa=()=>e.jsxs(e.Fragment,{children:[e.jsx(Ge,{}),e.jsxs(le,{bodyClass:"h-full",children:[e.jsx(Je,{}),e.jsx(os,{})]})]});export{Aa as default};
