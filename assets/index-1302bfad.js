import{r as g,a as h,j as e,ai as $,ar as U}from"./index-2a02f09f.js";import{A as P}from"./AdaptableCard-260ffff4.js";import{D as W}from"./DataTable-76c04f2c.js";import{u,s as G,a as S,b as N,d as V,g as j,e as w,f as I,h as O,i as _,r as J}from"./AdditionalTag-4259bcb6.js";import{u as E}from"./useThemeClass-d3572517.js";import{B as v}from"./Button-3d6c325f.js";import{D as Q}from"./Drawer-aa907a2f.js";import{C as X}from"./CustomerForm-a8b4df42.js";import{c as b}from"./cloneDeep-f2fd7982.js";import{T as Y}from"./TagsList-da492de3.js";import{u as D}from"./checkEditUpdate-064a00c7.js";import{t as k,N as R}from"./toast-66eca971.js";import{C as Z}from"./ConfirmDialog-5e3e2ca4.js";import{T as f}from"./TextTruncate-a26d8bdc.js";import{I as ee}from"./Input-4032ba6b.js";import{z as te,B as se,d as oe,a9 as re,r as ae}from"./index.esm-c61f0406.js";import{d as ne}from"./debounce-58c5e337.js";import{S as ie,c as le}from"./Select-e6a28a89.js";import{B as F}from"./Badge-ed31d9ee.js";import{C as ce}from"./Card-de52f0bd.js";import{A as me}from"./index-5ca6dc5a.js";import{M as de}from"./MediaSkeleton-930d3682.js";import{N as ue}from"./react-number-format.es-b6150c61.js";import"./index-ff9062dc.js";import"./index.esm-4f607dea.js";import"./Pagination-45470020.js";import"./index-33716023.js";import"./_Uint8Array-49dd6612.js";import"./_MapCache-dabc1c97.js";import"./Views-597fd265.js";import"./_baseIsEqual-d37b49c3.js";import"./get-c92f924e.js";import"./toString-8660963f.js";import"./TableRowSkeleton-f01debf2.js";import"./Skeleton-a1c6070d.js";import"./index-be1c4c56.js";import"./formik.esm-dba0dfcc.js";import"./Alert-72ccf787.js";import"./useTimeout-90c2003f.js";import"./CloseButton-1ba6d0ce.js";import"./StatusIcon-19ebbef4.js";import"./Calendar-10f7bbb4.js";import"./useControllableState-1afbd3cb.js";import"./index-cd684465.js";import"./useMergeRef-788c4cb0.js";import"./useRootClose-245ef2ef.js";import"./usePopper-1bbb94fb.js";import"./RangeCalendar-f83aa7d5.js";import"./TimeInput-5e6b4bd8.js";import"./useUniqueId-5771e452.js";import"./useDidUpdate-63a48c56.js";import"./Dialog-fa942d86.js";import"./index-02c6e7a7.js";import"./index-7d1fc360.js";import"./useUncertainRef-cde3ec19.js";import"./isNil-68e69365.js";import"./index-30fffd86.js";import"./chainedFunction-070f832c.js";import"./index-39ff14cb.js";import"./FormItem-c05bb264.js";import"./context-ccc0a902.js";import"./index-09081188.js";import"./index-7060438e.js";import"./Progress-225a8f75.js";import"./index-9590e8bb.js";import"./ScrollBar-5f7786c3.js";import"./index-9436b2c1.js";import"./index-94a50ac5.js";import"./mapCloneElement-80af996d.js";import"./Switcher-b6d1bfff.js";import"./index-bb34e564.js";import"./Tag-592deaaf.js";import"./index-292be09a.js";import"./index-da0bddc3.js";import"./Tooltip-7716d794.js";import"./index.esm-c0bac851.js";import"./Upload-21ca1a8f.js";import"./index.esm-62b86c40.js";import"./index.esm-9f9c71ef.js";import"./CrmService-dd365f26.js";import"./index.esm-d97e517c.js";import"./index.esm-1c4998f8.js";/* empty css              */import"./_getPrototype-63f10215.js";import"./toConsumableArray-648e2274.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";const L=g.forwardRef((s,t)=>{h();const r=u(l=>l.crmCustomers.data.selectedCustomer);u(l=>l.crmCustomers.data.customerList);const o=async l=>{};return e.jsx(X,{ref:t,customer:r,onFormSubmit:o})});L.displayName="CustomerEditContent";const pe=({onSaveClick:s,onCancel:t})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(v,{size:"sm",className:"mr-2",onClick:t,children:"Cancel"}),e.jsx(v,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),Ce=()=>{const s=h(),t=u(a=>a.crmCustomers.data.drawerOpen),r=()=>{s(G()),s(S({}))},o=g.useRef(null),l=()=>{var a,c;console.log("formSubmit function called",(a=o.current)==null?void 0:a.values),(c=o.current)==null||c.submitForm()};return e.jsx(Q,{isOpen:t,closable:!1,bodyClass:"p-0",footer:e.jsx(pe,{onCancel:r,onSaveClick:l}),onClose:r,onRequestClose:r,children:e.jsx(L,{ref:o})})},ge=()=>{const s=h(),t=u(a=>a.crmCustomers.data.deleteConfirmation),r=u(a=>a.crmCustomers.data.selectedCustomer),o=()=>{s(N(!1))},l=async()=>{var c,d,i;s(N(!1));const a=await s(V(r.id));await s(j()),(c=a==null?void 0:a.payload)!=null&&c.success?(k.push(e.jsx(R,{title:"Successfuly Deleted",type:"success",duration:2500,children:(d=a==null?void 0:a.payload)==null?void 0:d.message}),{placement:"top-center"}),await s(j())):(k.push(e.jsx(R,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(i=a==null?void 0:a.payload)==null?void 0:i.message}),{placement:"top-center"}),await s(j()))};return e.jsx(Z,{isOpen:t,type:"danger",title:"Delete Customer",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:l,children:e.jsx("p",{children:"Are you sure you want to delete this customer? All record related to this customer will be deleted as well. This action cannot be undone."})})},he=({row:s})=>{const{textTheme:t}=E(),r=h(),o=()=>{r(I()),r(S(s))};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},xe=({row:s})=>{const{textTheme:t}=E(),r=h(),o=async()=>{await r(S(s)),r(N(!0))};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold text-red-500`,onClick:o,children:"Delete"})},fe=()=>{const s=h(),t=u(m=>m.crmCustomers.data.customerList),r=u(m=>m.crmCustomers.data.loading),o=D("clients","canModify"),l=D("clients","canDelete"),a=u(m=>m.crmCustomers.data.filterData),{pageIndex:c,pageSize:d,sort:i,query:p,total:T}=u(m=>m.crmCustomers.data.tableData),A=g.useCallback(()=>{s(j())},[s]);g.useEffect(()=>{A()},[A,c,d,i,a]);const x=g.useMemo(()=>({pageIndex:c,pageSize:d,sort:i,query:p,total:T}),[c,d,i,p,T]),K=g.useMemo(()=>{const m=[{header:"Customer Name",accessorKey:"clientName",cell:n=>{const C=n.row.original.clientName;return e.jsx(f,{text:C,maxLength:20})}},{header:"Contact Number",accessorKey:"contactInfo",cell:n=>n.row.original.contactInfo},{header:"Address",accessorKey:"address",cell:n=>{const C=n.row.original.address;return e.jsx(f,{text:C,maxLength:20})}},{header:"Billing Details",accessorKey:"billingDetails",cell:n=>{const C=n.row.original.billingDetails;return e.jsx(f,{text:C,maxLength:20})}},{header:"History",accessorKey:"history",cell:n=>{const C=n.row.original.history;return e.jsx(f,{text:C,maxLength:20})}},{header:"Notes",accessorKey:"notes",cell:n=>{const C=n.row.original.notes;return e.jsx(f,{text:C,maxLength:20})}},{header:"Tag Name",accessorKey:"tagName",cell:n=>{const C=n.row.original.tags||[];return e.jsx(Y,{tags:C})}}];return l&&m.unshift({header:"Delete",id:"action",cell:n=>e.jsx(xe,{row:n.row.original})}),o&&m.unshift({header:"Edit",id:"action",cell:n=>e.jsx(he,{row:n.row.original})}),m},[o,l]),H=m=>{const n=b(x);n.pageIndex=m,s(w(n))},M=m=>{const n=b(x);n.pageSize=Number(m),n.pageIndex=1,s(w(n))},q=m=>{const n=b(x);n.sort=m,s(w(n))};return e.jsxs("div",{children:[e.jsx(W,{columns:K,data:t,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:r,pagingData:{total:x.total,pageIndex:x.pageIndex,pageSize:x.pageSize},onPaginationChange:H,onSelectChange:M,onSort:q}),e.jsx(Ce,{}),e.jsx(ge,{})]})},B=g.forwardRef((s,t)=>{const{onInputChange:r}=s,o=ne(l,500);function l(c){r==null||r(c)}const a=c=>{o(c.target.value)};return e.jsx(ee,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(te,{className:"text-lg"}),onChange:a})});B.displayName="CustomerTableSearch";const{Control:je}=le,z=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],be=({innerProps:s,label:t,data:r,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{innerClass:r.color}),e.jsx("span",{children:t})]}),o&&e.jsx(se,{className:"text-emerald-500 text-xl"})]}),we=({children:s,...t})=>{const r=t.getValue()[0];return e.jsxs(je,{...t,children:[r&&e.jsx(F,{className:"ltr:ml-4 rtl:mr-4",innerClass:r.color}),s]})},ve=()=>{const s=h(),{status:t}=u(o=>o.crmCustomers.data.filterData),r=o=>{s(O({status:o==null?void 0:o.value}))};return e.jsx(ie,{options:z,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:be,Control:we},value:z.filter(o=>o.value===t),onChange:r})},ye=()=>{const s=h(),t=g.useRef(null),r=u(i=>i.crmCustomers.data.tableData),o=D("clients","canCreate"),l=i=>{const p=b(r);p.query=i,p.pageIndex=1,typeof i=="string"&&i.length>1&&a(p),typeof i=="string"&&i.length===0&&a(p)},a=i=>{s(w(i)),s(j())},c=()=>{const i=b(r);i.query="",t.current&&(t.current.value=""),s(O({status:""})),a(i)},d=()=>{s(I())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(B,{ref:t,onInputChange:l}),e.jsx(ve,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(v,{size:"sm",className:"me-2",onClick:c,children:"Clear All"}),o&&e.jsx(v,{size:"sm",onClick:d,children:"Add New"})]})]})},y=s=>{const{icon:t,avatarClass:r,label:o,value:l,growthRate:a,loading:c}=s,d=55;return e.jsx(ce,{bordered:!0,children:e.jsx($,{loading:c,customLoader:e.jsx(de,{avatarProps:{className:"rounded",width:d,height:d}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(me,{className:r,size:d,icon:t}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(ue,{thousandSeparator:!0,displayType:"text",value:l})})]})]})})})})},Ne=()=>{var o,l,a,c,d,i;const s=h(),t=u(p=>p.crmCustomers.data.statisticData),r=u(p=>p.crmCustomers.data.statisticLoading);return g.useEffect(()=>{s(_())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(y,{icon:e.jsx(oe,{}),avatarClass:"!bg-indigo-600",label:"Total Customers",value:(o=t==null?void 0:t.totalCustomers)==null?void 0:o.value,growthRate:(l=t==null?void 0:t.totalCustomers)==null?void 0:l.growShrink,loading:r}),e.jsx(y,{icon:e.jsx(re,{}),avatarClass:"!bg-blue-500",label:"Active Customers",value:(a=t==null?void 0:t.activeCustomers)==null?void 0:a.value,growthRate:(c=t==null?void 0:t.activeCustomers)==null?void 0:c.growShrink,loading:r}),e.jsx(y,{icon:e.jsx(ae,{}),avatarClass:"!bg-emerald-500",label:"New Customers",value:(d=t==null?void 0:t.newCustomers)==null?void 0:d.value,growthRate:(i=t==null?void 0:t.newCustomers)==null?void 0:i.growShrink,loading:r})]})};U("crmCustomers",J);const De=()=>e.jsxs(e.Fragment,{children:[e.jsx(Ne,{}),e.jsxs(P,{bodyClass:"h-full",children:[e.jsx(ye,{}),e.jsx(fe,{})]})]}),as=De;export{as as default};
