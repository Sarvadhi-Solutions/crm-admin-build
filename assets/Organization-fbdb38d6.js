import{a as $,r as M,j as e,c as re,aq as se,ah as ie}from"./index-8f180057.js";import{S as Y}from"./StickyFooter-134c0766.js";import"./Alert-26b93c15.js";import"./index-50da1f05.js";import"./Badge-da9b4bac.js";import{B as S}from"./Button-9a124664.js";import"./RangeCalendar-4f882c48.js";import"./Card-c08b3dc7.js";import"./index-467c57d1.js";import"./index-f90d0a46.js";import{D as ne}from"./Dialog-00762d81.js";import"./Drawer-9e2f40a2.js";import"./index-57f971c2.js";import{a as h,F as _}from"./FormItem-6da989b2.js";import"./toString-6546c1f5.js";import{I as C}from"./Input-80948cc5.js";import"./index-c14dd8b2.js";import"./index-7419ce87.js";import"./index-8db80fc8.js";import{t as H,N as V}from"./toast-d4a23693.js";import"./Pagination-02ddc899.js";import"./Progress-4aad2981.js";import"./index-f1c49e5c.js";import"./ScrollBar-cc732ada.js";import"./index-5c4aebcf.js";import{S as oe}from"./Select-b8e32f8a.js";import"./Skeleton-a652bf9f.js";import"./index-3ad4fd06.js";import{S as de}from"./Switcher-b15fc15a.js";import"./index-68091566.js";import"./index-19730294.js";import{T as ce}from"./Tag-f078f978.js";import"./index-04594492.js";import"./index-f2e93cf2.js";import"./Tooltip-c46cdf61.js";import"./Upload-5d1aec4a.js";import{i as le}from"./isLastChild-83eb4c23.js";import{F as me}from"./FormDesription-b9a91e67.js";import{F as pe}from"./FormRow-80cac18f.js";import{u as ue,b as y,F as J,a as K}from"./formik.esm-23c950a3.js";import{c as ge}from"./cloneDeep-1f39f070.js";import{A as X,c as xe}from"./index.esm-df09f035.js";import{S as he,ad as fe}from"./index.esm-d559b7a8.js";import{R as Z}from"./index.esm-1717af00.js";import{c as U,a as E,d as be}from"./index.esm-f2cf7456.js";import{u as v,g as ee,s as k,c as je,a as R,b as q,e as ye,d as Ne,f as we,h as W,i as ve,r as Oe}from"./index-8fcdd113.js";/* empty css              */import{B as ze}from"./index.esm-047fe164.js";import"./Views-0f0dd1b0.js";import"./chart.constant-9b9fa33b.js";import"./GrowShrinkTag-a0071cd9.js";import"./DataTable-3741aea2.js";import"./react-tooltip.min-4facd0ed.js";import{R as Ce}from"./RichTextEditor-233df5d8.js";import"./SegmentItemOption-79a4fade.js";import"./SvgIcon-70b4e497.js";import{G as Ie}from"./index.esm-b66e6ba9.js";import{b as Ee}from"./index.esm-bdf0e103.js";import{T as Se}from"./index.esm-add274cc.js";const w=[],ke=s=>{const{touched:o,errors:a,setFieldValue:t,values:r}=s,l=$();M.useEffect(()=>{(async()=>{await l(ee())})()},[l]);const d=v(i=>{var N,I;return(I=(N=i.crmOrganizations)==null?void 0:N.data)==null?void 0:I.usersList});w.length=0,d==null||d.forEach(i=>{w==null||w.push({label:`${i==null?void 0:i.firstName} ${i==null?void 0:i.lastName}`,value:i.id})});const m=()=>{l(k(!1))},O=ue();return e.jsxs(e.Fragment,{children:[e.jsx(h,{label:"Branch Name",invalid:a.branchName&&o.branchName,errorMessage:a.branchName,children:e.jsx(y,{type:"text",autoComplete:"off",name:"branchName",placeholder:"Branch Name",component:C,prefix:e.jsx(Z,{className:"text-xl"})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(h,{label:"Branch Owner",invalid:a.branchOwnerId&&o.branchOwnerId,errorMessage:a.branchOwnerId,children:e.jsx(oe,{name:"branchOwnerId",placeholder:"Branch Owner",options:w,id:"branchOwnerId",value:w==null?void 0:w.find(i=>(i==null?void 0:i.value)===(r==null?void 0:r.branchOwnerId)),onChange:i=>{const N=i==null?void 0:i.value;t("branchOwnerId",N)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(h,{label:"Contact Number",invalid:a.contact&&o.contact,errorMessage:a.contact,children:e.jsx(y,{type:"text",autoComplete:"off",name:"contact",placeholder:"Contact",component:C,prefix:e.jsx(ze,{className:"text-xl"})})})})]}),e.jsx(h,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"form-label",style:{marginRight:"10px"},children:"Head Quarter"}),e.jsx(y,{autoComplete:"off",name:"isHeadQuarter",component:de,checked:O.values.isHeadQuarter})]})}),e.jsx(h,{label:"Address",invalid:a.addressInformation&&o.addressInformation,errorMessage:a.addressInformation,children:e.jsx(y,{type:"text",autoComplete:"off",name:"addressInformation",placeholder:"Address",component:C,prefix:e.jsx(he,{className:"text-xl"})})}),e.jsx(Y,{className:" px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(S,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:m,children:"Cancel"}),e.jsx(S,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(X,{}),children:"Save"})]})})]})},Fe=U().shape({branchName:E().required("Details are required"),contact:E().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",s=>!isNaN(s)).test("is-ten-digits"," Contact must be exactly 10 digits",s=>{if(s){const o=Number(s);return/^\d{10}$/.test(o.toString())}return!0}).test("is-not-more-than-ten-digits","Contact must not exceed 10 digits",s=>s?Number(s).toString().length<=10:!0),addressInformation:E(),isHeadQuarter:E(),branchOwnerId:E().required("This field is required").test("is-valid-contact","Invalid contact selected",s=>!!w.find(o=>o.value==s))}),ae=M.forwardRef((s,o)=>{const a=$(),t=v(l=>l.crmOrganizations.data.dialogMode),r=v(l=>{var d,m;return(m=(d=l.crmOrganizations)==null?void 0:d.data)==null?void 0:m.selectedBranch});return e.jsx(J,{innerRef:o,initialValues:{branchName:t==="Edit"?r==null?void 0:r.branchName:"",branchOwnerId:t==="Edit"?r==null?void 0:r.branchOwnerId:"",addressInformation:t==="Edit"?r==null?void 0:r.addressInformation:"",contact:t==="Edit"?r==null?void 0:r.contact:null,isHeadQuarter:t==="Edit"?r==null?void 0:r.isHeadQuarter:!1},validationSchema:Fe,onSubmit:async(l,{setSubmitting:d})=>{var m,O,i,N,I,A;if(t==="Add"){const n=await a(je(l));let f="",b="",j="";(m=n==null?void 0:n.payload)!=null&&m.success?(f="Successfully Added",b=(O=n==null?void 0:n.payload)==null?void 0:O.message,j="success"):(f="Something went wrong !!!",b=(i=n==null?void 0:n.error)==null?void 0:i.message,j="danger"),H.push(e.jsx(V,{title:f,type:j,duration:2500,children:b}),{placement:"top-end"}),a(k(!1)),await a(R()),await a(q()),d(!1)}else{const n=await a(ye({branchId:r==null?void 0:r.id,updatedData:l}));let f="",b="",j="";(N=n==null?void 0:n.payload)!=null&&N.success?(f="Successfully Added",b=(I=n==null?void 0:n.payload)==null?void 0:I.message,j="success"):(f="Something went wrong !!!",b=(A=n==null?void 0:n.error)==null?void 0:A.message,j="danger"),H.push(e.jsx(V,{title:f,type:j,duration:2500,children:b}),{placement:"top-end"}),a(k(!1)),await a(R()),await a(q()),d(!1)}},children:({touched:l,errors:d,values:m,setFieldValue:O})=>e.jsx(K,{children:e.jsx(_,{children:e.jsx(ke,{touched:l,errors:d,setFieldValue:O,values:m})})})})});ae.displayName="BranchesMainForm";const De=s=>{const{values:o,touched:a,errors:t}=s;return e.jsxs(e.Fragment,{children:[e.jsx("h5",{children:"Organizations"}),e.jsx("p",{className:"mb-6",children:"Section to config the organizations attribute"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(h,{label:"Organization Name",invalid:t.organizationName&&a.organizationName,errorMessage:t.organizationName,children:e.jsx(y,{type:"text",autoComplete:"off",name:"organizationName",placeholder:"Organization Name",component:C,prefix:e.jsx(Ie,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(h,{label:"Industry",invalid:t.industry&&a.industry,errorMessage:t.industry,children:e.jsx(y,{type:"text",autoComplete:"off",name:"industry",value:o.industry,placeholder:"Organization Industry",component:C})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(h,{label:"Contact",invalid:t.contact&&a.contact,errorMessage:t.contact,children:e.jsx(y,{type:"number",autoComplete:"off",name:"contact",placeholder:"Contact",component:C,prefix:e.jsx(Se,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(h,{label:"Website",invalid:t.website&&a.website,errorMessage:t.website,children:e.jsx(y,{type:"test",autoComplete:"off",name:"website",placeholder:"Website",component:C,prefix:e.jsx(Ee,{className:"text-xl"})})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"col-span-1",children:e.jsx(h,{label:"Number Of Employees",invalid:t.numberOfEmployees&&a.numberOfEmployees,errorMessage:t.numberOfEmployees,children:e.jsx(y,{type:"number",autoComplete:"off",name:"numberOfEmployees",placeholder:"Number Of Employees",component:C,prefix:e.jsx(xe,{className:"text-xl"})})})})}),e.jsx(h,{label:"Description",labelClass:"!justify-start",invalid:t.notes&&a.notes,errorMessage:t.notes,children:e.jsx(y,{name:"notes",children:({field:r,form:l})=>e.jsx(Ce,{value:r.value,onChange:d=>l.setFieldValue(r.name,d)})})})]})},Me=U().shape({organizationName:E().required("Organization Name Required"),industry:E().required("Industry Required"),contact:be().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",s=>!isNaN(s)).test("is-ten-digits"," Contact must be exactly 10 digits",s=>{if(s){const o=Number(s);return/^\d{10}$/.test(o.toString())}return!0}).test("is-not-more-than-ten-digits","Contact must not exceed 10 digits",s=>s?Number(s).toString().length<=10:!0)}),te=M.forwardRef((s,o)=>{var f,b,j,B,Q,T;const a=$(),t=v(c=>{var p,u;return(u=(p=c.crmOrganizations)==null?void 0:p.data)==null?void 0:u.organizationData});M.useEffect(()=>{(async()=>{var u;const p=await a(q());a(we((u=p==null?void 0:p.payload)==null?void 0:u.data)),await a(ee()),await a(q())})()},[a]);const r=v(c=>c.crmOrganizations.data.usersList),{type:l,onFormSubmit:d,onDiscard:m}=s,O=v(c=>c.crmOrganizations.data.isDialogOpen),i=v(c=>c.crmOrganizations.data.branchList),N=v(c=>c.crmOrganizations.data.dialogMode),I=()=>{a(k(!1))},A=()=>{a(k(!0)),a(W("Add"))},n=c=>{a(k(!0)),a(ve(c)),a(W("Edit"))};return e.jsxs(e.Fragment,{children:[e.jsx(J,{innerRef:o,initialValues:{organizationName:((f=t[0])==null?void 0:f.organizationName)||"",industry:((b=t[0])==null?void 0:b.industry)||"",contact:((j=t[0])==null?void 0:j.contact)||null,website:((B=t[0])==null?void 0:B.website)||"",numberOfEmployees:((Q=t[0])==null?void 0:Q.numberOfEmployees)||null,notes:((T=t[0])==null?void 0:T.notes)||""},validationSchema:Me,onSubmit:async(c,{setSubmitting:p})=>{var z,L,P,G;const u=ge(c),g=await a(Ne({organizationId:(z=t[0])==null?void 0:z.id,updatedData:u}));let F="",x="",D="";(L=g==null?void 0:g.payload)!=null&&L.success?(F="Successfully Added",x=(P=g==null?void 0:g.payload)==null?void 0:P.message,D="success"):(F="Something went wrong !!!",x=(G=g==null?void 0:g.error)==null?void 0:G.message,D="danger"),H.push(e.jsx(V,{title:F,type:D,duration:2500,children:x}),{placement:"top-end"}),await a(R()),d==null||d(u,p)},children:({values:c,touched:p,errors:u,isSubmitting:g})=>{const F={touched:p,errors:u};return e.jsx(K,{children:e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:e.jsx("div",{className:"lg:col-span-4",children:e.jsx(De,{touched:p,errors:u,values:c})})}),e.jsx(me,{title:" Branches",desc:"You can update your branches information here"}),e.jsxs(pe,{name:"branches",alignCenter:!0,label:"",...F,children:[e.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600",children:i==null?void 0:i.map((x,D)=>e.jsxs("div",{className:re("flex items-center justify-between p-4",!le(i,D)&&"border-b border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{}),e.jsx("div",{className:"ml-3 rtl:mr-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"text-gray-900 dark:text-gray-100 font-semibold",children:[x.branchName," ",r!=null&&r.find(z=>z.id===x.branchOwnerId)?`${r.find(z=>z.id===x.branchOwnerId).firstName} ${r.find(z=>z.id===x.branchOwnerId).lastName}`:""]}),x.isHeadQuarter&&e.jsx(ce,{className:"bg-sky-100 text-sky-600 dark:bg-sky-500/20 dark:text-sky-100 rounded-md border-0 mx-2",children:e.jsxs("span",{className:"capitalize",children:[" ","Head Quarter"," "]})})]})})]}),e.jsx("div",{className:"flex",children:e.jsx(S,{size:"sm",type:"button",onClick:()=>n(x),children:"Edit"})})]},x.id))}),e.jsx("div",{className:"mt-2",children:e.jsx(S,{type:"button",variant:"plain",size:"sm",icon:e.jsx(fe,{className:"text-lg"}),onClick:()=>A(),children:e.jsx("span",{className:"font-semibold",children:"Add new branch"})})})]}),e.jsx(Y,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(S,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>m==null?void 0:m(),children:"Discard"}),e.jsx(S,{size:"sm",variant:"solid",loading:g,icon:e.jsx(X,{}),type:"submit",children:"Save"})]})})]})})}}),e.jsxs(ne,{isOpen:O,onClose:I,children:[e.jsxs("h5",{className:"mb-4",children:[N==="Edit"?"Edit":"Add New"," Branch"]}),e.jsx(ae,{})]})]})});te.displayName="OrganizationForm";se("crmOrganizations",Oe);const Ae=()=>{const s=$(),o=v(a=>a.crmOrganizations.data.loading);return M.useEffect(()=>{s(R())},[]),e.jsx(e.Fragment,{children:e.jsx(ie,{loading:o,children:e.jsx(te,{type:"edit",onFormSubmit:function(a,t){t(!1)}})})})},Ba=Ae;export{Ba as O};
