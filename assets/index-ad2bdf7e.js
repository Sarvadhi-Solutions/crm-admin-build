import{a as M,r as b,j as e,ah as De,al as ve,aq as Ie}from"./index-01b42c77.js";import{A as Te}from"./AdaptableCard-74120e91.js";import{F as ie}from"./FormDesription-3c60f0a2.js";import{C as Ee}from"./Card-039a9ed6.js";import{A as Ae}from"./index-b609fa7a.js";import{M as Fe}from"./MediaSkeleton-e7fe4bf9.js";import{u as C,g as se,t as ae,d as ke,a as z,s as q,b as Me,c as Re,f as ce,e as le,h as re,i as Oe,j as de,k as P,l as ee,m as Ve,n as H,o as $e,p as me,r as qe}from"./index-d8fa9df0.js";import{o as ze,M as Be,C as _e,N as We,O as Pe,P as He,b as Ke}from"./index.esm-587e89d5.js";import{N as Ue}from"./react-number-format.es-0ae6a7fe.js";import{D as Ge}from"./DataTable-2544ad05.js";import{T as Je}from"./TagsList-35e036c3.js";import{T as K}from"./TextTruncate-93f99085.js";import{u as Y}from"./checkEditUpdate-27f908f6.js";import{u as Qe}from"./useThemeClass-42da9995.js";import{c as Z}from"./cloneDeep-29f2aae8.js";import{t as G,N as J}from"./toast-9d39500f.js";import{C as Xe}from"./ConfirmDialog-a691c410.js";import{B as Q}from"./Button-a5544b15.js";import{D as Ye}from"./Drawer-a351bd90.js";import{a as V,F as ue}from"./FormItem-4a386e6f.js";import{T as pe}from"./index-0fe1020b.js";import{u as Ze,b as $,F as ge,a as he}from"./formik.esm-a8cc53a4.js";import{c as xe,a as W,d as et,e as tt}from"./index.esm-d51743a0.js";import{I as O}from"./Input-b0748b3e.js";/* empty css              */import"./Alert-ba84ad42.js";import"./Badge-6cc907e6.js";import"./RangeCalendar-7e850f6c.js";import"./index-dab07eaf.js";import"./index-a9a60eee.js";import{D as at}from"./Dialog-b7c1600d.js";import"./index-71de6292.js";import"./toString-228d794c.js";import"./index-2bfb9d4e.js";import"./index-ca28e0d9.js";import"./index-a6a0da8c.js";import"./Pagination-d57e7c83.js";import"./Progress-613f4d7f.js";import"./index-8ad179bb.js";import"./ScrollBar-349c0130.js";import"./index-92468997.js";import{S as st}from"./Select-2cf95561.js";import"./Skeleton-cf28f7d5.js";import"./index-b9cef8bb.js";import"./Switcher-cf39306f.js";import"./index-f7318691.js";import{T as rt}from"./Tag-989e3abd.js";import"./index-8359d520.js";import"./index-3b362267.js";import{T as X}from"./Tooltip-06c83e8f.js";import"./Upload-b982e753.js";import{B as ot,a as nt}from"./index.esm-b7456581.js";import{M as it}from"./index.esm-afe81195.js";import{T as ct,a as lt}from"./index.esm-1917add6.js";import{B as ne}from"./index.esm-4671d282.js";import{u as dt}from"./useGetModule-07162855.js";import{D as mt}from"./DynamicDropDown-c1bbd1e9.js";import{A as ut,a as pt}from"./index.esm-44ca1025.js";import"./Views-0a1f8861.js";import"./chart.constant-8991471a.js";import"./GrowShrinkTag-a3ea01ed.js";import"./react-tooltip.min-cd40762f.js";import"./RichTextEditor-d17e3214.js";import"./SegmentItemOption-b31b5145.js";import{S as gt}from"./StickyFooter-db68b1b0.js";import"./SvgIcon-dc305fe7.js";import{S as ht}from"./Status-b06dbb8a.js";import{s as xt}from"./index-f1ab8068.js";import{d as ft}from"./debounce-9cff76d4.js";import"./useMergeRef-788c4cb0.js";import"./CrmService-fb54ad5b.js";import"./index-ffd8f14d.js";import"./moment-fbc5633a.js";import"./_MapCache-466adbaa.js";import"./_getPrototype-583e3aad.js";import"./useTimeout-459c0c98.js";import"./CloseButton-f0093569.js";import"./StatusIcon-f4c9b6a3.js";import"./chainedFunction-070f832c.js";import"./index-07bde89e.js";import"./index-5bdc2e1d.js";import"./useControllableState-6df01025.js";import"./isNil-93830b79.js";import"./get-4bda1c07.js";import"./_baseIsEqual-e4dc226f.js";import"./useRootClose-25e3e193.js";import"./usePopper-f47dd5aa.js";import"./TimeInput-1e7df44b.js";import"./useUniqueId-3c39e5d6.js";import"./useDidUpdate-172f95a0.js";import"./useUncertainRef-9e1ddaf5.js";import"./slicedToArray-0eb2b673.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-f54b4040.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-830eb65c.js";import"./index.esm-30f67dfd.js";import"./index.esm-68702517.js";import"./index-6cd17dbd.js";import"./index.esm-e0d3397a.js";import"./index-99289558.js";const te=a=>{const{icon:o,avatarClass:t,label:h,value:p,loading:n}=a,d=55;return e.jsx(Ee,{bordered:!0,children:e.jsx(De,{loading:n,customLoader:e.jsx(Fe,{avatarProps:{className:"rounded",width:d,height:d}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ae,{className:t,size:d,icon:o}),e.jsxs("div",{children:[e.jsx("span",{children:h}),e.jsx("h3",{children:e.jsx(Ue,{thousandSeparator:!0,displayType:"text",value:p})})]})]})})})})},jt=()=>{const a=M(),o=C(h=>h.crmLeads.data.statisticData),t=C(h=>h.crmLeads.data.statisticLoading);return b.useEffect(()=>{a(se())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(te,{icon:e.jsx(ze,{}),avatarClass:"!bg-indigo-600",label:"Total Leads",value:o.totalLeads,growthRate:o==null?void 0:o.totalLeads,loading:t}),e.jsx(te,{icon:e.jsx(Be,{}),avatarClass:"!bg-blue-500",label:"Open Leads",value:o.openLeads,growthRate:o.openLeads,loading:t}),e.jsx(te,{icon:e.jsx(_e,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Leads",value:o==null?void 0:o.newLeads,growthRate:o==null?void 0:o.newLeads,loading:t})]})},bt=()=>{const a=M(),o=C(n=>n.crmLeads.data.deleteConfirmation),t=C(n=>n.crmLeads.data.selectedLeads),h=()=>{a(ae(!1))},p=async()=>{var d,u,f;a(ae(!1));const n=await a(ke(t.id));await a(z()),(d=n==null?void 0:n.payload)!=null&&d.success?G.push(e.jsx(J,{title:"Successfuly Deleted",type:"success",duration:2500,children:(u=n==null?void 0:n.payload)==null?void 0:u.message}),{placement:"top-end"}):G.push(e.jsx(J,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(f=n==null?void 0:n.error)==null?void 0:f.message}),{placement:"top-end"}),await a(z()),await a(se())};return e.jsx(Xe,{isOpen:o,type:"danger",title:"Delete Lead",confirmButtonColor:"red-600",onClose:h,onRequestClose:h,onCancel:h,onConfirm:p,children:e.jsx("p",{children:"Are you sure you want to delete this Lead? All record related to this lead will be deleted as well. This action cannot be undone."})})},U=[],yt=a=>{const{touched:o,errors:t,setFieldValue:h,values:p}=a,n=M(),d=Ze(),[u,f]=b.useState(null),[T,D]=b.useState([]),[A,k]=b.useState(!1),r=C(s=>s.crmLeads.data.contactList);U.length=0;const j={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},l=C(s=>{var L;return(L=s.crmLeads.data.customField)==null?void 0:L.data});C(s=>s.crmLeads.data.leadsList),r==null||r.forEach(s=>{U.push({value:s==null?void 0:s.id,label:`${s==null?void 0:s.firstName} ${s==null?void 0:s.lastName}`})});const{getModule:g}=dt();b.useEffect(()=>{const s=async()=>{var N,B;try{n(q(!0));const{payload:F}=await n(ce());console.log("Step 1");const _=(N=F==null?void 0:F.data)==null?void 0:N.find(R=>(R==null?void 0:R.moduleName)==="leads");if(_){console.log("Step 1");const{payload:R}=await n(le({id:(B=_==null?void 0:_.id)==null?void 0:B.toString()}));D(R==null?void 0:R.data)}n(q(!1))}catch(F){console.error("Error fetching module data:",F)}};(async()=>{await n(q(!0));const N=await g("leads");f(p.contactsDataId),s(),await n(Me()),await n(Re(N)),await n(q(!1))})()},[]),C(s=>{var L,N;return(N=(L=s.crmLeads)==null?void 0:L.data)==null?void 0:N.selectedLeads});const I=async(s,L)=>{await d.setFieldValue(`tagId_${L}`,s),k(!A)},E=async()=>{const s=new Set;T==null||T.forEach(N=>{p&&p[`tagId_${N.id}`]&&p[`tagId_${N.id}`].length&&p[`tagId_${N.id}`].map(F=>F.value).forEach(F=>{s.add(F)})});const L=[...s];await d.setFieldValue("tagId",L)};return b.useMemo(()=>{E()},[A,T]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Contact Name",invalid:t.contactsDataId&&o.contactsDataId,errorMessage:t.contactsDataId,children:e.jsx(st,{name:"contactsDataId",placeholder:"Contact Name",options:U,id:"contactsDataId",value:U.find(s=>(s==null?void 0:s.value)===(p==null?void 0:p.contactsDataId)),onChange:s=>{const L=s.value;h("email",""),h("contactNumber",""),f(L),h("contactsDataId",L)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Title*",invalid:t.title&&o.title,errorMessage:t.title,children:e.jsx($,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:O,prefix:e.jsx(it,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[!u&&e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Email*",invalid:t.email&&o.email,errorMessage:t.email,children:e.jsx($,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:O,prefix:e.jsx(We,{className:"text-xl"})})})}),!u&&e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Contact Number*",invalid:t.contactNumber&&o.contactNumber,errorMessage:t.contactNumber,children:e.jsx($,{type:"text",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:O,prefix:e.jsx(ot,{className:"text-xl"})})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Budget",invalid:t.budget&&o.budget,errorMessage:t.budget,children:e.jsx($,{type:"number",autoComplete:"off",name:"budget",placeholder:"Budget",component:O,prefix:e.jsx(nt,{className:"text-xl"})})})})}),e.jsx(V,{label:"Notes",invalid:t.notes&&o.notes,errorMessage:t.notes,children:e.jsx($,{textArea:!0,type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:O,prefix:e.jsx(ct,{className:"text-xl"})})}),e.jsx(mt,{data:T,handleTagChange:I}),(l==null?void 0:l.length)>0?e.jsxs(e.Fragment,{children:[" ",e.jsx(ie,{title:"Additional Details",desc:"",className:"mb-2"}),e.jsx("div",{style:j,children:l==null?void 0:l.map(s=>e.jsx("div",{children:e.jsx(V,{label:s==null?void 0:s.label,children:s.inputType==="textArea"?e.jsx($,{textArea:!0,type:"text",autoComplete:"off",name:s.name,placeholder:s==null?void 0:s.label,defaultValue:s.defaultValue,component:O,prefix:e.jsx(ne,{className:"text-xl"})}):e.jsx($,{type:s.inputType,autoComplete:"off",name:s.name,placeholder:s==null?void 0:s.label,defaultValue:s.defaultValue,component:O,prefix:e.jsx(ne,{className:"text-xl"})})})},s.id))})]}):null]})},Ct=xe().shape({title:W().required("Title is required"),notes:W(),contactNumber:W().test("validateContactNumber","Invalid contact number",function(a){if(!this.parent.contactsDataId){if(!a)return this.createError({message:"Contact is required"});const t=Number(a);if(isNaN(t))return this.createError({message:"Contact must be a number"});if(a.length!==10)return this.createError({message:"Contact must have exactly 10 digits"});if(a.startsWith("0"))return this.createError({message:"Contact number cannot start with 0"})}return!0}),email:W().test("validateEmail","Invalid email",function(a){return this.parent.contactsDataId?!0:!!a||this.createError({message:"Email is required"})}),budget:et().test("greaterThanOne","Budget must be greater than 1",a=>a>0).required("Budget is required"),tagId:tt(),contactsDataId:W().test("is-valid-contact","Invalid contact selected",function(a){return this.parent.contactsDataId&&this.parent.contactsDataId.length>0?!!U.find(o=>o.value===a):!0})}),{TabNav:Lt,TabList:Nt,TabContent:wt}=pe,fe=b.forwardRef((a,o)=>{var D,A,k;const t=C(r=>r.crmLeads.data.selectedLeads);(D=t==null?void 0:t.tags)==null||D.reduce((r,j)=>(r[`tagId_${j.id}`]=[],r),{});const h=b.useMemo(()=>{var r;return(r=t==null?void 0:t.tags)==null?void 0:r.reduce((j,l)=>{const g=l.tagCategoryId;return j[`tagId_${g}`]||(j[`tagId_${g}`]=[]),j[`tagId_${g}`].push({label:l.tagName,value:l.id}),j},{})},[t.tags]),p=!!t.id,n=C(r=>{var j,l,g;return(g=(l=(j=r.crmLeads)==null?void 0:j.data)==null?void 0:l.customField)==null?void 0:g.data}),d=M(),u=async(r,j,l)=>{var E,s,L,N;const g=(E=r==null?void 0:r.payload)!=null&&E.success?j:"Something went wrong !!!",I=(s=r==null?void 0:r.payload)!=null&&s.success?(L=r==null?void 0:r.payload)==null?void 0:L.message:l;G.push(e.jsx(J,{title:g,type:(N=r==null?void 0:r.payload)!=null&&N.success?"success":"danger",duration:2500,children:I}),{placement:"top-end"})},f=async(r,{setSubmitting:j})=>{const l=n.reduce((g,I)=>(g[I.name]=r[I.name],g),{});try{const g={title:r.title,contactsDataId:r.contactsDataId,email:r.email,contactNumber:r.contactNumber,budget:r.budget.toString(),description:r.notes,tagId:r==null?void 0:r.tagId,...l,...h},{name:I,tagName:E,...s}=r,L=p?await d(re({leadsId:(t==null?void 0:t.id)||"",updatedData:g})):await d(Oe(g));await u(L,p?"Successfully Updated":"Successfully Added","An error occurred."),d(de()),await Promise.all([d(z()),d(se())])}catch(g){console.error("An error occurred:",g)}finally{j(!1)}},T=b.useMemo(()=>n==null?void 0:n.reduce((j,l)=>{var I;const g=(I=t==null?void 0:t.leadFields)==null?void 0:I.find(E=>(E==null?void 0:E.name)===(l==null?void 0:l.name));return j[l==null?void 0:l.name]=g?g==null?void 0:g.value:l!=null&&l.defaultValue?l==null?void 0:l.defaultValue:"",j},{}),[n]);return e.jsx(ge,{innerRef:o,initialValues:{contactsDataId:((A=t.contactData)==null?void 0:A.id)||"",title:(t==null?void 0:t.title)||"",notes:(t==null?void 0:t.description)||"",tagId:((k=t==null?void 0:t.tags)==null?void 0:k.map(r=>({label:r.tagName,value:r.id})))||[],budget:(t==null?void 0:t.budget)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",email:(t==null?void 0:t.email)||"",...T,...h},validationSchema:Ct,onSubmit:f,children:({touched:r,errors:j,values:l,setFieldValue:g})=>e.jsx(he,{children:e.jsx(ue,{children:e.jsxs(pe,{defaultValue:"leadsInfo",children:[e.jsx(Nt,{children:e.jsx(Lt,{value:"leadsInfo",children:"Leads Detail"})}),e.jsx("div",{className:"p-6",children:e.jsx(wt,{value:"leadsInfo",children:e.jsx(yt,{touched:r,errors:j,setFieldValue:g,values:l})})})]})})})})});fe.displayName="LeadsForm";const je=b.forwardRef((a,o)=>{M();const t=C(p=>{var n,d;return(d=(n=p.crmLeads)==null?void 0:n.data)==null?void 0:d.selectedLeads});C(p=>p.crmLeads.data.leadsList);const h=async p=>{};return e.jsx(fe,{ref:o,leads:t,onFormSubmit:h})});je.displayName="LeadsEditContent";const St=({onSaveClick:a,onCancel:o})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(Q,{size:"sm",className:"mr-2",onClick:o,children:"Cancel"}),e.jsx(Q,{size:"sm",variant:"solid",onClick:a,children:"Save"})]}),Dt=()=>{const a=M(),o=C(f=>f.crmLeads.data.drawerOpen),[t,h]=b.useState(window.innerWidth/2),p=()=>{a(de()),a(P({}))},n=b.useRef(null),d=()=>{var f;(f=n.current)==null||f.submitForm()};b.useEffect(()=>(window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}),[]);const u=()=>{h(window.innerWidth/2)};return e.jsx(Ye,{isOpen:o,closable:!1,bodyClass:"p-0",width:t,footer:e.jsx(St,{onCancel:p,onSaveClick:d}),onClose:p,onRequestClose:p,children:e.jsx(je,{ref:n})})},vt=xe().shape({reason:W().required("Reason is required")}),be=b.forwardRef((a,o)=>{const t=M(),h=C(d=>{var u,f;return(f=(u=d.crmLeads)==null?void 0:u.data)==null?void 0:f.selectedLeads}),p=()=>{t(ee(!1))},n=async(d,u,f,T)=>{var j,l,g;const D=await f(re({leadsId:u==null?void 0:u.id,updatedData:{reason:d.reason,status:a.id}}));let A="",k="",r="danger";(j=D==null?void 0:D.payload)!=null&&j.success?(A="Successfully Added",k=(l=D==null?void 0:D.payload)==null?void 0:l.message,r="success"):(A="Something went wrong !!!",k=(g=D==null?void 0:D.error)==null?void 0:g.message),T.push(e.jsx(J,{title:A,type:r,duration:2500,children:k}),{placement:"top-end"}),f(ee(!1)),await f(z())};return e.jsx(ge,{innerRef:o,initialValues:{reason:"",status:""},validationSchema:vt,onSubmit:async(d,{setSubmitting:u})=>{await n(d,h,t,G),u(!1)},children:({touched:d,errors:u,values:f,setFieldValue:T})=>e.jsxs(he,{children:[e.jsx(ue,{children:e.jsx(V,{label:"Reason",invalid:u.reason&&d.reason,errorMessage:u.reason,children:e.jsx($,{type:"text",autoComplete:"off",name:"reason",placeholder:"Reason",component:O,prefix:e.jsx(lt,{className:"text-xl"})})})}),e.jsx(gt,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(Q,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:p,children:"Cancel"}),e.jsx(Q,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(ut,{}),children:"Save"})]})})]})})});be.displayName="LeadForm";const It=()=>{const a=M(),[o,t]=b.useState([]),[h,p]=b.useState([]),[n,d]=b.useState(null);b.useEffect(()=>{a(Ve(n))},[n]);const[u,f]=b.useState(""),T=C(i=>i.crmLeads.data.displayedLeadsList),D=C(i=>i.crmLeads.data.loading),A=C(i=>i.crmLeads.data.isDialogOpen),k=C(i=>i.crmLeads.data.tableData),{pageIndex:r,pageSize:j,sort:l,query:g,total:I}=C(i=>i.crmLeads.data.tableData),E=b.useCallback(()=>{a(q(!0)),Ce(),a(q(!1)),a(z())},[a]);b.useEffect(()=>(E(),()=>{window.location.pathname.includes("lead")||a(H({...k,query:""}))}),[E]);const s=b.useMemo(()=>({pageIndex:r,pageSize:j,sort:l,query:g,total:I}),[r,j,l,g,I]);C(i=>i.crmLeads.data.selectedLeads);const L=Y("leads","canDelete"),N=Y("leads","canModify"),B=Y("leads","canView"),F=ve(),_=async(i,c)=>{var m,S,w;if((c==null?void 0:c.statusName)==="closed_lost")f(c==null?void 0:c.id),a(P(i)),a(ee(!0));else{const x=await a(re({leadsId:i==null?void 0:i.id,updatedData:{status:c==null?void 0:c.id}}));let y="",v="",oe="danger";(m=x==null?void 0:x.payload)!=null&&m.success?(y="Successfully Added",v=(S=x==null?void 0:x.payload)==null?void 0:S.message,oe="success"):(y="Something went wrong !!!",v=(w=x==null?void 0:x.error)==null?void 0:w.message),G.push(e.jsx(J,{title:y,type:oe,duration:2500,children:v}),{placement:"top-end"})}await a(z())},R=({row:i})=>{const c=M();Qe();const m=()=>{c(me()),c(P(i))},S=async()=>{await c(P(i)),c(ae(!0))},w=()=>{var y;d((y=i==null?void 0:i.leadStatus)==null?void 0:y.id)},x=()=>{c(P(i));const y=`/app/crm/lead-details/${i.id}`;F(y)};return e.jsxs("div",{className:"flex text-base items-center",onClick:w,children:[N&&h&&e.jsx(ht,{statusList:h,module:"leads",row:i,orgStatus:i==null?void 0:i.leadStatus,handleStatusChange:_}),N&&e.jsx("button",{disabled:(i==null?void 0:i.status)!=="open",className:`circle items-center mx-1 ${(i==null?void 0:i.status)!=="open"?"!cursor-not-allowed":"cursor-pointer hover:text-indigo-500"}`,onClick:m,children:e.jsx(Pe,{})}),L&&e.jsx("span",{className:"cursor-pointer hover:text-red-500 circle items-center",onClick:S,children:e.jsx(He,{})}),B&&e.jsx("span",{className:"cursor-pointer hover:text-green-500 circle mx-1 items-center text-lg",onClick:x,children:e.jsx(pt,{})})]})},Ce=async()=>{var i,c,m,S;try{await a(q(!0));const{payload:w}=await a(ce()),x=(i=w==null?void 0:w.data)==null?void 0:i.find(y=>(y==null?void 0:y.moduleName)==="leads");if(x){console.log("Step 2");const{payload:y}=await a(le({id:(c=x==null?void 0:x.id)==null?void 0:c.toString()})),v=await a($e((m=x==null?void 0:x.id)==null?void 0:m.toString()));p((S=v==null?void 0:v.payload)==null?void 0:S.data),t(y==null?void 0:y.data)}}catch(w){console.error("Error fetching module data:",w)}finally{await a(q(!1))}},Le=b.useMemo(()=>{const i=[{header:"Action",id:"action",cell:c=>e.jsx(R,{row:c.row.original})},{header:"Contact Name",accessorKey:"contactName",cell:c=>{var S,w,x,y,v;const m=(S=c.row.original)!=null&&S.contactData?((x=(w=c.row.original)==null?void 0:w.contactData)==null?void 0:x.firstName)+" "+((v=(y=c.row.original)==null?void 0:y.contactData)==null?void 0:v.lastName):"-";return e.jsx(X,{title:m,children:e.jsx(K,{text:m,maxLength:15})},m)}},{header:"Title",accessorKey:"title",cell:c=>{const m=c.row.original.title;return e.jsx(X,{title:m,children:e.jsx(K,{text:m,maxLength:20})},m)}},{header:"Budget",accessorKey:"budget",cell:c=>{const m=c.row.original;return e.jsx(K,{text:m.budget,maxLength:20})}},{header:"Status",accessorKey:"status",cell:c=>{var w,x,y;const m=c.row.original,S={backgroundColor:`${((w=m==null?void 0:m.leadStatus)==null?void 0:w.colorCode)||"red"}10`};return e.jsx(e.Fragment,{children:e.jsx(rt,{style:S,className:"border-0 rounded",children:e.jsx("p",{style:{color:((x=m==null?void 0:m.leadStatus)==null?void 0:x.colorCode)||"red"},children:(y=m==null?void 0:m.leadStatus)==null?void 0:y.statusName})})})}},{header:"Reason",accessorKey:"reason",cell:c=>{var S;const m=(S=c.row.original)==null?void 0:S.reason;return m?e.jsx(X,{title:m,children:e.jsx(K,{text:m,maxLength:20})},m):e.jsx(X,{title:m,children:e.jsx(K,{text:"NA",maxLength:20})},m)}}];return o.map((c,m)=>{const S={header:c.categoryName,id:c.id,accessorKey:"tagCategory.categoryName",cell:w=>{var y;const x=(y=w.row.original.tags)==null?void 0:y.filter(v=>(v==null?void 0:v.tagCategoryId)===c.id);return x&&x.length?e.jsx(Je,{tags:x}):"-"}};i.splice(m+3,0,S)}),i},[N,L,o]),Ne=i=>{const c=Z(s);c.pageIndex=i,a(H(c))},we=i=>{const c=Z(s);c.pageSize=Number(i),c.pageIndex=1,a(H(c))},Se=i=>{const c=Z(s);c.sort=i,a(H(c))};return e.jsxs("div",{children:[e.jsx(Ge,{columns:Le,data:T,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:D,pagingData:{total:s.total,pageIndex:s.pageIndex,pageSize:s.pageSize},onPaginationChange:Ne,onSelectChange:we,onSort:Se}),e.jsx(Dt,{}),e.jsx(bt,{}),e.jsxs(at,{isOpen:A,onClose:()=>a(ee(!1)),children:[e.jsx("h5",{className:"mb-4",children:"Enter Reason"}),e.jsx(be,{id:u})]})]})},ye=b.forwardRef((a,o)=>{const{onInputChange:t}=a,h=ft(p,500);function p(d){t==null||t(d)}const n=d=>{h(d.target.value)};return e.jsx(O,{ref:o,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search by name or title",prefix:e.jsx(Ke,{className:"text-lg"}),onChange:n})});ye.displayName="LeadsTableSearch";const Tt=()=>{const a=M(),o=b.useRef(null),t=C(u=>u.crmLeads.data.tableData),h=Y("leads","canCreate"),p=u=>{const f=Z(t);f.query=u,f.pageIndex=1,typeof u=="string"&&u.length>1&&n(f),typeof u=="string"&&u.length===0&&n(f)},n=u=>{a(u?H(u):z())},d=()=>{a(me()),a(P({})),a(xt("Add"))};return b.useEffect(()=>{o.current&&(o.current.value=t.query||"",a(H(t)))},[t==null?void 0:t.query]),e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(ye,{ref:o,onInputChange:p})}),e.jsx("div",{className:"mb-4",children:h&&e.jsx(Q,{size:"sm",onClick:d,children:"Add New"})})]})};Ie("crmLeads",qe);const Et=()=>{const a=C(o=>o.crmLeads.data.tableData);return e.jsxs(e.Fragment,{children:[e.jsx(jt,{}),e.jsxs(Te,{bodyClass:"h-full",children:[e.jsx(ie,{title:`Leads (${(a==null?void 0:a.total)||0})`,desc:"",className:"mb-2"}),e.jsx(Tt,{}),e.jsx(It,{})]})]})},ws=Et;export{ws as default};
