import{a as b,r as x,j as e,ai as re,p as oe,ar as ie}from"./index-a75c2214.js";import{M as ne}from"./MediaSkeleton-a4de8acd.js";import{A as le}from"./index-3aa09f20.js";import{C as ce}from"./Card-f8be7cf5.js";import{m as me,a8 as de,A as K,a6 as V,b as ue,d as pe}from"./index.esm-ba9f59e9.js";import{N as fe}from"./react-number-format.es-b704a7db.js";import{u as d,a as P,p as J,s as H,g as E,b as xe,c as L,t as $,d as he,e as F,f as ge,h as be,i as Q,r as je}from"./index-6b251452.js";import{D as ve}from"./DataTable-b1135672.js";import{u as Y}from"./useThemeClass-37b957ee.js";import{c as N}from"./cloneDeep-88274fc4.js";import{B}from"./Button-13333fa1.js";import{D as Ce}from"./Drawer-4be8ac77.js";import{i as we}from"./Views-10f1927c.js";import{T as X}from"./index-1e228cad.js";import{a as C,F as Ne}from"./FormItem-e7510cc7.js";import{b as S,F as Ue,a as ye}from"./formik.esm-3c1d58de.js";import{c as De,a as w}from"./index.esm-c3869bde.js";import{I as U}from"./Input-8164dacf.js";/* empty css              */import{a as W,S as Se,c as Ie}from"./Select-e3c4e091.js";import{r as Fe}from"./index.esm-d6edb43c.js";import{k as Te}from"./index.esm-64d4f91c.js";import{t as T,N as k}from"./toast-9ba48d0f.js";import"./Alert-a3186a3f.js";import{B as ee}from"./Badge-03bb3502.js";import"./Calendar-527cd69e.js";import"./index-4e44d9bc.js";import"./index-28e44be9.js";import"./Dialog-093c796b.js";import"./index-04ed9e3c.js";import"./toString-a311c7f9.js";import"./index-d65d54e7.js";import"./index-ce1976e4.js";import"./index-24cfecab.js";import"./Pagination-d83ae71e.js";import"./Progress-17d38890.js";import"./index-63ca2c3a.js";import"./RangeCalendar-e6435c7c.js";import"./ScrollBar-da9f6718.js";import"./index-916893a5.js";import"./Skeleton-d2cdaf3e.js";import"./index-191a7578.js";import"./Switcher-5b991065.js";import"./index-00cb4b16.js";import{T as Z}from"./Tag-9c9d82f1.js";import"./index-4c7d26f9.js";import"./index-3499d56e.js";import"./Tooltip-b12e8e28.js";import"./Upload-b697435a.js";import{g as ke}from"./index-35939218.js";import{C as Ee}from"./ConfirmDialog-7121b8e8.js";import{u as _}from"./checkEditUpdate-f9d6d97e.js";import{d as Ae}from"./debounce-0a9c6838.js";import"./useMergeRef-788c4cb0.js";import"./CrmService-4f2387c5.js";import"./TableRowSkeleton-c1e29323.js";import"./index-55fec6a8.js";import"./_Uint8Array-d074a65a.js";import"./_MapCache-876ac592.js";import"./_getPrototype-42ea40f8.js";import"./context-e419e330.js";import"./index-60763994.js";import"./CloseButton-aa3449ba.js";import"./useControllableState-974d6e74.js";import"./index-6d61f856.js";import"./isNil-92cba2d7.js";import"./get-de137b47.js";import"./slicedToArray-fb2022e5.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-d3906663.js";import"./floating-ui.dom-bef9cea3.js";import"./useTimeout-af422490.js";import"./StatusIcon-7df21d38.js";import"./chainedFunction-070f832c.js";import"./_baseIsEqual-e85234c7.js";import"./useRootClose-481198be.js";import"./usePopper-c93af6af.js";import"./TimeInput-a7dbe6f6.js";import"./useUniqueId-88c0f361.js";import"./useDidUpdate-9629db24.js";import"./useUncertainRef-46d98c81.js";import"./mapCloneElement-24483c5b.js";import"./index.esm-6e5dfffa.js";import"./index.esm-35d9794d.js";const I=t=>{const{icon:r,avatarClass:s,label:a,value:c,growthRate:o,loading:n}=t,i=55;return e.jsx(ce,{bordered:!0,children:e.jsx(re,{loading:n,customLoader:e.jsx(ne,{avatarProps:{className:"rounded",width:i,height:i}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(le,{className:s,size:i,icon:r}),e.jsxs("div",{children:[e.jsx("span",{children:a}),e.jsx("h3",{children:e.jsx(fe,{thousandSeparator:!0,displayType:"text",value:c})})]})]})})})})},Re=()=>{const t=b(),r=d(a=>a.crmUsers.data.statisticData),s=d(a=>a.crmUsers.data.statisticLoading);return x.useEffect(()=>{t(P())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4 mb-6",children:[e.jsx(I,{icon:e.jsx(me,{}),avatarClass:"!bg-indigo-600",label:"Total Users",value:r==null?void 0:r.totalUser,loading:s}),e.jsx(I,{icon:e.jsx(de,{}),avatarClass:"!bg-blue-500",label:"Active Users",value:r==null?void 0:r.activeUser,loading:s}),e.jsx(I,{icon:e.jsx(K,{}),avatarClass:"!bg-emerald-500",label:"Inactivate Users",value:r==null?void 0:r.deactiveUser,loading:s}),e.jsx(I,{icon:e.jsx(K,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Users",value:r==null?void 0:r.newUser,loading:s})]})},y=[],qe=t=>{const{touched:r,errors:s,setFieldValue:a,values:c}=t,o=d(i=>i.crmUsers.data.rolesList);y.length=0,o.forEach(i=>{y.push({label:i.roleName,value:i.id})});const n=[{label:"active",value:"active"},{label:"inactive",value:"inactive"}];return e.jsxs(e.Fragment,{children:[e.jsx(C,{label:"First Name",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"firstName",component:U,prefix:e.jsx(V,{className:"text-xl"})})}),e.jsx(C,{label:"Last Name",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"lastName",component:U,prefix:e.jsx(V,{className:"text-xl"})})}),e.jsx(C,{label:"Email",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"email",component:U,prefix:e.jsx(Te,{className:"text-xl"})})}),e.jsx(C,{label:"Phone",children:e.jsx(S,{disabled:!0,type:"text",autoComplete:"off",name:"phone",component:U,prefix:e.jsx(Fe,{className:"text-xl"})})}),e.jsx(C,{label:"Role",invalid:s.roleId&&r.roleId,errorMessage:s.roleId,children:e.jsx(W,{name:"roleId",id:"roleId",value:y.find(i=>(i==null?void 0:i.value)===(c==null?void 0:c.roleId)),options:y,onChange:i=>{a("roleId",i.value||"")}})}),e.jsx(C,{label:"Status",invalid:s.status&&r.status,errorMessage:s.status,children:e.jsx(W,{name:"status",id:"status",value:n.find(i=>(i==null?void 0:i.value)===(c==null?void 0:c.status)),options:n,onChange:i=>{a("status",i.value||"")}})})]})},Me=De().shape({firstName:w().required("First name is required"),lastName:w().required("Last name is required"),email:w().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),phone:w().matches(/^\d{10}$/,"Phone number must be 10 digits").required("Phone is required"),status:w().required("Status is required").oneOf(["active","inactive"]),roleId:w().required("Role is required").test("is-valid-role","Invalid role selected",t=>!!y.find(r=>r.value==t))}),{TabNav:Oe,TabList:ze,TabContent:Le}=X,se=x.forwardRef((t,r)=>{const s=d(o=>o.crmUsers.data.selectedUser),a=d(o=>o.crmUsers.data.drawerMode),c=b();return e.jsx(Ue,{innerRef:r,initialValues:{firstName:a==="Edit"&&(s==null?void 0:s.firstName)||"",lastName:a==="Edit"&&(s==null?void 0:s.lastName)||"",email:a==="Edit"&&(s==null?void 0:s.email)||"",phone:a==="Edit"&&(s==null?void 0:s.phone)||"",status:a==="Add"?"inactive":(s==null?void 0:s.status)||"",roleId:a==="Edit"&&(s==null?void 0:s.roleId)||""},validationSchema:Me,onSubmit:async(o,{setSubmitting:n})=>{var i,p,j;if(a==="Edit"){const u=await c(J({id:s.id,data:o}));(i=u==null?void 0:u.payload)!=null&&i.success?T.push(e.jsx(k,{title:"Successfully Update",type:"success",duration:2500,children:(p=u==null?void 0:u.payload)==null?void 0:p.message}),{placement:"top-end"}):T.push(e.jsx(k,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(j=u==null?void 0:u.error)==null?void 0:j.message}),{placement:"top-end"}),c(H()),await c(E()),await c(P())}n(!1)},children:({touched:o,errors:n,setFieldValue:i,values:p})=>e.jsx(ye,{children:e.jsx(Ne,{children:e.jsxs(X,{defaultValue:"usersInfo",children:[e.jsx(ze,{children:e.jsx(Oe,{value:"usersInfo",children:"Users Info"})}),e.jsx("div",{className:"p-6",children:e.jsx(Le,{value:"usersInfo",children:e.jsx(qe,{touched:o,errors:n,setFieldValue:i,values:p})})})]})})})})});se.displayName="UsersForm";const te=x.forwardRef((t,r)=>{const s=b(),a=d(i=>i.crmUsers.data.selectedUser),c=d(i=>i.crmUsers.data.usersList),{id:o}=a,n=i=>{const{name:p,birthday:j,email:u,img:D,location:g,title:A,phoneNumber:R,facebook:q,twitter:M,pinterest:O,linkedIn:z}=i,m={name:p,email:u,img:D},l={location:g,title:A,birthday:oe(j).format("DD/MM/YYYY"),phoneNumber:R,facebook:q,twitter:M,pinterest:O,linkedIn:z};let h=N(c),v={};h=h.map(f=>(f.id===o&&(f={...f,...m},f.personalInfo={...f.personalInfo,...l},v=f),f)),we(v)||s(J(v)),s(H()),s(xe(h))};return e.jsx(se,{ref:r,users:a,onFormSubmit:n})});te.displayName="UsersEditContent";const $e=({onSaveClick:t,onCancel:r})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(B,{size:"sm",className:"mr-2",onClick:r,children:"Cancel"}),e.jsx(B,{size:"sm",variant:"solid",onClick:t,children:"Save"})]}),Be=()=>{const t=b(),r=d(o=>o.crmUsers.data.drawerOpen);d(o=>o.crmUsers.data.drawerMode),d(o=>o.crmUsers.data.selectedUser);const s=()=>{t(H()),t(L({}))},a=x.useRef(null),c=async()=>{var o,n;(o=a.current)==null||o.values,(n=a.current)==null||n.submitForm()};return e.jsx(Ce,{isOpen:r,closable:!1,bodyClass:"p-0",footer:e.jsx($e,{onCancel:s,onSaveClick:c}),onClose:s,onRequestClose:s,children:e.jsx(te,{ref:a})})},Pe=()=>{const t=b(),r=d(o=>o.crmUsers.data.deleteConfirmation),s=d(o=>o.crmUsers.data.selectedUser),a=()=>{t($(!1))},c=async()=>{var n,i,p;t($(!1));const o=await t(he(s.id));(n=o==null?void 0:o.payload)!=null&&n.success?T.push(e.jsx(k,{title:"Successfuly Deleted",type:"success",duration:2500,children:(i=o==null?void 0:o.payload)==null?void 0:i.message}),{placement:"top-end"}):(T.push(e.jsx(k,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(p=o==null?void 0:o.error)==null?void 0:p.message}),{placement:"top-end"}),await t(E()),await t(P()))};return e.jsx(Ee,{isOpen:r,type:"danger",title:"Delete User",confirmButtonColor:"red-600",onClose:a,onRequestClose:a,onCancel:a,onConfirm:c,children:e.jsx("p",{children:"Are you sure you want to delete this user? All record related to this user will be deleted as well. This action cannot be undone."})})},He=({status:t})=>{switch(t){case"active":return e.jsx(Z,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100  border-0 rounded",children:"Active"});case"inactive":return e.jsx(Z,{className:"text-amber-600 bg-amber-100 dark:text-amber-100 dark:bg-amber-500/20  border-0 rounded",children:"Inactive"});default:return e.jsx(e.Fragment,{})}},Ke=()=>{const t=b(),r=d(m=>m.crmUsers.data.displayedUsersList),s=d(m=>m.crmUsers.data.loading);d(m=>m.crmUsers.data.filterData);const a=d(m=>m.crmUsers.data.rolesList),c=_("users","canModify"),o=_("users","canDelete");x.useEffect(()=>{async function m(){await t(ke())}m()},[t]);const{pageIndex:n,pageSize:i,sort:p,query:j,total:u}=d(m=>m.crmUsers.data.tableData),D=x.useCallback(()=>{t(E())},[t]);x.useEffect(()=>{D()},[D]);const g=x.useMemo(()=>({pageIndex:n,pageSize:i,sort:p,query:j,total:u}),[n,i,p,j,u]),A=({row:m})=>{const{textTheme:l}=Y(),h=()=>{t(ge()),t(L(m)),t(be("Edit"))};return e.jsx("div",{className:`${l} cursor-pointer select-none font-semibold`,onClick:h,children:"Edit"})},R=({row:m})=>{const{textTheme:l}=Y(),h=async()=>{await t(L(m)),t($(!0))};return e.jsx("div",{className:`${l} cursor-pointer select-none font-semibold text-red-500`,onClick:h,children:"Delete"})},q=x.useMemo(()=>{const m=[{header:"First Name",accessorKey:"firstName",cell:l=>l.row.original.firstName},{header:"Last Name",accessorKey:"lastName",cell:l=>l.row.original.lastName},{header:"Role",accessorKey:"role",cell:l=>{var v;return((v=a==null?void 0:a.find(f=>(f==null?void 0:f.id)===(l==null?void 0:l.row.original.roleId)))==null?void 0:v.roleName)||"-"}},{header:"Email",accessorKey:"email",cell:l=>l.row.original.email},{header:"Phone",accessorKey:"phone",cell:l=>l.row.original.phone},{header:"Status",accessorKey:"status",cell:l=>{const h=l.row.original;return e.jsx(He,{status:h.status})}}];return o&&m.unshift({header:"Delete",id:"delete",cell:l=>e.jsx(R,{row:l.row.original})}),c&&m.unshift({header:"Edit",id:"action",cell:l=>e.jsx(A,{row:l.row.original})}),m},[c,o,a]),M=m=>{const l=N(g);l.pageIndex=m,t(F(l))},O=m=>{const l=N(g);l.pageSize=Number(m),l.pageIndex=1,t(F(l))},z=m=>{const l=N(g);l.sort=m,t(F(l))};return e.jsxs("div",{children:[e.jsx(ve,{columns:q,data:r,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:s,pagingData:{total:g.total,pageIndex:g.pageIndex,pageSize:g.pageSize},onPaginationChange:M,onSelectChange:O,onSort:z}),e.jsx(Be,{}),e.jsx(Pe,{})]})},ae=x.forwardRef((t,r)=>{const{onInputChange:s}=t,a=Ae(c,500);function c(n){s==null||s(n)}const o=n=>{a(n.target.value)};return e.jsx(U,{ref:r,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(ue,{className:"text-lg"}),onChange:o})});ae.displayName="UsersTableSearch";const{Control:Ve}=Ie,G=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],Ye=({innerProps:t,label:r,data:s,isSelected:a})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${a?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...t,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{innerClass:s.color}),e.jsx("span",{children:r})]}),a&&e.jsx(pe,{className:"text-emerald-500 text-xl"})]}),We=({children:t,...r})=>{const s=r.getValue()[0];return e.jsxs(Ve,{...r,children:[s&&e.jsx(ee,{className:"ltr:ml-4 rtl:mr-4",innerClass:s.color}),t]})},Ze=()=>{const t=b(),{status:r}=d(a=>a.crmUsers.data.filterData),s=a=>{t(Q({status:a==null?void 0:a.value}))};return e.jsx(Se,{options:G,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:Ye,Control:We},value:G.filter(a=>a.value===r),onChange:s})},_e=()=>{const t=b(),r=x.useRef(null),s=d(n=>n.crmUsers.data.tableData),a=n=>{const i=N(s);i.query=n,i.pageIndex=1,typeof n=="string"&&n.length>1&&c(i),typeof n=="string"&&n.length===0&&c(i)},c=n=>{t(F(n)),t(E())},o=()=>{const n=N(s);n.query="",r.current&&(r.current.value=""),t(Q({status:""})),c(n)};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(ae,{ref:r,onInputChange:a}),e.jsx(Ze,{})]}),e.jsx("div",{className:"mb-4",children:e.jsx(B,{size:"sm",className:"me-2",onClick:o,children:"Clear All"})})]})};ie("crmUsers",je);const It=()=>e.jsxs(e.Fragment,{children:[e.jsx(Re,{}),e.jsx(_e,{}),e.jsx(Ke,{})]});export{It as default};
