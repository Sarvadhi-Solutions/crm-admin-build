import{am as N,an as S,ao as L,ap as R,j as e,aq as A,r as d,ai as w,ar as B,a as E}from"./index-b09faefa.js";import{a as F,b as z}from"./CrmService-5f2f53bd.js";import{C as u}from"./Card-33431fc8.js";import{B as y}from"./Badge-d1515062.js";import{C as T}from"./Chart-64f66d0e.js";import{C as n}from"./chart.constant-ef346b48.js";import{B as M}from"./Button-3bdf4581.js";import{T as k}from"./index-a157bc37.js";import{S as O}from"./StatusCapsule-42d6c5a6.js";import{T as I}from"./TagsList-a530de63.js";import{T as v}from"./TextTruncate-222d0204.js";import{c as H,u as V,f as C,g as $}from"./index-e08096fb.js";import{S as p}from"./index-d106a35e.js";import{i as G}from"./Views-57e82c67.js";import{A as x}from"./index-2f1f758f.js";import{F as q,a as W,b as _,c as J}from"./index.esm-6116c558.js";import"./chart.config-4c177efc.js";import"./context-80e77f1b.js";import"./index.esm-dbc068f5.js";import"./Alert-a515d81f.js";import"./useTimeout-68d097ea.js";import"./index.esm-2c67faf2.js";import"./CloseButton-13cd4a8c.js";import"./StatusIcon-b02f9bab.js";import"./Calendar-6959847d.js";import"./useControllableState-5d01e6b9.js";import"./index-c173cf47.js";import"./cloneDeep-de9ec659.js";import"./_Uint8Array-b1a93c95.js";import"./_MapCache-a97510fd.js";import"./_getPrototype-3540f1e6.js";import"./_baseIsEqual-77ddc906.js";import"./get-263a9377.js";import"./toString-9cef9a7f.js";import"./index-82bb2b50.js";import"./useMergeRef-788c4cb0.js";import"./Input-8c731b0c.js";import"./isNil-f81aee01.js";import"./useRootClose-3c97a09c.js";import"./usePopper-29fe3cd5.js";import"./RangeCalendar-b4e9e88f.js";import"./TimeInput-23ce06d7.js";import"./useUniqueId-6d806f5c.js";import"./useDidUpdate-ec3bfb81.js";import"./Dialog-a2bd00be.js";import"./index-8c214619.js";import"./Drawer-1ea16c4a.js";import"./index-96409d01.js";import"./useUncertainRef-b762bd82.js";import"./index-62df96f3.js";import"./chainedFunction-070f832c.js";import"./index-ae319e32.js";import"./FormItem-cdcc11d5.js";import"./index-c886a512.js";import"./index-056a1440.js";import"./toast-2c9f9fcf.js";import"./Pagination-d71ebe95.js";import"./Progress-a1e68dcb.js";import"./index-bc0f434c.js";import"./ScrollBar-a256ec53.js";import"./Select-71db8857.js";import"./slicedToArray-00fbfd7c.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-f69b773e.js";import"./floating-ui.dom-bef9cea3.js";import"./Skeleton-5bf82d8e.js";import"./index-975733af.js";import"./mapCloneElement-ef910f8e.js";import"./Switcher-e643b9c6.js";import"./index-addd5e63.js";import"./Tag-0d544e3b.js";import"./index-ba770d43.js";import"./index-dd0b5a15.js";import"./Tooltip-5b8c5fcd.js";import"./index.esm-7a963ea9.js";import"./Upload-8f332031.js";import"./index.esm-a78f5b32.js";const K="crmDashboard",b=N("crmDashboard/data/dashboard",async()=>(await F()).data),f=N("crmDashboard/data/dashboard/tasks",async()=>(await z()).data),P={loading:!0,dashboardData:{},tasksChartData:{}},Q=S({name:`${K}/state`,initialState:P,reducers:{},extraReducers:a=>{a.addCase(b.fulfilled,(s,r)=>{s.dashboardData=r.payload.crmDashboardData,s.loading=!1}).addCase(b.pending,s=>{s.loading=!0}).addCase(f.fulfilled,(s,r)=>{s.loading=!1,s.tasksChartData.chart=r.payload.data}).addCase(f.pending,s=>{s.loading=!0})}}),U=Q.reducer,X=L({data:U}),g=R,Y=({data:a={labels:[],data:[]}})=>e.jsxs(u,{children:[e.jsx("h4",{children:"Leads"}),e.jsx("div",{className:"mt-6",children:a.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{donutTitle:`${a.data.reduce((s,r)=>s+r,0)}`,donutText:"Leads",series:a.data,customOptions:{labels:a.labels},type:"donut"}),a.data.length===a.labels.length&&e.jsx("div",{className:"mt-6 grid grid-cols-2 gap-4 max-w-[180px] mx-auto",children:a.labels.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{badgeStyle:{backgroundColor:n[r]}}),e.jsx("span",{className:"font-semibold",children:s})]},s))})]})})]}),{Tr:D,Td:Z,TBody:ee,THead:se,Th:ae}=k,m=H(),te=[m.accessor("associatedContact",{header:"Associated Contact",cell:a=>a.row.original.contactData.firstName+" "+a.row.original.contactData.lastName}),m.accessor("details",{header:"Details",cell:a=>{const s=a.row.original;return e.jsx(v,{text:s.details,maxLength:30})}}),m.accessor("status",{header:"Status",cell:a=>{const s=a.row.original;return e.jsx(O,{status:s.status})}}),m.accessor("tags",{header:"Tags",cell:a=>{const s=a.row.original;return e.jsx(I,{tags:s.tags})}}),m.accessor("notes",{header:"Notes",cell:a=>{const s=a.row.original.notes;return e.jsx(v,{text:s,maxLength:30})}})],re=({data:a=[],className:s})=>{const r=A(),t=V({data:a,columns:te,getCoreRowModel:$()}),l=()=>{r("/app/crm/leads")};return e.jsxs(u,{className:s,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{children:"Leads"}),e.jsx(M,{size:"sm",onClick:l,children:"View All Leads"})]}),e.jsxs(k,{children:[e.jsx(se,{children:t.getHeaderGroups().map(i=>e.jsx(D,{children:i.headers.map(o=>e.jsx(ae,{colSpan:o.colSpan,children:C(o.column.columnDef.header,o.getContext())},o.id))},i.id))}),e.jsx(ee,{children:t.getRowModel().rows.map(i=>e.jsx(D,{children:i.getVisibleCells().map(o=>e.jsx(Z,{children:C(o.column.columnDef.cell,o.getContext())},o.id))},i.id))})]})]})},h=({label:a,value:s,badgeClass:r,showBadge:t=!0})=>e.jsxs("div",{className:"flex gap-2",children:[t&&e.jsx(y,{className:"mt-2.5",innerClass:r}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold",children:s}),e.jsx("p",{children:a})]})]}),oe=({className:a})=>{const[s,r]=d.useState(["weekly"]),t=g(c=>c.crmDashboard.data.tasksChartData),[l,i]=d.useState(!1),o=g(c=>c.theme.layout.sideNavCollapse);return d.useEffect(()=>{i(!0);const c=setTimeout(()=>i(!1),300);return console.log(n[0],n[2],n[1]),()=>{clearTimeout(c)}},[t,o]),e.jsxs(u,{className:a,children:[e.jsxs("div",{className:"flex sm:flex-row flex-col md:items-center justify-between mb-6 gap-4",children:[e.jsx("h4",{children:"Tasks Overview"}),e.jsxs(p,{value:s,size:"sm",onChange:c=>r(c),children:[e.jsx(p.Item,{value:"monthly",children:"Monthly"}),e.jsx(p.Item,{value:"weekly",children:"Weekly"}),e.jsx(p.Item,{value:"daily",children:"Daily"})]})]}),!G(t)&&!l&&(t==null?void 0:t.chart)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{children:e.jsx(h,{showBadge:!1,label:"Total Tasks",value:t==null?void 0:t.chart[s[0]].total})}),e.jsxs("div",{className:"flex gap-x-6",children:[e.jsx(h,{badgeClass:"bg-emerald-500",label:t==null?void 0:t.chart[s[0]].series[0].name,value:t==null?void 0:t.chart[s[0]].completed}),e.jsx(h,{badgeClass:"bg-indigo-600",label:t==null?void 0:t.chart[s[0]].series[1].name,value:t==null?void 0:t.chart[s[0]].pending}),e.jsx(h,{badgeClass:"bg-red-500",label:t==null?void 0:t.chart[s[0]].series[2].name,value:t==null?void 0:t.chart[s[0]].rejected})]})]}),e.jsxs("div",{children:[e.jsx(T,{series:t==null?void 0:t.chart[s[0]].series,xAxis:t==null?void 0:t.chart[s[0]].range,type:"bar",customOptions:{colors:[n[2],n[0],n[4]],legend:{show:!1}}}),e.jsx("div",{className:""})]})]}),e.jsx(w,{loading:l,type:"cover",children:l&&e.jsx("div",{className:"h-[300px]"})})]})},ie=({type:a})=>{switch(a){case"newLeads":return e.jsx(x,{size:55,className:"bg-indigo-100 text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-100",icon:e.jsx(J,{})});case"company":return e.jsx(x,{size:55,className:"bg-cyan-100 text-cyan-600 dark:bg-cyan-500/20 dark:text-cyan-100",icon:e.jsx(_,{})});case"clients":return e.jsx(x,{size:55,className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100",icon:e.jsx(W,{})});case"task":return e.jsx(x,{size:55,className:"bg-amber-100 text-amber-600 dark:bg-amber-500/20 dark:text-amber-100",icon:e.jsx(q,{})});default:return e.jsx("div",{})}},ce=({data:a={}})=>e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ie,{type:a.key}),e.jsx("div",{children:e.jsxs("div",{className:"flex gap-1.5 items-end mb-2",children:[e.jsx("h3",{className:"font-bold leading-none",children:a.value}),e.jsx("p",{className:"font-semibold",children:a.label})]})})]})}),le=({data:a=[]})=>e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4",children:a.map(s=>e.jsx(ce,{data:s},s.key))});B("crmDashboard",X);const ne=()=>{const a=E(),{statisticData:s,recentLeadsData:r}=g(o=>o.crmDashboard.data.dashboardData),t=g(o=>o.crmDashboard.data.loading);d.useEffect(()=>{l()},[]);const l=()=>{a(b()),a(f())},i=d.useMemo(()=>{const o=(r==null?void 0:r.filter(j=>j.status==="active").length)||0,c=(r==null?void 0:r.filter(j=>j.status==="deactive").length)||0;return{labels:["Active","Deactive"],data:[o,c]}},[r]);return e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs(w,{loading:t,children:[e.jsx(le,{data:s}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx(oe,{className:"col-span-2"}),e.jsx(Y,{data:i})]}),e.jsx(re,{data:r})]})})},zs=ne;export{zs as default};
