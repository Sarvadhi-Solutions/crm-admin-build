import{a as w,r as h,j as e,ai as de,ar as pe}from"./index-a75c2214.js";import{A as ue}from"./AdaptableCard-157123a1.js";import{D as xe}from"./DataTable-b1135672.js";import{u as g,a as he,f as ge,b as fe,e as Ce,s as B,g as K,c as $,d as je,h as Z,t as U,i as Ne,j as V,k as Y,l as ee,r as be}from"./index-f4901db1.js";import{u as te}from"./useThemeClass-37b957ee.js";import{B as H}from"./Button-13333fa1.js";import{D as ye}from"./Drawer-4be8ac77.js";import{T as ae}from"./index-1e228cad.js";import{a as C,F as we}from"./FormItem-e7510cc7.js";import{u as ve,b as N,F as De,a as Se}from"./formik.esm-3c1d58de.js";import{c as Te,a as b,b as Ie}from"./index.esm-c3869bde.js";import{t as L,N as M}from"./toast-9ba48d0f.js";import{I as y}from"./Input-8164dacf.js";import{D as Ae,A as Fe,t as ke,c as qe}from"./AdditionalTag-9ab7e90c.js";/* empty css              */import{A as Le}from"./index.esm-29ce9f56.js";import{a6 as Me,ab as Ee,a7 as J,b as ze,d as Oe,m as Re,a8 as Ke}from"./index.esm-ba9f59e9.js";import{a as Ve,T as $e,b as O}from"./index.esm-f6b05d17.js";import"./Alert-a3186a3f.js";import{A as He}from"./index-3aa09f20.js";import{B as se}from"./Badge-03bb3502.js";import"./Calendar-527cd69e.js";import{C as Pe}from"./Card-f8be7cf5.js";import"./index-4e44d9bc.js";import"./index-28e44be9.js";import"./Dialog-093c796b.js";import"./index-04ed9e3c.js";import"./toString-a311c7f9.js";import"./index-d65d54e7.js";import"./index-ce1976e4.js";import"./index-24cfecab.js";import"./Pagination-d83ae71e.js";import"./Progress-17d38890.js";import"./index-63ca2c3a.js";import"./RangeCalendar-e6435c7c.js";import"./ScrollBar-da9f6718.js";import"./index-916893a5.js";import{S as oe,c as Be}from"./Select-e3c4e091.js";import"./Skeleton-d2cdaf3e.js";import"./index-191a7578.js";import"./Switcher-5b991065.js";import"./index-00cb4b16.js";import"./Tag-9c9d82f1.js";import"./index-4c7d26f9.js";import"./index-3499d56e.js";import"./Tooltip-b12e8e28.js";import"./Upload-b697435a.js";import{c as R}from"./cloneDeep-88274fc4.js";import{T as Ue}from"./TagsList-0056b07b.js";import{u as W}from"./checkEditUpdate-f9d6d97e.js";import{C as We}from"./ConfirmDialog-7121b8e8.js";import{T as v}from"./TextTruncate-4ddafa66.js";import{d as Ze}from"./debounce-0a9c6838.js";import{M as _e}from"./MediaSkeleton-a4de8acd.js";import{N as Ge}from"./react-number-format.es-b704a7db.js";import"./TableRowSkeleton-c1e29323.js";import"./index-55fec6a8.js";import"./CrmService-4f2387c5.js";import"./context-e419e330.js";import"./index-60763994.js";import"./Views-10f1927c.js";import"./CloseButton-aa3449ba.js";import"./useControllableState-974d6e74.js";import"./index-6d61f856.js";import"./useTimeout-af422490.js";import"./StatusIcon-7df21d38.js";import"./chainedFunction-070f832c.js";import"./isNil-92cba2d7.js";import"./get-de137b47.js";import"./_MapCache-876ac592.js";import"./useMergeRef-788c4cb0.js";import"./_Uint8Array-d074a65a.js";import"./_baseIsEqual-e85234c7.js";import"./useRootClose-481198be.js";import"./usePopper-c93af6af.js";import"./TimeInput-a7dbe6f6.js";import"./useUniqueId-88c0f361.js";import"./useDidUpdate-9629db24.js";import"./useUncertainRef-46d98c81.js";import"./slicedToArray-fb2022e5.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-d3906663.js";import"./floating-ui.dom-bef9cea3.js";import"./mapCloneElement-24483c5b.js";import"./index.esm-6e5dfffa.js";import"./index.esm-d6edb43c.js";import"./index.esm-35d9794d.js";import"./_getPrototype-42ea40f8.js";const S=[],Je=s=>{const{touched:a,errors:t,values:r,setFieldValue:i}=s,n=w(),[c,f]=h.useState(!1),[m,u]=h.useState(!1),[D,j]=h.useState([]),[T,I]=h.useState([]),A=()=>{f(!c),u(!1)},F=g(x=>x.crmContact.data.companyList);S.length=0,F.forEach(x=>{S.push({value:x.id,label:x.companyName})});const[d,o]=h.useState("");h.useEffect(()=>{(async()=>{var k,G;try{const{payload:E}=await n(ge()),z=(k=E==null?void 0:E.data)==null?void 0:k.find(q=>(q==null?void 0:q.moduleName)==="contacts");if(o(z.id),z){const{payload:q}=await n(fe({id:(G=z==null?void 0:z.id)==null?void 0:G.toString()})),ce=ke(q.data),me=qe(q.data);I(me),j(ce)}}catch(E){console.error("Error fetching module data:",E)}})(),n(he())},[n]);const l=g(x=>x.crmContact.data.selectedContact),[P,p]=h.useState(l?l.tags||[]:[]),_=ve(),le=x=>{p(x);const k=[x.value];_.setFieldValue("tagId",k)};return e.jsxs(e.Fragment,{children:[e.jsx(C,{label:"Name",invalid:t.name&&a.name,errorMessage:t.name,children:e.jsx(N,{type:"text",autoComplete:"off",name:"name",placeholder:"Name",component:y,prefix:e.jsx(Me,{className:"text-xl"})})}),e.jsx(C,{label:"First Name",invalid:t.firstName&&a.firstName,errorMessage:t.firstName,children:e.jsx(N,{type:"text",autoComplete:"off",name:"firstName",placeholder:"First Name",component:y,prefix:e.jsx(Ee,{className:"text-xl"})})}),e.jsx(C,{label:"Last Name",invalid:t.lastName&&a.lastName,errorMessage:t.lastName,children:e.jsx(N,{type:"text",autoComplete:"off",name:"lastName",placeholder:"Last Name",component:y,prefix:e.jsx(J,{className:"text-xl"})})}),e.jsx(C,{label:"Title",invalid:t.title&&a.title,errorMessage:t.title,children:e.jsx(N,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:y,prefix:e.jsx(J,{className:"text-xl"})})}),e.jsx(C,{label:"Description",invalid:t.description&&a.description,errorMessage:t.description,children:e.jsx(N,{type:"text",autoComplete:"off",name:"description",placeholder:"Description",component:y,prefix:e.jsx(Ve,{className:"text-xl"})})}),e.jsx(C,{label:"Contact Number",invalid:t.contactNumber&&a.contactNumber,errorMessage:t.contactNumber,children:e.jsx(N,{type:"text",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:y,prefix:e.jsx(Le,{className:"text-xl"})})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(C,{label:"Tag",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(N,{name:"tagId",component:Ae,options:D,placeholder:"Select a Tag",value:_.initialValues.tagName,onChange:le}),e.jsx($e,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{A(),u(!0)}})]})}),e.jsx(Fe,{isOpen:c,categoryList:T,moduleName:d,onOpenChange:x=>f(x)})]}),e.jsx(C,{label:"Email",invalid:t.email&&a.email,errorMessage:t.email,children:e.jsx(N,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:y,prefix:e.jsx(O,{className:"text-xl"})})}),e.jsx(C,{label:"Address",invalid:t.address&&a.address,errorMessage:t.address,children:e.jsx(N,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:y,prefix:e.jsx(O,{className:"text-xl"})})}),e.jsx(C,{label:"Company Name",invalid:t.companiesId&&a.companiesId,errorMessage:t.companiesId,children:e.jsx(oe,{name:"companiesId",placeholder:"Company Name",options:S,id:"companiesId",value:S.find(x=>(x==null?void 0:x.value)==(r==null?void 0:r.companiesId)),onChange:x=>{const k=x.value;i("companiesId",k||"")}})}),e.jsx(C,{label:"Position",invalid:t.position&&a.position,errorMessage:t.position,children:e.jsx(N,{type:"text",autoComplete:"off",name:"position",placeholder:"Position",component:y,prefix:e.jsx(O,{className:"text-xl"})})}),e.jsx(C,{label:"Source",invalid:t.source&&a.source,errorMessage:t.source,children:e.jsx(N,{type:"text",autoComplete:"off",name:"source",placeholder:"Source",component:y,prefix:e.jsx(O,{className:"text-xl"})})}),e.jsx(C,{label:"Notes",invalid:t.notes&&a.notes,errorMessage:t.notes,children:e.jsx(N,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:y,prefix:e.jsx(O,{className:"text-xl"})})})]})},Qe=Te().shape({name:b().required("Name is required"),firstName:b().required("First Name is required"),lastName:b().required("Last Name is required"),title:b().required("Title is required"),contactNumber:b().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",s=>!isNaN(s)).test("is-ten-digits"," Contact must be exactly 10 digits",s=>{if(s){const a=Number(s);return/^\d{10}$/.test(a.toString())}return!0}).test("is-not-more-than-ten-digits","Contact must not exceed 10 digits",s=>s?Number(s).toString().length<=10:!0),email:b().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),address:b().required("Address is required"),companiesId:b().required("This field is required").test("is-valid-contact","Invalid contact selected",s=>!!(S!=null&&S.find(a=>(console.log(a.value,"option.value"),console.log(s,"value"),a.value==s)))),position:b().required("Position is required"),source:b().required("Source is required"),description:b().required("Description Is Required"),notes:b(),tagId:Ie()});console.log(S,"company optionsssssssss");const{TabNav:Xe,TabList:Ye,TabContent:et}=ae,re=h.forwardRef((s,a)=>{var n,c,f,m;const t=g(u=>u.crmContact.data.selectedContact),r=!!t.id,i=w();return e.jsx(De,{innerRef:a,initialValues:{name:(t==null?void 0:t.name)||"",firstName:(t==null?void 0:t.firstName)||"",lastName:(t==null?void 0:t.lastName)||"",title:(t==null?void 0:t.title)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",companyName:((n=t==null?void 0:t.company)==null?void 0:n.companyName)||"",tagName:((f=(c=t==null?void 0:t.tags)==null?void 0:c[0])==null?void 0:f.tagName)||"",email:(t==null?void 0:t.email)||"",address:(t==null?void 0:t.address)||"",companiesId:(t==null?void 0:t.companiesId)||null,position:(t==null?void 0:t.position)||"",source:(t==null?void 0:t.source)||"",description:(t==null?void 0:t.description)||"",notes:(t==null?void 0:t.notes)||"",tagId:((m=t==null?void 0:t.tags)==null?void 0:m.map(u=>u.id))||[]},validationSchema:Qe,onSubmit:async(u,{setSubmitting:D})=>{var A,F,d,o,l,P;const{colorName:j,tagName:T,...I}=u;if(console.log(j),r===!0){const p=await i(Ce({contactId:(t==null?void 0:t.id)||"",updatedData:I}));(A=p==null?void 0:p.payload)!=null&&A.success?L.push(e.jsx(M,{title:"Successfully Added",type:"success",duration:2500,children:(F=p==null?void 0:p.payload)==null?void 0:F.message}),{placement:"top-end"}):L.push(e.jsx(M,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(d=p==null?void 0:p.error)==null?void 0:d.message}),{placement:"top-end"}),i(B()),await i(K()),await i($())}else{const p=await i(je(I));console.log(p,"resposnse"),(o=p==null?void 0:p.payload)!=null&&o.success?L.push(e.jsx(M,{title:"Successfully Added",type:"success",duration:2500,children:(l=p==null?void 0:p.payload)==null?void 0:l.message}),{placement:"top-end"}):L.push(e.jsx(M,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(P=p==null?void 0:p.error)==null?void 0:P.message}),{placement:"top-end"}),i(B()),await i(K()),await i($())}D(!1)},children:({touched:u,errors:D,values:j,setFieldValue:T})=>e.jsx(Se,{children:e.jsx(we,{children:e.jsxs(ae,{defaultValue:"personalInfo",children:[e.jsx(Ye,{children:e.jsx(Xe,{value:"personalInfo",children:"Contact Details"})}),e.jsx("div",{className:"p-6",children:e.jsx(et,{value:"personalInfo",children:e.jsx(Je,{touched:u,errors:D,values:j,setFieldValue:T})})})]})})})})});re.displayName="ContactForm";const ne=h.forwardRef((s,a)=>{w();const t=g(i=>i.crmContact.data.selectedContact);g(i=>i.crmContact.data.contactList);const r=async i=>{};return e.jsx(re,{ref:a,contact:t,onFormSubmit:r})});ne.displayName="ContactEditContent";const tt=({onSaveClick:s,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(H,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(H,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),at=()=>{const s=w(),a=g(n=>n.crmContact.data.drawerOpen),t=()=>{s(B()),s(Z({}))},r=h.useRef(null),i=()=>{var n,c;console.log("formSubmit function called",(n=r.current)==null?void 0:n.values),(c=r.current)==null||c.submitForm()};return e.jsx(ye,{isOpen:a,closable:!1,bodyClass:"p-0",footer:e.jsx(tt,{onCancel:t,onSaveClick:i}),onClose:t,onRequestClose:t,children:e.jsx(ne,{ref:r})})},st=()=>{const s=w(),a=g(n=>n.crmContact.data.deleteConfirmation),t=g(n=>n.crmContact.data.selectedContact),r=()=>{s(U(!1))},i=async()=>{var c,f,m;s(U(!1));const n=await s(Ne(t==null?void 0:t.id));(c=n==null?void 0:n.payload)!=null&&c.success?L.push(e.jsx(M,{title:"Successfuly Deleted",type:"success",duration:2500,children:(f=n==null?void 0:n.payload)==null?void 0:f.message}),{placement:"top-end"}):L.push(e.jsx(M,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(m=n==null?void 0:n.error)==null?void 0:m.message}),{placement:"top-end"}),await s(K()),await s($())};return e.jsx(We,{isOpen:a,type:"danger",title:"Delete Contact",confirmButtonColor:"red-600",onClose:r,onRequestClose:r,onCancel:r,onConfirm:i,children:e.jsx("p",{children:"Are you sure you want to delete this Contact? All record related to this contact will be deleted as well. This action cannot be undone."})})},ot=({row:s})=>{const{textTheme:a}=te(),t=w(),r=()=>{t(Y()),t(Z(s))};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold`,onClick:r,children:"Edit"})},rt=({row:s})=>{const{textTheme:a}=te(),t=w(),r=async()=>{console.log(s),t(Z(s)),t(U(!0))};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold text-red-500`,onClick:r,children:"Delete"})},nt=()=>{const s=w(),a=g(d=>d.crmContact.data.displayedContactList),t=W("contacts","canModify"),r=W("contacts","canDelete"),i=g(d=>d.crmContact.data.loading);g(d=>d.crmContact.data.filterData);const{pageIndex:n,pageSize:c,sort:f,query:m,total:u}=g(d=>d.crmContact.data.tableData),D=h.useCallback(()=>{s(K())},[s]);h.useEffect(()=>{D()},[D]);const j=h.useMemo(()=>({pageIndex:n,pageSize:c,sort:f,query:m,total:u}),[n,c,f,m,u]),T=h.useMemo(()=>{const d=[{header:"Name",accessorKey:"name",cell:o=>{const l=o.row.original.name;return e.jsx(v,{text:l,maxLength:20})}},{header:"firstName",accessorKey:"firstName",cell:o=>{const l=o.row.original.firstName;return e.jsx(v,{text:l,maxLength:20})}},{header:"lastName",accessorKey:"lastName",cell:o=>{const l=o.row.original.lastName;return e.jsx(v,{text:l,maxLength:20})}},{header:"title",accessorKey:"title",cell:o=>{const l=o.row.original.title;return e.jsx(v,{text:l,maxLength:20})}},{header:"description",accessorKey:"description",cell:o=>{const l=o.row.original.description;return e.jsx(v,{text:l,maxLength:20})}},{header:"contact Number",accessorKey:"contactNumber",cell:o=>o.row.original.contactNumber},{header:"Tag Name",accessorKey:"tagName",cell:o=>{const l=o.row.original.tags||[];return e.jsx(Ue,{tags:l})}},{header:"email",accessorKey:"email",cell:o=>o.row.original.email},{header:"address",accessorKey:"address",cell:o=>{const l=o.row.original.address;return e.jsx(v,{text:l,maxLength:20})}},{header:"Company Name",accessorKey:"companyName",cell:o=>o.row.original.company?o.row.original.company.companyName:""},{header:"position",accessorKey:"position",cell:o=>{const l=o.row.original.position;return e.jsx(v,{text:l,maxLength:20})}},{header:"source",accessorKey:"source",cell:o=>{const l=o.row.original.source;return e.jsx(v,{text:l,maxLength:20})}},{header:"Notes",accessorKey:"notes",cell:o=>{const l=o.row.original.notes;return e.jsx(v,{text:l,maxLength:20})}}];return r&&d.unshift({header:"Delete",id:"action",cell:o=>e.jsx(rt,{row:o.row.original})}),t&&d.unshift({header:"Edit",id:"action",cell:o=>e.jsx(ot,{row:o.row.original})}),d},[t,r]),I=d=>{const o=R(j);o.pageIndex=d,s(V(o))},A=d=>{const o=R(j);o.pageSize=Number(d),o.pageIndex=1,s(V(o))},F=d=>{const o=R(j);o.sort=d,s(V(o))};return e.jsxs("div",{children:[e.jsx(xe,{columns:T,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:i,pagingData:{total:j.total,pageIndex:j.pageIndex,pageSize:j.pageSize},onPaginationChange:I,onSelectChange:A,onSort:F}),e.jsx(at,{}),e.jsx(st,{})]})},ie=h.forwardRef((s,a)=>{const{onInputChange:t}=s,r=Ze(i,500);function i(c){t==null||t(c)}const n=c=>{r(c.target.value)};return e.jsx(y,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(ze,{className:"text-lg"}),onChange:n})});ie.displayName="ContactTableSearch";const{Control:it}=Be,Q=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],lt=({innerProps:s,label:a,data:t,isSelected:r})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${r?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{innerClass:t.color}),e.jsx("span",{children:a})]}),r&&e.jsx(Oe,{className:"text-emerald-500 text-xl"})]}),ct=({children:s,...a})=>{const t=a.getValue()[0];return e.jsxs(it,{...a,children:[t&&e.jsx(se,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),s]})},mt=()=>{const s=w(),{status:a}=g(r=>r.crmContact.data.filterData),t=r=>{s(ee({status:r==null?void 0:r.value}))};return e.jsx(oe,{options:Q,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:lt,Control:ct},value:Q.filter(r=>r.value===a),onChange:t})},dt=()=>{const s=w(),a=h.useRef(null),t=g(m=>m.crmContact.data.tableData),r=W("contacts","canCreate"),i=m=>{const u=R(t);u.query=m,u.pageIndex=1,typeof m=="string"&&m.length>1&&n(u),typeof m=="string"&&m.length===0&&n(u)},n=m=>{s(V(m)),s(K())},c=()=>{const m=R(t);m.query="",a.current&&(a.current.value=""),s(ee({status:""})),n(m)},f=()=>{s(Y())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(ie,{ref:a,onInputChange:i}),e.jsx(mt,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(H,{size:"sm",className:"me-2",onClick:c,children:"Clear All"}),r&&e.jsx(H,{size:"sm",onClick:f,children:"Add New"})]})]})},X=s=>{const{icon:a,avatarClass:t,label:r,value:i,loading:n}=s,c=55;return e.jsx(Pe,{bordered:!0,children:e.jsx(de,{loading:n,customLoader:e.jsx(_e,{avatarProps:{className:"rounded",width:c,height:c}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(He,{className:t,size:c,icon:a}),e.jsxs("div",{children:[e.jsx("span",{children:r}),e.jsx("h3",{children:e.jsx(Ge,{thousandSeparator:!0,displayType:"text",value:i})})]})]})})})})},pt=()=>{const s=w(),a=g(r=>r.crmContact.data.statisticData),t=g(r=>r.crmContact.data.statisticLoading);return h.useEffect(()=>{s($())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(X,{icon:e.jsx(Re,{}),avatarClass:"!bg-indigo-600",label:"Total Contact",value:a.totalContacts,growthRate:a==null?void 0:a.totalContacts,loading:t}),e.jsx(X,{icon:e.jsx(Ke,{}),avatarClass:"!bg-blue-500",label:"This Week's New Contacts",value:a.newContacts,growthRate:a.newContacts,loading:t})]})};pe("crmContact",be);const ut=()=>e.jsxs(e.Fragment,{children:[e.jsx(pt,{}),e.jsxs(ue,{bodyClass:"h-full",children:[e.jsx(dt,{}),e.jsx(nt,{})]})]}),Ja=ut;export{Ja as default};
