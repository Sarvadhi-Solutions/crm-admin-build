import{al as r,am as f,an as w,ao as C}from"./index-63e2e8ff.js";import{s as L,t as D,u as k,c as S,v as b,w as h,o as x,p as T,q as M}from"./CrmService-5cf7bda2.js";import{g as z}from"./index-622138d6.js";import{g as E}from"./index-b297e092.js";const G="crmTasks",u=r("crmTasks/data/getTasksStatistic",async()=>(await L()).data),y=r("crmTasks/data/getTasks",async()=>(await D()).data);r("crmTasks/data/editTask",async({taskId:s,updatedData:a})=>(await k(s,a)).data);const O=r("crmLeads/data/getLeads",async()=>(await S()).data),N=r("crmTasks/data/deleteTask",async s=>{var a,e;try{return(await b(s)).data}catch(t){throw new Error((e=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:e.message)}}),P=r("crmTasks/data/putTasks",async({taskId:s,data:a})=>{var e,t;try{return(await k(s,a)).data}catch(o){throw new Error((t=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:t.message)}}),_=r("crmTasks/data/createTasks",async s=>{var a,e;try{return(await h(s)).data}catch(t){throw new Error((e=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:e.message)}}),$=r("crmTasks/data/module",async()=>(await x()).data),B=r("tag-category",async({id:s})=>(await T(s)).data);r("crmTasks/data/fetchTag",async({id:s})=>(await T(s)).data);r("crmTasks/data/createTag",async({masterId:s,colorName:a,tagName:e,tagCategoryId:t})=>(await M({colorName:a,tagName:e,masterId:s,tagCategoryId:t})).data);const A={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},q={status:""},F={loading:!1,statisticLoading:!1,tasksList:[],displayedTasksList:[],statisticData:{},tableData:A,filterData:q,drawerOpen:!1,selectedTask:{},usersList:[],contactsList:[],leadsList:[],drawerMode:"Add",deleteConfirmation:!1},m=f({name:`${G}/state`,initialState:F,reducers:{setTableData:(s,a)=>{var t;s.tableData=a.payload;const e=(t=s.tasksList)==null?void 0:t.filter(o=>o.title.toLowerCase().includes(a.payload.query.toLowerCase()));s.tableData={...a.payload,total:e==null?void 0:e.length},s.displayedTasksList=e==null?void 0:e.slice(a.payload.pageSize*(a.payload.pageIndex-1),a.payload.pageSize*a.payload.pageIndex)},setTasksList:(s,a)=>{s.tasksList=a.payload},setUsersList:(s,a)=>{s.usersList=a.payload},setContactsList:(s,a)=>{s.usersList=a.payload},setFilterData:(s,a)=>{s.filterData=a.payload},setSelectedTask:(s,a)=>{s.selectedTask=a.payload},setDrawerOpen:s=>{s.drawerOpen=!0},setDrawerClose:s=>{s.drawerOpen=!1},setDrawerMode:(s,a)=>{s.drawerMode=a.payload},toggleDeleteConfirmation:(s,a)=>{s.deleteConfirmation=a.payload}},extraReducers:s=>{s.addCase(y.fulfilled,(a,e)=>{var t,o,d,n,i,l,c,p,g;a.tasksList=(t=e.payload)==null?void 0:t.data,a.tableData.total=(d=(o=e.payload)==null?void 0:o.data)==null?void 0:d.length,a.displayedTasksList=(g=(n=e.payload)==null?void 0:n.data)==null?void 0:g.slice(((i=a==null?void 0:a.tableData)==null?void 0:i.pageSize)*(((l=a==null?void 0:a.tableData)==null?void 0:l.pageIndex)-1),((c=a==null?void 0:a.tableData)==null?void 0:c.pageSize)*((p=a==null?void 0:a.tableData)==null?void 0:p.pageIndex)),a.loading=!1}).addCase(E.fulfilled,(a,e)=>{a.usersList=e.payload.data,a.loading=!1}).addCase(z.fulfilled,(a,e)=>{a.contactsList=e.payload.data,a.loading=!1}).addCase(y.pending,a=>{a.loading=!0}).addCase(u.fulfilled,(a,e)=>{a.statisticData=e.payload,a.statisticLoading=!1}).addCase(O.fulfilled,(a,e)=>{a.leadsList=e.payload.data,a.loading=!1}).addCase(u.pending,a=>{a.statisticLoading=!0})}}),{setTableData:H,setTasksList:J,setFilterData:K,setSelectedTask:Q,setDrawerOpen:V,setDrawerClose:W,setContactsList:X,setDrawerMode:Y,setUsersList:Z,toggleDeleteConfirmation:aa}=m.actions,I=m.reducer,sa=w({data:I}),ea=C;export{H as a,V as b,Q as c,N as d,u as e,O as f,y as g,$ as h,B as i,_ as j,W as k,J as l,P as p,sa as r,Y as s,aa as t,ea as u};
