import{am as R,an as P,ao as Y,ap as G,a as x,r as p,j as a,ai as U,B as _,ar as V}from"./index-04de45f1.js";import{A as J}from"./AdaptableCard-b66d711f.js";import{c as Q,d as W,e as X}from"./CrmService-1cd24b67.js";import{C as Z}from"./Card-5dadf163.js";import{A as ee}from"./index-d960fe16.js";import{M as ae}from"./MediaSkeleton-345b1161.js";import{d as te,a7 as se,r as re,z as oe,B as ie}from"./index.esm-dece01db.js";import{N as ne}from"./react-number-format.es-042f37c4.js";import{B as E}from"./Button-c014eb4a.js";import{c as f}from"./cloneDeep-9e3b0d5b.js";import{I as le}from"./Input-177911dc.js";import{d as ce}from"./debounce-72f24c40.js";import{S as de,c as me}from"./Select-8dd681ec.js";import{B as F}from"./Badge-fd219ce7.js";import{D as pe}from"./DataTable-26a56396.js";import{u as ue}from"./useThemeClass-d6175223.js";import{D as ge}from"./Drawer-a2e296b0.js";import{i as xe}from"./Views-9d427d6f.js";import{C as he}from"./CustomerForm-635ad948.js";import"./useMergeRef-788c4cb0.js";import"./Tooltip-8263a1ca.js";import"./usePopper-301f1b7b.js";import"./index.esm-86efb1ff.js";import"./index-5206a52a.js";import"./Skeleton-74d23b60.js";import"./context-3f43d22b.js";import"./_Uint8Array-51fedccd.js";import"./_MapCache-593c8f28.js";import"./_getPrototype-c53c6c29.js";import"./isNil-2d09164b.js";import"./get-e02c019e.js";import"./toString-85ae3482.js";import"./toConsumableArray-c4879a90.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";import"./index-f4f40370.js";import"./index.esm-bec52084.js";import"./Pagination-d7bd87b8.js";import"./index-746fa18b.js";import"./_baseIsEqual-aab3701d.js";import"./TableRowSkeleton-b8809059.js";import"./index-57d63c42.js";import"./index-ce7a2c9a.js";import"./CloseButton-c81f3a7a.js";import"./index-d856057f.js";import"./useControllableState-517757cf.js";import"./formik.esm-21613a47.js";import"./index.esm-7ed3d02a.js";import"./Upload-8284d175.js";import"./index.esm-31d11ed9.js";import"./toast-5c5a7d02.js";import"./useTimeout-352435f8.js";import"./StatusIcon-43cda077.js";import"./chainedFunction-070f832c.js";import"./index.esm-af77fe4a.js";import"./index.esm-eee56358.js";import"./AdditionalTag-04d8fd06.js";import"./Alert-b77365f1.js";import"./Calendar-3ea43322.js";import"./index-688929a7.js";import"./useRootClose-9c807e39.js";import"./RangeCalendar-31722222.js";import"./TimeInput-89c18d58.js";import"./useUniqueId-d1553e7a.js";import"./useDidUpdate-be24419c.js";import"./Dialog-94528cff.js";import"./index-34afd70e.js";import"./useUncertainRef-83c88a9e.js";import"./index-18e79e75.js";import"./index-0dfb4b3d.js";import"./index-4e807dfb.js";import"./Progress-500b53ea.js";import"./index-5445ceea.js";import"./ScrollBar-9c40bad5.js";import"./index-eb3ec0a1.js";import"./index-7626a7a3.js";import"./mapCloneElement-022773c2.js";import"./Switcher-51151d96.js";import"./Tag-b89b8728.js";import"./index-8639ecda.js";import"./index-b1e5b8b7.js";/* empty css              */const fe="crmLeads",O=R("crmLeads/data/getLeadsStatistic",async()=>(await Q()).data),w=R("crmLeads/data/getLeads",async t=>(await W()).data),be=R("crmLeads/data/putLeads",async t=>(await X(t)).data),Ce={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Le={status:""},je={loading:!1,statisticLoading:!1,leadsList:[],statisticData:{},tableData:Ce,filterData:Le,drawerOpen:!1,selectedLeads:{}},B=P({name:`${fe}/state`,initialState:je,reducers:{setTableData:(t,e)=>{t.tableData=e.payload},setLeadsList:(t,e)=>{t.leadsList=e.payload},setFilterData:(t,e)=>{t.filterData=e.payload},setSelectedLeads:(t,e)=>{t.selectedLeads=e.payload},setDrawerOpen:t=>{t.drawerOpen=!0},setDrawerClose:t=>{t.drawerOpen=!1}},extraReducers:t=>{t.addCase(w.fulfilled,(e,s)=>{e.leadsList=s.payload.data,e.tableData.total=s.payload.total,e.loading=!1}).addCase(w.pending,e=>{e.loading=!0}).addCase(O.fulfilled,(e,s)=>{e.statisticData=s.payload,e.statisticLoading=!1}).addCase(O.pending,e=>{e.statisticLoading=!0})}}),{setTableData:j,setLeadsList:we,setFilterData:M,setSelectedLeads:$,setDrawerOpen:ye,setDrawerClose:q}=B.actions,De=B.reducer,ve=Y({data:De}),m=G,A=t=>{const{icon:e,avatarClass:s,label:r,value:l,growthRate:c,loading:o}=t,n=55;return a.jsx(Z,{bordered:!0,children:a.jsx(U,{loading:o,customLoader:a.jsx(ae,{avatarProps:{className:"rounded",width:n,height:n}}),children:a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ee,{className:s,size:n,icon:e}),a.jsxs("div",{children:[a.jsx("span",{children:r}),a.jsx("h3",{children:a.jsx(ne,{thousandSeparator:!0,displayType:"text",value:l})})]})]})})})})},Se=()=>{const t=x(),e=m(r=>r.crmLeads.data.statisticData),s=m(r=>r.crmLeads.data.statisticLoading);return p.useEffect(()=>{t(O())},[]),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[a.jsx(A,{icon:a.jsx(te,{}),avatarClass:"!bg-indigo-600",label:"Total Leads",value:e==null?void 0:e.totalLeads,loading:s}),a.jsx(A,{icon:a.jsx(se,{}),avatarClass:"!bg-blue-500",label:"Active Leads",value:e==null?void 0:e.activeLeads,loading:s}),a.jsx(A,{icon:a.jsx(re,{}),avatarClass:"!bg-emerald-500",label:"New Leads",value:e==null?void 0:e.newLeads,loading:s})]})},H=p.forwardRef((t,e)=>{const{onInputChange:s}=t,r=ce(l,500);function l(o){s==null||s(o)}const c=o=>{r(o.target.value)};return a.jsx(le,{ref:e,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:a.jsx(oe,{className:"text-lg"}),onChange:c})});H.displayName="LeadsTableSearch";const{Control:Ne}=me,z=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],Te=({innerProps:t,label:e,data:s,isSelected:r})=>a.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${r?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...t,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(F,{innerClass:s.color}),a.jsx("span",{children:e})]}),r&&a.jsx(ie,{className:"text-emerald-500 text-xl"})]}),ke=({children:t,...e})=>{const s=e.getValue()[0];return a.jsxs(Ne,{...e,children:[s&&a.jsx(F,{className:"ltr:ml-4 rtl:mr-4",innerClass:s.color}),t]})},Ie=()=>{const t=x(),{status:e}=m(r=>r.crmLeads.data.filterData),s=r=>{t(M({status:r==null?void 0:r.value}))};return a.jsx(de,{options:z,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:Te,Control:ke},value:z.filter(r=>r.value===e),onChange:s})},Ae=()=>{const t=x(),e=p.useRef(null),s=m(o=>o.crmLeads.data.tableData),r=o=>{const n=f(s);n.query=o,n.pageIndex=1,typeof o=="string"&&o.length>1&&l(n),typeof o=="string"&&o.length===0&&l(n)},l=o=>{t(j(o)),t(w(o))},c=()=>{const o=f(s);o.query="",e.current&&(e.current.value=""),t(M({status:""})),l(o)};return a.jsxs("div",{className:"md:flex items-center justify-between",children:[a.jsxs("div",{className:"md:flex items-center gap-4",children:[a.jsx(H,{ref:e,onInputChange:r}),a.jsx(Ie,{})]}),a.jsx("div",{className:"mb-4",children:a.jsx(E,{size:"sm",onClick:c,children:"Clear All"})})]})},K=p.forwardRef((t,e)=>{const s=x(),r=m(n=>n.crmLeads.data.selectedLeads),l=m(n=>n.crmLeads.data.leadsList),{id:c}=r,o=n=>{const{name:C,birthday:L,email:u,img:y,location:D,title:v,phoneNumber:S,facebook:i,twitter:d,pinterest:N,linkedIn:b}=n,h={name:C,email:u,img:y},T={location:D,title:v,birthday:_(L).format("DD/MM/YYYY"),phoneNumber:S,facebook:i,twitter:d,pinterest:N,linkedIn:b};let k=f(l),I={};k=k.map(g=>(g.id===c&&(g={...g,...h},g.personalInfo={...g.personalInfo,...T},I=g),g)),xe(I)||s(be(I)),s(q()),s(we(k))};return a.jsx(he,{ref:e,customer,onFormSubmit:o})});K.displayName="CustomerEditContent";const Ee=({onSaveClick:t,onCancel:e})=>a.jsxs("div",{className:"text-right w-full",children:[a.jsx(E,{size:"sm",className:"mr-2",onClick:e,children:"Cancel"}),a.jsx(E,{size:"sm",variant:"solid",onClick:t,children:"Save"})]}),Oe=()=>{const t=x(),e=m(c=>c.crmLeads.data.drawerOpen),s=()=>{t(q()),t($({}))},r=p.useRef(null),l=()=>{var c;(c=r.current)==null||c.submitForm()};return a.jsx(ge,{isOpen:e,closable:!1,bodyClass:"p-0",footer:a.jsx(Ee,{onCancel:s,onSaveClick:l}),onClose:s,onRequestClose:s,children:a.jsx(K,{ref:r})})},Re=({row:t})=>{const{textTheme:e}=ue(),s=x(),r=()=>{s(ye()),s($(t))};return a.jsx("div",{className:`${e} cursor-pointer select-none font-semibold`,onClick:r,children:"Edit"})},ze=()=>{const t=x(),e=m(i=>i.crmLeads.data.leadsList),s=m(i=>i.crmLeads.data.loading),r=m(i=>i.crmLeads.data.filterData),{pageIndex:l,pageSize:c,sort:o,query:n,total:C}=m(i=>i.crmLeads.data.tableData),L=p.useCallback(()=>{t(w({pageIndex:l,pageSize:c,sort:o,query:n,filterData:r}))},[l,c,o,n,r,t]);p.useEffect(()=>{L()},[L,l,c,o,r]);const u=p.useMemo(()=>({pageIndex:l,pageSize:c,sort:o,query:n,total:C}),[l,c,o,n,C]),y=p.useMemo(()=>[{header:"Associated Contact",accessorKey:"associatedContact",cell:i=>i.row.original.associatedContact,width:200},{header:"Details",accessorKey:"details",cell:i=>i.row.original.details,width:200},{header:"Status",accessorKey:"status",cell:i=>i.row.original.status,width:200},{header:"Notes",accessorKey:"notes",cell:i=>i.row.original.notes,width:200},{header:"Tag Name",accessorKey:"tagName",width:200,cell:i=>{const N=(i.row.original.tags||[]).map(b=>{const h=b.colorName||"#000000",T={backgroundColor:`rgba(${parseInt(h.slice(1,3),16)}, ${parseInt(h.slice(3,5),16)}, ${parseInt(h.slice(5,7),16)}, 0.2)`,color:h,padding:"4px 8px",borderRadius:"4px",marginRight:"4px",marginBottom:"4px"};return a.jsx("div",{style:T,children:b.tagName},b.id)});return a.jsx("div",{children:N})}},{header:"Edit",id:"action",cell:i=>a.jsx(Re,{row:i.row.original})}],[]),D=i=>{const d=f(u);d.pageIndex=i,t(j(d))},v=i=>{const d=f(u);d.pageSize=Number(i),d.pageIndex=1,t(j(d))},S=i=>{const d=f(u);d.sort=i,t(j(d))};return a.jsxs("div",{children:[a.jsx(pe,{columns:y,data:e,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:s,pagingData:{total:u.total,pageIndex:u.pageIndex,pageSize:u.pageSize},onPaginationChange:D,onSelectChange:v,onSort:S}),a.jsx(Oe,{})]})};V("crmLeads",ve);const Fe=()=>a.jsxs(a.Fragment,{children:[a.jsx(Se,{}),a.jsxs(J,{bodyClass:"h-full",children:[a.jsx(Ae,{}),a.jsx(ze,{})]})]}),mt=Fe;export{mt as default};
