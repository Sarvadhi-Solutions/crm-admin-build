import{a as V,r as n,j as t}from"./index-4bd6b7b3.js";import{T as $}from"./index-00b89123.js";import{a as r,F as R}from"./FormItem-e2a22149.js";import{u as U,b as c,F as _,a as z}from"./formik.esm-a048d78e.js";import{c as G,a as N,f as J,b as K}from"./index.esm-3518a165.js";import{u as B,D as Q,A as W,j as X,k as Y,t as Z,c as ee,l as te,g as L,s as E,e as H,m as ae}from"./AdditionalTag-1f0b69bf.js";import{t as v,N as S}from"./toast-88ff7e3e.js";import{I as g}from"./Input-1462fe73.js";import{a6 as se,a7 as oe,a8 as ie}from"./index.esm-0cdca32a.js";import{A as ne}from"./index.esm-24d8aaa0.js";import{a as le,T as re,b as ce}from"./index.esm-54d5fc4e.js";/* empty css              */const de=d=>{const{touched:o,errors:e}=d,x=V(),[s,u]=n.useState(!1);n.useState("#808080");const[F,h]=n.useState(!1),[i,f]=n.useState([]),[M,k]=n.useState([]),b=()=>{u(!s),h(!1)},[D,I]=n.useState("");n.useEffect(()=>{(async()=>{var T,q;try{const{payload:m}=await x(X());console.log(m,"send Me The Id And The Payload");const C=(T=m==null?void 0:m.data)==null?void 0:T.find(p=>(p==null?void 0:p.moduleName)==="clients");if(I(C.id),C){const{payload:p}=await x(Y({id:(q=C==null?void 0:C.id)==null?void 0:q.toString()})),O=Z(p.data),P=ee(p.data);k(P),f(O)}}catch(m){console.error("Error fetching module data:",m)}})()},[x]);const y=B(l=>l.crmCustomers.data.selectedCustomer),[A,w]=n.useState(y?y.tags||[]:[]),j=U(),a=l=>{console.log(l),w(l);const T=[l.value];j.setFieldValue("tagId",T)};return t.jsxs(t.Fragment,{children:[t.jsx(r,{label:"Client Name",invalid:e.clientName&&o.clientName,errorMessage:e.clientName,children:t.jsx(c,{type:"text",autoComplete:"off",name:"clientName",placeholder:"Client Name",component:g,prefix:t.jsx(se,{className:"text-xl"})})}),t.jsx(r,{label:"Contact Number",invalid:e.contactInfo&&o.contactInfo,errorMessage:e.contactInfo,children:t.jsx(c,{type:"text",autoComplete:"off",name:"contactInfo",placeholder:"Contact Number",component:g,prefix:t.jsx(oe,{className:"text-xl"})})}),t.jsx(r,{label:"Address",invalid:e.address&&o.address,errorMessage:e.address,children:t.jsx(c,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:g,prefix:t.jsx(ie,{className:"text-xl"})})}),t.jsx(r,{label:"Billing Details",invalid:e.billingDetails&&o.billingDetails,errorMessage:e.billingDetails,children:t.jsx(c,{type:"text",autoComplete:"off",name:"billingDetails",placeholder:"Billing Details",component:g,prefix:t.jsx(le,{className:"text-xl"})})}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx(r,{label:"Tags",invalid:e.history&&o.history,errorMessage:e.history,children:t.jsxs("div",{style:{position:"relative"},children:[t.jsx(c,{name:"Tag",component:Q,options:i,placeholder:"Select a Tag",value:j.initialValues.tagName,onChange:a}),t.jsx(re,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{b(),h(!0)}})]})}),t.jsx(W,{isOpen:s,moduleName:D,categoryList:M,onOpenChange:l=>u(l)})]}),t.jsx(r,{label:"History",invalid:e.history&&o.history,errorMessage:e.history,children:t.jsx(c,{type:"text",autoComplete:"off",name:"history",placeholder:"History",component:g,prefix:t.jsx(ne,{className:"text-xl"})})}),t.jsx(r,{label:"Notes",invalid:e.notes&&o.notes,errorMessage:e.notes,children:t.jsx(c,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:g,prefix:t.jsx(ce,{className:"text-xl"})})})]})},me=G().shape({clientName:N().required("Customer Name is required"),contactInfo:J().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",d=>!isNaN(d)).test("is-ten-digits","Contact must be exactly 10 digits",d=>/^\d{10}$/.test(d)),address:N().required("Address is required"),billingDetails:N().required("Billing Details is required"),history:N(),notes:N(),tagId:K()}),{TabNav:pe,TabList:ge,TabContent:xe}=$,ue=n.forwardRef((d,o)=>{var u,F,h;const e=B(i=>i.crmCustomers.data.selectedCustomer),x=!!e.id,s=V();return t.jsx(_,{innerRef:o,initialValues:{clientName:(e==null?void 0:e.clientName)||"",contactInfo:(e==null?void 0:e.contactInfo)||"",address:(e==null?void 0:e.address)||"",billingDetails:(e==null?void 0:e.billingDetails)||"",history:(e==null?void 0:e.history)||"",notes:(e==null?void 0:e.notes)||"",tagName:((F=(u=e==null?void 0:e.tags)==null?void 0:u[0])==null?void 0:F.tagName)||"",tagId:((h=e==null?void 0:e.tags)==null?void 0:h.map(i=>i.id))||[],colorName:e!=null&&e.tags&&(e==null?void 0:e.tags.length)>0?e==null?void 0:e.tags[0].colorName:""},validationSchema:me,onSubmit:async(i,{setSubmitting:f})=>{var D,I,y,A,w,j;const{colorName:M,tagName:k,...b}=i;if(x){const a=await s(te({customerId:(e==null?void 0:e.id)||"",updatedData:b}));(D=a==null?void 0:a.payload)!=null&&D.success?v.push(t.jsx(S,{title:"Successfully Added",type:"success",duration:2500,children:(I=a==null?void 0:a.payload)==null?void 0:I.message}),{placement:"top-center"}):v.push(t.jsx(S,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(y=a==null?void 0:a.payload)==null?void 0:y.message}),{placement:"top-center"}),await s(L()),await s(E()),await s(H())}else{const a=await s(ae(b));(A=a==null?void 0:a.payload)!=null&&A.success?v.push(t.jsx(S,{title:"Successfully Added",type:"success",duration:2500,children:(w=a==null?void 0:a.payload)==null?void 0:w.message}),{placement:"top-center"}):v.push(t.jsx(S,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(j=a==null?void 0:a.payload)==null?void 0:j.message}),{placement:"top-center"}),await s(L()),await s(E()),await s(H())}f(!1)},children:({touched:i,errors:f})=>t.jsx(z,{children:t.jsx(R,{children:t.jsxs($,{defaultValue:"customerInfo",children:[t.jsx(ge,{children:t.jsx(pe,{value:"customerInfo",children:"Client Details"})}),t.jsx("div",{className:"p-6",children:t.jsx(xe,{value:"customerInfo",children:t.jsx(de,{touched:i,errors:f})})})]})})})})});ue.displayName="CustomerForm";export{ue as C};
