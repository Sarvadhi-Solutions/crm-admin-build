var es=Object.defineProperty;var ns=(p,e,D)=>e in p?es(p,e,{enumerable:!0,configurable:!0,writable:!0,value:D}):p[e]=D;var ne=(p,e,D)=>(ns(p,typeof e!="symbol"?e+"":e,D),D),je=(p,e,D)=>{if(!e.has(p))throw TypeError("Cannot "+D)};var t=(p,e,D)=>(je(p,e,"read from private field"),D?D.call(p):e.get(p)),H=(p,e,D)=>{if(e.has(p))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(p):e.set(p,D)},ot=(p,e,D,n)=>(je(p,e,"write to private field"),n?n.call(p,D):e.set(p,D),D);var me=(p,e,D,n)=>({set _(d){ot(p,e,d,D)},get _(){return t(p,e,n)}}),Y=(p,e,D)=>(je(p,e,"access private method"),D);import{al as createAsyncThunk,am as createSlice,an as combineReducers,ao as useSelector,a as useAppDispatch,r as reactExports,j as jsxRuntimeExports,ap as useNavigate,au as getAugmentedNamespace,m as getDefaultExportFromCjs,a3 as React,aq as injectReducer,at as useParams,ah as Loading}from"./index-0ab2c514.js";import{b as _pt,C as Container,i as isEmpty}from"./Views-ba63249c.js";import{x as apiGetCrmTaskById,i as apiCreateCrmNotes,j as apiEditCrmNotes,k as apiDeleteCrmNotes}from"./CrmService-d077c852.js";import{A as AdaptableCard}from"./AdaptableCard-afe020d2.js";import"./Badge-edf0b9d8.js";import"./chart.constant-7e7be1ae.js";import"./GrowShrinkTag-480cf741.js";import"./index-713c1ac9.js";import{B as Button}from"./Button-968324b3.js";import{D as Dialog}from"./Dialog-6e6660ce.js";import"./DataTable-a66c505f.js";import{D as DoubleSidedImage}from"./DoubleSidedImage-fb81f6a7.js";import{I as Input}from"./Input-da780288.js";import"./Skeleton-139abafa.js";import"./react-tooltip.min-d3f02ea8.js";import"./RichTextEditor-4196a1be.js";import"./SegmentItemOption-9e30f3b9.js";import"./SvgIcon-67cf6073.js";import"./Tooltip-f95f0645.js";import{N as NoteTimeline,L as LeadActivity}from"./LeadActivity-bc6c8efe.js";import"./Alert-fd1c6434.js";import"./RangeCalendar-23cf777a.js";import{C as Card}from"./Card-36fb08c8.js";import"./index-8466c23b.js";import"./index-665fd580.js";import"./Drawer-0d99631e.js";import"./index-bb763aff.js";import{F as FormContainer,a as FormItem}from"./FormItem-e6ee784c.js";import"./toString-8ab117f8.js";import"./index-8e362e39.js";import"./index-ddf729b1.js";import"./index-da413dc5.js";import{t as toast,N as Notification}from"./toast-f47eb111.js";import"./Pagination-f681e8ee.js";import"./Progress-8fed0827.js";import"./index-392b4f57.js";import"./ScrollBar-99e33cfa.js";import"./index-6d1daefb.js";import"./Select-022e394f.js";import"./index-e1984e61.js";import"./Switcher-278dbd82.js";import"./index-a4f8223f.js";import"./index-1e57f70f.js";import"./Tag-66d1e717.js";import"./index-ace76341.js";import"./index-d29598bc.js";import"./Upload-5e95a87c.js";import{u as useCheckEditUpdate}from"./checkEditUpdate-672745ae.js";import{a as BiSolidMessageSquareAdd}from"./index.esm-26860cf2.js";import{I as IoIosArrowRoundBack}from"./index.esm-c3405e1c.js";import{u as useAppSelector$2,b as setSelectedTask,t as toggleDeleteConfirmation$1,d as deleteTask,g as getTasks,c as getTasksStatistic}from"./index-79d7868b.js";import{F as Formik,a as Form,b as Field,c as FieldArray,w as warning}from"./formik.esm-8fede37e.js";import{c as create$3,a as create$6}from"./index.esm-40264850.js";import{u as useAppSelector$1,m as modulesOptions}from"./TagCategoryDetailsForm-b5fb02dd.js";import{C as ConfirmDialog}from"./ConfirmDialog-7f417840.js";import{S as StatusCapsule}from"./StatusCapsule-e7dab1be.js";import{h as hooks}from"./moment-fbc5633a.js";import{P as HiOutlineTrash}from"./index.esm-42b7b20a.js";import{T as TagsList}from"./TagsList-ceef7f86.js";import{i as invariant}from"./tiny-invariant-dd7d57d2.js";import"./useMergeRef-788c4cb0.js";import"./index-2544a6e9.js";import"./CloseButton-84582cc2.js";import"./index-a0ae6717.js";import"./isNil-bf67e220.js";import"./get-e3d59f81.js";import"./_MapCache-438327fc.js";import"./floating-ui.dom-4bc0055b.js";import"./_baseIsEqual-a16dae54.js";import"./cloneDeep-1f1702a9.js";import"./_getPrototype-6bd7c339.js";import"./useThemeClass-1f876eb2.js";import"./usePopper-0441deed.js";import"./index.esm-d6cc7dce.js";import"./index-1a5cdab8.js";import"./useTimeout-c2c175af.js";import"./StatusIcon-83ac331c.js";import"./useControllableState-e8851140.js";import"./useRootClose-f3a243e8.js";import"./TimeInput-c04de9a3.js";import"./useUniqueId-c68f5c73.js";import"./useDidUpdate-f978eb31.js";import"./useUncertainRef-5b5ab7e8.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-0f5c9dec.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-003b7048.js";import"./mapCloneElement-9cb2dda4.js";import"./index.esm-785e2bc5.js";import"./index.esm-e1d89ef7.js";import"./index-1b514f01.js";import"./index-ebde62fa.js";/* empty css              */function _mergeNamespaces(p,e){for(var D=0;D<e.length;D++){const n=e[D];if(typeof n!="string"&&!Array.isArray(n)){for(const d in n)if(d!=="default"&&!(d in p)){const $=Object.getOwnPropertyDescriptor(n,d);$&&Object.defineProperty(p,d,$.get?$:{enumerable:!0,get:()=>n[d]})}}}return Object.freeze(Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}))}const SLICE_NAME="crmTaskDetails",initialState={loading:!0,task:{},addForm:!1,dialogMode:"",selectedNote:{},deleteConfirmation:!1},getTaskById=createAsyncThunk(`${SLICE_NAME}/getTaskById`,async p=>{var e,D;try{return await apiGetCrmTaskById(p)}catch(n){throw new Error((D=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:D.message)}}),createNotes=createAsyncThunk(`${SLICE_NAME}/getNotes`,async p=>{var e,D;try{return(await apiCreateCrmNotes(p)).data}catch(n){throw new Error((D=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:D.message)}}),editNotes=createAsyncThunk(`${SLICE_NAME}/editNotes`,async({id:p,formData:e})=>{var D,n;try{return(await apiEditCrmNotes(p,e)).data}catch(d){throw new Error((n=(D=d==null?void 0:d.response)==null?void 0:D.data)==null?void 0:n.message)}}),deleteNote=createAsyncThunk(`${SLICE_NAME}/deleteNote`,async p=>{var e,D;try{return(await apiDeleteCrmNotes(p)).data}catch(n){throw new Error((D=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:D.message)}}),taskDetailSlice=createSlice({name:`${SLICE_NAME}/state`,initialState,reducers:{toggleAddForm:(p,e)=>{p.addForm=e.payload},setSelectedNote:(p,e)=>{p.selectedNote=e.payload},setDialogMode:(p,e)=>{p.dialogMode=e.payload},toggleDeleteConfirmation:(p,e)=>{p.deleteConfirmation=e.payload}},extraReducers:p=>{p.addCase(getTaskById.fulfilled,(e,D)=>{e.loading=!1,e.task=D==null?void 0:D.payload.data}).addCase(getTaskById.pending,e=>{e.loading=!0})}}),{toggleAddForm,setSelectedNote,setDialogMode,toggleDeleteConfirmation}=taskDetailSlice.actions,reducers=taskDetailSlice.reducer,reducer$1=combineReducers({data:reducers}),useAppSelector=useSelector,validationSchema=create$3({notes:create$6().required("Notes is required")}),NotesAddFormTask=()=>{var rt;const p=useAppDispatch(),e=useAppSelector$1(k=>{var A;return(A=k==null?void 0:k.crmTaskDetails)==null?void 0:A.data}),[D,n]=reactExports.useState([]),d=useAppSelector$1(k=>{var A,m,L;return(L=(m=(A=k.crmTaskDetails)==null?void 0:A.data)==null?void 0:m.task)==null?void 0:L.data}),$=useAppSelector$1(k=>k.crmTaskDetails.data.addForm);modulesOptions.length=0,D==null||D.forEach(k=>{modulesOptions.push({value:k.id,label:k.moduleName})});const I=()=>{p(toggleAddForm(!1))};return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Dialog,{isOpen:$,onClose:I,children:jsxRuntimeExports.jsx(Formik,{validationSchema,initialValues:{notes:(e==null?void 0:e.dialogMode)==="Edit"?(rt=e.selectedNote)==null?void 0:rt.notes:""},onSubmit:async k=>{var P,x,w,g,v,R,C;let A="",m="",L="";const N={notes:k.notes,masterId:"6",modelDataId:d==null?void 0:d.id};if((e==null?void 0:e.dialogMode)==="Edit"&&e.selectedNote){const y=(P=e==null?void 0:e.selectedNote)==null?void 0:P.id,l=await p(editNotes({id:y,formData:N}));(x=l==null?void 0:l.payload)!=null&&x.success?(A="Successfully Edited",m=(w=l==null?void 0:l.payload)==null?void 0:w.message,L="success"):(A="Something went wrong !!!",m=(g=l==null?void 0:l.error)==null?void 0:g.message,L="danger")}else{const y=await p(createNotes(N));(v=y==null?void 0:y.payload)!=null&&v.success?(A="Successfully Added",m=(R=y==null?void 0:y.payload)==null?void 0:R.message,L="success"):(A="Something went wrong !!!",m=(C=y==null?void 0:y.error)==null?void 0:C.message,L="danger")}toast.push(jsxRuntimeExports.jsx(Notification,{title:A,type:L,duration:2500,children:m}),{placement:"top-end"}),p(toggleAddForm(!1)),p(getTaskById(d==null?void 0:d.id))},children:({touched:k,errors:A,values:m,setFieldValue:L})=>jsxRuntimeExports.jsx(Form,{children:jsxRuntimeExports.jsx(FormContainer,{layout:"inline",children:jsxRuntimeExports.jsxs("div",{className:"w-full custom-scrollbar",style:{maxHeight:"75vh",overflowY:"auto"},children:[jsxRuntimeExports.jsxs("div",{className:"mb-10",children:[jsxRuntimeExports.jsxs("h5",{className:"mb-4",children:[" ",(e==null?void 0:e.dialogMode)==="Add"?"Add Notes":"Edit Notes"]}),jsxRuntimeExports.jsx(FormItem,{layout:"vertical",label:"Notes",invalid:A.notes&&k.notes,errorMessage:A.notes,children:jsxRuntimeExports.jsx(Field,{textArea:!0,placeholder:"Notes",name:"notes",component:Input})})]}),jsxRuntimeExports.jsx(FieldArray,{name:"tags",children:({form:N,remove:P,push:x})=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(Button,{type:"submit",variant:"solid",children:(e==null?void 0:e.dialogMode)==="Add"?"Add":"Edit"})})})})]})})})})})})},NotesDeleteConfirmationTask=()=>{const p=useAppDispatch(),e=useAppSelector(I=>{var rt,k,A;return(A=(k=(rt=I.crmTaskDetails)==null?void 0:rt.data)==null?void 0:k.task)==null?void 0:A.data}),D=useAppSelector(I=>{var rt,k;return(k=(rt=I.crmTaskDetails)==null?void 0:rt.data)==null?void 0:k.deleteConfirmation}),n=useAppSelector(I=>{var rt;return(rt=I==null?void 0:I.crmTaskDetails)==null?void 0:rt.data}),d=()=>{p(toggleDeleteConfirmation(!1))},$=async()=>{var rt,k,A,m,L;p(toggleDeleteConfirmation(!1)),console.log("jh===d",(rt=n==null?void 0:n.selectedNote)==null?void 0:rt.id);const I=await p(deleteNote((k=n==null?void 0:n.selectedNote)==null?void 0:k.id));await p(getTaskById(e==null?void 0:e.id)),console.log("wdwd",I),(A=I==null?void 0:I.payload)!=null&&A.success?toast.push(jsxRuntimeExports.jsx(Notification,{title:"Successfuly Deleted",type:"success",duration:2500,children:(m=I==null?void 0:I.payload)==null?void 0:m.message}),{placement:"top-end"}):toast.push(jsxRuntimeExports.jsx(Notification,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(L=I==null?void 0:I.error)==null?void 0:L.message}),{placement:"top-end"}),await p(getTaskById(e==null?void 0:e.id))};return jsxRuntimeExports.jsx(ConfirmDialog,{isOpen:D,type:"danger",title:"Delete Note",confirmButtonColor:"red-600",onClose:d,onRequestClose:d,onCancel:d,onConfirm:$,children:jsxRuntimeExports.jsx("p",{children:"Are you sure you want to delete this Note? This action cannot be undone."})})},TaskProfileAction=p=>{const e=useAppSelector$2(A=>{var m,L;return(L=(m=A.crmTasks)==null?void 0:m.data)==null?void 0:L.selectedTask}),D=useAppDispatch(),[n,d]=reactExports.useState(!1),$=useNavigate(),I=()=>{d(!1)},rt=()=>{d(!0)},k=async()=>{var m,L,N;await D(setSelectedTask(p)),D(toggleDeleteConfirmation$1(!1));const A=await D(deleteTask(e.id));await D(getTasks()),(m=A==null?void 0:A.payload)!=null&&m.success?(toast.push(jsxRuntimeExports.jsx(Notification,{title:"Successfuly Deleted",type:"success",duration:2500,children:(L=A==null?void 0:A.payload)==null?void 0:L.message}),{placement:"top-end"}),$("/app/crm/tasks"),D(setSelectedTask({}))):toast.push(jsxRuntimeExports.jsx(Notification,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(N=A==null?void 0:A.error)==null?void 0:N.message}),{placement:"top-end"}),await D(getTasks()),await D(getTasksStatistic())};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{size:"xs",onClick:rt,block:!0,variant:"solid",children:jsxRuntimeExports.jsx(HiOutlineTrash,{className:"text-lg"})}),jsxRuntimeExports.jsx(ConfirmDialog,{isOpen:n,type:"danger",title:"Delete Task",confirmButtonColor:"red-600",onClose:I,onRequestClose:I,onCancel:I,onConfirm:k,children:jsxRuntimeExports.jsx("p",{children:"Are you sure you want to delete this Task? All record related to this Task will be deleted as well. This action cannot be undone."})})]})},TaskProfile=({data:p={}})=>{var e,D,n,d,$;return jsxRuntimeExports.jsx(Card,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col xl:flex-row",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-5 gap-2 wrap-data",children:[(p==null?void 0:p.priority)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Priority:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:jsxRuntimeExports.jsx(StatusCapsule,{status:p==null?void 0:p.priority})})]}),(p==null?void 0:p.completionStatus)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Status:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:jsxRuntimeExports.jsx(StatusCapsule,{status:p==null?void 0:p.completionStatus})})]}),(p==null?void 0:p.dueDate)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Due Date:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:hooks(p==null?void 0:p.dueDate).format("DD MMMM YYYY")})]}),(p==null?void 0:p.title)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Title:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:p==null?void 0:p.title})]}),(p==null?void 0:p.assignedToData)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Assigned To:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:`${(e=p==null?void 0:p.assignedToData)==null?void 0:e.firstName} ${(D=p==null?void 0:p.assignedToData)==null?void 0:D.lastName}`})]}),(p==null?void 0:p.module)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Module:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:p==null?void 0:p.module})]}),(p==null?void 0:p.type)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Type:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:p==null?void 0:p.type})]}),(p==null?void 0:p.nextDateTime)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Date Time:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:hooks(p==null?void 0:p.nextDateTime).format("DD MMMM YYYY")})]}),(p==null?void 0:p.connectedLead)&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Connected Lead:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:(n=p==null?void 0:p.leadModel)==null?void 0:n.title})]}),((d=p==null?void 0:p.tags)==null?void 0:d.length)>0&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Tags:"}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:jsxRuntimeExports.jsx(TagsList,{fullDisplay:!0,tags:p==null?void 0:p.tags})})]}),(($=p==null?void 0:p.taskFields)==null?void 0:$.length)>0&&p.taskFields.map((I,rt)=>I.value&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:[I==null?void 0:I.name,":"]}),jsxRuntimeExports.jsx("div",{className:"ml-2",children:I.value})]},rt))]}),jsxRuntimeExports.jsx("div",{className:"w-10",children:jsxRuntimeExports.jsx(TaskProfileAction,{data:p})})]})})};function commonjsRequire(p){throw new Error('Could not dynamically require "'+p+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,D){module.exports=e.pdfjsLib=D()})(globalThis,()=>(()=>{var __webpack_modules__=[,(p,e)=>{var Xt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=dt,e.bytesToString=W,e.createValidAbsoluteUrl=Et,e.getModificationDate=Ct,e.getUuid=Gt,e.getVerbosityLevel=X,e.info=at,e.isArrayBuffer=pt,e.isArrayEqual=Tt,e.isNodeJS=void 0,e.normalizeUnicode=zt,e.objectFromMap=ht,e.objectSize=et,e.setVerbosityLevel=E,e.shadow=wt,e.string32=tt,e.stringToBytes=it,e.stringToPDFString=gt,e.stringToUTF8String=nt,e.unreachable=V,e.utf8StringToString=st,e.warn=ct;const D=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=D;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const d=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=d;const $=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=$;const I=1.35;e.LINE_FACTOR=I;const rt=.35;e.LINE_DESCENT_FACTOR=rt;const k=rt/I;e.BASELINE_FACTOR=k;const A={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=A;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=m;const L="pdfjs_internal_editor_";e.AnnotationEditorPrefix=L;const N={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=N;const P={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=P;const x={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=x;const w={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=w;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=g;const v={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=v;const R={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=R;const C={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=C;const y={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=y;const l={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=l;const u={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=u;const O={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=O;const _={O:"PageOpen",C:"PageClose"};e.PageActionEventType=_;const c={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=c;const F={NONE:0,BINARY:1};e.CMapCompressionType=F;const b={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=b;const G={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=G;let z=c.WARNINGS;function E(ft){Number.isInteger(ft)&&(z=ft)}function X(){return z}function at(ft){z>=c.INFOS&&console.log(`Info: ${ft}`)}function ct(ft){z>=c.WARNINGS&&console.log(`Warning: ${ft}`)}function V(ft){throw new Error(ft)}function dt(ft,Z){ft||V(Z)}function mt(ft){switch(ft==null?void 0:ft.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Et(ft,Z=null,K=null){if(!ft)return null;try{if(K&&typeof ft=="string"){if(K.addDefaultProtocol&&ft.startsWith("www.")){const vt=ft.match(/\./g);(vt==null?void 0:vt.length)>=2&&(ft=`http://${ft}`)}if(K.tryConvertEncoding)try{ft=nt(ft)}catch{}}const At=Z?new URL(ft,Z):new URL(ft);if(mt(At))return At}catch{}return null}function wt(ft,Z,K,At=!1){return Object.defineProperty(ft,Z,{value:K,enumerable:!At,configurable:!0,writable:!1}),K}const M=function(){function Z(K,At){this.constructor===Z&&V("Cannot initialize BaseException."),this.message=K,this.name=At}return Z.prototype=new Error,Z.constructor=Z,Z}();e.BaseException=M;class i extends M{constructor(Z,K){super(Z,"PasswordException"),this.code=K}}e.PasswordException=i;class o extends M{constructor(Z,K){super(Z,"UnknownErrorException"),this.details=K}}e.UnknownErrorException=o;class a extends M{constructor(Z){super(Z,"InvalidPDFException")}}e.InvalidPDFException=a;class h extends M{constructor(Z){super(Z,"MissingPDFException")}}e.MissingPDFException=h;class f extends M{constructor(Z,K){super(Z,"UnexpectedResponseException"),this.status=K}}e.UnexpectedResponseException=f;class T extends M{constructor(Z){super(Z,"FormatError")}}e.FormatError=T;class j extends M{constructor(Z){super(Z,"AbortException")}}e.AbortException=j;function W(ft){(typeof ft!="object"||(ft==null?void 0:ft.length)===void 0)&&V("Invalid argument for bytesToString");const Z=ft.length,K=8192;if(Z<K)return String.fromCharCode.apply(null,ft);const At=[];for(let vt=0;vt<Z;vt+=K){const ee=Math.min(vt+K,Z),te=ft.subarray(vt,ee);At.push(String.fromCharCode.apply(null,te))}return At.join("")}function it(ft){typeof ft!="string"&&V("Invalid argument for stringToBytes");const Z=ft.length,K=new Uint8Array(Z);for(let At=0;At<Z;++At)K[At]=ft.charCodeAt(At)&255;return K}function tt(ft){return String.fromCharCode(ft>>24&255,ft>>16&255,ft>>8&255,ft&255)}function et(ft){return Object.keys(ft).length}function ht(ft){const Z=Object.create(null);for(const[K,At]of ft)Z[K]=At;return Z}function bt(){const ft=new Uint8Array(4);return ft[0]=1,new Uint32Array(ft.buffer,0,1)[0]===1}function ut(){try{return new Function(""),!0}catch{return!1}}class Ft{static get isLittleEndian(){return wt(this,"isLittleEndian",bt())}static get isEvalSupported(){return wt(this,"isEvalSupported",ut())}static get isOffscreenCanvasSupported(){return wt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?wt(this,"platform",{isWin:!1,isMac:!1}):wt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Z,K;return wt(this,"isCSSRoundSupported",(K=(Z=globalThis.CSS)==null?void 0:Z.supports)==null?void 0:K.call(Z,"width: round(1.5px, 1px)"))}}e.FeatureTest=Ft;const Bt=[...Array(256).keys()].map(ft=>ft.toString(16).padStart(2,"0"));class St{static makeHexColor(Z,K,At){return`#${Bt[Z]}${Bt[K]}${Bt[At]}`}static scaleMinMax(Z,K){let At;Z[0]?(Z[0]<0&&(At=K[0],K[0]=K[1],K[1]=At),K[0]*=Z[0],K[1]*=Z[0],Z[3]<0&&(At=K[2],K[2]=K[3],K[3]=At),K[2]*=Z[3],K[3]*=Z[3]):(At=K[0],K[0]=K[2],K[2]=At,At=K[1],K[1]=K[3],K[3]=At,Z[1]<0&&(At=K[2],K[2]=K[3],K[3]=At),K[2]*=Z[1],K[3]*=Z[1],Z[2]<0&&(At=K[0],K[0]=K[1],K[1]=At),K[0]*=Z[2],K[1]*=Z[2]),K[0]+=Z[4],K[1]+=Z[4],K[2]+=Z[5],K[3]+=Z[5]}static transform(Z,K){return[Z[0]*K[0]+Z[2]*K[1],Z[1]*K[0]+Z[3]*K[1],Z[0]*K[2]+Z[2]*K[3],Z[1]*K[2]+Z[3]*K[3],Z[0]*K[4]+Z[2]*K[5]+Z[4],Z[1]*K[4]+Z[3]*K[5]+Z[5]]}static applyTransform(Z,K){const At=Z[0]*K[0]+Z[1]*K[2]+K[4],vt=Z[0]*K[1]+Z[1]*K[3]+K[5];return[At,vt]}static applyInverseTransform(Z,K){const At=K[0]*K[3]-K[1]*K[2],vt=(Z[0]*K[3]-Z[1]*K[2]+K[2]*K[5]-K[4]*K[3])/At,ee=(-Z[0]*K[1]+Z[1]*K[0]+K[4]*K[1]-K[5]*K[0])/At;return[vt,ee]}static getAxialAlignedBoundingBox(Z,K){const At=this.applyTransform(Z,K),vt=this.applyTransform(Z.slice(2,4),K),ee=this.applyTransform([Z[0],Z[3]],K),te=this.applyTransform([Z[2],Z[1]],K);return[Math.min(At[0],vt[0],ee[0],te[0]),Math.min(At[1],vt[1],ee[1],te[1]),Math.max(At[0],vt[0],ee[0],te[0]),Math.max(At[1],vt[1],ee[1],te[1])]}static inverseTransform(Z){const K=Z[0]*Z[3]-Z[1]*Z[2];return[Z[3]/K,-Z[1]/K,-Z[2]/K,Z[0]/K,(Z[2]*Z[5]-Z[4]*Z[3])/K,(Z[4]*Z[1]-Z[5]*Z[0])/K]}static singularValueDecompose2dScale(Z){const K=[Z[0],Z[2],Z[1],Z[3]],At=Z[0]*K[0]+Z[1]*K[2],vt=Z[0]*K[1]+Z[1]*K[3],ee=Z[2]*K[0]+Z[3]*K[2],te=Z[2]*K[1]+Z[3]*K[3],Q=(At+te)/2,xt=Math.sqrt((At+te)**2-4*(At*te-ee*vt))/2,It=Q+xt||1,Pt=Q-xt||1;return[Math.sqrt(It),Math.sqrt(Pt)]}static normalizeRect(Z){const K=Z.slice(0);return Z[0]>Z[2]&&(K[0]=Z[2],K[2]=Z[0]),Z[1]>Z[3]&&(K[1]=Z[3],K[3]=Z[1]),K}static intersect(Z,K){const At=Math.max(Math.min(Z[0],Z[2]),Math.min(K[0],K[2])),vt=Math.min(Math.max(Z[0],Z[2]),Math.max(K[0],K[2]));if(At>vt)return null;const ee=Math.max(Math.min(Z[1],Z[3]),Math.min(K[1],K[3])),te=Math.min(Math.max(Z[1],Z[3]),Math.max(K[1],K[3]));return ee>te?null:[At,ee,vt,te]}static bezierBoundingBox(Z,K,At,vt,ee,te,Q,xt){const It=[],Pt=[[],[]];let Nt,jt,Qt,yt,Kt,Ot,B,s;for(let J=0;J<2;++J){if(J===0?(jt=6*Z-12*At+6*ee,Nt=-3*Z+9*At-9*ee+3*Q,Qt=3*At-3*Z):(jt=6*K-12*vt+6*te,Nt=-3*K+9*vt-9*te+3*xt,Qt=3*vt-3*K),Math.abs(Nt)<1e-12){if(Math.abs(jt)<1e-12)continue;yt=-Qt/jt,0<yt&&yt<1&&It.push(yt);continue}B=jt*jt-4*Qt*Nt,s=Math.sqrt(B),!(B<0)&&(Kt=(-jt+s)/(2*Nt),0<Kt&&Kt<1&&It.push(Kt),Ot=(-jt-s)/(2*Nt),0<Ot&&Ot<1&&It.push(Ot))}let S=It.length,U;const q=S;for(;S--;)yt=It[S],U=1-yt,Pt[0][S]=U*U*U*Z+3*U*U*yt*At+3*U*yt*yt*ee+yt*yt*yt*Q,Pt[1][S]=U*U*U*K+3*U*U*yt*vt+3*U*yt*yt*te+yt*yt*yt*xt;return Pt[0][q]=Z,Pt[1][q]=K,Pt[0][q+1]=Q,Pt[1][q+1]=xt,Pt[0].length=Pt[1].length=q+2,[Math.min(...Pt[0]),Math.min(...Pt[1]),Math.max(...Pt[0]),Math.max(...Pt[1])]}}e.Util=St;const Lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function gt(ft){if(ft[0]>="ï"){let K;if(ft[0]==="þ"&&ft[1]==="ÿ"?K="utf-16be":ft[0]==="ÿ"&&ft[1]==="þ"?K="utf-16le":ft[0]==="ï"&&ft[1]==="»"&&ft[2]==="¿"&&(K="utf-8"),K)try{const At=new TextDecoder(K,{fatal:!0}),vt=it(ft);return At.decode(vt)}catch(At){ct(`stringToPDFString: "${At}".`)}}const Z=[];for(let K=0,At=ft.length;K<At;K++){const vt=Lt[ft.charCodeAt(K)];Z.push(vt?String.fromCharCode(vt):ft.charAt(K))}return Z.join("")}function nt(ft){return decodeURIComponent(escape(ft))}function st(ft){return unescape(encodeURIComponent(ft))}function pt(ft){return typeof ft=="object"&&(ft==null?void 0:ft.byteLength)!==void 0}function Tt(ft,Z){if(ft.length!==Z.length)return!1;for(let K=0,At=ft.length;K<At;K++)if(ft[K]!==Z[K])return!1;return!0}function Ct(ft=new Date){return[ft.getUTCFullYear().toString(),(ft.getUTCMonth()+1).toString().padStart(2,"0"),ft.getUTCDate().toString().padStart(2,"0"),ft.getUTCHours().toString().padStart(2,"0"),ft.getUTCMinutes().toString().padStart(2,"0"),ft.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){H(this,Xt,!1);this.promise=new Promise((Z,K)=>{this.resolve=At=>{ot(this,Xt,!0),Z(At)},this.reject=At=>{ot(this,Xt,!0),K(At)}})}get settled(){return t(this,Xt)}}Xt=new WeakMap,e.PromiseCapability=Ut;let Vt=null,Wt=null;function zt(ft){return Vt||(Vt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Wt=new Map([["ﬅ","ſt"]])),ft.replaceAll(Vt,(Z,K,At)=>K?K.normalize("NFKC"):Wt.get(At))}function Gt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ft=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ft);else for(let Z=0;Z<32;Z++)ft[Z]=Math.floor(Math.random()*255);return W(ft)}const Ht="pdfjs_internal_id_";e.AnnotationPrefix=Ht},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var p,D,n,d,de,I,xe,k,A,m,L,N,P,x,w,g,we,R,C,Be,l,u;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(_){if(typeof _=="string"||_ instanceof URL?_={url:_}:(0,_util.isArrayBuffer)(_)&&(_={data:_}),typeof _!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!_.url&&!_.data&&!_.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const c=new PDFDocumentLoadingTask,{docId:F}=c,b=_.url?getUrlProp(_.url):null,G=_.data?getDataProp(_.data):null,z=_.httpHeaders||null,E=_.withCredentials===!0,X=_.password??null,at=_.range instanceof PDFDataRangeTransport?_.range:null,ct=Number.isInteger(_.rangeChunkSize)&&_.rangeChunkSize>0?_.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let V=_.worker instanceof PDFWorker?_.worker:null;const dt=_.verbosity,mt=typeof _.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(_.docBaseUrl)?_.docBaseUrl:null,Et=typeof _.cMapUrl=="string"?_.cMapUrl:null,wt=_.cMapPacked!==!1,M=_.CMapReaderFactory||DefaultCMapReaderFactory,i=typeof _.standardFontDataUrl=="string"?_.standardFontDataUrl:null,o=_.StandardFontDataFactory||DefaultStandardFontDataFactory,a=_.stopAtErrors!==!0,h=Number.isInteger(_.maxImageSize)&&_.maxImageSize>-1?_.maxImageSize:-1,f=_.isEvalSupported!==!1,T=typeof _.isOffscreenCanvasSupported=="boolean"?_.isOffscreenCanvasSupported:!_util.isNodeJS,j=Number.isInteger(_.canvasMaxAreaInBytes)?_.canvasMaxAreaInBytes:-1,W=typeof _.disableFontFace=="boolean"?_.disableFontFace:_util.isNodeJS,it=_.fontExtraProperties===!0,tt=_.enableXfa===!0,et=_.ownerDocument||globalThis.document,ht=_.disableRange===!0,bt=_.disableStream===!0,ut=_.disableAutoFetch===!0,Ft=_.pdfBug===!0,Bt=at?at.length:_.length??NaN,St=typeof _.useSystemFonts=="boolean"?_.useSystemFonts:!_util.isNodeJS&&!W,Lt=typeof _.useWorkerFetch=="boolean"?_.useWorkerFetch:M===_display_utils.DOMCMapReaderFactory&&o===_display_utils.DOMStandardFontDataFactory&&Et&&i&&(0,_display_utils.isValidFetchUrl)(Et,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI),gt=_.canvasFactory||new DefaultCanvasFactory({ownerDocument:et}),nt=_.filterFactory||new DefaultFilterFactory({docId:F,ownerDocument:et}),st=null;(0,_util.setVerbosityLevel)(dt);const pt={canvasFactory:gt,filterFactory:nt};if(Lt||(pt.cMapReaderFactory=new M({baseUrl:Et,isCompressed:wt}),pt.standardFontDataFactory=new o({baseUrl:i})),!V){const Ut={verbosity:dt,port:_worker_options.GlobalWorkerOptions.workerPort};V=Ut.port?PDFWorker.fromPort(Ut):new PDFWorker(Ut),c._worker=V}const Tt={docId:F,apiVersion:"3.11.174",data:G,password:X,disableAutoFetch:ut,rangeChunkSize:ct,length:Bt,docBaseUrl:mt,enableXfa:tt,evaluatorOptions:{maxImageSize:h,disableFontFace:W,ignoreErrors:a,isEvalSupported:f,isOffscreenCanvasSupported:T,canvasMaxAreaInBytes:j,fontExtraProperties:it,useSystemFonts:St,cMapUrl:Lt?Et:null,standardFontDataUrl:Lt?i:null}},Ct={ignoreErrors:a,isEvalSupported:f,disableFontFace:W,fontExtraProperties:it,enableXfa:tt,ownerDocument:et,disableAutoFetch:ut,pdfBug:Ft,styleElement:st};return V.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const Ut=_fetchDocument(V,Tt),Vt=new Promise(function(Wt){let zt;at?zt=new _transport_stream.PDFDataTransportStream({length:Bt,initialData:at.initialData,progressiveDone:at.progressiveDone,contentDispositionFilename:at.contentDispositionFilename,disableRange:ht,disableStream:bt},at):G||(zt=(Ht=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Ht):(0,_display_utils.isValidFetchUrl)(Ht.url)?new _displayFetch_stream.PDFFetchStream(Ht):new _displayNetwork.PDFNetworkStream(Ht))({url:b,length:Bt,httpHeaders:z,withCredentials:E,rangeChunkSize:ct,disableRange:ht,disableStream:bt})),Wt(zt)});return Promise.all([Ut,Vt]).then(function([Wt,zt]){if(c.destroyed)throw new Error("Loading aborted");const Gt=new _message_handler.MessageHandler(F,Wt,V.port),Ht=new WorkerTransport(Gt,c,zt,Ct,pt);c._transport=Ht,Gt.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(_,c){if(_.destroyed)throw new Error("Worker was destroyed");const F=await _.messageHandler.sendWithPromise("GetDocRequest",c,c.data?[c.data.buffer]:null);if(_.destroyed)throw new Error("Worker was destroyed");return F}function getUrlProp(_){if(_ instanceof URL)return _.href;try{return new URL(_,window.location).href}catch{if(_util.isNodeJS&&typeof _=="string")return _}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(_){if(_util.isNodeJS&&typeof Buffer<"u"&&_ instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength)return _;if(typeof _=="string")return(0,_util.stringToBytes)(_);if(typeof _=="object"&&!isNaN(_==null?void 0:_.length)||(0,_util.isArrayBuffer)(_))return new Uint8Array(_);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${me(e,p)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var c,F,b;this.destroyed=!0;try{(c=this._worker)!=null&&c.port&&(this._worker._pendingDestroy=!0),await((F=this._transport)==null?void 0:F.destroy())}catch(G){throw(b=this._worker)!=null&&b.port&&delete this._worker._pendingDestroy,G}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};p=new WeakMap,H(e,p,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,F,b=!1,G=null){this.length=c,this.initialData=F,this.progressiveDone=b,this.contentDispositionFilename=G,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,F){for(const b of this._rangeListeners)b(c,F)}onDataProgress(c,F){this._readyCapability.promise.then(()=>{for(const b of this._progressListeners)b(c,F)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const F of this._progressiveReadListeners)F(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,F){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,F){this._pdfInfo=c,this._transport=F,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(b=>{if(!b)return b;const G=[];for(const z in b)G.push(...b[z]);return G}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,F,b,G=!1){H(this,d);H(this,I);H(this,D,null);H(this,n,!1);this._pageIndex=c,this._pageInfo=F,this._transport=b,this._stats=G?new _display_utils.StatTimer:null,this._pdfBug=G,this.commonObjs=b.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:F=this.rotate,offsetX:b=0,offsetY:G=0,dontFlip:z=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:F,offsetX:b,offsetY:G,dontFlip:z})}getAnnotations({intent:c="display"}={}){const F=this._transport.getRenderingIntent(c);return this._transport.getAnnotations(this._pageIndex,F.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:F,intent:b="display",annotationMode:G=_util.AnnotationMode.ENABLE,transform:z=null,background:E=null,optionalContentConfigPromise:X=null,annotationCanvasMap:at=null,pageColors:ct=null,printAnnotationStorage:V=null}){var o,a;(o=this._stats)==null||o.time("Overall");const dt=this._transport.getRenderingIntent(b,G,V);ot(this,n,!1),Y(this,I,xe).call(this),X||(X=this._transport.getOptionalContentConfig());let mt=this._intentStates.get(dt.cacheKey);mt||(mt=Object.create(null),this._intentStates.set(dt.cacheKey,mt)),mt.streamReaderCancelTimeout&&(clearTimeout(mt.streamReaderCancelTimeout),mt.streamReaderCancelTimeout=null);const Et=!!(dt.renderingIntent&_util.RenderingIntentFlag.PRINT);mt.displayReadyCapability||(mt.displayReadyCapability=new _util.PromiseCapability,mt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(a=this._stats)==null||a.time("Page Request"),this._pumpOperatorList(dt));const wt=h=>{var f,T;mt.renderTasks.delete(M),(this._maybeCleanupAfterRender||Et)&&ot(this,n,!0),Y(this,d,de).call(this,!Et),h?(M.capability.reject(h),this._abortOperatorList({intentState:mt,reason:h instanceof Error?h:new Error(h)})):M.capability.resolve(),(f=this._stats)==null||f.timeEnd("Rendering"),(T=this._stats)==null||T.timeEnd("Overall")},M=new InternalRenderTask({callback:wt,params:{canvasContext:c,viewport:F,transform:z,background:E},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:at,operatorList:mt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Et,pdfBug:this._pdfBug,pageColors:ct});(mt.renderTasks||(mt.renderTasks=new Set)).add(M);const i=M.task;return Promise.all([mt.displayReadyCapability.promise,X]).then(([h,f])=>{var T;if(this.destroyed){wt();return}(T=this._stats)==null||T.time("Rendering"),M.initializeGraphics({transparency:h,optionalContentConfig:f}),M.operatorListChanged()}).catch(wt),i}getOperatorList({intent:c="display",annotationMode:F=_util.AnnotationMode.ENABLE,printAnnotationStorage:b=null}={}){var at;function G(){E.operatorList.lastChunk&&(E.opListReadCapability.resolve(E.operatorList),E.renderTasks.delete(X))}const z=this._transport.getRenderingIntent(c,F,b,!0);let E=this._intentStates.get(z.cacheKey);E||(E=Object.create(null),this._intentStates.set(z.cacheKey,E));let X;return E.opListReadCapability||(X=Object.create(null),X.operatorListChanged=G,E.opListReadCapability=new _util.PromiseCapability,(E.renderTasks||(E.renderTasks=new Set)).add(X),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(at=this._stats)==null||at.time("Page Request"),this._pumpOperatorList(z)),E.opListReadCapability.promise}streamTextContent({includeMarkedContent:c=!1,disableNormalization:F=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:c===!0,disableNormalization:F===!0},{highWaterMark:100,size(G){return G.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(b=>_xfa_text.XfaText.textContent(b));const F=this.streamTextContent(c);return new Promise(function(b,G){function z(){E.read().then(function({value:at,done:ct}){if(ct){b(X);return}Object.assign(X.styles,at.styles),X.items.push(...at.items),z()},G)}const E=F.getReader(),X={items:[],styles:Object.create(null)};z()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const c=[];for(const F of this._intentStates.values())if(this._abortOperatorList({intentState:F,reason:new Error("Page was destroyed."),force:!0}),!F.opListReadCapability)for(const b of F.renderTasks)c.push(b.completed),b.cancel();return this.objs.clear(),ot(this,n,!1),Y(this,I,xe).call(this),Promise.all(c)}cleanup(c=!1){ot(this,n,!0);const F=Y(this,d,de).call(this,!1);return c&&F&&this._stats&&(this._stats=new _display_utils.StatTimer),F}_startRenderPage(c,F){var G,z;const b=this._intentStates.get(F);b&&((G=this._stats)==null||G.timeEnd("Page Request"),(z=b.displayReadyCapability)==null||z.resolve(c))}_renderPageChunk(c,F){for(let b=0,G=c.length;b<G;b++)F.operatorList.fnArray.push(c.fnArray[b]),F.operatorList.argsArray.push(c.argsArray[b]);F.operatorList.lastChunk=c.lastChunk,F.operatorList.separateAnnots=c.separateAnnots;for(const b of F.renderTasks)b.operatorListChanged();c.lastChunk&&Y(this,d,de).call(this,!0)}_pumpOperatorList({renderingIntent:c,cacheKey:F,annotationStorageSerializable:b}){const{map:G,transfers:z}=b,X=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:F,annotationStorage:G},z).getReader(),at=this._intentStates.get(F);at.streamReader=X;const ct=()=>{X.read().then(({value:V,done:dt})=>{if(dt){at.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(V,at),ct())},V=>{if(at.streamReader=null,!this._transport.destroyed){if(at.operatorList){at.operatorList.lastChunk=!0;for(const dt of at.renderTasks)dt.operatorListChanged();Y(this,d,de).call(this,!0)}if(at.displayReadyCapability)at.displayReadyCapability.reject(V);else if(at.opListReadCapability)at.opListReadCapability.reject(V);else throw V}})};ct()}_abortOperatorList({intentState:c,reason:F,force:b=!1}){if(c.streamReader){if(c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null),!b){if(c.renderTasks.size>0)return;if(F instanceof _display_utils.RenderingCancelledException){let G=RENDERING_CANCELLED_TIMEOUT;F.extraDelay>0&&F.extraDelay<1e3&&(G+=F.extraDelay),c.streamReaderCancelTimeout=setTimeout(()=>{c.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:c,reason:F,force:!0})},G);return}}if(c.streamReader.cancel(new _util.AbortException(F.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[G,z]of this._intentStates)if(z===c){this._intentStates.delete(G);break}this.cleanup()}}}get stats(){return this._stats}}D=new WeakMap,n=new WeakMap,d=new WeakSet,de=function(c=!1){if(Y(this,I,xe).call(this),!t(this,n)||this.destroyed)return!1;if(c)return ot(this,D,setTimeout(()=>{ot(this,D,null),Y(this,d,de).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:F,operatorList:b}of this._intentStates.values())if(F.size>0||!b.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ot(this,n,!1),!0},I=new WeakSet,xe=function(){t(this,D)&&(clearTimeout(t(this,D)),ot(this,D,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){H(this,k,new Set);H(this,A,Promise.resolve())}postMessage(c,F){const b={data:structuredClone(c,F?{transfer:F}:null)};t(this,A).then(()=>{for(const G of t(this,k))G.call(this,b)})}addEventListener(c,F){t(this,k).add(F)}removeEventListener(c,F){t(this,k).delete(F)}terminate(){t(this,k).clear()}}k=new WeakMap,A=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const _=(m=document==null?void 0:document.currentScript)==null?void 0:m.src;_&&(PDFWorkerUtil.fallbackWorkerSrc=_.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(_,c){let F;try{if(F=new URL(_),!F.origin||F.origin==="null")return!1}catch{return!1}const b=new URL(c,F);return F.origin===b.origin},PDFWorkerUtil.createCDNWrapper=function(_){const c=`importScripts("${_}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class _PDFWorker{constructor({name:_=null,port:c=null,verbosity:F=(0,_util.getVerbosityLevel)()}={}){var b;if(this.name=_,this.destroyed=!1,this.verbosity=F,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,c){if((b=t(_PDFWorker,L))!=null&&b.has(c))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,L)||ot(_PDFWorker,L,new WeakMap)).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(_){this._port=_,this._messageHandler=new _message_handler.MessageHandler("main","worker",_),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:_}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,_)||(_=PDFWorkerUtil.createCDNWrapper(new URL(_,window.location).href));const c=new Worker(_),F=new _message_handler.MessageHandler("main","worker",c),b=()=>{c.removeEventListener("error",G),F.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},G=()=>{this._webWorker||b()};c.addEventListener("error",G),F.on("test",E=>{if(c.removeEventListener("error",G),this.destroyed){b();return}E?(this._messageHandler=F,this._port=c,this._webWorker=c,this._readyCapability.resolve(),F.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),F.destroy(),c.terminate())}),F.on("ready",E=>{if(c.removeEventListener("error",G),this.destroyed){b();return}try{z()}catch{this._setupFakeWorker()}});const z=()=>{const E=new Uint8Array;F.send("test",E,[E.buffer])};z();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(_=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const F=`fake${PDFWorkerUtil.fakeWorkerId++}`,b=new _message_handler.MessageHandler(F+"_worker",F,c);_.setup(b,c);const G=new _message_handler.MessageHandler(F,F+"_worker",c);this._messageHandler=G,this._readyCapability.resolve(),G.send("configure",{verbosity:this.verbosity})}).catch(_=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${_.message}".`))})}destroy(){var _;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(_=t(_PDFWorker,L))==null||_.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(_){var F;if(!(_!=null&&_.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const c=(F=t(this,L))==null?void 0:F.get(_.port);if(c){if(c._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return c}return new _PDFWorker(_)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var _;try{return((_=globalThis.pdfjsWorker)==null?void 0:_.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};L=new WeakMap,H(_PDFWorker,L,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(c,F,b,G,z){H(this,g);H(this,N,new Map);H(this,P,new Map);H(this,x,new Map);H(this,w,null);this.messageHandler=c,this.loadingTask=F,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:G.ownerDocument,styleElement:G.styleElement}),this._params=G,this.canvasFactory=z.canvasFactory,this.filterFactory=z.filterFactory,this.cMapReaderFactory=z.cMapReaderFactory,this.standardFontDataFactory=z.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=b,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(c,F=_util.AnnotationMode.ENABLE,b=null,G=!1){let z=_util.RenderingIntentFlag.DISPLAY,E=_annotation_storage.SerializableEmpty;switch(c){case"any":z=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":z=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch(F){case _util.AnnotationMode.DISABLE:z+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:z+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:z+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,E=(z&_util.RenderingIntentFlag.PRINT&&b instanceof _annotation_storage.PrintAnnotationStorage?b:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${F}`)}return G&&(z+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:z,cacheKey:`${z}_${E.hash}`,annotationStorageSerializable:E}}destroy(){var b;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(b=t(this,w))==null||b.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const G of t(this,P).values())c.push(G._destroy());t(this,P).clear(),t(this,x).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const F=this.messageHandler.sendWithPromise("Terminate",null);return c.push(F),Promise.all(c).then(()=>{var G;this.commonObjs.clear(),this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(),(G=this._networkStream)==null||G.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:F}=this;c.on("GetReader",(b,G)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=z=>{this._lastProgress={loaded:z.loaded,total:z.total}},G.onPull=()=>{this._fullReader.read().then(function({value:z,done:E}){if(E){G.close();return}(0,_util.assert)(z instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),G.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{G.error(z)})},G.onCancel=z=>{this._fullReader.cancel(z),G.ready.catch(E=>{if(!this.destroyed)throw E})}}),c.on("ReaderHeadersReady",b=>{const G=new _util.PromiseCapability,z=this._fullReader;return z.headersReady.then(()=>{var E;(!z.isStreamingSupported||!z.isRangeSupported)&&(this._lastProgress&&((E=F.onProgress)==null||E.call(F,this._lastProgress)),z.onProgress=X=>{var at;(at=F.onProgress)==null||at.call(F,{loaded:X.loaded,total:X.total})}),G.resolve({isStreamingSupported:z.isStreamingSupported,isRangeSupported:z.isRangeSupported,contentLength:z.contentLength})},G.reject),G.promise}),c.on("GetRangeReader",(b,G)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const z=this._networkStream.getRangeReader(b.begin,b.end);if(!z){G.close();return}G.onPull=()=>{z.read().then(function({value:E,done:X}){if(X){G.close();return}(0,_util.assert)(E instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),G.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{G.error(E)})},G.onCancel=E=>{z.cancel(E),G.ready.catch(X=>{if(!this.destroyed)throw X})}}),c.on("GetDoc",({pdfInfo:b})=>{this._numPages=b.numPages,this._htmlForXfa=b.htmlForXfa,delete b.htmlForXfa,F._capability.resolve(new PDFDocumentProxy(b,this))}),c.on("DocException",function(b){let G;switch(b.name){case"PasswordException":G=new _util.PasswordException(b.message,b.code);break;case"InvalidPDFException":G=new _util.InvalidPDFException(b.message);break;case"MissingPDFException":G=new _util.MissingPDFException(b.message);break;case"UnexpectedResponseException":G=new _util.UnexpectedResponseException(b.message,b.status);break;case"UnknownErrorException":G=new _util.UnknownErrorException(b.message,b.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}F._capability.reject(G)}),c.on("PasswordRequest",b=>{if(ot(this,w,new _util.PromiseCapability),F.onPassword){const G=z=>{z instanceof Error?t(this,w).reject(z):t(this,w).resolve({password:z})};try{F.onPassword(G,b.code)}catch(z){t(this,w).reject(z)}}else t(this,w).reject(new _util.PasswordException(b.message,b.code));return t(this,w).promise}),c.on("DataLoaded",b=>{var G;(G=F.onProgress)==null||G.call(F,{loaded:b.length,total:b.length}),this.downloadInfoCapability.resolve(b)}),c.on("StartRenderPage",b=>{if(this.destroyed)return;t(this,P).get(b.pageIndex)._startRenderPage(b.transparency,b.cacheKey)}),c.on("commonobj",([b,G,z])=>{var E;if(!this.destroyed&&!this.commonObjs.has(b))switch(G){case"Font":const X=this._params;if("error"in z){const V=z.error;(0,_util.warn)(`Error during font loading: ${V}`),this.commonObjs.resolve(b,V);break}const at=X.pdfBug&&((E=globalThis.FontInspector)!=null&&E.enabled)?(V,dt)=>globalThis.FontInspector.fontAdded(V,dt):null,ct=new _font_loader.FontFaceObject(z,{isEvalSupported:X.isEvalSupported,disableFontFace:X.disableFontFace,ignoreErrors:X.ignoreErrors,inspectFont:at});this.fontLoader.bind(ct).catch(V=>c.sendWithPromise("FontFallback",{id:b})).finally(()=>{!X.fontExtraProperties&&ct.data&&(ct.data=null),this.commonObjs.resolve(b,ct)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(b,z);break;default:throw new Error(`Got unknown common object type ${G}`)}}),c.on("obj",([b,G,z,E])=>{var at;if(this.destroyed)return;const X=t(this,P).get(G);if(!X.objs.has(b))switch(z){case"Image":if(X.objs.resolve(b,E),E){let ct;if(E.bitmap){const{width:V,height:dt}=E;ct=V*dt*4}else ct=((at=E.data)==null?void 0:at.length)||0;ct>_util.MAX_IMAGE_SIZE_TO_CACHE&&(X._maybeCleanupAfterRender=!0)}break;case"Pattern":X.objs.resolve(b,E);break;default:throw new Error(`Got unknown object type ${z}`)}}),c.on("DocProgress",b=>{var G;this.destroyed||(G=F.onProgress)==null||G.call(F,{loaded:b.loaded,total:b.total})}),c.on("FetchBuiltInCMap",b=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(b):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",b=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(b):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var b;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:c,transfers:F}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:c,filename:((b=this._fullReader)==null?void 0:b.filename)??null},F).finally(()=>{this.annotationStorage.resetModified()})}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const F=c-1,b=t(this,x).get(F);if(b)return b;const G=this.messageHandler.sendWithPromise("GetPage",{pageIndex:F}).then(z=>{if(this.destroyed)throw new Error("Transport destroyed");const E=new PDFPageProxy(F,z,this,this._params.pdfBug);return t(this,P).set(F,E),E});return t(this,x).set(F,G),G}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,F){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:F})}getFieldObjects(){return Y(this,g,we).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,g,we).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,g,we).call(this,"GetDocJSActions")}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const c="GetMetadata",F=t(this,N).get(c);if(F)return F;const b=this.messageHandler.sendWithPromise(c,null).then(G=>{var z,E;return{info:G[0],metadata:G[1]?new _metadata.Metadata(G[1]):null,contentDispositionFilename:((z=this._fullReader)==null?void 0:z.filename)??null,contentLength:((E=this._fullReader)==null?void 0:E.contentLength)??null}});return t(this,N).set(c,b),b}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const F of t(this,P).values())if(!F.cleanup())throw new Error(`startCleanup: Page ${F.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:c,enableXfa:F}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c,enableXfa:F})}}N=new WeakMap,P=new WeakMap,x=new WeakMap,w=new WeakMap,g=new WeakSet,we=function(c,F=null){const b=t(this,N).get(c);if(b)return b;const G=this.messageHandler.sendWithPromise(c,F);return t(this,N).set(c,G),G};class PDFObjects{constructor(){H(this,C);H(this,R,Object.create(null))}get(c,F=null){if(F){const G=Y(this,C,Be).call(this,c);return G.capability.promise.then(()=>F(G.data)),null}const b=t(this,R)[c];if(!(b!=null&&b.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return b.data}has(c){const F=t(this,R)[c];return(F==null?void 0:F.capability.settled)||!1}resolve(c,F=null){const b=Y(this,C,Be).call(this,c);b.data=F,b.capability.resolve()}clear(){var c;for(const F in t(this,R)){const{data:b}=t(this,R)[F];(c=b==null?void 0:b.bitmap)==null||c.close()}ot(this,R,Object.create(null))}}R=new WeakMap,C=new WeakSet,Be=function(c){var F;return(F=t(this,R))[c]||(F[c]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(c){H(this,l,null);ot(this,l,c),this.onContinue=null}get promise(){return t(this,l).capability.promise}cancel(c=0){t(this,l).cancel(null,c)}get separateAnnots(){const{separateAnnots:c}=t(this,l).operatorList;if(!c)return!1;const{annotationCanvasMap:F}=t(this,l);return c.form||c.canvas&&(F==null?void 0:F.size)>0}}l=new WeakMap,exports.RenderTask=RenderTask;const O=class O{constructor({callback:c,params:F,objs:b,commonObjs:G,annotationCanvasMap:z,operatorList:E,pageIndex:X,canvasFactory:at,filterFactory:ct,useRequestAnimationFrame:V=!1,pdfBug:dt=!1,pageColors:mt=null}){this.callback=c,this.params=F,this.objs=b,this.commonObjs=G,this.annotationCanvasMap=z,this.operatorListIdx=null,this.operatorList=E,this._pageIndex=X,this.canvasFactory=at,this.filterFactory=ct,this._pdfBug=dt,this.pageColors=mt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=V===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=F.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:F}){var X,at;if(this.cancelled)return;if(this._canvas){if(t(O,u).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(O,u).add(this._canvas)}this._pdfBug&&((X=globalThis.StepperManager)!=null&&X.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:b,viewport:G,transform:z,background:E}=this.params;this.gfx=new _canvas.CanvasGraphics(b,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:F},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:z,viewport:G,transparency:c,background:E}),this.operatorListIdx=0,this.graphicsReady=!0,(at=this.graphicsReadyCallback)==null||at.call(this)}cancel(c=null,F=0){var b;this.running=!1,this.cancelled=!0,(b=this.gfx)==null||b.endDrawing(),t(O,u).delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,F))}operatorListChanged(){var c;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(c=this.stepper)==null||c.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(O,u).delete(this._canvas),this.callback())))}};u=new WeakMap,H(O,u,new WeakSet);let InternalRenderTask=O;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(p,e,D)=>{var A,m,L,vn,P;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=D(1),d=D(4),$=D(8);const I=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=I;class rt{constructor(){H(this,L);H(this,A,!1);H(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(w,g){const v=t(this,m).get(w);return v===void 0?g:Object.assign(g,v)}getRawValue(w){return t(this,m).get(w)}remove(w){if(t(this,m).delete(w),t(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of t(this,m).values())if(g instanceof d.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(w,g){const v=t(this,m).get(w);let R=!1;if(v!==void 0)for(const[C,y]of Object.entries(g))v[C]!==y&&(R=!0,v[C]=y);else R=!0,t(this,m).set(w,g);R&&Y(this,L,vn).call(this),g instanceof d.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(w){return t(this,m).has(w)}getAll(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}setAll(w){for(const[g,v]of Object.entries(w))this.setValue(g,v)}get size(){return t(this,m).size}resetModified(){t(this,A)&&(ot(this,A,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new k(this)}get serializable(){if(t(this,m).size===0)return I;const w=new Map,g=new $.MurmurHash3_64,v=[],R=Object.create(null);let C=!1;for(const[y,l]of t(this,m)){const u=l instanceof d.AnnotationEditor?l.serialize(!1,R):l;u&&(w.set(y,u),g.update(`${y}:${JSON.stringify(u)}`),C||(C=!!u.bitmap))}if(C)for(const y of w.values())y.bitmap&&v.push(y.bitmap);return w.size>0?{map:w,hash:g.hexdigest(),transfers:v}:I}}A=new WeakMap,m=new WeakMap,L=new WeakSet,vn=function(){t(this,A)||(ot(this,A,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=rt;class k extends rt{constructor(g){super();H(this,P,void 0);const{map:v,hash:R,transfers:C}=g.serializable,y=structuredClone(v,C?{transfer:C}:null);ot(this,P,{map:y,hash:R,transfers:C})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,P)}}P=new WeakMap,e.PrintAnnotationStorage=k},(p,e,D)=>{var k,A,m,L,N,P,x,w,g,v,R,C,y,l,u,Ue,_,We,F,He,G,$e,E,En,at,Sn,V,xn,mt,Ge,wt,wn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=D(5),d=D(1),$=D(6);const i=class i{constructor(a){H(this,u);H(this,_);H(this,G);H(this,E);H(this,at);H(this,V);H(this,mt);H(this,wt);H(this,k,"");H(this,A,!1);H(this,m,null);H(this,L,null);H(this,N,null);H(this,P,!1);H(this,x,null);H(this,w,this.focusin.bind(this));H(this,g,this.focusout.bind(this));H(this,v,!1);H(this,R,!1);H(this,C,!1);ne(this,"_initialOptions",Object.create(null));ne(this,"_uiManager",null);ne(this,"_focusEventsAllowed",!0);ne(this,"_l10nPromise",null);H(this,y,!1);H(this,l,i._zIndex++);this.constructor===i&&(0,d.unreachable)("Cannot initialize AnnotationEditor."),this.parent=a.parent,this.id=a.id,this.width=this.height=null,this.pageIndex=a.parent.pageIndex,this.name=a.name,this.div=null,this._uiManager=a.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=a.isCentered,this._structTreeParentId=null;const{rotation:h,rawDims:{pageWidth:f,pageHeight:T,pageX:j,pageY:W}}=this.parent.viewport;this.rotation=h,this.pageRotation=(360+h-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[f,T],this.pageTranslation=[j,W];const[it,tt]=this.parentDimensions;this.x=a.x/it,this.y=a.y/tt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,d.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(a){const h=new rt({id:a.parent.getNextId(),parent:a.parent,uiManager:a._uiManager});h.annotationElementId=a.annotationElementId,h.deleted=!0,h._uiManager.addToAnnotationStorage(h)}static initialize(a,h=null){if(i._l10nPromise||(i._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(T=>[T,a.get(T)]))),h!=null&&h.strings)for(const T of h.strings)i._l10nPromise.set(T,a.get(T));if(i._borderLineWidth!==-1)return;const f=getComputedStyle(document.documentElement);i._borderLineWidth=parseFloat(f.getPropertyValue("--outline-width"))||0}static updateDefaultParams(a,h){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(a){return!1}static paste(a,h){(0,d.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,y)}set _isDraggable(a){var h;ot(this,y,a),(h=this.div)==null||h.classList.toggle("draggable",a)}center(){const[a,h]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*h/(a*2),this.y+=this.width*a/(h*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*h/(a*2),this.y-=this.width*a/(h*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(a){this._uiManager.addCommands(a)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,l)}setParent(a){a!==null&&(this.pageIndex=a.pageIndex,this.pageDimensions=a.pageDimensions),this.parent=a}focusin(a){this._focusEventsAllowed&&(t(this,v)?ot(this,v,!1):this.parent.setSelected(this))}focusout(a){var f;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const h=a.relatedTarget;h!=null&&h.closest(`#${this.id}`)||(a.preventDefault(),(f=this.parent)!=null&&f.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(a,h,f,T){const[j,W]=this.parentDimensions;[f,T]=this.screenToPageTranslation(f,T),this.x=(a+f)/j,this.y=(h+T)/W,this.fixAndSetPosition()}translate(a,h){Y(this,u,Ue).call(this,this.parentDimensions,a,h)}translateInPage(a,h){Y(this,u,Ue).call(this,this.pageDimensions,a,h),this.div.scrollIntoView({block:"nearest"})}drag(a,h){const[f,T]=this.parentDimensions;if(this.x+=a/f,this.y+=h/T,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:et,y:ht}=this.div.getBoundingClientRect();this.parent.findNewParent(this,et,ht)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:j,y:W}=this;const[it,tt]=Y(this,_,We).call(this);j+=it,W+=tt,this.div.style.left=`${(100*j).toFixed(2)}%`,this.div.style.top=`${(100*W).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[a,h]=this.pageDimensions;let{x:f,y:T,width:j,height:W}=this;switch(j*=a,W*=h,f*=a,T*=h,this.rotation){case 0:f=Math.max(0,Math.min(a-j,f)),T=Math.max(0,Math.min(h-W,T));break;case 90:f=Math.max(0,Math.min(a-W,f)),T=Math.min(h,Math.max(j,T));break;case 180:f=Math.min(a,Math.max(j,f)),T=Math.min(h,Math.max(W,T));break;case 270:f=Math.min(a,Math.max(W,f)),T=Math.max(0,Math.min(h-j,T));break}this.x=f/=a,this.y=T/=h;const[it,tt]=Y(this,_,We).call(this);f+=it,T+=tt;const{style:et}=this.div;et.left=`${(100*f).toFixed(2)}%`,et.top=`${(100*T).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(a,h){var f;return Y(f=i,F,He).call(f,a,h,this.parentRotation)}pageTranslationToScreen(a,h){var f;return Y(f=i,F,He).call(f,a,h,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:a,pageDimensions:[h,f]}=this,T=h*a,j=f*a;return d.FeatureTest.isCSSRoundSupported?[Math.round(T),Math.round(j)]:[T,j]}setDims(a,h){var j;const[f,T]=this.parentDimensions;this.div.style.width=`${(100*a/f).toFixed(2)}%`,t(this,P)||(this.div.style.height=`${(100*h/T).toFixed(2)}%`),(j=t(this,m))==null||j.classList.toggle("small",a<i.SMALL_EDITOR_SIZE||h<i.SMALL_EDITOR_SIZE)}fixDims(){const{style:a}=this.div,{height:h,width:f}=a,T=f.endsWith("%"),j=!t(this,P)&&h.endsWith("%");if(T&&j)return;const[W,it]=this.parentDimensions;T||(a.width=`${(100*parseFloat(f)/W).toFixed(2)}%`),!t(this,P)&&!j&&(a.height=`${(100*parseFloat(h)/it).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,m))return;const a=ot(this,m,document.createElement("button"));a.className="altText";const h=await i._l10nPromise.get("editor_alt_text_button_label");a.textContent=h,a.setAttribute("aria-label",h),a.tabIndex="0",a.addEventListener("contextmenu",$.noContextMenu),a.addEventListener("pointerdown",f=>f.stopPropagation()),a.addEventListener("click",f=>{f.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),a.addEventListener("keydown",f=>{f.target===a&&f.key==="Enter"&&(f.preventDefault(),this._uiManager.editAltText(this))}),Y(this,mt,Ge).call(this),this.div.append(a),i.SMALL_EDITOR_SIZE||(i.SMALL_EDITOR_SIZE=Math.min(128,Math.round(a.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,k),decorative:t(this,A)}}set altTextData({altText:a,decorative:h}){t(this,k)===a&&t(this,A)===h||(ot(this,k,a),ot(this,A,h),Y(this,mt,Ge).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,w)),this.div.addEventListener("focusout",t(this,g));const[a,h]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*h/a).toFixed(2)}%`,this.div.style.maxHeight=`${(100*a/h).toFixed(2)}%`);const[f,T]=this.getInitialTranslation();return this.translate(f,T),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(a){const{isMac:h}=d.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&h){a.preventDefault();return}ot(this,v,!0),Y(this,wt,wn).call(this,a)}moveInDOM(){var a;(a=this.parent)==null||a.moveEditorInDOM(this)}_setParentAndPosition(a,h,f){a.changeParent(this),this.x=h,this.y=f,this.fixAndSetPosition()}getRect(a,h){const f=this.parentScale,[T,j]=this.pageDimensions,[W,it]=this.pageTranslation,tt=a/f,et=h/f,ht=this.x*T,bt=this.y*j,ut=this.width*T,Ft=this.height*j;switch(this.rotation){case 0:return[ht+tt+W,j-bt-et-Ft+it,ht+tt+ut+W,j-bt-et+it];case 90:return[ht+et+W,j-bt+tt+it,ht+et+Ft+W,j-bt+tt+ut+it];case 180:return[ht-tt-ut+W,j-bt+et+it,ht-tt+W,j-bt+et+Ft+it];case 270:return[ht-et-Ft+W,j-bt-tt-ut+it,ht-et+W,j-bt-tt+it];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(a,h){const[f,T,j,W]=a,it=j-f,tt=W-T;switch(this.rotation){case 0:return[f,h-W,it,tt];case 90:return[f,h-T,tt,it];case 180:return[j,h-T,it,tt];case 270:return[j,h-W,tt,it];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ot(this,C,!0)}disableEditMode(){ot(this,C,!1)}isInEditMode(){return t(this,C)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var a,h;(a=this.div)==null||a.addEventListener("focusin",t(this,w)),(h=this.div)==null||h.addEventListener("focusout",t(this,g))}serialize(a=!1,h=null){(0,d.unreachable)("An editor must be serializable")}static deserialize(a,h,f){const T=new this.prototype.constructor({parent:h,id:h.getNextId(),uiManager:f});T.rotation=a.rotation;const[j,W]=T.pageDimensions,[it,tt,et,ht]=T.getRectInCurrentCoords(a.rect,W);return T.x=it/j,T.y=tt/W,T.width=et/j,T.height=ht/W,T}remove(){var a;this.div.removeEventListener("focusin",t(this,w)),this.div.removeEventListener("focusout",t(this,g)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(a=t(this,m))==null||a.remove(),ot(this,m,null),ot(this,L,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,E,En).call(this),t(this,x).classList.remove("hidden"))}select(){var a;this.makeResizable(),(a=this.div)==null||a.classList.add("selectedEditor")}unselect(){var a,h,f;(a=t(this,x))==null||a.classList.add("hidden"),(h=this.div)==null||h.classList.remove("selectedEditor"),(f=this.div)!=null&&f.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(a,h){}disableEditing(){t(this,m)&&(t(this,m).hidden=!0)}enableEditing(){t(this,m)&&(t(this,m).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,R)}set isEditing(a){ot(this,R,a),this.parent&&(a?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(a,h){ot(this,P,!0);const f=a/h,{style:T}=this.div;T.aspectRatio=f,T.height="auto"}static get MIN_SIZE(){return 16}};k=new WeakMap,A=new WeakMap,m=new WeakMap,L=new WeakMap,N=new WeakMap,P=new WeakMap,x=new WeakMap,w=new WeakMap,g=new WeakMap,v=new WeakMap,R=new WeakMap,C=new WeakMap,y=new WeakMap,l=new WeakMap,u=new WeakSet,Ue=function([a,h],f,T){[f,T]=this.screenToPageTranslation(f,T),this.x+=f/a,this.y+=T/h,this.fixAndSetPosition()},_=new WeakSet,We=function(){const[a,h]=this.parentDimensions,{_borderLineWidth:f}=i,T=f/a,j=f/h;switch(this.rotation){case 90:return[-T,j];case 180:return[T,j];case 270:return[T,-j];default:return[-T,-j]}},F=new WeakSet,He=function(a,h,f){switch(f){case 90:return[h,-a];case 180:return[-a,-h];case 270:return[-h,a];default:return[a,h]}},G=new WeakSet,$e=function(a){switch(a){case 90:{const[h,f]=this.pageDimensions;return[0,-h/f,f/h,0]}case 180:return[-1,0,0,-1];case 270:{const[h,f]=this.pageDimensions;return[0,h/f,-f/h,0]}default:return[1,0,0,1]}},E=new WeakSet,En=function(){if(t(this,x))return;ot(this,x,document.createElement("div")),t(this,x).classList.add("resizers");const a=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||a.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const h of a){const f=document.createElement("div");t(this,x).append(f),f.classList.add("resizer",h),f.addEventListener("pointerdown",Y(this,at,Sn).bind(this,h)),f.addEventListener("contextmenu",$.noContextMenu)}this.div.prepend(t(this,x))},at=new WeakSet,Sn=function(a,h){h.preventDefault();const{isMac:f}=d.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&f)return;const T=Y(this,V,xn).bind(this,a),j=this._isDraggable;this._isDraggable=!1;const W={passive:!0,capture:!0};window.addEventListener("pointermove",T,W);const it=this.x,tt=this.y,et=this.width,ht=this.height,bt=this.parent.div.style.cursor,ut=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(h.target).cursor;const Ft=()=>{this._isDraggable=j,window.removeEventListener("pointerup",Ft),window.removeEventListener("blur",Ft),window.removeEventListener("pointermove",T,W),this.parent.div.style.cursor=bt,this.div.style.cursor=ut;const Bt=this.x,St=this.y,Lt=this.width,gt=this.height;Bt===it&&St===tt&&Lt===et&&gt===ht||this.addCommands({cmd:()=>{this.width=Lt,this.height=gt,this.x=Bt,this.y=St;const[nt,st]=this.parentDimensions;this.setDims(nt*Lt,st*gt),this.fixAndSetPosition()},undo:()=>{this.width=et,this.height=ht,this.x=it,this.y=tt;const[nt,st]=this.parentDimensions;this.setDims(nt*et,st*ht),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Ft),window.addEventListener("blur",Ft)},V=new WeakSet,xn=function(a,h){const[f,T]=this.parentDimensions,j=this.x,W=this.y,it=this.width,tt=this.height,et=i.MIN_SIZE/f,ht=i.MIN_SIZE/T,bt=At=>Math.round(At*1e4)/1e4,ut=Y(this,G,$e).call(this,this.rotation),Ft=(At,vt)=>[ut[0]*At+ut[2]*vt,ut[1]*At+ut[3]*vt],Bt=Y(this,G,$e).call(this,360-this.rotation),St=(At,vt)=>[Bt[0]*At+Bt[2]*vt,Bt[1]*At+Bt[3]*vt];let Lt,gt,nt=!1,st=!1;switch(a){case"topLeft":nt=!0,Lt=(At,vt)=>[0,0],gt=(At,vt)=>[At,vt];break;case"topMiddle":Lt=(At,vt)=>[At/2,0],gt=(At,vt)=>[At/2,vt];break;case"topRight":nt=!0,Lt=(At,vt)=>[At,0],gt=(At,vt)=>[0,vt];break;case"middleRight":st=!0,Lt=(At,vt)=>[At,vt/2],gt=(At,vt)=>[0,vt/2];break;case"bottomRight":nt=!0,Lt=(At,vt)=>[At,vt],gt=(At,vt)=>[0,0];break;case"bottomMiddle":Lt=(At,vt)=>[At/2,vt],gt=(At,vt)=>[At/2,0];break;case"bottomLeft":nt=!0,Lt=(At,vt)=>[0,vt],gt=(At,vt)=>[At,0];break;case"middleLeft":st=!0,Lt=(At,vt)=>[0,vt/2],gt=(At,vt)=>[At,vt/2];break}const pt=Lt(it,tt),Tt=gt(it,tt);let Ct=Ft(...Tt);const Ut=bt(j+Ct[0]),Vt=bt(W+Ct[1]);let Wt=1,zt=1,[Gt,Ht]=this.screenToPageTranslation(h.movementX,h.movementY);if([Gt,Ht]=St(Gt/f,Ht/T),nt){const At=Math.hypot(it,tt);Wt=zt=Math.max(Math.min(Math.hypot(Tt[0]-pt[0]-Gt,Tt[1]-pt[1]-Ht)/At,1/it,1/tt),et/it,ht/tt)}else st?Wt=Math.max(et,Math.min(1,Math.abs(Tt[0]-pt[0]-Gt)))/it:zt=Math.max(ht,Math.min(1,Math.abs(Tt[1]-pt[1]-Ht)))/tt;const Xt=bt(it*Wt),ft=bt(tt*zt);Ct=Ft(...gt(Xt,ft));const Z=Ut-Ct[0],K=Vt-Ct[1];this.width=Xt,this.height=ft,this.x=Z,this.y=K,this.setDims(f*Xt,T*ft),this.fixAndSetPosition()},mt=new WeakSet,Ge=async function(){var f;const a=t(this,m);if(!a)return;if(!t(this,k)&&!t(this,A)){a.classList.remove("done"),(f=t(this,L))==null||f.remove();return}i._l10nPromise.get("editor_alt_text_edit_button_label").then(T=>{a.setAttribute("aria-label",T)});let h=t(this,L);if(!h){ot(this,L,h=document.createElement("span")),h.className="tooltip",h.setAttribute("role","tooltip");const T=h.id=`alt-text-tooltip-${this.id}`;a.setAttribute("aria-describedby",T);const j=100;a.addEventListener("mouseenter",()=>{ot(this,N,setTimeout(()=>{ot(this,N,null),t(this,L).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},j))}),a.addEventListener("mouseleave",()=>{var W;clearTimeout(t(this,N)),ot(this,N,null),(W=t(this,L))==null||W.classList.remove("show")})}a.classList.add("done"),h.innerText=t(this,A)?await i._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,k),h.parentNode||a.append(h)},wt=new WeakSet,wn=function(a){if(!this._isDraggable)return;const h=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let f,T;h&&(f={passive:!0,capture:!0},T=W=>{const[it,tt]=this.screenToPageTranslation(W.movementX,W.movementY);this._uiManager.dragSelectedEditors(it,tt)},window.addEventListener("pointermove",T,f));const j=()=>{if(window.removeEventListener("pointerup",j),window.removeEventListener("blur",j),h&&window.removeEventListener("pointermove",T,f),ot(this,v,!1),!this._uiManager.endDragSession()){const{isMac:W}=d.FeatureTest.platform;a.ctrlKey&&!W||a.shiftKey||a.metaKey&&W?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",j),window.addEventListener("blur",j)},H(i,F),ne(i,"_borderLineWidth",-1),ne(i,"_colorManager",new n.ColorManager),ne(i,"_zIndex",1),ne(i,"SMALL_EDITOR_SIZE",0);let I=i;e.AnnotationEditor=I;class rt extends I{constructor(a){super(a),this.annotationElementId=a.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(p,e,D)=>{var P,x,w,g,v,Ve,y,l,u,O,_,Tn,b,G,z,E,X,at,ct,V,dt,mt,Et,wt,M,i,o,a,h,f,T,j,W,it,tt,et,ht,bt,ut,Ft,Bt,St,Lt,gt,nt,st,pt,Cn,Ct,ze,Vt,Xe,zt,Te,Ht,qe,ft,Ye,K,ae,vt,be,te,Pn,xt,Rn,Pt,Ke,jt,_e,yt,Je;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=$,e.opacityToHex=I;var n=D(1),d=D(6);function $(B,s,S){for(const U of S)s.addEventListener(U,B[U].bind(B))}function I(B){return Math.round(Math.min(255,Math.max(1,255*B))).toString(16).padStart(2,"0")}class rt{constructor(){H(this,P,0)}getId(){return`${n.AnnotationEditorPrefix}${me(this,P)._++}`}}P=new WeakMap;const C=class C{constructor(){H(this,v);H(this,x,(0,n.getUuid)());H(this,w,0);H(this,g,null)}static get _isSVGFittingCanvas(){const s='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',U=new OffscreenCanvas(1,3).getContext("2d"),q=new Image;q.src=s;const J=q.decode().then(()=>(U.drawImage(q,0,0,1,1,0,0,1,3),new Uint32Array(U.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",J)}async getFromFile(s){const{lastModified:S,name:U,size:q,type:J}=s;return Y(this,v,Ve).call(this,`${S}_${U}_${q}_${J}`,s)}async getFromUrl(s){return Y(this,v,Ve).call(this,s,s)}async getFromId(s){t(this,g)||ot(this,g,new Map);const S=t(this,g).get(s);return S?S.bitmap?(S.refCounter+=1,S):S.file?this.getFromFile(S.file):this.getFromUrl(S.url):null}getSvgUrl(s){const S=t(this,g).get(s);return S!=null&&S.isSvg?S.svgUrl:null}deleteId(s){t(this,g)||ot(this,g,new Map);const S=t(this,g).get(s);S&&(S.refCounter-=1,S.refCounter===0&&(S.bitmap=null))}isValidId(s){return s.startsWith(`image_${t(this,x)}_`)}};x=new WeakMap,w=new WeakMap,g=new WeakMap,v=new WeakSet,Ve=async function(s,S){t(this,g)||ot(this,g,new Map);let U=t(this,g).get(s);if(U===null)return null;if(U!=null&&U.bitmap)return U.refCounter+=1,U;try{U||(U={bitmap:null,id:`image_${t(this,x)}_${me(this,w)._++}`,refCounter:0,isSvg:!1});let q;if(typeof S=="string"){U.url=S;const J=await fetch(S);if(!J.ok)throw new Error(J.statusText);q=await J.blob()}else q=U.file=S;if(q.type==="image/svg+xml"){const J=C._isSVGFittingCanvas,lt=new FileReader,_t=new Image,kt=new Promise((Rt,qt)=>{_t.onload=()=>{U.bitmap=_t,U.isSvg=!0,Rt()},lt.onload=async()=>{const Mt=U.svgUrl=lt.result;_t.src=await J?`${Mt}#svgView(preserveAspectRatio(none))`:Mt},_t.onerror=lt.onerror=qt});lt.readAsDataURL(q),await kt}else U.bitmap=await createImageBitmap(q);U.refCounter=1}catch(q){console.error(q),U=null}return t(this,g).set(s,U),U&&t(this,g).set(U.id,U),U};let k=C;class A{constructor(s=128){H(this,y,[]);H(this,l,!1);H(this,u,void 0);H(this,O,-1);ot(this,u,s)}add({cmd:s,undo:S,mustExec:U,type:q=NaN,overwriteIfSameType:J=!1,keepUndo:lt=!1}){if(U&&s(),t(this,l))return;const _t={cmd:s,undo:S,type:q};if(t(this,O)===-1){t(this,y).length>0&&(t(this,y).length=0),ot(this,O,0),t(this,y).push(_t);return}if(J&&t(this,y)[t(this,O)].type===q){lt&&(_t.undo=t(this,y)[t(this,O)].undo),t(this,y)[t(this,O)]=_t;return}const kt=t(this,O)+1;kt===t(this,u)?t(this,y).splice(0,1):(ot(this,O,kt),kt<t(this,y).length&&t(this,y).splice(kt)),t(this,y).push(_t)}undo(){t(this,O)!==-1&&(ot(this,l,!0),t(this,y)[t(this,O)].undo(),ot(this,l,!1),ot(this,O,t(this,O)-1))}redo(){t(this,O)<t(this,y).length-1&&(ot(this,O,t(this,O)+1),ot(this,l,!0),t(this,y)[t(this,O)].cmd(),ot(this,l,!1))}hasSomethingToUndo(){return t(this,O)!==-1}hasSomethingToRedo(){return t(this,O)<t(this,y).length-1}destroy(){ot(this,y,null)}}y=new WeakMap,l=new WeakMap,u=new WeakMap,O=new WeakMap,e.CommandManager=A;class m{constructor(s){H(this,_);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:S}=n.FeatureTest.platform;for(const[U,q,J={}]of s)for(const lt of U){const _t=lt.startsWith("mac+");S&&_t?(this.callbacks.set(lt.slice(4),{callback:q,options:J}),this.allKeys.add(lt.split("+").at(-1))):!S&&!_t&&(this.callbacks.set(lt,{callback:q,options:J}),this.allKeys.add(lt.split("+").at(-1)))}}exec(s,S){if(!this.allKeys.has(S.key))return;const U=this.callbacks.get(Y(this,_,Tn).call(this,S));if(!U)return;const{callback:q,options:{bubbles:J=!1,args:lt=[],checker:_t=null}}=U;_t&&!_t(s,S)||(q.bind(s,...lt)(),J||(S.stopPropagation(),S.preventDefault()))}}_=new WeakSet,Tn=function(s){s.altKey&&this.buffer.push("alt"),s.ctrlKey&&this.buffer.push("ctrl"),s.metaKey&&this.buffer.push("meta"),s.shiftKey&&this.buffer.push("shift"),this.buffer.push(s.key);const S=this.buffer.join("+");return this.buffer.length=0,S},e.KeyboardManager=m;const F=class F{get _colors(){const s=new Map([["CanvasText",null],["Canvas",null]]);return(0,d.getColorValues)(s),(0,n.shadow)(this,"_colors",s)}convert(s){const S=(0,d.getRGB)(s);if(!window.matchMedia("(forced-colors: active)").matches)return S;for(const[U,q]of this._colors)if(q.every((J,lt)=>J===S[lt]))return F._colorsMapping.get(U);return S}getHexCode(s){const S=this._colors.get(s);return S?n.Util.makeHexColor(...S):s}};ne(F,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let L=F;e.ColorManager=L;const Ot=class Ot{constructor(s,S,U,q,J,lt){H(this,pt);H(this,Ct);H(this,Vt);H(this,zt);H(this,Ht);H(this,ft);H(this,K);H(this,vt);H(this,te);H(this,xt);H(this,Pt);H(this,jt);H(this,yt);H(this,b,null);H(this,G,new Map);H(this,z,new Map);H(this,E,null);H(this,X,null);H(this,at,new A);H(this,ct,0);H(this,V,new Set);H(this,dt,null);H(this,mt,null);H(this,Et,new Set);H(this,wt,null);H(this,M,new rt);H(this,i,!1);H(this,o,!1);H(this,a,null);H(this,h,n.AnnotationEditorType.NONE);H(this,f,new Set);H(this,T,null);H(this,j,this.blur.bind(this));H(this,W,this.focus.bind(this));H(this,it,this.copy.bind(this));H(this,tt,this.cut.bind(this));H(this,et,this.paste.bind(this));H(this,ht,this.keydown.bind(this));H(this,bt,this.onEditingAction.bind(this));H(this,ut,this.onPageChanging.bind(this));H(this,Ft,this.onScaleChanging.bind(this));H(this,Bt,this.onRotationChanging.bind(this));H(this,St,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});H(this,Lt,[0,0]);H(this,gt,null);H(this,nt,null);H(this,st,null);ot(this,nt,s),ot(this,st,S),ot(this,E,U),this._eventBus=q,this._eventBus._on("editingaction",t(this,bt)),this._eventBus._on("pagechanging",t(this,ut)),this._eventBus._on("scalechanging",t(this,Ft)),this._eventBus._on("rotationchanging",t(this,Bt)),ot(this,X,J.annotationStorage),ot(this,wt,J.filterFactory),ot(this,T,lt),this.viewParameters={realScale:d.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const s=Ot.prototype,S=J=>{const{activeElement:lt}=document;return lt&&t(J,nt).contains(lt)&&J.hasSomethingToControl()},U=this.TRANSLATE_SMALL,q=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],s.selectAll],[["ctrl+z","mac+meta+z"],s.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],s.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],s.delete],[["Escape","mac+Escape"],s.unselectAll],[["ArrowLeft","mac+ArrowLeft"],s.translateSelectedEditors,{args:[-U,0],checker:S}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s.translateSelectedEditors,{args:[-q,0],checker:S}],[["ArrowRight","mac+ArrowRight"],s.translateSelectedEditors,{args:[U,0],checker:S}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s.translateSelectedEditors,{args:[q,0],checker:S}],[["ArrowUp","mac+ArrowUp"],s.translateSelectedEditors,{args:[0,-U],checker:S}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s.translateSelectedEditors,{args:[0,-q],checker:S}],[["ArrowDown","mac+ArrowDown"],s.translateSelectedEditors,{args:[0,U],checker:S}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s.translateSelectedEditors,{args:[0,q],checker:S}]]))}destroy(){Y(this,zt,Te).call(this),Y(this,Ct,ze).call(this),this._eventBus._off("editingaction",t(this,bt)),this._eventBus._off("pagechanging",t(this,ut)),this._eventBus._off("scalechanging",t(this,Ft)),this._eventBus._off("rotationchanging",t(this,Bt));for(const s of t(this,z).values())s.destroy();t(this,z).clear(),t(this,G).clear(),t(this,Et).clear(),ot(this,b,null),t(this,f).clear(),t(this,at).destroy(),t(this,E).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,T)?t(this,wt).addHCMFilter(t(this,T).foreground,t(this,T).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,nt)).direction)}editAltText(s){var S;(S=t(this,E))==null||S.editAltText(this,s)}onPageChanging({pageNumber:s}){ot(this,ct,s-1)}focusMainContainer(){t(this,nt).focus()}findParent(s,S){for(const U of t(this,z).values()){const{x:q,y:J,width:lt,height:_t}=U.div.getBoundingClientRect();if(s>=q&&s<=q+lt&&S>=J&&S<=J+_t)return U}return null}disableUserSelect(s=!1){t(this,st).classList.toggle("noUserSelect",s)}addShouldRescale(s){t(this,Et).add(s)}removeShouldRescale(s){t(this,Et).delete(s)}onScaleChanging({scale:s}){this.commitOrRemove(),this.viewParameters.realScale=s*d.PixelsPerInch.PDF_TO_CSS_UNITS;for(const S of t(this,Et))S.onScaleChanging()}onRotationChanging({pagesRotation:s}){this.commitOrRemove(),this.viewParameters.rotation=s}addToAnnotationStorage(s){!s.isEmpty()&&t(this,X)&&!t(this,X).has(s.id)&&t(this,X).setValue(s.id,s)}blur(){if(!this.hasSelection)return;const{activeElement:s}=document;for(const S of t(this,f))if(S.div.contains(s)){ot(this,a,[S,s]),S._focusEventsAllowed=!1;break}}focus(){if(!t(this,a))return;const[s,S]=t(this,a);ot(this,a,null),S.addEventListener("focusin",()=>{s._focusEventsAllowed=!0},{once:!0}),S.focus()}addEditListeners(){Y(this,Vt,Xe).call(this),Y(this,Ht,qe).call(this)}removeEditListeners(){Y(this,zt,Te).call(this),Y(this,ft,Ye).call(this)}copy(s){var U;if(s.preventDefault(),(U=t(this,b))==null||U.commitOrRemove(),!this.hasSelection)return;const S=[];for(const q of t(this,f)){const J=q.serialize(!0);J&&S.push(J)}S.length!==0&&s.clipboardData.setData("application/pdfjs",JSON.stringify(S))}cut(s){this.copy(s),this.delete()}paste(s){s.preventDefault();const{clipboardData:S}=s;for(const J of S.items)for(const lt of t(this,mt))if(lt.isHandlingMimeForPasting(J.type)){lt.paste(J,this.currentLayer);return}let U=S.getData("application/pdfjs");if(!U)return;try{U=JSON.parse(U)}catch(J){(0,n.warn)(`paste: "${J.message}".`);return}if(!Array.isArray(U))return;this.unselectAll();const q=this.currentLayer;try{const J=[];for(const kt of U){const Rt=q.deserialize(kt);if(!Rt)return;J.push(Rt)}const lt=()=>{for(const kt of J)Y(this,Pt,Ke).call(this,kt);Y(this,yt,Je).call(this,J)},_t=()=>{for(const kt of J)kt.remove()};this.addCommands({cmd:lt,undo:_t,mustExec:!0})}catch(J){(0,n.warn)(`paste: "${J.message}".`)}}keydown(s){var S;(S=this.getActive())!=null&&S.shouldGetKeyboardEvents()||Ot._keyboardManager.exec(this,s)}onEditingAction(s){["undo","redo","delete","selectAll"].includes(s.name)&&this[s.name]()}setEditingState(s){s?(Y(this,pt,Cn).call(this),Y(this,Vt,Xe).call(this),Y(this,Ht,qe).call(this),Y(this,K,ae).call(this,{isEditing:t(this,h)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,jt,_e).call(this),hasSomethingToUndo:t(this,at).hasSomethingToUndo(),hasSomethingToRedo:t(this,at).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,Ct,ze).call(this),Y(this,zt,Te).call(this),Y(this,ft,Ye).call(this),Y(this,K,ae).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(s){if(!t(this,mt)){ot(this,mt,s);for(const S of t(this,mt))Y(this,vt,be).call(this,S.defaultPropertiesToUpdate)}}getId(){return t(this,M).getId()}get currentLayer(){return t(this,z).get(t(this,ct))}getLayer(s){return t(this,z).get(s)}get currentPageIndex(){return t(this,ct)}addLayer(s){t(this,z).set(s.pageIndex,s),t(this,i)?s.enable():s.disable()}removeLayer(s){t(this,z).delete(s.pageIndex)}updateMode(s,S=null){if(t(this,h)!==s){if(ot(this,h,s),s===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,xt,Rn).call(this);return}this.setEditingState(!0),Y(this,te,Pn).call(this),this.unselectAll();for(const U of t(this,z).values())U.updateMode(s);if(S){for(const U of t(this,G).values())if(U.annotationElementId===S){this.setSelected(U),U.enterInEditMode();break}}}}updateToolbar(s){s!==t(this,h)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:s})}updateParams(s,S){if(t(this,mt)){if(s===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(s);return}for(const U of t(this,f))U.updateParams(s,S);for(const U of t(this,mt))U.updateDefaultParams(s,S)}}enableWaiting(s=!1){if(t(this,o)!==s){ot(this,o,s);for(const S of t(this,z).values())s?S.disableClick():S.enableClick(),S.div.classList.toggle("waiting",s)}}getEditors(s){const S=[];for(const U of t(this,G).values())U.pageIndex===s&&S.push(U);return S}getEditor(s){return t(this,G).get(s)}addEditor(s){t(this,G).set(s.id,s)}removeEditor(s){var S;t(this,G).delete(s.id),this.unselect(s),(!s.annotationElementId||!t(this,V).has(s.annotationElementId))&&((S=t(this,X))==null||S.remove(s.id))}addDeletedAnnotationElement(s){t(this,V).add(s.annotationElementId),s.deleted=!0}isDeletedAnnotationElement(s){return t(this,V).has(s)}removeDeletedAnnotationElement(s){t(this,V).delete(s.annotationElementId),s.deleted=!1}setActiveEditor(s){t(this,b)!==s&&(ot(this,b,s),s&&Y(this,vt,be).call(this,s.propertiesToUpdate))}toggleSelected(s){if(t(this,f).has(s)){t(this,f).delete(s),s.unselect(),Y(this,K,ae).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,f).add(s),s.select(),Y(this,vt,be).call(this,s.propertiesToUpdate),Y(this,K,ae).call(this,{hasSelectedEditor:!0})}setSelected(s){for(const S of t(this,f))S!==s&&S.unselect();t(this,f).clear(),t(this,f).add(s),s.select(),Y(this,vt,be).call(this,s.propertiesToUpdate),Y(this,K,ae).call(this,{hasSelectedEditor:!0})}isSelected(s){return t(this,f).has(s)}unselect(s){s.unselect(),t(this,f).delete(s),Y(this,K,ae).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,f).size!==0}undo(){t(this,at).undo(),Y(this,K,ae).call(this,{hasSomethingToUndo:t(this,at).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,jt,_e).call(this)})}redo(){t(this,at).redo(),Y(this,K,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,at).hasSomethingToRedo(),isEmpty:Y(this,jt,_e).call(this)})}addCommands(s){t(this,at).add(s),Y(this,K,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,jt,_e).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const s=[...t(this,f)],S=()=>{for(const q of s)q.remove()},U=()=>{for(const q of s)Y(this,Pt,Ke).call(this,q)};this.addCommands({cmd:S,undo:U,mustExec:!0})}commitOrRemove(){var s;(s=t(this,b))==null||s.commitOrRemove()}hasSomethingToControl(){return t(this,b)||this.hasSelection}selectAll(){for(const s of t(this,f))s.commit();Y(this,yt,Je).call(this,t(this,G).values())}unselectAll(){if(t(this,b)){t(this,b).commitOrRemove();return}if(this.hasSelection){for(const s of t(this,f))s.unselect();t(this,f).clear(),Y(this,K,ae).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(s,S,U=!1){if(U||this.commitOrRemove(),!this.hasSelection)return;t(this,Lt)[0]+=s,t(this,Lt)[1]+=S;const[q,J]=t(this,Lt),lt=[...t(this,f)],_t=1e3;t(this,gt)&&clearTimeout(t(this,gt)),ot(this,gt,setTimeout(()=>{ot(this,gt,null),t(this,Lt)[0]=t(this,Lt)[1]=0,this.addCommands({cmd:()=>{for(const kt of lt)t(this,G).has(kt.id)&&kt.translateInPage(q,J)},undo:()=>{for(const kt of lt)t(this,G).has(kt.id)&&kt.translateInPage(-q,-J)},mustExec:!1})},_t));for(const kt of lt)kt.translateInPage(s,S)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ot(this,dt,new Map);for(const s of t(this,f))t(this,dt).set(s,{savedX:s.x,savedY:s.y,savedPageIndex:s.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,dt))return!1;this.disableUserSelect(!1);const s=t(this,dt);ot(this,dt,null);let S=!1;for(const[{x:q,y:J,pageIndex:lt},_t]of s)_t.newX=q,_t.newY=J,_t.newPageIndex=lt,S||(S=q!==_t.savedX||J!==_t.savedY||lt!==_t.savedPageIndex);if(!S)return!1;const U=(q,J,lt,_t)=>{if(t(this,G).has(q.id)){const kt=t(this,z).get(_t);kt?q._setParentAndPosition(kt,J,lt):(q.pageIndex=_t,q.x=J,q.y=lt)}};return this.addCommands({cmd:()=>{for(const[q,{newX:J,newY:lt,newPageIndex:_t}]of s)U(q,J,lt,_t)},undo:()=>{for(const[q,{savedX:J,savedY:lt,savedPageIndex:_t}]of s)U(q,J,lt,_t)},mustExec:!0}),!0}dragSelectedEditors(s,S){if(t(this,dt))for(const U of t(this,dt).keys())U.drag(s,S)}rebuild(s){if(s.parent===null){const S=this.getLayer(s.pageIndex);S?(S.changeParent(s),S.addOrRebuild(s)):(this.addEditor(s),this.addToAnnotationStorage(s),s.rebuild())}else s.parent.addOrRebuild(s)}isActive(s){return t(this,b)===s}getActive(){return t(this,b)}getMode(){return t(this,h)}get imageManager(){return(0,n.shadow)(this,"imageManager",new k)}};b=new WeakMap,G=new WeakMap,z=new WeakMap,E=new WeakMap,X=new WeakMap,at=new WeakMap,ct=new WeakMap,V=new WeakMap,dt=new WeakMap,mt=new WeakMap,Et=new WeakMap,wt=new WeakMap,M=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,h=new WeakMap,f=new WeakMap,T=new WeakMap,j=new WeakMap,W=new WeakMap,it=new WeakMap,tt=new WeakMap,et=new WeakMap,ht=new WeakMap,bt=new WeakMap,ut=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,St=new WeakMap,Lt=new WeakMap,gt=new WeakMap,nt=new WeakMap,st=new WeakMap,pt=new WeakSet,Cn=function(){window.addEventListener("focus",t(this,W)),window.addEventListener("blur",t(this,j))},Ct=new WeakSet,ze=function(){window.removeEventListener("focus",t(this,W)),window.removeEventListener("blur",t(this,j))},Vt=new WeakSet,Xe=function(){window.addEventListener("keydown",t(this,ht),{capture:!0})},zt=new WeakSet,Te=function(){window.removeEventListener("keydown",t(this,ht),{capture:!0})},Ht=new WeakSet,qe=function(){document.addEventListener("copy",t(this,it)),document.addEventListener("cut",t(this,tt)),document.addEventListener("paste",t(this,et))},ft=new WeakSet,Ye=function(){document.removeEventListener("copy",t(this,it)),document.removeEventListener("cut",t(this,tt)),document.removeEventListener("paste",t(this,et))},K=new WeakSet,ae=function(s){Object.entries(s).some(([U,q])=>t(this,St)[U]!==q)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,St),s)})},vt=new WeakSet,be=function(s){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:s})},te=new WeakSet,Pn=function(){if(!t(this,i)){ot(this,i,!0);for(const s of t(this,z).values())s.enable()}},xt=new WeakSet,Rn=function(){if(this.unselectAll(),t(this,i)){ot(this,i,!1);for(const s of t(this,z).values())s.disable()}},Pt=new WeakSet,Ke=function(s){const S=t(this,z).get(s.pageIndex);S?S.addOrRebuild(s):this.addEditor(s)},jt=new WeakSet,_e=function(){if(t(this,G).size===0)return!0;if(t(this,G).size===1)for(const s of t(this,G).values())return s.isEmpty();return!1},yt=new WeakSet,Je=function(s){t(this,f).clear();for(const S of s)S.isEmpty()||(t(this,f).add(S),S.select());Y(this,K,ae).call(this,{hasSelectedEditor:!0})},ne(Ot,"TRANSLATE_SMALL",1),ne(Ot,"TRANSLATE_BIG",10);let N=Ot;e.AnnotationEditorUIManager=N},(p,e,D)=>{var ct,V,dt,mt,Et,wt,M,i,o,a,h,f,ue,j,fe,it,Qe,et,Ce,bt,Pe,Ft,Ae,St,ye;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=O,e.getColorValues=G,e.getCurrentTransform=z,e.getCurrentTransformInverse=E,e.getFilenameFromUrl=v,e.getPdfFilenameFromUrl=R,e.getRGB=b,e.getXfaPageViewport=F,e.isDataScheme=w,e.isPdfFile=g,e.isValidFetchUrl=y,e.loadScript=u,e.noContextMenu=l,e.setLayerDimensions=X;var n=D(7),d=D(1);const $="http://www.w3.org/2000/svg",at=class at{};ne(at,"CSS",96),ne(at,"PDF",72),ne(at,"PDF_TO_CSS_UNITS",at.CSS/at.PDF);let I=at;e.PixelsPerInch=I;class rt extends n.BaseFilterFactory{constructor({docId:st,ownerDocument:pt=globalThis.document}={}){super();H(this,f);H(this,j);H(this,it);H(this,et);H(this,bt);H(this,Ft);H(this,St);H(this,ct,void 0);H(this,V,void 0);H(this,dt,void 0);H(this,mt,void 0);H(this,Et,void 0);H(this,wt,void 0);H(this,M,void 0);H(this,i,void 0);H(this,o,void 0);H(this,a,void 0);H(this,h,0);ot(this,dt,st),ot(this,mt,pt)}addFilter(st){if(!st)return"none";let pt=t(this,f,ue).get(st);if(pt)return pt;let Tt,Ct,Ut,Vt;if(st.length===1){const Ht=st[0],Xt=new Array(256);for(let ft=0;ft<256;ft++)Xt[ft]=Ht[ft]/255;Vt=Tt=Ct=Ut=Xt.join(",")}else{const[Ht,Xt,ft]=st,Z=new Array(256),K=new Array(256),At=new Array(256);for(let vt=0;vt<256;vt++)Z[vt]=Ht[vt]/255,K[vt]=Xt[vt]/255,At[vt]=ft[vt]/255;Tt=Z.join(","),Ct=K.join(","),Ut=At.join(","),Vt=`${Tt}${Ct}${Ut}`}if(pt=t(this,f,ue).get(Vt),pt)return t(this,f,ue).set(st,pt),pt;const Wt=`g_${t(this,dt)}_transfer_map_${me(this,h)._++}`,zt=`url(#${Wt})`;t(this,f,ue).set(st,zt),t(this,f,ue).set(Vt,zt);const Gt=Y(this,et,Ce).call(this,Wt);return Y(this,Ft,Ae).call(this,Tt,Ct,Ut,Gt),zt}addHCMFilter(st,pt){var Xt;const Tt=`${st}-${pt}`;if(t(this,wt)===Tt)return t(this,M);if(ot(this,wt,Tt),ot(this,M,"none"),(Xt=t(this,Et))==null||Xt.remove(),!st||!pt)return t(this,M);const Ct=Y(this,St,ye).call(this,st);st=d.Util.makeHexColor(...Ct);const Ut=Y(this,St,ye).call(this,pt);if(pt=d.Util.makeHexColor(...Ut),t(this,j,fe).style.color="",st==="#000000"&&pt==="#ffffff"||st===pt)return t(this,M);const Vt=new Array(256);for(let ft=0;ft<=255;ft++){const Z=ft/255;Vt[ft]=Z<=.03928?Z/12.92:((Z+.055)/1.055)**2.4}const Wt=Vt.join(","),zt=`g_${t(this,dt)}_hcm_filter`,Gt=ot(this,i,Y(this,et,Ce).call(this,zt));Y(this,Ft,Ae).call(this,Wt,Wt,Wt,Gt),Y(this,it,Qe).call(this,Gt);const Ht=(ft,Z)=>{const K=Ct[ft]/255,At=Ut[ft]/255,vt=new Array(Z+1);for(let ee=0;ee<=Z;ee++)vt[ee]=K+ee/Z*(At-K);return vt.join(",")};return Y(this,Ft,Ae).call(this,Ht(0,5),Ht(1,5),Ht(2,5),Gt),ot(this,M,`url(#${zt})`),t(this,M)}addHighlightHCMFilter(st,pt,Tt,Ct){var At;const Ut=`${st}-${pt}-${Tt}-${Ct}`;if(t(this,o)===Ut)return t(this,a);if(ot(this,o,Ut),ot(this,a,"none"),(At=t(this,i))==null||At.remove(),!st||!pt)return t(this,a);const[Vt,Wt]=[st,pt].map(Y(this,St,ye).bind(this));let zt=Math.round(.2126*Vt[0]+.7152*Vt[1]+.0722*Vt[2]),Gt=Math.round(.2126*Wt[0]+.7152*Wt[1]+.0722*Wt[2]),[Ht,Xt]=[Tt,Ct].map(Y(this,St,ye).bind(this));Gt<zt&&([zt,Gt,Ht,Xt]=[Gt,zt,Xt,Ht]),t(this,j,fe).style.color="";const ft=(vt,ee,te)=>{const Q=new Array(256),xt=(Gt-zt)/te,It=vt/255,Pt=(ee-vt)/(255*te);let Nt=0;for(let jt=0;jt<=te;jt++){const Qt=Math.round(zt+jt*xt),yt=It+jt*Pt;for(let Kt=Nt;Kt<=Qt;Kt++)Q[Kt]=yt;Nt=Qt+1}for(let jt=Nt;jt<256;jt++)Q[jt]=Q[Nt-1];return Q.join(",")},Z=`g_${t(this,dt)}_hcm_highlight_filter`,K=ot(this,i,Y(this,et,Ce).call(this,Z));return Y(this,it,Qe).call(this,K),Y(this,Ft,Ae).call(this,ft(Ht[0],Xt[0],5),ft(Ht[1],Xt[1],5),ft(Ht[2],Xt[2],5),K),ot(this,a,`url(#${Z})`),t(this,a)}destroy(st=!1){st&&(t(this,M)||t(this,a))||(t(this,V)&&(t(this,V).parentNode.parentNode.remove(),ot(this,V,null)),t(this,ct)&&(t(this,ct).clear(),ot(this,ct,null)),ot(this,h,0))}}ct=new WeakMap,V=new WeakMap,dt=new WeakMap,mt=new WeakMap,Et=new WeakMap,wt=new WeakMap,M=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,h=new WeakMap,f=new WeakSet,ue=function(){return t(this,ct)||ot(this,ct,new Map)},j=new WeakSet,fe=function(){if(!t(this,V)){const st=t(this,mt).createElement("div"),{style:pt}=st;pt.visibility="hidden",pt.contain="strict",pt.width=pt.height=0,pt.position="absolute",pt.top=pt.left=0,pt.zIndex=-1;const Tt=t(this,mt).createElementNS($,"svg");Tt.setAttribute("width",0),Tt.setAttribute("height",0),ot(this,V,t(this,mt).createElementNS($,"defs")),st.append(Tt),Tt.append(t(this,V)),t(this,mt).body.append(st)}return t(this,V)},it=new WeakSet,Qe=function(st){const pt=t(this,mt).createElementNS($,"feColorMatrix");pt.setAttribute("type","matrix"),pt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),st.append(pt)},et=new WeakSet,Ce=function(st){const pt=t(this,mt).createElementNS($,"filter");return pt.setAttribute("color-interpolation-filters","sRGB"),pt.setAttribute("id",st),t(this,j,fe).append(pt),pt},bt=new WeakSet,Pe=function(st,pt,Tt){const Ct=t(this,mt).createElementNS($,pt);Ct.setAttribute("type","discrete"),Ct.setAttribute("tableValues",Tt),st.append(Ct)},Ft=new WeakSet,Ae=function(st,pt,Tt,Ct){const Ut=t(this,mt).createElementNS($,"feComponentTransfer");Ct.append(Ut),Y(this,bt,Pe).call(this,Ut,"feFuncR",st),Y(this,bt,Pe).call(this,Ut,"feFuncG",pt),Y(this,bt,Pe).call(this,Ut,"feFuncB",Tt)},St=new WeakSet,ye=function(st){return t(this,j,fe).style.color=st,b(getComputedStyle(t(this,j,fe)).getPropertyValue("color"))},e.DOMFilterFactory=rt;class k extends n.BaseCanvasFactory{constructor({ownerDocument:nt=globalThis.document}={}){super(),this._document=nt}_createCanvas(nt,st){const pt=this._document.createElement("canvas");return pt.width=nt,pt.height=st,pt}}e.DOMCanvasFactory=k;async function A(gt,nt=!1){if(y(gt,document.baseURI)){const st=await fetch(gt);if(!st.ok)throw new Error(st.statusText);return nt?new Uint8Array(await st.arrayBuffer()):(0,d.stringToBytes)(await st.text())}return new Promise((st,pt)=>{const Tt=new XMLHttpRequest;Tt.open("GET",gt,!0),nt&&(Tt.responseType="arraybuffer"),Tt.onreadystatechange=()=>{if(Tt.readyState===XMLHttpRequest.DONE){if(Tt.status===200||Tt.status===0){let Ct;if(nt&&Tt.response?Ct=new Uint8Array(Tt.response):!nt&&Tt.responseText&&(Ct=(0,d.stringToBytes)(Tt.responseText)),Ct){st(Ct);return}}pt(new Error(Tt.statusText))}},Tt.send(null)})}class m extends n.BaseCMapReaderFactory{_fetchData(nt,st){return A(nt,this.isCompressed).then(pt=>({cMapData:pt,compressionType:st}))}}e.DOMCMapReaderFactory=m;class L extends n.BaseStandardFontDataFactory{_fetchData(nt){return A(nt,!0)}}e.DOMStandardFontDataFactory=L;class N extends n.BaseSVGFactory{_createSVG(nt){return document.createElementNS($,nt)}}e.DOMSVGFactory=N;class P{constructor({viewBox:nt,scale:st,rotation:pt,offsetX:Tt=0,offsetY:Ct=0,dontFlip:Ut=!1}){this.viewBox=nt,this.scale=st,this.rotation=pt,this.offsetX=Tt,this.offsetY=Ct;const Vt=(nt[2]+nt[0])/2,Wt=(nt[3]+nt[1])/2;let zt,Gt,Ht,Xt;switch(pt%=360,pt<0&&(pt+=360),pt){case 180:zt=-1,Gt=0,Ht=0,Xt=1;break;case 90:zt=0,Gt=1,Ht=1,Xt=0;break;case 270:zt=0,Gt=-1,Ht=-1,Xt=0;break;case 0:zt=1,Gt=0,Ht=0,Xt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ut&&(Ht=-Ht,Xt=-Xt);let ft,Z,K,At;zt===0?(ft=Math.abs(Wt-nt[1])*st+Tt,Z=Math.abs(Vt-nt[0])*st+Ct,K=(nt[3]-nt[1])*st,At=(nt[2]-nt[0])*st):(ft=Math.abs(Vt-nt[0])*st+Tt,Z=Math.abs(Wt-nt[1])*st+Ct,K=(nt[2]-nt[0])*st,At=(nt[3]-nt[1])*st),this.transform=[zt*st,Gt*st,Ht*st,Xt*st,ft-zt*st*Vt-Ht*st*Wt,Z-Gt*st*Vt-Xt*st*Wt],this.width=K,this.height=At}get rawDims(){const{viewBox:nt}=this;return(0,d.shadow)(this,"rawDims",{pageWidth:nt[2]-nt[0],pageHeight:nt[3]-nt[1],pageX:nt[0],pageY:nt[1]})}clone({scale:nt=this.scale,rotation:st=this.rotation,offsetX:pt=this.offsetX,offsetY:Tt=this.offsetY,dontFlip:Ct=!1}={}){return new P({viewBox:this.viewBox.slice(),scale:nt,rotation:st,offsetX:pt,offsetY:Tt,dontFlip:Ct})}convertToViewportPoint(nt,st){return d.Util.applyTransform([nt,st],this.transform)}convertToViewportRectangle(nt){const st=d.Util.applyTransform([nt[0],nt[1]],this.transform),pt=d.Util.applyTransform([nt[2],nt[3]],this.transform);return[st[0],st[1],pt[0],pt[1]]}convertToPdfPoint(nt,st){return d.Util.applyInverseTransform([nt,st],this.transform)}}e.PageViewport=P;class x extends d.BaseException{constructor(nt,st=0){super(nt,"RenderingCancelledException"),this.extraDelay=st}}e.RenderingCancelledException=x;function w(gt){const nt=gt.length;let st=0;for(;st<nt&&gt[st].trim()==="";)st++;return gt.substring(st,st+5).toLowerCase()==="data:"}function g(gt){return typeof gt=="string"&&/\.pdf$/i.test(gt)}function v(gt,nt=!1){return nt||([gt]=gt.split(/[#?]/,1)),gt.substring(gt.lastIndexOf("/")+1)}function R(gt,nt="document.pdf"){if(typeof gt!="string")return nt;if(w(gt))return(0,d.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),nt;const st=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,pt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Tt=st.exec(gt);let Ct=pt.exec(Tt[1])||pt.exec(Tt[2])||pt.exec(Tt[3]);if(Ct&&(Ct=Ct[0],Ct.includes("%")))try{Ct=pt.exec(decodeURIComponent(Ct))[0]}catch{}return Ct||nt}class C{constructor(){ne(this,"started",Object.create(null));ne(this,"times",[])}time(nt){nt in this.started&&(0,d.warn)(`Timer is already running for ${nt}`),this.started[nt]=Date.now()}timeEnd(nt){nt in this.started||(0,d.warn)(`Timer has not been started for ${nt}`),this.times.push({name:nt,start:this.started[nt],end:Date.now()}),delete this.started[nt]}toString(){const nt=[];let st=0;for(const{name:pt}of this.times)st=Math.max(pt.length,st);for(const{name:pt,start:Tt,end:Ct}of this.times)nt.push(`${pt.padEnd(st)} ${Ct-Tt}ms
`);return nt.join("")}}e.StatTimer=C;function y(gt,nt){try{const{protocol:st}=nt?new URL(gt,nt):new URL(gt);return st==="http:"||st==="https:"}catch{return!1}}function l(gt){gt.preventDefault()}function u(gt,nt=!1){return new Promise((st,pt)=>{const Tt=document.createElement("script");Tt.src=gt,Tt.onload=function(Ct){nt&&Tt.remove(),st(Ct)},Tt.onerror=function(){pt(new Error(`Cannot load script at: ${Tt.src}`))},(document.head||document.documentElement).append(Tt)})}function O(gt){console.log("Deprecated API usage: "+gt)}let _;class c{static toDateObject(nt){if(!nt||typeof nt!="string")return null;_||(_=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const st=_.exec(nt);if(!st)return null;const pt=parseInt(st[1],10);let Tt=parseInt(st[2],10);Tt=Tt>=1&&Tt<=12?Tt-1:0;let Ct=parseInt(st[3],10);Ct=Ct>=1&&Ct<=31?Ct:1;let Ut=parseInt(st[4],10);Ut=Ut>=0&&Ut<=23?Ut:0;let Vt=parseInt(st[5],10);Vt=Vt>=0&&Vt<=59?Vt:0;let Wt=parseInt(st[6],10);Wt=Wt>=0&&Wt<=59?Wt:0;const zt=st[7]||"Z";let Gt=parseInt(st[8],10);Gt=Gt>=0&&Gt<=23?Gt:0;let Ht=parseInt(st[9],10)||0;return Ht=Ht>=0&&Ht<=59?Ht:0,zt==="-"?(Ut+=Gt,Vt+=Ht):zt==="+"&&(Ut-=Gt,Vt-=Ht),new Date(Date.UTC(pt,Tt,Ct,Ut,Vt,Wt))}}e.PDFDateString=c;function F(gt,{scale:nt=1,rotation:st=0}){const{width:pt,height:Tt}=gt.attributes.style,Ct=[0,0,parseInt(pt),parseInt(Tt)];return new P({viewBox:Ct,scale:nt,rotation:st})}function b(gt){if(gt.startsWith("#")){const nt=parseInt(gt.slice(1),16);return[(nt&16711680)>>16,(nt&65280)>>8,nt&255]}return gt.startsWith("rgb(")?gt.slice(4,-1).split(",").map(nt=>parseInt(nt)):gt.startsWith("rgba(")?gt.slice(5,-1).split(",").map(nt=>parseInt(nt)).slice(0,3):((0,d.warn)(`Not a valid color format: "${gt}"`),[0,0,0])}function G(gt){const nt=document.createElement("span");nt.style.visibility="hidden",document.body.append(nt);for(const st of gt.keys()){nt.style.color=st;const pt=window.getComputedStyle(nt).color;gt.set(st,b(pt))}nt.remove()}function z(gt){const{a:nt,b:st,c:pt,d:Tt,e:Ct,f:Ut}=gt.getTransform();return[nt,st,pt,Tt,Ct,Ut]}function E(gt){const{a:nt,b:st,c:pt,d:Tt,e:Ct,f:Ut}=gt.getTransform().invertSelf();return[nt,st,pt,Tt,Ct,Ut]}function X(gt,nt,st=!1,pt=!0){if(nt instanceof P){const{pageWidth:Tt,pageHeight:Ct}=nt.rawDims,{style:Ut}=gt,Vt=d.FeatureTest.isCSSRoundSupported,Wt=`var(--scale-factor) * ${Tt}px`,zt=`var(--scale-factor) * ${Ct}px`,Gt=Vt?`round(${Wt}, 1px)`:`calc(${Wt})`,Ht=Vt?`round(${zt}, 1px)`:`calc(${zt})`;!st||nt.rotation%180===0?(Ut.width=Gt,Ut.height=Ht):(Ut.width=Ht,Ut.height=Gt)}pt&&gt.setAttribute("data-main-rotation",nt.rotation)}},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=D(1);class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,L){return"none"}addHighlightHCMFilter(m,L,N,P){return"none"}destroy(m=!1){}}e.BaseFilterFactory=d;class ${constructor(){this.constructor===$&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,L){if(m<=0||L<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(m,L);return{canvas:N,context:N.getContext("2d")}}reset(m,L,N){if(!m.canvas)throw new Error("Canvas is not specified");if(L<=0||N<=0)throw new Error("Invalid canvas size");m.canvas.width=L,m.canvas.height=N}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,L){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=$;class I{constructor({baseUrl:m=null,isCompressed:L=!0}){this.constructor===I&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=L}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const L=this.baseUrl+m+(this.isCompressed?".bcmap":""),N=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(L,N).catch(P=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${L}`)})}_fetchData(m,L){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=I;class rt{constructor({baseUrl:m=null}){this.constructor===rt&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const L=`${this.baseUrl}${m}`;return this._fetchData(L).catch(N=>{throw new Error(`Unable to load font data at: ${L}`)})}_fetchData(m){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=rt;class k{constructor(){this.constructor===k&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,L,N=!1){if(m<=0||L<=0)throw new Error("Invalid SVG dimensions");const P=this._createSVG("svg:svg");return P.setAttribute("version","1.1"),N||(P.setAttribute("width",`${m}px`),P.setAttribute("height",`${L}px`)),P.setAttribute("preserveAspectRatio","none"),P.setAttribute("viewBox",`0 0 ${m} ${L}`),P}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=k},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=D(1);const d=3285377520,$=4294901760,I=65535;class rt{constructor(A){this.h1=A?A&4294967295:d,this.h2=A?A&4294967295:d}update(A){let m,L;if(typeof A=="string"){m=new Uint8Array(A.length*2),L=0;for(let O=0,_=A.length;O<_;O++){const c=A.charCodeAt(O);c<=255?m[L++]=c:(m[L++]=c>>>8,m[L++]=c&255)}}else if((0,n.isArrayBuffer)(A))m=A.slice(),L=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const N=L>>2,P=L-N*4,x=new Uint32Array(m.buffer,0,N);let w=0,g=0,v=this.h1,R=this.h2;const C=3432918353,y=461845907,l=C&I,u=y&I;for(let O=0;O<N;O++)O&1?(w=x[O],w=w*C&$|w*l&I,w=w<<15|w>>>17,w=w*y&$|w*u&I,v^=w,v=v<<13|v>>>19,v=v*5+3864292196):(g=x[O],g=g*C&$|g*l&I,g=g<<15|g>>>17,g=g*y&$|g*u&I,R^=g,R=R<<13|R>>>19,R=R*5+3864292196);switch(w=0,P){case 3:w^=m[N*4+2]<<16;case 2:w^=m[N*4+1]<<8;case 1:w^=m[N*4],w=w*C&$|w*l&I,w=w<<15|w>>>17,w=w*y&$|w*u&I,N&1?v^=w:R^=w}this.h1=v,this.h2=R}hexdigest(){let A=this.h1,m=this.h2;return A^=m>>>1,A=A*3981806797&$|A*36045&I,m=m*4283543511&$|((m<<16|A>>>16)*2950163797&$)>>>16,A^=m>>>1,A=A*444984403&$|A*60499&I,m=m*3301882366&$|((m<<16|A>>>16)*3120437893&$)>>>16,A^=m>>>1,(A>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=rt},(p,e,D)=>{var I;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=D(1);class d{constructor({ownerDocument:k=globalThis.document,styleElement:A=null}){H(this,I,new Set);this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const A=this.styleElement.sheet;A.insertRule(k,A.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),t(this,I).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(k){if(!(!k||t(this,I).has(k.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:A,src:m,style:L}=k,N=new FontFace(A,m,L);this.addNativeFontFace(N);try{await N.load(),t(this,I).add(A)}catch{(0,n.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(N)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k.systemFontInfo);return}if(this.isFontLoadingAPISupported){const m=k.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(L){throw(0,n.warn)(`Failed to load font '${m.family}': '${L}'.`),k.disableFontFace=!0,L}}return}const A=k.createFontFaceRule();if(A){if(this.insertRule(A),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const L=this._queueLoadingCallback(m);this._prepareFontLoadEvent(k,L)})}}get isFontLoadingAPISupported(){var A;const k=!!((A=this._document)!=null&&A.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function A(){for((0,n.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;m.length>0&&m[0].done;){const N=m.shift();setTimeout(N.callback,0)}}const{loadingRequests:m}=this,L={done:!1,complete:A,callback:k};return m.push(L),L}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,A){function m(b,G){return b.charCodeAt(G)<<24|b.charCodeAt(G+1)<<16|b.charCodeAt(G+2)<<8|b.charCodeAt(G+3)&255}function L(b,G,z,E){const X=b.substring(0,G),at=b.substring(G+z);return X+E+at}let N,P;const x=this._document.createElement("canvas");x.width=1,x.height=1;const w=x.getContext("2d");let g=0;function v(b,G){if(++g>30){(0,n.warn)("Load test font never loaded."),G();return}if(w.font="30px "+b,w.fillText(".",0,20),w.getImageData(0,0,1,1).data[3]>0){G();return}setTimeout(v.bind(null,b,G))}const R=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=L(C,976,R.length,R);const l=16,u=1482184792;let O=m(C,l);for(N=0,P=R.length-3;N<P;N+=4)O=O-u+m(R,N)|0;N<R.length&&(O=O-u+m(R+"XXX",N)|0),C=L(C,l,4,(0,n.string32)(O));const _=`url(data:font/opentype;base64,${btoa(C)});`,c=`@font-face {font-family:"${R}";src:${_}}`;this.insertRule(c);const F=this._document.createElement("div");F.style.visibility="hidden",F.style.width=F.style.height="10px",F.style.position="absolute",F.style.top=F.style.left="0px";for(const b of[k.loadedName,R]){const G=this._document.createElement("span");G.textContent="Hi",G.style.fontFamily=b,F.append(G)}this._document.body.append(F),v(R,()=>{F.remove(),A.complete()})}}I=new WeakMap,e.FontLoader=d;class ${constructor(k,{isEvalSupported:A=!0,disableFontFace:m=!1,ignoreErrors:L=!1,inspectFont:N=null}){this.compiledGlyphs=Object.create(null);for(const P in k)this[P]=k[P];this.isEvalSupported=A!==!1,this.disableFontFace=m===!0,this.ignoreErrors=L===!0,this._inspectFont=N}createNativeFontFace(){var A;if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(A=this._inspectFont)==null||A.call(this,this),k}createFontFaceRule(){var L;if(!this.data||this.disableFontFace)return null;const k=(0,n.bytesToString)(this.data),A=`url(data:${this.mimetype};base64,${btoa(k)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${A}}`;else{let N=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(N+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${N}src:${A}}`}return(L=this._inspectFont)==null||L.call(this,this,A),m}getPathGenerator(k,A){if(this.compiledGlyphs[A]!==void 0)return this.compiledGlyphs[A];let m;try{m=k.get(this.loadedName+"_path_"+A)}catch(L){if(!this.ignoreErrors)throw L;return(0,n.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[A]=function(N,P){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const L=[];for(const N of m){const P=N.args!==void 0?N.args.join(","):"";L.push("c.",N.cmd,"(",P,`);
`)}return this.compiledGlyphs[A]=new Function("c","size",L.join(""))}return this.compiledGlyphs[A]=function(L,N){for(const P of m)P.cmd==="scale"&&(P.args=[N,-N]),L[P.cmd].apply(L,P.args)}}}e.FontFaceObject=$},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=D(7);D(1);const d=function(A){return new Promise((m,L)=>{require$$5.readFile(A,(P,x)=>{if(P||!x){L(new Error(P));return}m(new Uint8Array(x))})})};class $ extends n.BaseFilterFactory{}e.NodeFilterFactory=$;class I extends n.BaseCanvasFactory{_createCanvas(m,L){return require$$5.createCanvas(m,L)}}e.NodeCanvasFactory=I;class rt extends n.BaseCMapReaderFactory{_fetchData(m,L){return d(m).then(N=>({cMapData:N,compressionType:L}))}}e.NodeCMapReaderFactory=rt;class k extends n.BaseStandardFontDataFactory{_fetchData(m){return d(m)}}e.NodeStandardFontDataFactory=k},(p,e,D)=>{var V,Ze,mt,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=D(1),d=D(6),$=D(12),I=D(13);const rt=16,k=100,A=4096,m=15,L=10,N=1e3,P=16;function x(M,i){if(M._removeMirroring)throw new Error("Context is already forwarding operations.");M.__originalSave=M.save,M.__originalRestore=M.restore,M.__originalRotate=M.rotate,M.__originalScale=M.scale,M.__originalTranslate=M.translate,M.__originalTransform=M.transform,M.__originalSetTransform=M.setTransform,M.__originalResetTransform=M.resetTransform,M.__originalClip=M.clip,M.__originalMoveTo=M.moveTo,M.__originalLineTo=M.lineTo,M.__originalBezierCurveTo=M.bezierCurveTo,M.__originalRect=M.rect,M.__originalClosePath=M.closePath,M.__originalBeginPath=M.beginPath,M._removeMirroring=()=>{M.save=M.__originalSave,M.restore=M.__originalRestore,M.rotate=M.__originalRotate,M.scale=M.__originalScale,M.translate=M.__originalTranslate,M.transform=M.__originalTransform,M.setTransform=M.__originalSetTransform,M.resetTransform=M.__originalResetTransform,M.clip=M.__originalClip,M.moveTo=M.__originalMoveTo,M.lineTo=M.__originalLineTo,M.bezierCurveTo=M.__originalBezierCurveTo,M.rect=M.__originalRect,M.closePath=M.__originalClosePath,M.beginPath=M.__originalBeginPath,delete M._removeMirroring},M.save=function(){i.save(),this.__originalSave()},M.restore=function(){i.restore(),this.__originalRestore()},M.translate=function(a,h){i.translate(a,h),this.__originalTranslate(a,h)},M.scale=function(a,h){i.scale(a,h),this.__originalScale(a,h)},M.transform=function(a,h,f,T,j,W){i.transform(a,h,f,T,j,W),this.__originalTransform(a,h,f,T,j,W)},M.setTransform=function(a,h,f,T,j,W){i.setTransform(a,h,f,T,j,W),this.__originalSetTransform(a,h,f,T,j,W)},M.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},M.rotate=function(a){i.rotate(a),this.__originalRotate(a)},M.clip=function(a){i.clip(a),this.__originalClip(a)},M.moveTo=function(o,a){i.moveTo(o,a),this.__originalMoveTo(o,a)},M.lineTo=function(o,a){i.lineTo(o,a),this.__originalLineTo(o,a)},M.bezierCurveTo=function(o,a,h,f,T,j){i.bezierCurveTo(o,a,h,f,T,j),this.__originalBezierCurveTo(o,a,h,f,T,j)},M.rect=function(o,a,h,f){i.rect(o,a,h,f),this.__originalRect(o,a,h,f)},M.closePath=function(){i.closePath(),this.__originalClosePath()},M.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class w{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,o,a){let h;return this.cache[i]!==void 0?(h=this.cache[i],this.canvasFactory.reset(h,o,a)):(h=this.canvasFactory.create(o,a),this.cache[i]=h),h}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const o=this.cache[i];this.canvasFactory.destroy(o),delete this.cache[i]}}}function g(M,i,o,a,h,f,T,j,W,it){const[tt,et,ht,bt,ut,Ft]=(0,d.getCurrentTransform)(M);if(et===0&&ht===0){const Lt=T*tt+ut,gt=Math.round(Lt),nt=j*bt+Ft,st=Math.round(nt),pt=(T+W)*tt+ut,Tt=Math.abs(Math.round(pt)-gt)||1,Ct=(j+it)*bt+Ft,Ut=Math.abs(Math.round(Ct)-st)||1;return M.setTransform(Math.sign(tt),0,0,Math.sign(bt),gt,st),M.drawImage(i,o,a,h,f,0,0,Tt,Ut),M.setTransform(tt,et,ht,bt,ut,Ft),[Tt,Ut]}if(tt===0&&bt===0){const Lt=j*ht+ut,gt=Math.round(Lt),nt=T*et+Ft,st=Math.round(nt),pt=(j+it)*ht+ut,Tt=Math.abs(Math.round(pt)-gt)||1,Ct=(T+W)*et+Ft,Ut=Math.abs(Math.round(Ct)-st)||1;return M.setTransform(0,Math.sign(et),Math.sign(ht),0,gt,st),M.drawImage(i,o,a,h,f,0,0,Ut,Tt),M.setTransform(tt,et,ht,bt,ut,Ft),[Ut,Tt]}M.drawImage(i,o,a,h,f,T,j,W,it);const Bt=Math.hypot(tt,et),St=Math.hypot(ht,bt);return[Bt*W,St*it]}function v(M){const{width:i,height:o}=M;if(i>N||o>N)return null;const a=1e3,h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),f=i+1;let T=new Uint8Array(f*(o+1)),j,W,it;const tt=i+7&-8;let et=new Uint8Array(tt*o),ht=0;for(const St of M.data){let Lt=128;for(;Lt>0;)et[ht++]=St&Lt?0:255,Lt>>=1}let bt=0;for(ht=0,et[ht]!==0&&(T[0]=1,++bt),W=1;W<i;W++)et[ht]!==et[ht+1]&&(T[W]=et[ht]?2:1,++bt),ht++;for(et[ht]!==0&&(T[W]=2,++bt),j=1;j<o;j++){ht=j*tt,it=j*f,et[ht-tt]!==et[ht]&&(T[it]=et[ht]?1:8,++bt);let St=(et[ht]?4:0)+(et[ht-tt]?8:0);for(W=1;W<i;W++)St=(St>>2)+(et[ht+1]?4:0)+(et[ht-tt+1]?8:0),h[St]&&(T[it+W]=h[St],++bt),ht++;if(et[ht-tt]!==et[ht]&&(T[it+W]=et[ht]?2:4,++bt),bt>a)return null}for(ht=tt*(o-1),it=j*f,et[ht]!==0&&(T[it]=8,++bt),W=1;W<i;W++)et[ht]!==et[ht+1]&&(T[it+W]=et[ht]?4:8,++bt),ht++;if(et[ht]!==0&&(T[it+W]=4,++bt),bt>a)return null;const ut=new Int32Array([0,f,-1,0,-f,0,0,0,1]),Ft=new Path2D;for(j=0;bt&&j<=o;j++){let St=j*f;const Lt=St+i;for(;St<Lt&&!T[St];)St++;if(St===Lt)continue;Ft.moveTo(St%f,j);const gt=St;let nt=T[St];do{const st=ut[nt];do St+=st;while(!T[St]);const pt=T[St];pt!==5&&pt!==10?(nt=pt,T[St]=0):(nt=pt&51*nt>>4,T[St]&=nt>>2|nt<<2),Ft.lineTo(St%f,St/f|0),T[St]||--bt}while(gt!==St);--j}return et=null,T=null,function(St){St.save(),St.scale(1/i,-1/o),St.translate(0,-o),St.fill(Ft),St.beginPath(),St.restore()}}class R{constructor(i,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,o])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,o){this.x=i,this.y=o}updatePathMinMax(i,o,a){[o,a]=n.Util.applyTransform([o,a],i),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,a),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,a)}updateRectMinMax(i,o){const a=n.Util.applyTransform(o,i),h=n.Util.applyTransform(o.slice(2),i);this.minX=Math.min(this.minX,a[0],h[0]),this.minY=Math.min(this.minY,a[1],h[1]),this.maxX=Math.max(this.maxX,a[0],h[0]),this.maxY=Math.max(this.maxY,a[1],h[1])}updateScalingPathMinMax(i,o){n.Util.scaleMinMax(i,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(i,o,a,h,f,T,j,W,it,tt){const et=n.Util.bezierBoundingBox(o,a,h,f,T,j,W,it);if(tt){tt[0]=Math.min(tt[0],et[0],et[2]),tt[1]=Math.max(tt[1],et[0],et[2]),tt[2]=Math.min(tt[2],et[1],et[3]),tt[3]=Math.max(tt[3],et[1],et[3]);return}this.updateRectMinMax(i,et)}getPathBoundingBox(i=$.PathType.FILL,o=null){const a=[this.minX,this.minY,this.maxX,this.maxY];if(i===$.PathType.STROKE){o||(0,n.unreachable)("Stroke bounding box must include transform.");const h=n.Util.singularValueDecompose2dScale(o),f=h[0]*this.lineWidth/2,T=h[1]*this.lineWidth/2;a[0]-=f,a[1]-=T,a[2]+=f,a[3]+=T}return a}updateClipFromPath(){const i=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=$.PathType.FILL,o=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(i,o))}}function C(M,i){if(typeof ImageData<"u"&&i instanceof ImageData){M.putImageData(i,0,0);return}const o=i.height,a=i.width,h=o%P,f=(o-h)/P,T=h===0?f:f+1,j=M.createImageData(a,P);let W=0,it;const tt=i.data,et=j.data;let ht,bt,ut,Ft;if(i.kind===n.ImageKind.GRAYSCALE_1BPP){const Bt=tt.byteLength,St=new Uint32Array(et.buffer,0,et.byteLength>>2),Lt=St.length,gt=a+7>>3,nt=4294967295,st=n.FeatureTest.isLittleEndian?4278190080:255;for(ht=0;ht<T;ht++){for(ut=ht<f?P:h,it=0,bt=0;bt<ut;bt++){const pt=Bt-W;let Tt=0;const Ct=pt>gt?a:pt*8-7,Ut=Ct&-8;let Vt=0,Wt=0;for(;Tt<Ut;Tt+=8)Wt=tt[W++],St[it++]=Wt&128?nt:st,St[it++]=Wt&64?nt:st,St[it++]=Wt&32?nt:st,St[it++]=Wt&16?nt:st,St[it++]=Wt&8?nt:st,St[it++]=Wt&4?nt:st,St[it++]=Wt&2?nt:st,St[it++]=Wt&1?nt:st;for(;Tt<Ct;Tt++)Vt===0&&(Wt=tt[W++],Vt=128),St[it++]=Wt&Vt?nt:st,Vt>>=1}for(;it<Lt;)St[it++]=0;M.putImageData(j,0,ht*P)}}else if(i.kind===n.ImageKind.RGBA_32BPP){for(bt=0,Ft=a*P*4,ht=0;ht<f;ht++)et.set(tt.subarray(W,W+Ft)),W+=Ft,M.putImageData(j,0,bt),bt+=P;ht<T&&(Ft=a*h*4,et.set(tt.subarray(W,W+Ft)),M.putImageData(j,0,bt))}else if(i.kind===n.ImageKind.RGB_24BPP)for(ut=P,Ft=a*ut,ht=0;ht<T;ht++){for(ht>=f&&(ut=h,Ft=a*ut),it=0,bt=Ft;bt--;)et[it++]=tt[W++],et[it++]=tt[W++],et[it++]=tt[W++],et[it++]=255;M.putImageData(j,0,ht*P)}else throw new Error(`bad image kind: ${i.kind}`)}function y(M,i){if(i.bitmap){M.drawImage(i.bitmap,0,0);return}const o=i.height,a=i.width,h=o%P,f=(o-h)/P,T=h===0?f:f+1,j=M.createImageData(a,P);let W=0;const it=i.data,tt=j.data;for(let et=0;et<T;et++){const ht=et<f?P:h;({srcPos:W}=(0,I.convertBlackAndWhiteToRGBA)({src:it,srcPos:W,dest:tt,width:a,height:ht,nonBlackColor:0})),M.putImageData(j,0,et*P)}}function l(M,i){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of o)M[a]!==void 0&&(i[a]=M[a]);M.setLineDash!==void 0&&(i.setLineDash(M.getLineDash()),i.lineDashOffset=M.lineDashOffset)}function u(M){if(M.strokeStyle=M.fillStyle="#000000",M.fillRule="nonzero",M.globalAlpha=1,M.lineWidth=1,M.lineCap="butt",M.lineJoin="miter",M.miterLimit=10,M.globalCompositeOperation="source-over",M.font="10px sans-serif",M.setLineDash!==void 0&&(M.setLineDash([]),M.lineDashOffset=0),!n.isNodeJS){const{filter:i}=M;i!=="none"&&i!==""&&(M.filter="none")}}function O(M,i,o,a){const h=M.length;for(let f=3;f<h;f+=4){const T=M[f];if(T===0)M[f-3]=i,M[f-2]=o,M[f-1]=a;else if(T<255){const j=255-T;M[f-3]=M[f-3]*T+i*j>>8,M[f-2]=M[f-2]*T+o*j>>8,M[f-1]=M[f-1]*T+a*j>>8}}}function _(M,i,o){const a=M.length,h=1/255;for(let f=3;f<a;f+=4){const T=o?o[M[f]]:M[f];i[f]=i[f]*T*h|0}}function c(M,i,o){const a=M.length;for(let h=3;h<a;h+=4){const f=M[h-3]*77+M[h-2]*152+M[h-1]*28;i[h]=o?i[h]*o[f>>8]>>8:i[h]*f>>16}}function F(M,i,o,a,h,f,T,j,W,it,tt){const et=!!f,ht=et?f[0]:0,bt=et?f[1]:0,ut=et?f[2]:0,Ft=h==="Luminosity"?c:_,St=Math.min(a,Math.ceil(1048576/o));for(let Lt=0;Lt<a;Lt+=St){const gt=Math.min(St,a-Lt),nt=M.getImageData(j-it,Lt+(W-tt),o,gt),st=i.getImageData(j,Lt+W,o,gt);et&&O(nt.data,ht,bt,ut),Ft(nt.data,st.data,T),i.putImageData(st,j,Lt+W)}}function b(M,i,o,a){const h=a[0],f=a[1],T=a[2]-h,j=a[3]-f;T===0||j===0||(F(i.context,o,T,j,i.subtype,i.backdrop,i.transferMap,h,f,i.offsetX,i.offsetY),M.save(),M.globalAlpha=1,M.globalCompositeOperation="source-over",M.setTransform(1,0,0,1,0,0),M.drawImage(o.canvas,0,0),M.restore())}function G(M,i){const o=n.Util.singularValueDecompose2dScale(M);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*d.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:o[0]<=a||o[1]<=a}const z=["butt","round","square"],E=["miter","round","bevel"],X={},at={},wt=class wt{constructor(i,o,a,h,f,{optionalContentConfig:T,markedContentStack:j=null},W,it){H(this,V);H(this,mt);this.ctx=i,this.current=new R(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=a,this.canvasFactory=h,this.filterFactory=f,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=j||[],this.optionalContentConfig=T,this.cachedCanvases=new w(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=W,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=it,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,o=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):o}beginDrawing({transform:i,viewport:o,transparency:a=!1,background:h=null}){const f=this.ctx.canvas.width,T=this.ctx.canvas.height,j=this.ctx.fillStyle;if(this.ctx.fillStyle=h||"#ffffff",this.ctx.fillRect(0,0,f,T),this.ctx.fillStyle=j,a){const W=this.cachedCanvases.getCanvas("transparent",f,T);this.compositeCtx=this.ctx,this.transparentCanvas=W.canvas,this.ctx=W.context,this.ctx.save(),this.ctx.transform(...(0,d.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),u(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,d.getCurrentTransform)(this.ctx)}executeOperatorList(i,o,a,h){const f=i.argsArray,T=i.fnArray;let j=o||0;const W=f.length;if(W===j)return j;const it=W-j>L&&typeof a=="function",tt=it?Date.now()+m:0;let et=0;const ht=this.commonObjs,bt=this.objs;let ut;for(;;){if(h!==void 0&&j===h.nextBreakPoint)return h.breakIt(j,a),j;if(ut=T[j],ut!==n.OPS.dependency)this[ut].apply(this,f[j]);else for(const Ft of f[j]){const Bt=Ft.startsWith("g_")?ht:bt;if(!Bt.has(Ft))return Bt.get(Ft,a),j}if(j++,j===W)return j;if(it&&++et>L){if(Date.now()>tt)return a(),j;et=0}}}endDrawing(){Y(this,V,Ze).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const o of i.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);i.clear()}this._cachedBitmapsMap.clear(),Y(this,mt,tn).call(this)}_scaleImage(i,o){const a=i.width,h=i.height;let f=Math.max(Math.hypot(o[0],o[1]),1),T=Math.max(Math.hypot(o[2],o[3]),1),j=a,W=h,it="prescale1",tt,et;for(;f>2&&j>1||T>2&&W>1;){let ht=j,bt=W;f>2&&j>1&&(ht=j>=16384?Math.floor(j/2)-1||1:Math.ceil(j/2),f/=j/ht),T>2&&W>1&&(bt=W>=16384?Math.floor(W/2)-1||1:Math.ceil(W)/2,T/=W/bt),tt=this.cachedCanvases.getCanvas(it,ht,bt),et=tt.context,et.clearRect(0,0,ht,bt),et.drawImage(i,0,0,j,W,0,0,ht,bt),i=tt.canvas,j=ht,W=bt,it=it==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:j,paintHeight:W}}_createMaskCanvas(i){const o=this.ctx,{width:a,height:h}=i,f=this.current.fillColor,T=this.current.patternFill,j=(0,d.getCurrentTransform)(o);let W,it,tt,et;if((i.bitmap||i.data)&&i.count>1){const Tt=i.bitmap||i.data.buffer;it=JSON.stringify(T?j:[j.slice(0,4),f]),W=this._cachedBitmapsMap.get(Tt),W||(W=new Map,this._cachedBitmapsMap.set(Tt,W));const Ct=W.get(it);if(Ct&&!T){const Ut=Math.round(Math.min(j[0],j[2])+j[4]),Vt=Math.round(Math.min(j[1],j[3])+j[5]);return{canvas:Ct,offsetX:Ut,offsetY:Vt}}tt=Ct}tt||(et=this.cachedCanvases.getCanvas("maskCanvas",a,h),y(et.context,i));let ht=n.Util.transform(j,[1/a,0,0,-1/h,0,0]);ht=n.Util.transform(ht,[1,0,0,1,0,-h]);const bt=n.Util.applyTransform([0,0],ht),ut=n.Util.applyTransform([a,h],ht),Ft=n.Util.normalizeRect([bt[0],bt[1],ut[0],ut[1]]),Bt=Math.round(Ft[2]-Ft[0])||1,St=Math.round(Ft[3]-Ft[1])||1,Lt=this.cachedCanvases.getCanvas("fillCanvas",Bt,St),gt=Lt.context,nt=Math.min(bt[0],ut[0]),st=Math.min(bt[1],ut[1]);gt.translate(-nt,-st),gt.transform(...ht),tt||(tt=this._scaleImage(et.canvas,(0,d.getCurrentTransformInverse)(gt)),tt=tt.img,W&&T&&W.set(it,tt)),gt.imageSmoothingEnabled=G((0,d.getCurrentTransform)(gt),i.interpolate),g(gt,tt,0,0,tt.width,tt.height,0,0,a,h),gt.globalCompositeOperation="source-in";const pt=n.Util.transform((0,d.getCurrentTransformInverse)(gt),[1,0,0,1,-nt,-st]);return gt.fillStyle=T?f.getPattern(o,this,pt,$.PathType.FILL):f,gt.fillRect(0,0,a,h),W&&!T&&(this.cachedCanvases.delete("fillCanvas"),W.set(it,Lt.canvas)),{canvas:Lt.canvas,offsetX:Math.round(nt),offsetY:Math.round(st)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=z[i]}setLineJoin(i){this.ctx.lineJoin=E[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,o){const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(i),a.lineDashOffset=o)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[o,a]of i)switch(o){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.current.fillAlpha=a,this.ctx.globalAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,o=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(a,i,o);this.suspendedCtx=this.ctx,this.ctx=h.context;const f=this.ctx;f.setTransform(...(0,d.getCurrentTransform)(this.suspendedCtx)),l(this.suspendedCtx,f),x(f,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),l(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,a=this.suspendedCtx;b(a,o,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(l(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),l(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,o,a,h,f,T){this.ctx.transform(i,o,a,h,f,T),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,o,a){const h=this.ctx,f=this.current;let T=f.x,j=f.y,W,it;const tt=(0,d.getCurrentTransform)(h),et=tt[0]===0&&tt[3]===0||tt[1]===0&&tt[2]===0,ht=et?a.slice(0):null;for(let bt=0,ut=0,Ft=i.length;bt<Ft;bt++)switch(i[bt]|0){case n.OPS.rectangle:T=o[ut++],j=o[ut++];const Bt=o[ut++],St=o[ut++],Lt=T+Bt,gt=j+St;h.moveTo(T,j),Bt===0||St===0?h.lineTo(Lt,gt):(h.lineTo(Lt,j),h.lineTo(Lt,gt),h.lineTo(T,gt)),et||f.updateRectMinMax(tt,[T,j,Lt,gt]),h.closePath();break;case n.OPS.moveTo:T=o[ut++],j=o[ut++],h.moveTo(T,j),et||f.updatePathMinMax(tt,T,j);break;case n.OPS.lineTo:T=o[ut++],j=o[ut++],h.lineTo(T,j),et||f.updatePathMinMax(tt,T,j);break;case n.OPS.curveTo:W=T,it=j,T=o[ut+4],j=o[ut+5],h.bezierCurveTo(o[ut],o[ut+1],o[ut+2],o[ut+3],T,j),f.updateCurvePathMinMax(tt,W,it,o[ut],o[ut+1],o[ut+2],o[ut+3],T,j,ht),ut+=6;break;case n.OPS.curveTo2:W=T,it=j,h.bezierCurveTo(T,j,o[ut],o[ut+1],o[ut+2],o[ut+3]),f.updateCurvePathMinMax(tt,W,it,T,j,o[ut],o[ut+1],o[ut+2],o[ut+3],ht),T=o[ut+2],j=o[ut+3],ut+=4;break;case n.OPS.curveTo3:W=T,it=j,T=o[ut+2],j=o[ut+3],h.bezierCurveTo(o[ut],o[ut+1],T,j,T,j),f.updateCurvePathMinMax(tt,W,it,o[ut],o[ut+1],T,j,T,j,ht),ut+=4;break;case n.OPS.closePath:h.closePath();break}et&&f.updateScalingPathMinMax(tt,ht),f.setCurrentPoint(T,j)}closePath(){this.ctx.closePath()}stroke(i=!0){const o=this.ctx,a=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof a=="object"&&(a!=null&&a.getPattern)?(o.save(),o.strokeStyle=a.getPattern(o,this,(0,d.getCurrentTransformInverse)(o),$.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const o=this.ctx,a=this.current.fillColor,h=this.current.patternFill;let f=!1;h&&(o.save(),o.fillStyle=a.getPattern(o,this,(0,d.getCurrentTransformInverse)(o),$.PathType.FILL),f=!0);const T=this.current.getClippedPathBoundingBox();this.contentVisible&&T!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),f&&o.restore(),i&&this.consumePath(T)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=X}eoClip(){this.pendingClip=at}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,o=this.ctx;if(i===void 0){o.beginPath();return}o.save(),o.beginPath();for(const a of i)o.setTransform(...a.transform),o.translate(a.x,a.y),a.addToPath(o,a.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,o){var tt;const a=this.commonObjs.get(i),h=this.current;if(!a)throw new Error(`Can't find font for ${i}`);if(h.fontMatrix=a.fontMatrix||n.FONT_IDENTITY_MATRIX,(h.fontMatrix[0]===0||h.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+i),o<0?(o=-o,h.fontDirection=-1):h.fontDirection=1,this.current.font=a,this.current.fontSize=o,a.isType3Font)return;const f=a.loadedName||"sans-serif",T=((tt=a.systemFontInfo)==null?void 0:tt.css)||`"${f}", ${a.fallbackName}`;let j="normal";a.black?j="900":a.bold&&(j="bold");const W=a.italic?"italic":"normal";let it=o;o<rt?it=rt:o>k&&(it=k),this.current.fontSizeScale=o/it,this.ctx.font=`${W} ${j} ${it}px ${T}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,o){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=o}setLeadingMoveText(i,o){this.setLeading(-o),this.moveText(i,o)}setTextMatrix(i,o,a,h,f,T){this.current.textMatrix=[i,o,a,h,f,T],this.current.textMatrixScale=Math.hypot(i,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,o,a,h){const f=this.ctx,T=this.current,j=T.font,W=T.textRenderingMode,it=T.fontSize/T.fontSizeScale,tt=W&n.TextRenderingMode.FILL_STROKE_MASK,et=!!(W&n.TextRenderingMode.ADD_TO_PATH_FLAG),ht=T.patternFill&&!j.missingFile;let bt;(j.disableFontFace||et||ht)&&(bt=j.getPathGenerator(this.commonObjs,i)),j.disableFontFace||ht?(f.save(),f.translate(o,a),f.beginPath(),bt(f,it),h&&f.setTransform(...h),(tt===n.TextRenderingMode.FILL||tt===n.TextRenderingMode.FILL_STROKE)&&f.fill(),(tt===n.TextRenderingMode.STROKE||tt===n.TextRenderingMode.FILL_STROKE)&&f.stroke(),f.restore()):((tt===n.TextRenderingMode.FILL||tt===n.TextRenderingMode.FILL_STROKE)&&f.fillText(i,o,a),(tt===n.TextRenderingMode.STROKE||tt===n.TextRenderingMode.FILL_STROKE)&&f.strokeText(i,o,a)),et&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,d.getCurrentTransform)(f),x:o,y:a,fontSize:it,addToPath:bt})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const o=i.getImageData(0,0,10,10).data;let a=!1;for(let h=3;h<o.length;h+=4)if(o[h]>0&&o[h]<255){a=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",a)}showText(i){const o=this.current,a=o.font;if(a.isType3Font)return this.showType3Text(i);const h=o.fontSize;if(h===0)return;const f=this.ctx,T=o.fontSizeScale,j=o.charSpacing,W=o.wordSpacing,it=o.fontDirection,tt=o.textHScale*it,et=i.length,ht=a.vertical,bt=ht?1:-1,ut=a.defaultVMetrics,Ft=h*o.fontMatrix[0],Bt=o.textRenderingMode===n.TextRenderingMode.FILL&&!a.disableFontFace&&!o.patternFill;f.save(),f.transform(...o.textMatrix),f.translate(o.x,o.y+o.textRise),it>0?f.scale(tt,-1):f.scale(tt,1);let St;if(o.patternFill){f.save();const pt=o.fillColor.getPattern(f,this,(0,d.getCurrentTransformInverse)(f),$.PathType.FILL);St=(0,d.getCurrentTransform)(f),f.restore(),f.fillStyle=pt}let Lt=o.lineWidth;const gt=o.textMatrixScale;if(gt===0||Lt===0){const pt=o.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(pt===n.TextRenderingMode.STROKE||pt===n.TextRenderingMode.FILL_STROKE)&&(Lt=this.getSinglePixelWidth())}else Lt/=gt;if(T!==1&&(f.scale(T,T),Lt/=T),f.lineWidth=Lt,a.isInvalidPDFjsFont){const pt=[];let Tt=0;for(const Ct of i)pt.push(Ct.unicode),Tt+=Ct.width;f.fillText(pt.join(""),0,0),o.x+=Tt*Ft*tt,f.restore(),this.compose();return}let nt=0,st;for(st=0;st<et;++st){const pt=i[st];if(typeof pt=="number"){nt+=bt*pt*h/1e3;continue}let Tt=!1;const Ct=(pt.isSpace?W:0)+j,Ut=pt.fontChar,Vt=pt.accent;let Wt,zt,Gt=pt.width;if(ht){const Xt=pt.vmetric||ut,ft=-(pt.vmetric?Xt[1]:Gt*.5)*Ft,Z=Xt[2]*Ft;Gt=Xt?-Xt[0]:Gt,Wt=ft/T,zt=(nt+Z)/T}else Wt=nt/T,zt=0;if(a.remeasure&&Gt>0){const Xt=f.measureText(Ut).width*1e3/h*T;if(Gt<Xt&&this.isFontSubpixelAAEnabled){const ft=Gt/Xt;Tt=!0,f.save(),f.scale(ft,1),Wt/=ft}else Gt!==Xt&&(Wt+=(Gt-Xt)/2e3*h/T)}if(this.contentVisible&&(pt.isInFont||a.missingFile)){if(Bt&&!Vt)f.fillText(Ut,Wt,zt);else if(this.paintChar(Ut,Wt,zt,St),Vt){const Xt=Wt+h*Vt.offset.x/T,ft=zt-h*Vt.offset.y/T;this.paintChar(Vt.fontChar,Xt,ft,St)}}const Ht=ht?Gt*Ft-Ct*it:Gt*Ft+Ct*it;nt+=Ht,Tt&&f.restore()}ht?o.y-=nt:o.x+=nt*tt,f.restore(),this.compose()}showType3Text(i){const o=this.ctx,a=this.current,h=a.font,f=a.fontSize,T=a.fontDirection,j=h.vertical?1:-1,W=a.charSpacing,it=a.wordSpacing,tt=a.textHScale*T,et=a.fontMatrix||n.FONT_IDENTITY_MATRIX,ht=i.length,bt=a.textRenderingMode===n.TextRenderingMode.INVISIBLE;let ut,Ft,Bt,St;if(!(bt||f===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...a.textMatrix),o.translate(a.x,a.y),o.scale(tt,T),ut=0;ut<ht;++ut){if(Ft=i[ut],typeof Ft=="number"){St=j*Ft*f/1e3,this.ctx.translate(St,0),a.x+=St*tt;continue}const Lt=(Ft.isSpace?it:0)+W,gt=h.charProcOperatorList[Ft.operatorListId];if(!gt){(0,n.warn)(`Type3 character "${Ft.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Ft,this.save(),o.scale(f,f),o.transform(...et),this.executeOperatorList(gt),this.restore()),Bt=n.Util.applyTransform([Ft.width,0],et)[0]*f+Lt,o.translate(Bt,0),a.x+=Bt*tt}o.restore(),this.processingType3=null}}setCharWidth(i,o){}setCharWidthAndBounds(i,o,a,h,f,T){this.ctx.rect(a,h,f-a,T-h),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let o;if(i[0]==="TilingPattern"){const a=i[1],h=this.baseTransform||(0,d.getCurrentTransform)(this.ctx),f={createCanvasGraphics:T=>new wt(T,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};o=new $.TilingPattern(i,a,this.ctx,f,h)}else o=this._getPattern(i[1],i[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,o,a){const h=n.Util.makeHexColor(i,o,a);this.ctx.strokeStyle=h,this.current.strokeColor=h}setFillRGBColor(i,o,a){const h=n.Util.makeHexColor(i,o,a);this.ctx.fillStyle=h,this.current.fillColor=h,this.current.patternFill=!1}_getPattern(i,o=null){let a;return this.cachedPatterns.has(i)?a=this.cachedPatterns.get(i):(a=(0,$.getShadingPattern)(this.getObject(i)),this.cachedPatterns.set(i,a)),o&&(a.matrix=o),a}shadingFill(i){if(!this.contentVisible)return;const o=this.ctx;this.save();const a=this._getPattern(i);o.fillStyle=a.getPattern(o,this,(0,d.getCurrentTransformInverse)(o),$.PathType.SHADING);const h=(0,d.getCurrentTransformInverse)(o);if(h){const{width:f,height:T}=o.canvas,[j,W,it,tt]=n.Util.getAxialAlignedBoundingBox([0,0,f,T],h);this.ctx.fillRect(j,W,it-j,tt-W)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,d.getCurrentTransform)(this.ctx),o)){const a=o[2]-o[0],h=o[3]-o[1];this.ctx.rect(o[0],o[1],a,h),this.current.updateRectMinMax((0,d.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;i.isolated||(0,n.info)("TODO: Support non-isolated groups."),i.knockout&&(0,n.warn)("Knockout groups not supported.");const a=(0,d.getCurrentTransform)(o);if(i.matrix&&o.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let h=n.Util.getAxialAlignedBoundingBox(i.bbox,(0,d.getCurrentTransform)(o));const f=[0,0,o.canvas.width,o.canvas.height];h=n.Util.intersect(h,f)||[0,0,0,0];const T=Math.floor(h[0]),j=Math.floor(h[1]);let W=Math.max(Math.ceil(h[2])-T,1),it=Math.max(Math.ceil(h[3])-j,1),tt=1,et=1;W>A&&(tt=W/A,W=A),it>A&&(et=it/A,it=A),this.current.startNewPathAndClipBox([0,0,W,it]);let ht="groupAt"+this.groupLevel;i.smask&&(ht+="_smask_"+this.smaskCounter++%2);const bt=this.cachedCanvases.getCanvas(ht,W,it),ut=bt.context;ut.scale(1/tt,1/et),ut.translate(-T,-j),ut.transform(...a),i.smask?this.smaskStack.push({canvas:bt.canvas,context:ut,offsetX:T,offsetY:j,scaleX:tt,scaleY:et,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(T,j),o.scale(tt,et),o.save()),l(o,ut),this.ctx=ut,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const h=(0,d.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...h);const f=n.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],h);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(f)}}beginAnnotation(i,o,a,h,f){if(Y(this,V,Ze).call(this),u(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const T=o[2]-o[0],j=o[3]-o[1];if(f&&this.annotationCanvasMap){a=a.slice(),a[4]-=o[0],a[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=T,o[3]=j;const[W,it]=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(this.ctx)),{viewportScale:tt}=this,et=Math.ceil(T*this.outputScaleX*tt),ht=Math.ceil(j*this.outputScaleY*tt);this.annotationCanvas=this.canvasFactory.create(et,ht);const{canvas:bt,context:ut}=this.annotationCanvas;this.annotationCanvasMap.set(i,bt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ut,this.ctx.save(),this.ctx.setTransform(W,0,0,-it,0,j*it),u(this.ctx)}else u(this.ctx),this.ctx.rect(o[0],o[1],T,j),this.ctx.clip(),this.endPath()}this.current=new R(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...a),this.transform(...h)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,mt,tn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const o=i.count;i=this.getObject(i.data,i),i.count=o;const a=this.ctx,h=this.processingType3;if(h&&(h.compiled===void 0&&(h.compiled=v(i)),h.compiled)){h.compiled(a);return}const f=this._createMaskCanvas(i),T=f.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(T,f.offsetX,f.offsetY),a.restore(),this.compose()}paintImageMaskXObjectRepeat(i,o,a=0,h=0,f,T){if(!this.contentVisible)return;i=this.getObject(i.data,i);const j=this.ctx;j.save();const W=(0,d.getCurrentTransform)(j);j.transform(o,a,h,f,0,0);const it=this._createMaskCanvas(i);j.setTransform(1,0,0,1,it.offsetX-W[4],it.offsetY-W[5]);for(let tt=0,et=T.length;tt<et;tt+=2){const ht=n.Util.transform(W,[o,a,h,f,T[tt],T[tt+1]]),[bt,ut]=n.Util.applyTransform([0,0],ht);j.drawImage(it.canvas,bt,ut)}j.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const o=this.ctx,a=this.current.fillColor,h=this.current.patternFill;for(const f of i){const{data:T,width:j,height:W,transform:it}=f,tt=this.cachedCanvases.getCanvas("maskCanvas",j,W),et=tt.context;et.save();const ht=this.getObject(T,f);y(et,ht),et.globalCompositeOperation="source-in",et.fillStyle=h?a.getPattern(et,this,(0,d.getCurrentTransformInverse)(o),$.PathType.FILL):a,et.fillRect(0,0,j,W),et.restore(),o.save(),o.transform(...it),o.scale(1,-1),g(o,tt.canvas,0,0,j,W,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const o=this.getObject(i);if(!o){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(i,o,a,h){if(!this.contentVisible)return;const f=this.getObject(i);if(!f){(0,n.warn)("Dependent image isn't ready yet");return}const T=f.width,j=f.height,W=[];for(let it=0,tt=h.length;it<tt;it+=2)W.push({transform:[o,0,0,a,h[it],h[it+1]],x:0,y:0,w:T,h:j});this.paintInlineImageXObjectGroup(f,W)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:o,width:a,height:h}=i,f=this.cachedCanvases.getCanvas("inlineImage",a,h),T=f.context;return T.filter=this.current.transferMaps,T.drawImage(o,0,0),T.filter="none",f.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const o=i.width,a=i.height,h=this.ctx;if(this.save(),!n.isNodeJS){const{filter:j}=h;j!=="none"&&j!==""&&(h.filter="none")}h.scale(1/o,-1/a);let f;if(i.bitmap)f=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)f=i;else{const W=this.cachedCanvases.getCanvas("inlineImage",o,a).context;C(W,i),f=this.applyTransferMapsToCanvas(W)}const T=this._scaleImage(f,(0,d.getCurrentTransformInverse)(h));h.imageSmoothingEnabled=G((0,d.getCurrentTransform)(h),i.interpolate),g(h,T.img,0,0,T.paintWidth,T.paintHeight,0,-a,o,a),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,o){if(!this.contentVisible)return;const a=this.ctx;let h;if(i.bitmap)h=i.bitmap;else{const f=i.width,T=i.height,W=this.cachedCanvases.getCanvas("inlineImage",f,T).context;C(W,i),h=this.applyTransferMapsToCanvas(W)}for(const f of o)a.save(),a.transform(...f.transform),a.scale(1,-1),g(a,h,f.x,f.y,f.w,f.h,0,-1,1,1),a.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,o){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,o){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const a=this.ctx;this.pendingClip&&(o||(this.pendingClip===at?a.clip("evenodd"):a.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),a.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,d.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const o=Math.abs(i[0]*i[3]-i[2]*i[1]),a=Math.hypot(i[0],i[2]),h=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(a,h)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:o,b:a,c:h,d:f}=this.ctx.getTransform();let T,j;if(a===0&&h===0){const W=Math.abs(o),it=Math.abs(f);if(W===it)if(i===0)T=j=1/W;else{const tt=W*i;T=j=tt<1?1/tt:1}else if(i===0)T=1/W,j=1/it;else{const tt=W*i,et=it*i;T=tt<1?1/tt:1,j=et<1?1/et:1}}else{const W=Math.abs(o*f-a*h),it=Math.hypot(o,a),tt=Math.hypot(h,f);if(i===0)T=tt/W,j=it/W;else{const et=i*W;T=tt>et?tt/et:1,j=it>et?it/et:1}}this._cachedScaleForStroking[0]=T,this._cachedScaleForStroking[1]=j}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:o}=this,{lineWidth:a}=this.current,[h,f]=this.getScaleForStroking();if(o.lineWidth=a||1,h===1&&f===1){o.stroke();return}const T=o.getLineDash();if(i&&o.save(),o.scale(h,f),T.length>0){const j=Math.max(h,f);o.setLineDash(T.map(W=>W/j)),o.lineDashOffset/=j}o.stroke(),i&&o.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};V=new WeakSet,Ze=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},mt=new WeakSet,tn=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const o=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=o}}};let ct=wt;e.CanvasGraphics=ct;for(const M in n.OPS)ct.prototype[M]!==void 0&&(ct.prototype[n.OPS[M]]=ct.prototype[M])},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=P;var n=D(1),d=D(6);const $={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=$;function I(v,R){if(!R)return;const C=R[2]-R[0],y=R[3]-R[1],l=new Path2D;l.rect(R[0],R[1],C,y),v.clip(l)}class rt{constructor(){this.constructor===rt&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class k extends rt{constructor(R){super(),this._type=R[1],this._bbox=R[2],this._colorStops=R[3],this._p0=R[4],this._p1=R[5],this._r0=R[6],this._r1=R[7],this.matrix=null}_createGradient(R){let C;this._type==="axial"?C=R.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=R.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const y of this._colorStops)C.addColorStop(y[0],y[1]);return C}getPattern(R,C,y,l){let u;if(l===$.STROKE||l===$.FILL){const O=C.current.getClippedPathBoundingBox(l,(0,d.getCurrentTransform)(R))||[0,0,0,0],_=Math.ceil(O[2]-O[0])||1,c=Math.ceil(O[3]-O[1])||1,F=C.cachedCanvases.getCanvas("pattern",_,c,!0),b=F.context;b.clearRect(0,0,b.canvas.width,b.canvas.height),b.beginPath(),b.rect(0,0,b.canvas.width,b.canvas.height),b.translate(-O[0],-O[1]),y=n.Util.transform(y,[1,0,0,1,O[0],O[1]]),b.transform(...C.baseTransform),this.matrix&&b.transform(...this.matrix),I(b,this._bbox),b.fillStyle=this._createGradient(b),b.fill(),u=R.createPattern(F.canvas,"no-repeat");const G=new DOMMatrix(y);u.setTransform(G)}else I(R,this._bbox),u=this._createGradient(R);return u}}function A(v,R,C,y,l,u,O,_){const c=R.coords,F=R.colors,b=v.data,G=v.width*4;let z;c[C+1]>c[y+1]&&(z=C,C=y,y=z,z=u,u=O,O=z),c[y+1]>c[l+1]&&(z=y,y=l,l=z,z=O,O=_,_=z),c[C+1]>c[y+1]&&(z=C,C=y,y=z,z=u,u=O,O=z);const E=(c[C]+R.offsetX)*R.scaleX,X=(c[C+1]+R.offsetY)*R.scaleY,at=(c[y]+R.offsetX)*R.scaleX,ct=(c[y+1]+R.offsetY)*R.scaleY,V=(c[l]+R.offsetX)*R.scaleX,dt=(c[l+1]+R.offsetY)*R.scaleY;if(X>=dt)return;const mt=F[u],Et=F[u+1],wt=F[u+2],M=F[O],i=F[O+1],o=F[O+2],a=F[_],h=F[_+1],f=F[_+2],T=Math.round(X),j=Math.round(dt);let W,it,tt,et,ht,bt,ut,Ft;for(let Bt=T;Bt<=j;Bt++){if(Bt<ct){const st=Bt<X?0:(X-Bt)/(X-ct);W=E-(E-at)*st,it=mt-(mt-M)*st,tt=Et-(Et-i)*st,et=wt-(wt-o)*st}else{let st;Bt>dt?st=1:ct===dt?st=0:st=(ct-Bt)/(ct-dt),W=at-(at-V)*st,it=M-(M-a)*st,tt=i-(i-h)*st,et=o-(o-f)*st}let St;Bt<X?St=0:Bt>dt?St=1:St=(X-Bt)/(X-dt),ht=E-(E-V)*St,bt=mt-(mt-a)*St,ut=Et-(Et-h)*St,Ft=wt-(wt-f)*St;const Lt=Math.round(Math.min(W,ht)),gt=Math.round(Math.max(W,ht));let nt=G*Bt+Lt*4;for(let st=Lt;st<=gt;st++)St=(W-st)/(W-ht),St<0?St=0:St>1&&(St=1),b[nt++]=it-(it-bt)*St|0,b[nt++]=tt-(tt-ut)*St|0,b[nt++]=et-(et-Ft)*St|0,b[nt++]=255}}function m(v,R,C){const y=R.coords,l=R.colors;let u,O;switch(R.type){case"lattice":const _=R.verticesPerRow,c=Math.floor(y.length/_)-1,F=_-1;for(u=0;u<c;u++){let b=u*_;for(let G=0;G<F;G++,b++)A(v,C,y[b],y[b+1],y[b+_],l[b],l[b+1],l[b+_]),A(v,C,y[b+_+1],y[b+1],y[b+_],l[b+_+1],l[b+1],l[b+_])}break;case"triangles":for(u=0,O=y.length;u<O;u+=3)A(v,C,y[u],y[u+1],y[u+2],l[u],l[u+1],l[u+2]);break;default:throw new Error("illegal figure")}}class L extends rt{constructor(R){super(),this._coords=R[2],this._colors=R[3],this._figures=R[4],this._bounds=R[5],this._bbox=R[7],this._background=R[8],this.matrix=null}_createMeshCanvas(R,C,y){const _=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),F=Math.ceil(this._bounds[2])-_,b=Math.ceil(this._bounds[3])-c,G=Math.min(Math.ceil(Math.abs(F*R[0]*1.1)),3e3),z=Math.min(Math.ceil(Math.abs(b*R[1]*1.1)),3e3),E=F/G,X=b/z,at={coords:this._coords,colors:this._colors,offsetX:-_,offsetY:-c,scaleX:1/E,scaleY:1/X},ct=G+2*2,V=z+2*2,dt=y.getCanvas("mesh",ct,V,!1),mt=dt.context,Et=mt.createImageData(G,z);if(C){const M=Et.data;for(let i=0,o=M.length;i<o;i+=4)M[i]=C[0],M[i+1]=C[1],M[i+2]=C[2],M[i+3]=255}for(const M of this._figures)m(Et,M,at);return mt.putImageData(Et,2,2),{canvas:dt.canvas,offsetX:_-2*E,offsetY:c-2*X,scaleX:E,scaleY:X}}getPattern(R,C,y,l){I(R,this._bbox);let u;if(l===$.SHADING)u=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(R));else if(u=n.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const _=n.Util.singularValueDecompose2dScale(this.matrix);u=[u[0]*_[0],u[1]*_[1]]}const O=this._createMeshCanvas(u,l===$.SHADING?null:this._background,C.cachedCanvases);return l!==$.SHADING&&(R.setTransform(...C.baseTransform),this.matrix&&R.transform(...this.matrix)),R.translate(O.offsetX,O.offsetY),R.scale(O.scaleX,O.scaleY),R.createPattern(O.canvas,"no-repeat")}}class N extends rt{getPattern(){return"hotpink"}}function P(v){switch(v[0]){case"RadialAxial":return new k(v);case"Mesh":return new L(v);case"Dummy":return new N}throw new Error(`Unknown IR type: ${v[0]}`)}const x={COLORED:1,UNCOLORED:2},g=class g{constructor(R,C,y,l,u){this.operatorList=R[2],this.matrix=R[3]||[1,0,0,1,0,0],this.bbox=R[4],this.xstep=R[5],this.ystep=R[6],this.paintType=R[7],this.tilingType=R[8],this.color=C,this.ctx=y,this.canvasGraphicsFactory=l,this.baseTransform=u}createPatternCanvas(R){const C=this.operatorList,y=this.bbox,l=this.xstep,u=this.ystep,O=this.paintType,_=this.tilingType,c=this.color,F=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+_);const b=y[0],G=y[1],z=y[2],E=y[3],X=n.Util.singularValueDecompose2dScale(this.matrix),at=n.Util.singularValueDecompose2dScale(this.baseTransform),ct=[X[0]*at[0],X[1]*at[1]],V=this.getSizeAndScale(l,this.ctx.canvas.width,ct[0]),dt=this.getSizeAndScale(u,this.ctx.canvas.height,ct[1]),mt=R.cachedCanvases.getCanvas("pattern",V.size,dt.size,!0),Et=mt.context,wt=F.createCanvasGraphics(Et);wt.groupLevel=R.groupLevel,this.setFillAndStrokeStyleToContext(wt,O,c);let M=b,i=G,o=z,a=E;return b<0&&(M=0,o+=Math.abs(b)),G<0&&(i=0,a+=Math.abs(G)),Et.translate(-(V.scale*M),-(dt.scale*i)),wt.transform(V.scale,0,0,dt.scale,0,0),Et.save(),this.clipBbox(wt,M,i,o,a),wt.baseTransform=(0,d.getCurrentTransform)(wt.ctx),wt.executeOperatorList(C),wt.endDrawing(),{canvas:mt.canvas,scaleX:V.scale,scaleY:dt.scale,offsetX:M,offsetY:i}}getSizeAndScale(R,C,y){R=Math.abs(R);const l=Math.max(g.MAX_PATTERN_SIZE,C);let u=Math.ceil(R*y);return u>=l?u=l:y=u/R,{scale:y,size:u}}clipBbox(R,C,y,l,u){const O=l-C,_=u-y;R.ctx.rect(C,y,O,_),R.current.updateRectMinMax((0,d.getCurrentTransform)(R.ctx),[C,y,l,u]),R.clip(),R.endPath()}setFillAndStrokeStyleToContext(R,C,y){const l=R.ctx,u=R.current;switch(C){case x.COLORED:const O=this.ctx;l.fillStyle=O.fillStyle,l.strokeStyle=O.strokeStyle,u.fillColor=O.fillStyle,u.strokeColor=O.strokeStyle;break;case x.UNCOLORED:const _=n.Util.makeHexColor(y[0],y[1],y[2]);l.fillStyle=_,l.strokeStyle=_,u.fillColor=_,u.strokeColor=_;break;default:throw new n.FormatError(`Unsupported paint type: ${C}`)}}getPattern(R,C,y,l){let u=y;l!==$.SHADING&&(u=n.Util.transform(u,C.baseTransform),this.matrix&&(u=n.Util.transform(u,this.matrix)));const O=this.createPatternCanvas(C);let _=new DOMMatrix(u);_=_.translate(O.offsetX,O.offsetY),_=_.scale(1/O.scaleX,1/O.scaleY);const c=R.createPattern(O.canvas,"repeat");return c.setTransform(_),c}};ne(g,"MAX_PATTERN_SIZE",3e3);let w=g;e.TilingPattern=w},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=$,e.convertToRGBA=d,e.grayToRGBA=rt;var n=D(1);function d(k){switch(k.kind){case n.ImageKind.GRAYSCALE_1BPP:return $(k);case n.ImageKind.RGB_24BPP:return I(k)}return null}function $({src:k,srcPos:A=0,dest:m,width:L,height:N,nonBlackColor:P=4294967295,inverseDecode:x=!1}){const w=n.FeatureTest.isLittleEndian?4278190080:255,[g,v]=x?[P,w]:[w,P],R=L>>3,C=L&7,y=k.length;m=new Uint32Array(m.buffer);let l=0;for(let u=0;u<N;u++){for(const _=A+R;A<_;A++){const c=A<y?k[A]:255;m[l++]=c&128?v:g,m[l++]=c&64?v:g,m[l++]=c&32?v:g,m[l++]=c&16?v:g,m[l++]=c&8?v:g,m[l++]=c&4?v:g,m[l++]=c&2?v:g,m[l++]=c&1?v:g}if(C===0)continue;const O=A<y?k[A++]:255;for(let _=0;_<C;_++)m[l++]=O&1<<7-_?v:g}return{srcPos:A,destPos:l}}function I({src:k,srcPos:A=0,dest:m,destPos:L=0,width:N,height:P}){let x=0;const w=k.length>>2,g=new Uint32Array(k.buffer,A,w);if(n.FeatureTest.isLittleEndian){for(;x<w-2;x+=3,L+=4){const v=g[x],R=g[x+1],C=g[x+2];m[L]=v|4278190080,m[L+1]=v>>>24|R<<8|4278190080,m[L+2]=R>>>16|C<<16|4278190080,m[L+3]=C>>>8|4278190080}for(let v=x*4,R=k.length;v<R;v+=3)m[L++]=k[v]|k[v+1]<<8|k[v+2]<<16|4278190080}else{for(;x<w-2;x+=3,L+=4){const v=g[x],R=g[x+1],C=g[x+2];m[L]=v|255,m[L+1]=v<<24|R>>>8|255,m[L+2]=R<<16|C>>>16|255,m[L+3]=C<<8|255}for(let v=x*4,R=k.length;v<R;v+=3)m[L++]=k[v]<<24|k[v+1]<<16|k[v+2]<<8|255}return{srcPos:A,destPos:L}}function rt(k,A){if(n.FeatureTest.isLittleEndian)for(let m=0,L=k.length;m<L;m++)A[m]=k[m]*65793|4278190080;else for(let m=0,L=k.length;m<L;m++)A[m]=k[m]*16843008|255}},(p,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const D=Object.create(null);e.GlobalWorkerOptions=D,D.workerPort=null,D.workerSrc=""},(p,e,D)=>{var k,kn,m,Fn,N,Re;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=D(1);const d={UNKNOWN:0,DATA:1,ERROR:2},$={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function I(x){switch(x instanceof Error||typeof x=="object"&&x!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),x.name){case"AbortException":return new n.AbortException(x.message);case"MissingPDFException":return new n.MissingPDFException(x.message);case"PasswordException":return new n.PasswordException(x.message,x.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(x.message,x.status);case"UnknownErrorException":return new n.UnknownErrorException(x.message,x.details);default:return new n.UnknownErrorException(x.message,x.toString())}}class rt{constructor(w,g,v){H(this,k);H(this,m);H(this,N);this.sourceName=w,this.targetName=g,this.comObj=v,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=R=>{const C=R.data;if(C.targetName!==this.sourceName)return;if(C.stream){Y(this,m,Fn).call(this,C);return}if(C.callback){const l=C.callbackId,u=this.callbackCapabilities[l];if(!u)throw new Error(`Cannot resolve callback ${l}`);if(delete this.callbackCapabilities[l],C.callback===d.DATA)u.resolve(C.data);else if(C.callback===d.ERROR)u.reject(I(C.reason));else throw new Error("Unexpected callback case");return}const y=this.actionHandler[C.action];if(!y)throw new Error(`Unknown action from worker: ${C.action}`);if(C.callbackId){const l=this.sourceName,u=C.sourceName;new Promise(function(O){O(y(C.data))}).then(function(O){v.postMessage({sourceName:l,targetName:u,callback:d.DATA,callbackId:C.callbackId,data:O})},function(O){v.postMessage({sourceName:l,targetName:u,callback:d.ERROR,callbackId:C.callbackId,reason:I(O)})});return}if(C.streamId){Y(this,k,kn).call(this,C);return}y(C.data)},v.addEventListener("message",this._onComObjOnMessage)}on(w,g){const v=this.actionHandler;if(v[w])throw new Error(`There is already an actionName called "${w}"`);v[w]=g}send(w,g,v){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:w,data:g},v)}sendWithPromise(w,g,v){const R=this.callbackId++,C=new n.PromiseCapability;this.callbackCapabilities[R]=C;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:w,callbackId:R,data:g},v)}catch(y){C.reject(y)}return C.promise}sendWithStream(w,g,v,R){const C=this.streamId++,y=this.sourceName,l=this.targetName,u=this.comObj;return new ReadableStream({start:O=>{const _=new n.PromiseCapability;return this.streamControllers[C]={controller:O,startCall:_,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:y,targetName:l,action:w,streamId:C,data:g,desiredSize:O.desiredSize},R),_.promise},pull:O=>{const _=new n.PromiseCapability;return this.streamControllers[C].pullCall=_,u.postMessage({sourceName:y,targetName:l,stream:$.PULL,streamId:C,desiredSize:O.desiredSize}),_.promise},cancel:O=>{(0,n.assert)(O instanceof Error,"cancel must have a valid reason");const _=new n.PromiseCapability;return this.streamControllers[C].cancelCall=_,this.streamControllers[C].isClosed=!0,u.postMessage({sourceName:y,targetName:l,stream:$.CANCEL,streamId:C,reason:I(O)}),_.promise}},v)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}k=new WeakSet,kn=function(w){const g=w.streamId,v=this.sourceName,R=w.sourceName,C=this.comObj,y=this,l=this.actionHandler[w.action],u={enqueue(O,_=1,c){if(this.isCancelled)return;const F=this.desiredSize;this.desiredSize-=_,F>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),C.postMessage({sourceName:v,targetName:R,stream:$.ENQUEUE,streamId:g,chunk:O},c)},close(){this.isCancelled||(this.isCancelled=!0,C.postMessage({sourceName:v,targetName:R,stream:$.CLOSE,streamId:g}),delete y.streamSinks[g])},error(O){(0,n.assert)(O instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,C.postMessage({sourceName:v,targetName:R,stream:$.ERROR,streamId:g,reason:I(O)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:w.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[g]=u,new Promise(function(O){O(l(w.data,u))}).then(function(){C.postMessage({sourceName:v,targetName:R,stream:$.START_COMPLETE,streamId:g,success:!0})},function(O){C.postMessage({sourceName:v,targetName:R,stream:$.START_COMPLETE,streamId:g,reason:I(O)})})},m=new WeakSet,Fn=function(w){const g=w.streamId,v=this.sourceName,R=w.sourceName,C=this.comObj,y=this.streamControllers[g],l=this.streamSinks[g];switch(w.stream){case $.START_COMPLETE:w.success?y.startCall.resolve():y.startCall.reject(I(w.reason));break;case $.PULL_COMPLETE:w.success?y.pullCall.resolve():y.pullCall.reject(I(w.reason));break;case $.PULL:if(!l){C.postMessage({sourceName:v,targetName:R,stream:$.PULL_COMPLETE,streamId:g,success:!0});break}l.desiredSize<=0&&w.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=w.desiredSize,new Promise(function(u){var O;u((O=l.onPull)==null?void 0:O.call(l))}).then(function(){C.postMessage({sourceName:v,targetName:R,stream:$.PULL_COMPLETE,streamId:g,success:!0})},function(u){C.postMessage({sourceName:v,targetName:R,stream:$.PULL_COMPLETE,streamId:g,reason:I(u)})});break;case $.ENQUEUE:if((0,n.assert)(y,"enqueue should have stream controller"),y.isClosed)break;y.controller.enqueue(w.chunk);break;case $.CLOSE:if((0,n.assert)(y,"close should have stream controller"),y.isClosed)break;y.isClosed=!0,y.controller.close(),Y(this,N,Re).call(this,y,g);break;case $.ERROR:(0,n.assert)(y,"error should have stream controller"),y.controller.error(I(w.reason)),Y(this,N,Re).call(this,y,g);break;case $.CANCEL_COMPLETE:w.success?y.cancelCall.resolve():y.cancelCall.reject(I(w.reason)),Y(this,N,Re).call(this,y,g);break;case $.CANCEL:if(!l)break;new Promise(function(u){var O;u((O=l.onCancel)==null?void 0:O.call(l,I(w.reason)))}).then(function(){C.postMessage({sourceName:v,targetName:R,stream:$.CANCEL_COMPLETE,streamId:g,success:!0})},function(u){C.postMessage({sourceName:v,targetName:R,stream:$.CANCEL_COMPLETE,streamId:g,reason:I(u)})}),l.sinkCapability.reject(I(w.reason)),l.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}},N=new WeakSet,Re=async function(w,g){var v,R,C;await Promise.allSettled([(v=w.startCall)==null?void 0:v.promise,(R=w.pullCall)==null?void 0:R.promise,(C=w.cancelCall)==null?void 0:C.promise]),delete this.streamControllers[g]},e.MessageHandler=rt},(p,e,D)=>{var $,I;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=D(1);class d{constructor({parsedData:k,rawData:A}){H(this,$,void 0);H(this,I,void 0);ot(this,$,k),ot(this,I,A)}getRaw(){return t(this,I)}get(k){return t(this,$).get(k)??null}getAll(){return(0,n.objectFromMap)(t(this,$))}has(k){return t(this,$).has(k)}}$=new WeakMap,I=new WeakMap,e.Metadata=d},(p,e,D)=>{var k,A,m,L,N,P,en;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=D(1),d=D(8);const $=Symbol("INTERNAL");class I{constructor(g,v){H(this,k,!0);this.name=g,this.intent=v}get visible(){return t(this,k)}_setVisible(g,v){g!==$&&(0,n.unreachable)("Internal method `_setVisible` called."),ot(this,k,v)}}k=new WeakMap;class rt{constructor(g){H(this,P);H(this,A,null);H(this,m,new Map);H(this,L,null);H(this,N,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,ot(this,N,g.order);for(const v of g.groups)t(this,m).set(v.id,new I(v.name,v.intent));if(g.baseState==="OFF")for(const v of t(this,m).values())v._setVisible($,!1);for(const v of g.on)t(this,m).get(v)._setVisible($,!0);for(const v of g.off)t(this,m).get(v)._setVisible($,!1);ot(this,L,this.getHash())}}isVisible(g){if(t(this,m).size===0)return!0;if(!g)return(0,n.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return t(this,m).has(g.id)?t(this,m).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return Y(this,P,en).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const v of g.ids){if(!t(this,m).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(t(this,m).get(v).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const v of g.ids){if(!t(this,m).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(!t(this,m).get(v).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const v of g.ids){if(!t(this,m).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(!t(this,m).get(v).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const v of g.ids){if(!t(this,m).has(v))return(0,n.warn)(`Optional content group not found: ${v}`),!0;if(t(this,m).get(v).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,v=!0){if(!t(this,m).has(g)){(0,n.warn)(`Optional content group not found: ${g}`);return}t(this,m).get(g)._setVisible($,!!v),ot(this,A,null)}get hasInitialVisibility(){return t(this,L)===null||this.getHash()===t(this,L)}getOrder(){return t(this,m).size?t(this,N)?t(this,N).slice():[...t(this,m).keys()]:null}getGroups(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}getGroup(g){return t(this,m).get(g)||null}getHash(){if(t(this,A)!==null)return t(this,A);const g=new d.MurmurHash3_64;for(const[v,R]of t(this,m))g.update(`${v}:${R.visible}`);return ot(this,A,g.hexdigest())}}A=new WeakMap,m=new WeakMap,L=new WeakMap,N=new WeakMap,P=new WeakSet,en=function(g){const v=g.length;if(v<2)return!0;const R=g[0];for(let C=1;C<v;C++){const y=g[C];let l;if(Array.isArray(y))l=Y(this,P,en).call(this,y);else if(t(this,m).has(y))l=t(this,m).get(y).visible;else return(0,n.warn)(`Optional content group not found: ${y}`),!0;switch(R){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return R==="And"},e.OptionalContentConfig=rt},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=D(1),d=D(6);class ${constructor({length:A,initialData:m,progressiveDone:L=!1,contentDispositionFilename:N=null,disableRange:P=!1,disableStream:x=!1},w){if((0,n.assert)(w,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=L,this._contentDispositionFilename=N,(m==null?void 0:m.length)>0){const g=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=w,this._isStreamingSupported=!x,this._isRangeSupported=!P,this._contentLength=A,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,v)=>{this._onReceiveData({begin:g,chunk:v})}),this._pdfDataRangeTransport.addProgressListener((g,v)=>{this._onProgress({loaded:g,total:v})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:A,chunk:m}){const L=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(A===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(L):this._queuedChunks.push(L);else{const N=this._rangeReaders.some(function(P){return P._begin!==A?!1:(P._enqueue(L),!0)});(0,n.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var A;return((A=this._fullRequestReader)==null?void 0:A._loaded)??0}_onProgress(A){var m,L,N,P;A.total===void 0?(L=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||L.call(m,{loaded:A.loaded}):(P=(N=this._fullRequestReader)==null?void 0:N.onProgress)==null||P.call(N,{loaded:A.loaded,total:A.total})}_onProgressiveDone(){var A;(A=this._fullRequestReader)==null||A.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(A){const m=this._rangeReaders.indexOf(A);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const A=this._queuedChunks;return this._queuedChunks=null,new I(this,A,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(A,m){if(m<=this._progressiveDataLength)return null;const L=new rt(this,A,m);return this._pdfDataRangeTransport.requestDataRange(A,m),this._rangeReaders.push(L),L}cancelAllRequests(A){var m;(m=this._fullRequestReader)==null||m.cancel(A);for(const L of this._rangeReaders.slice(0))L.cancel(A);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=$;class I{constructor(A,m,L=!1,N=null){this._stream=A,this._done=L||!1,this._filename=(0,d.isPdfFile)(N)?N:null,this._queuedChunks=m||[],this._loaded=0;for(const P of this._queuedChunks)this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),A._fullRequestReader=this,this.onProgress=null}_enqueue(A){this._done||(this._requests.length>0?this._requests.shift().resolve({value:A,done:!1}):this._queuedChunks.push(A),this._loaded+=A.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=new n.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class rt{constructor(A,m,L){this._stream=A,this._begin=m,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(A){if(!this._done){if(this._requests.length===0)this._queuedChunk=A;else{this._requests.shift().resolve({value:A,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const A=new n.PromiseCapability;return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=D(1),d=D(20);function $(L,N,P){return{method:"GET",headers:L,signal:P.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function I(L){const N=new Headers;for(const P in L){const x=L[P];x!==void 0&&N.append(P,x)}return N}function rt(L){return L instanceof Uint8Array?L.buffer:L instanceof ArrayBuffer?L:((0,n.warn)(`getArrayBuffer - unexpected data format: ${L}`),new Uint8Array(L).buffer)}class k{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N;return((N=this._fullRequestReader)==null?void 0:N._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new A(this),this._fullRequestReader}getRangeReader(N,P){if(P<=this._progressiveDataLength)return null;const x=new m(this,N,P);return this._rangeRequestReaders.push(x),x}cancelAllRequests(N){var P;(P=this._fullRequestReader)==null||P.cancel(N);for(const x of this._rangeRequestReaders.slice(0))x.cancel(N)}}e.PDFFetchStream=k;class A{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const P=N.source;this._withCredentials=P.withCredentials||!1,this._contentLength=P.length,this._headersCapability=new n.PromiseCapability,this._disableRange=P.disableRange||!1,this._rangeChunkSize=P.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!P.disableStream,this._isRangeSupported=!P.disableRange,this._headers=I(this._stream.httpHeaders);const x=P.url;fetch(x,$(this._headers,this._withCredentials,this._abortController)).then(w=>{if(!(0,d.validateResponseStatus)(w.status))throw(0,d.createResponseStatusError)(w.status,x);this._reader=w.body.getReader(),this._headersCapability.resolve();const g=C=>w.headers.get(C),{allowRangeRequests:v,suggestedLength:R}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=R||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;await this._headersCapability.promise;const{value:N,done:P}=await this._reader.read();return P?{value:N,done:P}:(this._loaded+=N.byteLength,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded,total:this._contentLength}),{value:rt(N),done:!1})}cancel(N){var P;(P=this._reader)==null||P.cancel(N),this._abortController.abort()}}class m{constructor(N,P,x){this._stream=N,this._reader=null,this._loaded=0;const w=N.source;this._withCredentials=w.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!w.disableStream,this._abortController=new AbortController,this._headers=I(this._stream.httpHeaders),this._headers.append("Range",`bytes=${P}-${x-1}`);const g=w.url;fetch(g,$(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,d.validateResponseStatus)(v.status))throw(0,d.createResponseStatusError)(v.status,g);this._readCapability.resolve(),this._reader=v.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;await this._readCapability.promise;const{value:N,done:P}=await this._reader.read();return P?{value:N,done:P}:(this._loaded+=N.byteLength,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded}),{value:rt(N),done:!1})}cancel(N){var P;(P=this._reader)==null||P.cancel(N),this._abortController.abort()}}},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=k,e.extractFilenameFromHeader=rt,e.validateRangeRequestCapabilities=I,e.validateResponseStatus=A;var n=D(1),d=D(21),$=D(6);function I({getResponseHeader:m,isHttp:L,rangeChunkSize:N,disableRange:P}){const x={allowRangeRequests:!1,suggestedLength:void 0},w=parseInt(m("Content-Length"),10);return!Number.isInteger(w)||(x.suggestedLength=w,w<=2*N)||P||!L||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(x.allowRangeRequests=!0),x}function rt(m){const L=m("Content-Disposition");if(L){let N=(0,d.getFilenameFromContentDispositionHeader)(L);if(N.includes("%"))try{N=decodeURIComponent(N)}catch{}if((0,$.isPdfFile)(N))return N}return null}function k(m,L){return m===404||m===0&&L.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+L+'".'):new n.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${L}".`,m)}function A(m){return m===200||m===206}},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=d;var n=D(1);function d($){let I=!0,rt=k("filename\\*","i").exec($);if(rt){rt=rt[1];let w=N(rt);return w=unescape(w),w=P(w),w=x(w),m(w)}if(rt=L($),rt){const w=x(rt);return m(w)}if(rt=k("filename","i").exec($),rt){rt=rt[1];let w=N(rt);return w=x(w),m(w)}function k(w,g){return new RegExp("(?:^|;)\\s*"+w+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function A(w,g){if(w){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const v=new TextDecoder(w,{fatal:!0}),R=(0,n.stringToBytes)(g);g=v.decode(R),I=!1}catch{}}return g}function m(w){return I&&/[\x80-\xff]/.test(w)&&(w=A("utf-8",w),I&&(w=A("iso-8859-1",w))),w}function L(w){const g=[];let v;const R=k("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=R.exec(w))!==null;){let[,y,l,u]=v;if(y=parseInt(y,10),y in g){if(y===0)break;continue}g[y]=[l,u]}const C=[];for(let y=0;y<g.length&&y in g;++y){let[l,u]=g[y];u=N(u),l&&(u=unescape(u),y===0&&(u=P(u))),C.push(u)}return C.join("")}function N(w){if(w.startsWith('"')){const g=w.slice(1).split('\\"');for(let v=0;v<g.length;++v){const R=g[v].indexOf('"');R!==-1&&(g[v]=g[v].slice(0,R),g.length=v+1),g[v]=g[v].replaceAll(/\\(.)/g,"$1")}w=g.join('"')}return w}function P(w){const g=w.indexOf("'");if(g===-1)return w;const v=w.slice(0,g),C=w.slice(g+1).replace(/^[^']*'/,"");return A(v,C)}function x(w){return!w.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(w)?w:w.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,v,R,C){if(R==="q"||R==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,l){return String.fromCharCode(parseInt(l,16))}),A(v,C);try{C=atob(C)}catch{}return A(v,C)})}return""}},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=D(1),d=D(20);const $=200,I=206;function rt(N){const P=N.response;return typeof P!="string"?P:(0,n.stringToBytes)(P).buffer}class k{constructor(P,x={}){this.url=P,this.isHttp=/^https?:/i.test(P),this.httpHeaders=this.isHttp&&x.httpHeaders||Object.create(null),this.withCredentials=x.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(P,x,w){const g={begin:P,end:x};for(const v in w)g[v]=w[v];return this.request(g)}requestFull(P){return this.request(P)}request(P){const x=new XMLHttpRequest,w=this.currXhrId++,g=this.pendingRequests[w]={xhr:x};x.open("GET",this.url),x.withCredentials=this.withCredentials;for(const v in this.httpHeaders){const R=this.httpHeaders[v];R!==void 0&&x.setRequestHeader(v,R)}return this.isHttp&&"begin"in P&&"end"in P?(x.setRequestHeader("Range",`bytes=${P.begin}-${P.end-1}`),g.expectedStatus=I):g.expectedStatus=$,x.responseType="arraybuffer",P.onError&&(x.onerror=function(v){P.onError(x.status)}),x.onreadystatechange=this.onStateChange.bind(this,w),x.onprogress=this.onProgress.bind(this,w),g.onHeadersReceived=P.onHeadersReceived,g.onDone=P.onDone,g.onError=P.onError,g.onProgress=P.onProgress,x.send(null),w}onProgress(P,x){var g;const w=this.pendingRequests[P];w&&((g=w.onProgress)==null||g.call(w,x))}onStateChange(P,x){var y,l,u;const w=this.pendingRequests[P];if(!w)return;const g=w.xhr;if(g.readyState>=2&&w.onHeadersReceived&&(w.onHeadersReceived(),delete w.onHeadersReceived),g.readyState!==4||!(P in this.pendingRequests))return;if(delete this.pendingRequests[P],g.status===0&&this.isHttp){(y=w.onError)==null||y.call(w,g.status);return}const v=g.status||$;if(!(v===$&&w.expectedStatus===I)&&v!==w.expectedStatus){(l=w.onError)==null||l.call(w,g.status);return}const C=rt(g);if(v===I){const O=g.getResponseHeader("Content-Range"),_=/bytes (\d+)-(\d+)\/(\d+)/.exec(O);w.onDone({begin:parseInt(_[1],10),chunk:C})}else C?w.onDone({begin:0,chunk:C}):(u=w.onError)==null||u.call(w,g.status)}getRequestXhr(P){return this.pendingRequests[P].xhr}isPendingRequest(P){return P in this.pendingRequests}abortRequest(P){const x=this.pendingRequests[P].xhr;delete this.pendingRequests[P],x.abort()}}class A{constructor(P){this._source=P,this._manager=new k(P.url,{httpHeaders:P.httpHeaders,withCredentials:P.withCredentials}),this._rangeChunkSize=P.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(P){const x=this._rangeRequestReaders.indexOf(P);x>=0&&this._rangeRequestReaders.splice(x,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(P,x){const w=new L(this._manager,P,x);return w.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(w),w}cancelAllRequests(P){var x;(x=this._fullRequestReader)==null||x.cancel(P);for(const w of this._rangeRequestReaders.slice(0))w.cancel(P)}}e.PDFNetworkStream=A;class m{constructor(P,x){this._manager=P;const w={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._fullRequestId=P.requestFull(w),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=x.disableRange||!1,this._contentLength=x.length,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const P=this._fullRequestId,x=this._manager.getRequestXhr(P),w=R=>x.getResponseHeader(R),{allowRangeRequests:g,suggestedLength:v}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:w,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=v||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(w),this._isRangeSupported&&this._manager.abortRequest(P),this._headersReceivedCapability.resolve()}_onDone(P){if(P&&(this._requests.length>0?this._requests.shift().resolve({value:P.chunk,done:!1}):this._cachedChunks.push(P.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(P){this._storedError=(0,d.createResponseStatusError)(P,this._url),this._headersReceivedCapability.reject(this._storedError);for(const x of this._requests)x.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(P){var x;(x=this.onProgress)==null||x.call(this,{loaded:P.loaded,total:P.lengthComputable?P.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=new n.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0,this._headersReceivedCapability.reject(P);for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(P,x,w){this._manager=P;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=P.url,this._requestId=P.requestRange(x,w,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var P;(P=this.onClosed)==null||P.call(this,this)}_onDone(P){const x=P.chunk;this._requests.length>0?this._requests.shift().resolve({value:x,done:!1}):this._queuedChunk=x,this._done=!0;for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(P){this._storedError=(0,d.createResponseStatusError)(P,this._url);for(const x of this._requests)x.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(P){var x;this.isStreamingSupported||(x=this.onProgress)==null||x.call(this,{loaded:P.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const x=this._queuedChunk;return this._queuedChunk=null,{value:x,done:!1}}if(this._done)return{value:void 0,done:!0};const P=new n.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=D(1),d=D(20);const $=/^file:\/\/\/[a-zA-Z]:\//;function I(w){const g=require$$5,v=g.parse(w);return v.protocol==="file:"||v.host?v:/^[a-z]:[/\\]/i.test(w)?g.parse(`file:///${w}`):(v.host||(v.protocol="file:"),v)}class rt{constructor(g){this.source=g,this.url=I(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new P(this):new L(this),this._fullRequestReader}getRangeReader(g,v){if(v<=this._progressiveDataLength)return null;const R=this.isFsUrl?new x(this,g,v):new N(this,g,v);return this._rangeRequestReaders.push(R),R}cancelAllRequests(g){var v;(v=this._fullRequestReader)==null||v.cancel(g);for(const R of this._rangeRequestReaders.slice(0))R.cancel(g)}}e.PDFNodeStream=rt;class k{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const v=g.source;this._contentLength=v.length,this._loaded=0,this._filename=null,this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var R;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(R=this.onProgress)==null||R.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",v=>{this._error(v)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const v=g.source;this._isStreamingSupported=!v.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var R;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(R=this.onProgress)==null||R.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",v=>{this._error(v)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(w,g){return{protocol:w.protocol,auth:w.auth,host:w.hostname,port:w.port,path:w.path,method:"GET",headers:g}}class L extends k{constructor(g){super(g);const v=R=>{if(R.statusCode===404){const u=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=u,this._headersCapability.reject(u);return}this._headersCapability.resolve(),this._setReadableStream(R);const C=u=>this._readableStream.headers[u.toLowerCase()],{allowRangeRequests:y,suggestedLength:l}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:C,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=l||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(C)};if(this._request=null,this._url.protocol==="http:"){const R=require$$5;this._request=R.request(m(this._url,g.httpHeaders),v)}else{const R=require$$5;this._request=R.request(m(this._url,g.httpHeaders),v)}this._request.on("error",R=>{this._storedError=R,this._headersCapability.reject(R)}),this._request.end()}}class N extends A{constructor(g,v,R){super(g),this._httpHeaders={};for(const y in g.httpHeaders){const l=g.httpHeaders[y];l!==void 0&&(this._httpHeaders[y]=l)}this._httpHeaders.Range=`bytes=${v}-${R-1}`;const C=y=>{if(y.statusCode===404){const l=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=l;return}this._setReadableStream(y)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(m(this._url,this._httpHeaders),C)}else{const y=require$$5;this._request=y.request(m(this._url,this._httpHeaders),C)}this._request.on("error",y=>{this._storedError=y}),this._request.end()}}class P extends k{constructor(g){super(g);let v=decodeURIComponent(this._url.path);$.test(this._url.href)&&(v=v.replace(/^\//,""));const R=require$$5;R.lstat(v,(C,y)=>{if(C){C.code==="ENOENT"&&(C=new n.MissingPDFException(`Missing PDF "${v}".`)),this._storedError=C,this._headersCapability.reject(C);return}this._contentLength=y.size,this._setReadableStream(R.createReadStream(v)),this._headersCapability.resolve()})}}class x extends A{constructor(g,v,R){super(g);let C=decodeURIComponent(this._url.path);$.test(this._url.href)&&(C=C.replace(/^\//,""));const y=require$$5;this._setReadableStream(y.createReadStream(C,{start:v,end:R-1}))}}},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=D(6),d=D(1);const $={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},I="http://www.w3.org/XML/1998/namespace",rt="http://www.w3.org/1999/xlink",k=["butt","round","square"],A=["miter","round","bevel"],m=function(y,l="",u=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!u)return URL.createObjectURL(new Blob([y],{type:l}));const O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let _=`data:${l};base64,`;for(let c=0,F=y.length;c<F;c+=3){const b=y[c]&255,G=y[c+1]&255,z=y[c+2]&255,E=b>>2,X=(b&3)<<4|G>>4,at=c+1<F?(G&15)<<2|z>>6:64,ct=c+2<F?z&63:64;_+=O[E]+O[X]+O[at]+O[ct]}return _},L=function(){const y=new Uint8Array([137,80,78,71,13,10,26,10]),l=12,u=new Int32Array(256);for(let z=0;z<256;z++){let E=z;for(let X=0;X<8;X++)E=E&1?3988292384^E>>1&2147483647:E>>1&2147483647;u[z]=E}function O(z,E,X){let at=-1;for(let ct=E;ct<X;ct++){const V=(at^z[ct])&255,dt=u[V];at=at>>>8^dt}return at^-1}function _(z,E,X,at){let ct=at;const V=E.length;X[ct]=V>>24&255,X[ct+1]=V>>16&255,X[ct+2]=V>>8&255,X[ct+3]=V&255,ct+=4,X[ct]=z.charCodeAt(0)&255,X[ct+1]=z.charCodeAt(1)&255,X[ct+2]=z.charCodeAt(2)&255,X[ct+3]=z.charCodeAt(3)&255,ct+=4,X.set(E,ct),ct+=E.length;const dt=O(X,at+4,ct);X[ct]=dt>>24&255,X[ct+1]=dt>>16&255,X[ct+2]=dt>>8&255,X[ct+3]=dt&255}function c(z,E,X){let at=1,ct=0;for(let V=E;V<X;++V)at=(at+(z[V]&255))%65521,ct=(ct+at)%65521;return ct<<16|at}function F(z){if(!d.isNodeJS)return b(z);try{const E=parseInt(process.versions.node)>=8?z:Buffer.from(z),X=require$$5.deflateSync(E,{level:9});return X instanceof Uint8Array?X:new Uint8Array(X)}catch(E){(0,d.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+E)}return b(z)}function b(z){let E=z.length;const X=65535,at=Math.ceil(E/X),ct=new Uint8Array(2+E+at*5+4);let V=0;ct[V++]=120,ct[V++]=156;let dt=0;for(;E>X;)ct[V++]=0,ct[V++]=255,ct[V++]=255,ct[V++]=0,ct[V++]=0,ct.set(z.subarray(dt,dt+X),V),V+=X,dt+=X,E-=X;ct[V++]=1,ct[V++]=E&255,ct[V++]=E>>8&255,ct[V++]=~E&65535&255,ct[V++]=(~E&65535)>>8&255,ct.set(z.subarray(dt),V),V+=z.length-dt;const mt=c(z,0,z.length);return ct[V++]=mt>>24&255,ct[V++]=mt>>16&255,ct[V++]=mt>>8&255,ct[V++]=mt&255,ct}function G(z,E,X,at){const ct=z.width,V=z.height;let dt,mt,Et;const wt=z.data;switch(E){case d.ImageKind.GRAYSCALE_1BPP:mt=0,dt=1,Et=ct+7>>3;break;case d.ImageKind.RGB_24BPP:mt=2,dt=8,Et=ct*3;break;case d.ImageKind.RGBA_32BPP:mt=6,dt=8,Et=ct*4;break;default:throw new Error("invalid format")}const M=new Uint8Array((1+Et)*V);let i=0,o=0;for(let W=0;W<V;++W)M[i++]=0,M.set(wt.subarray(o,o+Et),i),o+=Et,i+=Et;if(E===d.ImageKind.GRAYSCALE_1BPP&&at){i=0;for(let W=0;W<V;W++){i++;for(let it=0;it<Et;it++)M[i++]^=255}}const a=new Uint8Array([ct>>24&255,ct>>16&255,ct>>8&255,ct&255,V>>24&255,V>>16&255,V>>8&255,V&255,dt,mt,0,0,0]),h=F(M),f=y.length+l*3+a.length+h.length,T=new Uint8Array(f);let j=0;return T.set(y,j),j+=y.length,_("IHDR",a,T,j),j+=l+a.length,_("IDATA",h,T,j),j+=l+h.length,_("IEND",new Uint8Array(0),T,j),m(T,"image/png",X)}return function(E,X,at){const ct=E.kind===void 0?d.ImageKind.GRAYSCALE_1BPP:E.kind;return G(E,ct,X,at)}}();class N{constructor(){this.fontSizeScale=1,this.fontWeight=$.fontWeight,this.fontSize=0,this.textMatrix=d.IDENTITY_MATRIX,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=d.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=$.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(l,u){this.x=l,this.y=u}}function P(y){let l=[];const u=[];for(const O of y){if(O.fn==="save"){l.push({fnId:92,fn:"group",items:[]}),u.push(l),l=l.at(-1).items;continue}O.fn==="restore"?l=u.pop():l.push(O)}return l}function x(y){if(Number.isInteger(y))return y.toString();const l=y.toFixed(10);let u=l.length-1;if(l[u]!=="0")return l;do u--;while(l[u]==="0");return l.substring(0,l[u]==="."?u:u+1)}function w(y){if(y[4]===0&&y[5]===0){if(y[1]===0&&y[2]===0)return y[0]===1&&y[3]===1?"":`scale(${x(y[0])} ${x(y[3])})`;if(y[0]===y[3]&&y[1]===-y[2]){const l=Math.acos(y[0])*180/Math.PI;return`rotate(${x(l)})`}}else if(y[0]===1&&y[1]===0&&y[2]===0&&y[3]===1)return`translate(${x(y[4])} ${x(y[5])})`;return`matrix(${x(y[0])} ${x(y[1])} ${x(y[2])} ${x(y[3])} ${x(y[4])} ${x(y[5])})`}let g=0,v=0,R=0;class C{constructor(l,u,O=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new N,this.transformMatrix=d.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=l,this.objs=u,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!O,this._operatorIdMapping=[];for(const _ in d.OPS)this._operatorIdMapping[d.OPS[_]]=_}getObject(l,u=null){return typeof l=="string"?l.startsWith("g_")?this.commonObjs.get(l):this.objs.get(l):u}save(){this.transformStack.push(this.transformMatrix);const l=this.current;this.extraStack.push(l),this.current=l.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(l){this.save(),this.executeOpTree(l),this.restore()}loadDependencies(l){const u=l.fnArray,O=l.argsArray;for(let _=0,c=u.length;_<c;_++)if(u[_]===d.OPS.dependency)for(const F of O[_]){const b=F.startsWith("g_")?this.commonObjs:this.objs,G=new Promise(z=>{b.get(F,z)});this.current.dependencies.push(G)}return Promise.all(this.current.dependencies)}transform(l,u,O,_,c,F){const b=[l,u,O,_,c,F];this.transformMatrix=d.Util.transform(this.transformMatrix,b),this.tgrp=null}getSVG(l,u){this.viewport=u;const O=this._initialize(u);return this.loadDependencies(l).then(()=>(this.transformMatrix=d.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(l)),O))}convertOpList(l){const u=this._operatorIdMapping,O=l.argsArray,_=l.fnArray,c=[];for(let F=0,b=_.length;F<b;F++){const G=_[F];c.push({fnId:G,fn:u[G],args:O[F]})}return P(c)}executeOpTree(l){for(const u of l){const O=u.fn,_=u.fnId,c=u.args;switch(_|0){case d.OPS.beginText:this.beginText();break;case d.OPS.dependency:break;case d.OPS.setLeading:this.setLeading(c);break;case d.OPS.setLeadingMoveText:this.setLeadingMoveText(c[0],c[1]);break;case d.OPS.setFont:this.setFont(c);break;case d.OPS.showText:this.showText(c[0]);break;case d.OPS.showSpacedText:this.showText(c[0]);break;case d.OPS.endText:this.endText();break;case d.OPS.moveText:this.moveText(c[0],c[1]);break;case d.OPS.setCharSpacing:this.setCharSpacing(c[0]);break;case d.OPS.setWordSpacing:this.setWordSpacing(c[0]);break;case d.OPS.setHScale:this.setHScale(c[0]);break;case d.OPS.setTextMatrix:this.setTextMatrix(c[0],c[1],c[2],c[3],c[4],c[5]);break;case d.OPS.setTextRise:this.setTextRise(c[0]);break;case d.OPS.setTextRenderingMode:this.setTextRenderingMode(c[0]);break;case d.OPS.setLineWidth:this.setLineWidth(c[0]);break;case d.OPS.setLineJoin:this.setLineJoin(c[0]);break;case d.OPS.setLineCap:this.setLineCap(c[0]);break;case d.OPS.setMiterLimit:this.setMiterLimit(c[0]);break;case d.OPS.setFillRGBColor:this.setFillRGBColor(c[0],c[1],c[2]);break;case d.OPS.setStrokeRGBColor:this.setStrokeRGBColor(c[0],c[1],c[2]);break;case d.OPS.setStrokeColorN:this.setStrokeColorN(c);break;case d.OPS.setFillColorN:this.setFillColorN(c);break;case d.OPS.shadingFill:this.shadingFill(c[0]);break;case d.OPS.setDash:this.setDash(c[0],c[1]);break;case d.OPS.setRenderingIntent:this.setRenderingIntent(c[0]);break;case d.OPS.setFlatness:this.setFlatness(c[0]);break;case d.OPS.setGState:this.setGState(c[0]);break;case d.OPS.fill:this.fill();break;case d.OPS.eoFill:this.eoFill();break;case d.OPS.stroke:this.stroke();break;case d.OPS.fillStroke:this.fillStroke();break;case d.OPS.eoFillStroke:this.eoFillStroke();break;case d.OPS.clip:this.clip("nonzero");break;case d.OPS.eoClip:this.clip("evenodd");break;case d.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case d.OPS.paintImageXObject:this.paintImageXObject(c[0]);break;case d.OPS.paintInlineImageXObject:this.paintInlineImageXObject(c[0]);break;case d.OPS.paintImageMaskXObject:this.paintImageMaskXObject(c[0]);break;case d.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(c[0],c[1]);break;case d.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case d.OPS.closePath:this.closePath();break;case d.OPS.closeStroke:this.closeStroke();break;case d.OPS.closeFillStroke:this.closeFillStroke();break;case d.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case d.OPS.nextLine:this.nextLine();break;case d.OPS.transform:this.transform(c[0],c[1],c[2],c[3],c[4],c[5]);break;case d.OPS.constructPath:this.constructPath(c[0],c[1]);break;case d.OPS.endPath:this.endPath();break;case 92:this.group(u.items);break;default:(0,d.warn)(`Unimplemented operator ${O}`);break}}}setWordSpacing(l){this.current.wordSpacing=l}setCharSpacing(l){this.current.charSpacing=l}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(l,u,O,_,c,F){const b=this.current;b.textMatrix=b.lineMatrix=[l,u,O,_,c,F],b.textMatrixScale=Math.hypot(l,u),b.x=b.lineX=0,b.y=b.lineY=0,b.xcoords=[],b.ycoords=[],b.tspan=this.svgFactory.createElement("svg:tspan"),b.tspan.setAttributeNS(null,"font-family",b.fontFamily),b.tspan.setAttributeNS(null,"font-size",`${x(b.fontSize)}px`),b.tspan.setAttributeNS(null,"y",x(-b.y)),b.txtElement=this.svgFactory.createElement("svg:text"),b.txtElement.append(b.tspan)}beginText(){const l=this.current;l.x=l.lineX=0,l.y=l.lineY=0,l.textMatrix=d.IDENTITY_MATRIX,l.lineMatrix=d.IDENTITY_MATRIX,l.textMatrixScale=1,l.tspan=this.svgFactory.createElement("svg:tspan"),l.txtElement=this.svgFactory.createElement("svg:text"),l.txtgrp=this.svgFactory.createElement("svg:g"),l.xcoords=[],l.ycoords=[]}moveText(l,u){const O=this.current;O.x=O.lineX+=l,O.y=O.lineY+=u,O.xcoords=[],O.ycoords=[],O.tspan=this.svgFactory.createElement("svg:tspan"),O.tspan.setAttributeNS(null,"font-family",O.fontFamily),O.tspan.setAttributeNS(null,"font-size",`${x(O.fontSize)}px`),O.tspan.setAttributeNS(null,"y",x(-O.y))}showText(l){const u=this.current,O=u.font,_=u.fontSize;if(_===0)return;const c=u.fontSizeScale,F=u.charSpacing,b=u.wordSpacing,G=u.fontDirection,z=u.textHScale*G,E=O.vertical,X=E?1:-1,at=O.defaultVMetrics,ct=_*u.fontMatrix[0];let V=0;for(const Et of l){if(Et===null){V+=G*b;continue}else if(typeof Et=="number"){V+=X*Et*_/1e3;continue}const wt=(Et.isSpace?b:0)+F,M=Et.fontChar;let i,o,a=Et.width;if(E){let f;const T=Et.vmetric||at;f=Et.vmetric?T[1]:a*.5,f=-f*ct;const j=T[2]*ct;a=T?-T[0]:a,i=f/c,o=(V+j)/c}else i=V/c,o=0;(Et.isInFont||O.missingFile)&&(u.xcoords.push(u.x+i),E&&u.ycoords.push(-u.y+o),u.tspan.textContent+=M);const h=E?a*ct-wt*G:a*ct+wt*G;V+=h}u.tspan.setAttributeNS(null,"x",u.xcoords.map(x).join(" ")),E?u.tspan.setAttributeNS(null,"y",u.ycoords.map(x).join(" ")):u.tspan.setAttributeNS(null,"y",x(-u.y)),E?u.y-=V:u.x+=V*z,u.tspan.setAttributeNS(null,"font-family",u.fontFamily),u.tspan.setAttributeNS(null,"font-size",`${x(u.fontSize)}px`),u.fontStyle!==$.fontStyle&&u.tspan.setAttributeNS(null,"font-style",u.fontStyle),u.fontWeight!==$.fontWeight&&u.tspan.setAttributeNS(null,"font-weight",u.fontWeight);const dt=u.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;if(dt===d.TextRenderingMode.FILL||dt===d.TextRenderingMode.FILL_STROKE?(u.fillColor!==$.fillColor&&u.tspan.setAttributeNS(null,"fill",u.fillColor),u.fillAlpha<1&&u.tspan.setAttributeNS(null,"fill-opacity",u.fillAlpha)):u.textRenderingMode===d.TextRenderingMode.ADD_TO_PATH?u.tspan.setAttributeNS(null,"fill","transparent"):u.tspan.setAttributeNS(null,"fill","none"),dt===d.TextRenderingMode.STROKE||dt===d.TextRenderingMode.FILL_STROKE){const Et=1/(u.textMatrixScale||1);this._setStrokeAttributes(u.tspan,Et)}let mt=u.textMatrix;u.textRise!==0&&(mt=mt.slice(),mt[5]+=u.textRise),u.txtElement.setAttributeNS(null,"transform",`${w(mt)} scale(${x(z)}, -1)`),u.txtElement.setAttributeNS(I,"xml:space","preserve"),u.txtElement.append(u.tspan),u.txtgrp.append(u.txtElement),this._ensureTransformGroup().append(u.txtElement)}setLeadingMoveText(l,u){this.setLeading(-u),this.moveText(l,u)}addFontStyle(l){if(!l.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const u=m(l.data,l.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${l.loadedName}"; src: url(${u}); }
`}setFont(l){const u=this.current,O=this.commonObjs.get(l[0]);let _=l[1];u.font=O,this.embedFonts&&!O.missingFile&&!this.embeddedFonts[O.loadedName]&&(this.addFontStyle(O),this.embeddedFonts[O.loadedName]=O),u.fontMatrix=O.fontMatrix||d.FONT_IDENTITY_MATRIX;let c="normal";O.black?c="900":O.bold&&(c="bold");const F=O.italic?"italic":"normal";_<0?(_=-_,u.fontDirection=-1):u.fontDirection=1,u.fontSize=_,u.fontFamily=O.loadedName,u.fontWeight=c,u.fontStyle=F,u.tspan=this.svgFactory.createElement("svg:tspan"),u.tspan.setAttributeNS(null,"y",x(-u.y)),u.xcoords=[],u.ycoords=[]}endText(){var u;const l=this.current;l.textRenderingMode&d.TextRenderingMode.ADD_TO_PATH_FLAG&&((u=l.txtElement)!=null&&u.hasChildNodes())&&(l.element=l.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(l){l>0&&(this.current.lineWidth=l)}setLineCap(l){this.current.lineCap=k[l]}setLineJoin(l){this.current.lineJoin=A[l]}setMiterLimit(l){this.current.miterLimit=l}setStrokeAlpha(l){this.current.strokeAlpha=l}setStrokeRGBColor(l,u,O){this.current.strokeColor=d.Util.makeHexColor(l,u,O)}setFillAlpha(l){this.current.fillAlpha=l}setFillRGBColor(l,u,O){this.current.fillColor=d.Util.makeHexColor(l,u,O),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(l){this.current.strokeColor=this._makeColorN_Pattern(l)}setFillColorN(l){this.current.fillColor=this._makeColorN_Pattern(l)}shadingFill(l){const{width:u,height:O}=this.viewport,_=d.Util.inverseTransform(this.transformMatrix),[c,F,b,G]=d.Util.getAxialAlignedBoundingBox([0,0,u,O],_),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x",c),z.setAttributeNS(null,"y",F),z.setAttributeNS(null,"width",b-c),z.setAttributeNS(null,"height",G-F),z.setAttributeNS(null,"fill",this._makeShadingPattern(l)),this.current.fillAlpha<1&&z.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(z)}_makeColorN_Pattern(l){return l[0]==="TilingPattern"?this._makeTilingPattern(l):this._makeShadingPattern(l)}_makeTilingPattern(l){const u=l[1],O=l[2],_=l[3]||d.IDENTITY_MATRIX,[c,F,b,G]=l[4],z=l[5],E=l[6],X=l[7],at=`shading${R++}`,[ct,V,dt,mt]=d.Util.normalizeRect([...d.Util.applyTransform([c,F],_),...d.Util.applyTransform([b,G],_)]),[Et,wt]=d.Util.singularValueDecompose2dScale(_),M=z*Et,i=E*wt,o=this.svgFactory.createElement("svg:pattern");o.setAttributeNS(null,"id",at),o.setAttributeNS(null,"patternUnits","userSpaceOnUse"),o.setAttributeNS(null,"width",M),o.setAttributeNS(null,"height",i),o.setAttributeNS(null,"x",`${ct}`),o.setAttributeNS(null,"y",`${V}`);const a=this.svg,h=this.transformMatrix,f=this.current.fillColor,T=this.current.strokeColor,j=this.svgFactory.create(dt-ct,mt-V);if(this.svg=j,this.transformMatrix=_,X===2){const W=d.Util.makeHexColor(...u);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(O)),this.svg=a,this.transformMatrix=h,this.current.fillColor=f,this.current.strokeColor=T,o.append(j.childNodes[0]),this.defs.append(o),`url(#${at})`}_makeShadingPattern(l){switch(typeof l=="string"&&(l=this.objs.get(l)),l[0]){case"RadialAxial":const u=`shading${R++}`,O=l[3];let _;switch(l[1]){case"axial":const c=l[4],F=l[5];_=this.svgFactory.createElement("svg:linearGradient"),_.setAttributeNS(null,"id",u),_.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),_.setAttributeNS(null,"x1",c[0]),_.setAttributeNS(null,"y1",c[1]),_.setAttributeNS(null,"x2",F[0]),_.setAttributeNS(null,"y2",F[1]);break;case"radial":const b=l[4],G=l[5],z=l[6],E=l[7];_=this.svgFactory.createElement("svg:radialGradient"),_.setAttributeNS(null,"id",u),_.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),_.setAttributeNS(null,"cx",G[0]),_.setAttributeNS(null,"cy",G[1]),_.setAttributeNS(null,"r",E),_.setAttributeNS(null,"fx",b[0]),_.setAttributeNS(null,"fy",b[1]),_.setAttributeNS(null,"fr",z);break;default:throw new Error(`Unknown RadialAxial type: ${l[1]}`)}for(const c of O){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",c[0]),F.setAttributeNS(null,"stop-color",c[1]),_.append(F)}return this.defs.append(_),`url(#${u})`;case"Mesh":return(0,d.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${l[0]}`)}}setDash(l,u){this.current.dashArray=l,this.current.dashPhase=u}constructPath(l,u){const O=this.current;let _=O.x,c=O.y,F=[],b=0;for(const G of l)switch(G|0){case d.OPS.rectangle:_=u[b++],c=u[b++];const z=u[b++],E=u[b++],X=_+z,at=c+E;F.push("M",x(_),x(c),"L",x(X),x(c),"L",x(X),x(at),"L",x(_),x(at),"Z");break;case d.OPS.moveTo:_=u[b++],c=u[b++],F.push("M",x(_),x(c));break;case d.OPS.lineTo:_=u[b++],c=u[b++],F.push("L",x(_),x(c));break;case d.OPS.curveTo:_=u[b+4],c=u[b+5],F.push("C",x(u[b]),x(u[b+1]),x(u[b+2]),x(u[b+3]),x(_),x(c)),b+=6;break;case d.OPS.curveTo2:F.push("C",x(_),x(c),x(u[b]),x(u[b+1]),x(u[b+2]),x(u[b+3])),_=u[b+2],c=u[b+3],b+=4;break;case d.OPS.curveTo3:_=u[b+2],c=u[b+3],F.push("C",x(u[b]),x(u[b+1]),x(_),x(c),x(_),x(c)),b+=4;break;case d.OPS.closePath:F.push("Z");break}F=F.join(" "),O.path&&l.length>0&&l[0]!==d.OPS.rectangle&&l[0]!==d.OPS.moveTo?F=O.path.getAttributeNS(null,"d")+F:(O.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(O.path)),O.path.setAttributeNS(null,"d",F),O.path.setAttributeNS(null,"fill","none"),O.element=O.path,O.setCurrentPoint(_,c)}endPath(){const l=this.current;if(l.path=null,!this.pendingClip)return;if(!l.element){this.pendingClip=null;return}const u=`clippath${g++}`,O=this.svgFactory.createElement("svg:clipPath");O.setAttributeNS(null,"id",u),O.setAttributeNS(null,"transform",w(this.transformMatrix));const _=l.element.cloneNode(!0);if(this.pendingClip==="evenodd"?_.setAttributeNS(null,"clip-rule","evenodd"):_.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,O.append(_),this.defs.append(O),l.activeClipUrl){l.clipGroup=null;for(const c of this.extraStack)c.clipGroup=null;O.setAttributeNS(null,"clip-path",l.activeClipUrl)}l.activeClipUrl=`url(#${u})`,this.tgrp=null}clip(l){this.pendingClip=l}closePath(){const l=this.current;if(l.path){const u=`${l.path.getAttributeNS(null,"d")}Z`;l.path.setAttributeNS(null,"d",u)}}setLeading(l){this.current.leading=-l}setTextRise(l){this.current.textRise=l}setTextRenderingMode(l){this.current.textRenderingMode=l}setHScale(l){this.current.textHScale=l/100}setRenderingIntent(l){}setFlatness(l){}setGState(l){for(const[u,O]of l)switch(u){case"LW":this.setLineWidth(O);break;case"LC":this.setLineCap(O);break;case"LJ":this.setLineJoin(O);break;case"ML":this.setMiterLimit(O);break;case"D":this.setDash(O[0],O[1]);break;case"RI":this.setRenderingIntent(O);break;case"FL":this.setFlatness(O);break;case"Font":this.setFont(O);break;case"CA":this.setStrokeAlpha(O);break;case"ca":this.setFillAlpha(O);break;default:(0,d.warn)(`Unimplemented graphic state operator ${u}`);break}}fill(){const l=this.current;l.element&&(l.element.setAttributeNS(null,"fill",l.fillColor),l.element.setAttributeNS(null,"fill-opacity",l.fillAlpha),this.endPath())}stroke(){const l=this.current;l.element&&(this._setStrokeAttributes(l.element),l.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(l,u=1){const O=this.current;let _=O.dashArray;u!==1&&_.length>0&&(_=_.map(function(c){return u*c})),l.setAttributeNS(null,"stroke",O.strokeColor),l.setAttributeNS(null,"stroke-opacity",O.strokeAlpha),l.setAttributeNS(null,"stroke-miterlimit",x(O.miterLimit)),l.setAttributeNS(null,"stroke-linecap",O.lineCap),l.setAttributeNS(null,"stroke-linejoin",O.lineJoin),l.setAttributeNS(null,"stroke-width",x(u*O.lineWidth)+"px"),l.setAttributeNS(null,"stroke-dasharray",_.map(x).join(" ")),l.setAttributeNS(null,"stroke-dashoffset",x(u*O.dashPhase)+"px")}eoFill(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var l;(l=this.current.element)==null||l.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width","1px"),l.setAttributeNS(null,"height","1px"),l.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(l)}paintImageXObject(l){const u=this.getObject(l);if(!u){(0,d.warn)(`Dependent image with object ID ${l} is not ready yet`);return}this.paintInlineImageXObject(u)}paintInlineImageXObject(l,u){const O=l.width,_=l.height,c=L(l,this.forceDataSchema,!!u),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",x(O)),F.setAttributeNS(null,"height",x(_)),this.current.element=F,this.clip("nonzero");const b=this.svgFactory.createElement("svg:image");b.setAttributeNS(rt,"xlink:href",c),b.setAttributeNS(null,"x","0"),b.setAttributeNS(null,"y",x(-_)),b.setAttributeNS(null,"width",x(O)+"px"),b.setAttributeNS(null,"height",x(_)+"px"),b.setAttributeNS(null,"transform",`scale(${x(1/O)} ${x(-1/_)})`),u?u.append(b):this._ensureTransformGroup().append(b)}paintImageMaskXObject(l){const u=this.getObject(l.data,l);if(u.bitmap){(0,d.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const O=this.current,_=u.width,c=u.height,F=O.fillColor;O.maskId=`mask${v++}`;const b=this.svgFactory.createElement("svg:mask");b.setAttributeNS(null,"id",O.maskId);const G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",x(_)),G.setAttributeNS(null,"height",x(c)),G.setAttributeNS(null,"fill",F),G.setAttributeNS(null,"mask",`url(#${O.maskId})`),this.defs.append(b),this._ensureTransformGroup().append(G),this.paintInlineImageXObject(u,b)}paintFormXObjectBegin(l,u){if(Array.isArray(l)&&l.length===6&&this.transform(l[0],l[1],l[2],l[3],l[4],l[5]),u){const O=u[2]-u[0],_=u[3]-u[1],c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",u[0]),c.setAttributeNS(null,"y",u[1]),c.setAttributeNS(null,"width",x(O)),c.setAttributeNS(null,"height",x(_)),this.current.element=c,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(l){const u=this.svgFactory.create(l.width,l.height),O=this.svgFactory.createElement("svg:defs");u.append(O),this.defs=O;const _=this.svgFactory.createElement("svg:g");return _.setAttributeNS(null,"transform",w(l.transform)),u.append(_),this.svg=_,u}_ensureClipGroup(){if(!this.current.clipGroup){const l=this.svgFactory.createElement("svg:g");l.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(l),this.current.clipGroup=l}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",w(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=C},(p,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class D{static textContent(d){const $=[],I={items:$,styles:Object.create(null)};function rt(k){var L;if(!k)return;let A=null;const m=k.name;if(m==="#text")A=k.value;else if(D.shouldBuildText(m))(L=k==null?void 0:k.attributes)!=null&&L.textContent?A=k.attributes.textContent:k.value&&(A=k.value);else return;if(A!==null&&$.push({str:A}),!!k.children)for(const N of k.children)rt(N)}return rt(d),I}static shouldBuildText(d){return!(d==="textarea"||d==="input"||d==="option"||d==="select")}}e.XfaText=D},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=w,e.updateTextLayer=g;var n=D(1),d=D(6);const $=1e5,I=30,rt=.8,k=new Map;function A(v,R){let C;if(R&&n.FeatureTest.isOffscreenCanvasSupported)C=new OffscreenCanvas(v,v).getContext("2d",{alpha:!1});else{const y=document.createElement("canvas");y.width=y.height=v,C=y.getContext("2d",{alpha:!1})}return C}function m(v,R){const C=k.get(v);if(C)return C;const y=A(I,R);y.font=`${I}px ${v}`;const l=y.measureText("");let u=l.fontBoundingBoxAscent,O=Math.abs(l.fontBoundingBoxDescent);if(u){const c=u/(u+O);return k.set(v,c),y.canvas.width=y.canvas.height=0,c}y.strokeStyle="red",y.clearRect(0,0,I,I),y.strokeText("g",0,0);let _=y.getImageData(0,0,I,I).data;O=0;for(let c=_.length-1-3;c>=0;c-=4)if(_[c]>0){O=Math.ceil(c/4/I);break}y.clearRect(0,0,I,I),y.strokeText("A",0,I),_=y.getImageData(0,0,I,I).data,u=0;for(let c=0,F=_.length;c<F;c+=4)if(_[c]>0){u=I-Math.floor(c/4/I);break}if(y.canvas.width=y.canvas.height=0,u){const c=u/(u+O);return k.set(v,c),c}return k.set(v,rt),rt}function L(v,R,C){const y=document.createElement("span"),l={angle:0,canvasWidth:0,hasText:R.str!=="",hasEOL:R.hasEOL,fontSize:0};v._textDivs.push(y);const u=n.Util.transform(v._transform,R.transform);let O=Math.atan2(u[1],u[0]);const _=C[R.fontName];_.vertical&&(O+=Math.PI/2);const c=Math.hypot(u[2],u[3]),F=c*m(_.fontFamily,v._isOffscreenCanvasSupported);let b,G;O===0?(b=u[4],G=u[5]-F):(b=u[4]+F*Math.sin(O),G=u[5]-F*Math.cos(O));const z="calc(var(--scale-factor)*",E=y.style;v._container===v._rootContainer?(E.left=`${(100*b/v._pageWidth).toFixed(2)}%`,E.top=`${(100*G/v._pageHeight).toFixed(2)}%`):(E.left=`${z}${b.toFixed(2)}px)`,E.top=`${z}${G.toFixed(2)}px)`),E.fontSize=`${z}${c.toFixed(2)}px)`,E.fontFamily=_.fontFamily,l.fontSize=c,y.setAttribute("role","presentation"),y.textContent=R.str,y.dir=R.dir,v._fontInspectorEnabled&&(y.dataset.fontName=R.fontName),O!==0&&(l.angle=O*(180/Math.PI));let X=!1;if(R.str.length>1)X=!0;else if(R.str!==" "&&R.transform[0]!==R.transform[3]){const at=Math.abs(R.transform[0]),ct=Math.abs(R.transform[3]);at!==ct&&Math.max(at,ct)/Math.min(at,ct)>1.5&&(X=!0)}X&&(l.canvasWidth=_.vertical?R.height:R.width),v._textDivProperties.set(y,l),v._isReadableStream&&v._layoutText(y)}function N(v){const{div:R,scale:C,properties:y,ctx:l,prevFontSize:u,prevFontFamily:O}=v,{style:_}=R;let c="";if(y.canvasWidth!==0&&y.hasText){const{fontFamily:F}=_,{canvasWidth:b,fontSize:G}=y;(u!==G||O!==F)&&(l.font=`${G*C}px ${F}`,v.prevFontSize=G,v.prevFontFamily=F);const{width:z}=l.measureText(R.textContent);z>0&&(c=`scaleX(${b*C/z})`)}y.angle!==0&&(c=`rotate(${y.angle}deg) ${c}`),c.length>0&&(_.transform=c)}function P(v){if(v._canceled)return;const R=v._textDivs,C=v._capability;if(R.length>$){C.resolve();return}if(!v._isReadableStream)for(const l of R)v._layoutText(l);C.resolve()}class x{constructor({textContentSource:R,container:C,viewport:y,textDivs:l,textDivProperties:u,textContentItemsStr:O,isOffscreenCanvasSupported:_}){var z;this._textContentSource=R,this._isReadableStream=R instanceof ReadableStream,this._container=this._rootContainer=C,this._textDivs=l||[],this._textContentItemsStr=O||[],this._isOffscreenCanvasSupported=_,this._fontInspectorEnabled=!!((z=globalThis.FontInspector)!=null&&z.enabled),this._reader=null,this._textDivProperties=u||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:A(0,_)};const{pageWidth:c,pageHeight:F,pageX:b,pageY:G}=y.rawDims;this._transform=[1,0,0,-1,-b,G+F],this._pageWidth=c,this._pageHeight=F,(0,d.setLayerDimensions)(C,y),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(R,C){for(const y of R){if(y.str===void 0){if(y.type==="beginMarkedContentProps"||y.type==="beginMarkedContent"){const l=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),y.id!==null&&this._container.setAttribute("id",`${y.id}`),l.append(this._container)}else y.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(y.str),L(this,y,C)}}_layoutText(R){const C=this._layoutTextParams.properties=this._textDivProperties.get(R);if(this._layoutTextParams.div=R,N(this._layoutTextParams),C.hasText&&this._container.append(R),C.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(){const R=new n.PromiseCapability;let C=Object.create(null);if(this._isReadableStream){const y=()=>{this._reader.read().then(({value:l,done:u})=>{if(u){R.resolve();return}Object.assign(C,l.styles),this._processItems(l.items,C),y()},R.reject)};this._reader=this._textContentSource.getReader(),y()}else if(this._textContentSource){const{items:y,styles:l}=this._textContentSource;this._processItems(y,l),R.resolve()}else throw new Error('No "textContentSource" parameter specified.');R.promise.then(()=>{C=null,P(this)},this._capability.reject)}}e.TextLayerRenderTask=x;function w(v){!v.textContentSource&&(v.textContent||v.textContentStream)&&((0,d.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),v.textContentSource=v.textContent||v.textContentStream);const{container:R,viewport:C}=v,y=getComputedStyle(R),l=y.getPropertyValue("visibility"),u=parseFloat(y.getPropertyValue("--scale-factor"));l==="visible"&&(!u||Math.abs(u-C.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const O=new x(v);return O._render(),O}function g({container:v,viewport:R,textDivs:C,textDivProperties:y,isOffscreenCanvasSupported:l,mustRotate:u=!0,mustRescale:O=!0}){if(u&&(0,d.setLayerDimensions)(v,{rotation:R.rotation}),O){const _=A(0,l),F={prevFontSize:null,prevFontFamily:null,div:null,scale:R.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:_};for(const b of C)F.properties=y.get(b),F.div=b,N(F)}}},(p,e,D)=>{var m,L,N,P,x,w,g,v,R,C,y,nn,u,ke,_,sn,F,rn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=D(1),d=D(4),$=D(28),I=D(33),rt=D(6),k=D(34);const G=class G{constructor({uiManager:E,pageIndex:X,div:at,accessibilityManager:ct,annotationLayer:V,viewport:dt,l10n:mt}){H(this,y);H(this,u);H(this,_);H(this,F);H(this,m,void 0);H(this,L,!1);H(this,N,null);H(this,P,this.pointerup.bind(this));H(this,x,this.pointerdown.bind(this));H(this,w,new Map);H(this,g,!1);H(this,v,!1);H(this,R,!1);H(this,C,void 0);const Et=[$.FreeTextEditor,I.InkEditor,k.StampEditor];if(!G._initialized){G._initialized=!0;for(const wt of Et)wt.initialize(mt)}E.registerEditorTypes(Et),ot(this,C,E),this.pageIndex=X,this.div=at,ot(this,m,ct),ot(this,N,V),this.viewport=dt,t(this,C).addLayer(this)}get isEmpty(){return t(this,w).size===0}updateToolbar(E){t(this,C).updateToolbar(E)}updateMode(E=t(this,C).getMode()){Y(this,F,rn).call(this),E===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),E!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",E===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",E===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",E===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(E){if(!E&&t(this,C).getMode()!==n.AnnotationEditorType.INK)return;if(!E){for(const at of t(this,w).values())if(at.isEmpty()){at.setInBackground();return}}Y(this,u,ke).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(E){t(this,C).setEditingState(E)}addCommands(E){t(this,C).addCommands(E)}enable(){this.div.style.pointerEvents="auto";const E=new Set;for(const at of t(this,w).values())at.enableEditing(),at.annotationElementId&&E.add(at.annotationElementId);if(!t(this,N))return;const X=t(this,N).getEditableAnnotations();for(const at of X){if(at.hide(),t(this,C).isDeletedAnnotationElement(at.data.id)||E.has(at.data.id))continue;const ct=this.deserialize(at);ct&&(this.addOrRebuild(ct),ct.enableEditing())}}disable(){var X;ot(this,R,!0),this.div.style.pointerEvents="none";const E=new Set;for(const at of t(this,w).values()){if(at.disableEditing(),!at.annotationElementId||at.serialize()!==null){E.add(at.annotationElementId);continue}(X=this.getEditableAnnotation(at.annotationElementId))==null||X.show(),at.remove()}if(t(this,N)){const at=t(this,N).getEditableAnnotations();for(const ct of at){const{id:V}=ct.data;E.has(V)||t(this,C).isDeletedAnnotationElement(V)||ct.show()}}Y(this,F,rn).call(this),this.isEmpty&&(this.div.hidden=!0),ot(this,R,!1)}getEditableAnnotation(E){var X;return((X=t(this,N))==null?void 0:X.getEditableAnnotation(E))||null}setActiveEditor(E){t(this,C).getActive()!==E&&t(this,C).setActiveEditor(E)}enableClick(){this.div.addEventListener("pointerdown",t(this,x)),this.div.addEventListener("pointerup",t(this,P))}disableClick(){this.div.removeEventListener("pointerdown",t(this,x)),this.div.removeEventListener("pointerup",t(this,P))}attach(E){t(this,w).set(E.id,E);const{annotationElementId:X}=E;X&&t(this,C).isDeletedAnnotationElement(X)&&t(this,C).removeDeletedAnnotationElement(E)}detach(E){var X;t(this,w).delete(E.id),(X=t(this,m))==null||X.removePointerInTextLayer(E.contentDiv),!t(this,R)&&E.annotationElementId&&t(this,C).addDeletedAnnotationElement(E)}remove(E){this.detach(E),t(this,C).removeEditor(E),E.div.contains(document.activeElement)&&setTimeout(()=>{t(this,C).focusMainContainer()},0),E.div.remove(),E.isAttachedToDOM=!1,t(this,v)||this.addInkEditorIfNeeded(!1)}changeParent(E){var X;E.parent!==this&&(E.annotationElementId&&(t(this,C).addDeletedAnnotationElement(E.annotationElementId),d.AnnotationEditor.deleteAnnotationElement(E),E.annotationElementId=null),this.attach(E),(X=E.parent)==null||X.detach(E),E.setParent(this),E.div&&E.isAttachedToDOM&&(E.div.remove(),this.div.append(E.div)))}add(E){if(this.changeParent(E),t(this,C).addEditor(E),this.attach(E),!E.isAttachedToDOM){const X=E.render();this.div.append(X),E.isAttachedToDOM=!0}E.fixAndSetPosition(),E.onceAdded(),t(this,C).addToAnnotationStorage(E)}moveEditorInDOM(E){var at;if(!E.isAttachedToDOM)return;const{activeElement:X}=document;E.div.contains(X)&&(E._focusEventsAllowed=!1,setTimeout(()=>{E.div.contains(document.activeElement)?E._focusEventsAllowed=!0:(E.div.addEventListener("focusin",()=>{E._focusEventsAllowed=!0},{once:!0}),X.focus())},0)),E._structTreeParentId=(at=t(this,m))==null?void 0:at.moveElementInDOM(this.div,E.div,E.contentDiv,!0)}addOrRebuild(E){E.needsToBeRebuilt()?E.rebuild():this.add(E)}addUndoableEditor(E){const X=()=>E._uiManager.rebuild(E),at=()=>{E.remove()};this.addCommands({cmd:X,undo:at,mustExec:!1})}getNextId(){return t(this,C).getId()}pasteEditor(E,X){t(this,C).updateToolbar(E),t(this,C).updateMode(E);const{offsetX:at,offsetY:ct}=Y(this,_,sn).call(this),V=this.getNextId(),dt=Y(this,y,nn).call(this,{parent:this,id:V,x:at,y:ct,uiManager:t(this,C),isCentered:!0,...X});dt&&this.add(dt)}deserialize(E){switch(E.annotationType??E.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return $.FreeTextEditor.deserialize(E,this,t(this,C));case n.AnnotationEditorType.INK:return I.InkEditor.deserialize(E,this,t(this,C));case n.AnnotationEditorType.STAMP:return k.StampEditor.deserialize(E,this,t(this,C))}return null}addNewEditor(){Y(this,u,ke).call(this,Y(this,_,sn).call(this),!0)}setSelected(E){t(this,C).setSelected(E)}toggleSelected(E){t(this,C).toggleSelected(E)}isSelected(E){return t(this,C).isSelected(E)}unselect(E){t(this,C).unselect(E)}pointerup(E){const{isMac:X}=n.FeatureTest.platform;if(!(E.button!==0||E.ctrlKey&&X)&&E.target===this.div&&t(this,g)){if(ot(this,g,!1),!t(this,L)){ot(this,L,!0);return}if(t(this,C).getMode()===n.AnnotationEditorType.STAMP){t(this,C).unselectAll();return}Y(this,u,ke).call(this,E,!1)}}pointerdown(E){if(t(this,g)){ot(this,g,!1);return}const{isMac:X}=n.FeatureTest.platform;if(E.button!==0||E.ctrlKey&&X||E.target!==this.div)return;ot(this,g,!0);const at=t(this,C).getActive();ot(this,L,!at||at.isEmpty())}findNewParent(E,X,at){const ct=t(this,C).findParent(X,at);return ct===null||ct===this?!1:(ct.changeParent(E),!0)}destroy(){var E,X;((E=t(this,C).getActive())==null?void 0:E.parent)===this&&(t(this,C).commitOrRemove(),t(this,C).setActiveEditor(null));for(const at of t(this,w).values())(X=t(this,m))==null||X.removePointerInTextLayer(at.contentDiv),at.setParent(null),at.isAttachedToDOM=!1,at.div.remove();this.div=null,t(this,w).clear(),t(this,C).removeLayer(this)}render({viewport:E}){this.viewport=E,(0,rt.setLayerDimensions)(this.div,E);for(const X of t(this,C).getEditors(this.pageIndex))this.add(X);this.updateMode()}update({viewport:E}){t(this,C).commitOrRemove(),this.viewport=E,(0,rt.setLayerDimensions)(this.div,{rotation:E.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:E,pageHeight:X}=this.viewport.rawDims;return[E,X]}};m=new WeakMap,L=new WeakMap,N=new WeakMap,P=new WeakMap,x=new WeakMap,w=new WeakMap,g=new WeakMap,v=new WeakMap,R=new WeakMap,C=new WeakMap,y=new WeakSet,nn=function(E){switch(t(this,C).getMode()){case n.AnnotationEditorType.FREETEXT:return new $.FreeTextEditor(E);case n.AnnotationEditorType.INK:return new I.InkEditor(E);case n.AnnotationEditorType.STAMP:return new k.StampEditor(E)}return null},u=new WeakSet,ke=function(E,X){const at=this.getNextId(),ct=Y(this,y,nn).call(this,{parent:this,id:at,x:E.offsetX,y:E.offsetY,uiManager:t(this,C),isCentered:X});return ct&&this.add(ct),ct},_=new WeakSet,sn=function(){const{x:E,y:X,width:at,height:ct}=this.div.getBoundingClientRect(),V=Math.max(0,E),dt=Math.max(0,X),mt=Math.min(window.innerWidth,E+at),Et=Math.min(window.innerHeight,X+ct),wt=(V+mt)/2-E,M=(dt+Et)/2-X,[i,o]=this.viewport.rotation%180===0?[wt,M]:[M,wt];return{offsetX:i,offsetY:o}},F=new WeakSet,rn=function(){ot(this,v,!0);for(const E of t(this,w).values())E.isEmpty()&&E.remove();ot(this,v,!1)},ne(G,"_initialized",!1);let A=G;e.AnnotationEditorLayer=A},(p,e,D)=>{var k,A,m,L,N,P,x,w,g,v,Mn,C,Dn,l,Ln,O,ve,c,an,b,On,z,on;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=D(1),d=D(5),$=D(4),I=D(29);const X=class X extends $.AnnotationEditor{constructor(V){super({...V,name:"freeTextEditor"});H(this,v);H(this,C);H(this,l);H(this,O);H(this,c);H(this,b);H(this,z);H(this,k,this.editorDivBlur.bind(this));H(this,A,this.editorDivFocus.bind(this));H(this,m,this.editorDivInput.bind(this));H(this,L,this.editorDivKeydown.bind(this));H(this,N,void 0);H(this,P,"");H(this,x,`${this.id}-editor`);H(this,w,void 0);H(this,g,null);ot(this,N,V.color||X._defaultColor||$.AnnotationEditor._defaultLineColor),ot(this,w,V.fontSize||X._defaultFontSize)}static get _keyboardManager(){const V=X.prototype,dt=wt=>wt.isEmpty(),mt=d.AnnotationEditorUIManager.TRANSLATE_SMALL,Et=d.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new d.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],V.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],V.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],V._translateEmpty,{args:[-mt,0],checker:dt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],V._translateEmpty,{args:[-Et,0],checker:dt}],[["ArrowRight","mac+ArrowRight"],V._translateEmpty,{args:[mt,0],checker:dt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],V._translateEmpty,{args:[Et,0],checker:dt}],[["ArrowUp","mac+ArrowUp"],V._translateEmpty,{args:[0,-mt],checker:dt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],V._translateEmpty,{args:[0,-Et],checker:dt}],[["ArrowDown","mac+ArrowDown"],V._translateEmpty,{args:[0,mt],checker:dt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],V._translateEmpty,{args:[0,Et],checker:dt}]]))}static initialize(V){$.AnnotationEditor.initialize(V,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const dt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(dt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(V,dt){switch(V){case n.AnnotationEditorParamsType.FREETEXT_SIZE:X._defaultFontSize=dt;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:X._defaultColor=dt;break}}updateParams(V,dt){switch(V){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,v,Mn).call(this,dt);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,C,Dn).call(this,dt);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,X._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,X._defaultColor||$.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,w)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,N)]]}_translateEmpty(V,dt){this._uiManager.translateSelectedEditors(V,dt,!0)}getInitialTranslation(){const V=this.parentScale;return[-X._internalPadding*V,-(X._internalPadding+t(this,w))*V]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,L)),this.editorDiv.addEventListener("focus",t(this,A)),this.editorDiv.addEventListener("blur",t(this,k)),this.editorDiv.addEventListener("input",t(this,m)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,x)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,L)),this.editorDiv.removeEventListener("focus",t(this,A)),this.editorDiv.removeEventListener("blur",t(this,k)),this.editorDiv.removeEventListener("input",t(this,m)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(V){this._focusEventsAllowed&&(super.focusin(V),V.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var V;if(this.width){Y(this,z,on).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(V=this._initialOptions)!=null&&V.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const V=t(this,P),dt=ot(this,P,Y(this,l,Ln).call(this).trimEnd());if(V===dt)return;const mt=Et=>{if(ot(this,P,Et),!Et){this.remove();return}Y(this,c,an).call(this),this._uiManager.rebuild(this),Y(this,O,ve).call(this)};this.addCommands({cmd:()=>{mt(dt)},undo:()=>{mt(V)},mustExec:!1}),Y(this,O,ve).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(V){this.enterInEditMode()}keydown(V){V.target===this.div&&V.key==="Enter"&&(this.enterInEditMode(),V.preventDefault())}editorDivKeydown(V){X._keyboardManager.exec(this,V)}editorDivFocus(V){this.isEditing=!0}editorDivBlur(V){this.isEditing=!1}editorDivInput(V){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let V,dt;this.width&&(V=this.x,dt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,x)),this.enableEditing(),$.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Et=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("aria-label",Et)}),$.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Et=>{var wt;return(wt=this.editorDiv)==null?void 0:wt.setAttribute("default-content",Et)}),this.editorDiv.contentEditable=!0;const{style:mt}=this.editorDiv;if(mt.fontSize=`calc(${t(this,w)}px * var(--scale-factor))`,mt.color=t(this,N),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,d.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Et,wt]=this.parentDimensions;if(this.annotationElementId){const{position:M}=t(this,g);let[i,o]=this.getInitialTranslation();[i,o]=this.pageTranslationToScreen(i,o);const[a,h]=this.pageDimensions,[f,T]=this.pageTranslation;let j,W;switch(this.rotation){case 0:j=V+(M[0]-f)/a,W=dt+this.height-(M[1]-T)/h;break;case 90:j=V+(M[0]-f)/a,W=dt-(M[1]-T)/h,[i,o]=[o,-i];break;case 180:j=V-this.width+(M[0]-f)/a,W=dt-(M[1]-T)/h,[i,o]=[-i,-o];break;case 270:j=V+(M[0]-f-this.height*h)/a,W=dt+(M[1]-T-this.width*a)/h,[i,o]=[-o,i];break}this.setAt(j*Et,W*wt,i,o)}else this.setAt(V*Et,dt*wt,this.width*Et,this.height*wt);Y(this,c,an).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(V,dt,mt){let Et=null;if(V instanceof I.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:M,fontColor:i},rect:o,rotation:a,id:h},textContent:f,textPosition:T,parent:{page:{pageNumber:j}}}=V;if(!f||f.length===0)return null;Et=V={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(i),fontSize:M,value:f.join(`
`),position:T,pageIndex:j-1,rect:o,rotation:a,id:h,deleted:!1}}const wt=super.deserialize(V,dt,mt);return ot(wt,w,V.fontSize),ot(wt,N,n.Util.makeHexColor(...V.color)),ot(wt,P,V.value),wt.annotationElementId=V.id||null,ot(wt,g,Et),wt}serialize(V=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const dt=X._internalPadding*this.parentScale,mt=this.getRect(dt,dt),Et=$.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,N)),wt={annotationType:n.AnnotationEditorType.FREETEXT,color:Et,fontSize:t(this,w),value:t(this,P),pageIndex:this.pageIndex,rect:mt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return V?wt:this.annotationElementId&&!Y(this,b,On).call(this,wt)?null:(wt.id=this.annotationElementId,wt)}};k=new WeakMap,A=new WeakMap,m=new WeakMap,L=new WeakMap,N=new WeakMap,P=new WeakMap,x=new WeakMap,w=new WeakMap,g=new WeakMap,v=new WeakSet,Mn=function(V){const dt=Et=>{this.editorDiv.style.fontSize=`calc(${Et}px * var(--scale-factor))`,this.translate(0,-(Et-t(this,w))*this.parentScale),ot(this,w,Et),Y(this,O,ve).call(this)},mt=t(this,w);this.addCommands({cmd:()=>{dt(V)},undo:()=>{dt(mt)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},C=new WeakSet,Dn=function(V){const dt=t(this,N);this.addCommands({cmd:()=>{ot(this,N,this.editorDiv.style.color=V)},undo:()=>{ot(this,N,this.editorDiv.style.color=dt)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Ln=function(){const V=this.editorDiv.getElementsByTagName("div");if(V.length===0)return this.editorDiv.innerText;const dt=[];for(const mt of V)dt.push(mt.innerText.replace(/\r\n?|\n/,""));return dt.join(`
`)},O=new WeakSet,ve=function(){const[V,dt]=this.parentDimensions;let mt;if(this.isAttachedToDOM)mt=this.div.getBoundingClientRect();else{const{currentLayer:Et,div:wt}=this,M=wt.style.display;wt.style.display="hidden",Et.div.append(this.div),mt=wt.getBoundingClientRect(),wt.remove(),wt.style.display=M}this.rotation%180===this.parentRotation%180?(this.width=mt.width/V,this.height=mt.height/dt):(this.width=mt.height/V,this.height=mt.width/dt),this.fixAndSetPosition()},c=new WeakSet,an=function(){if(this.editorDiv.replaceChildren(),!!t(this,P))for(const V of t(this,P).split(`
`)){const dt=document.createElement("div");dt.append(V?document.createTextNode(V):document.createElement("br")),this.editorDiv.append(dt)}},b=new WeakSet,On=function(V){const{value:dt,fontSize:mt,color:Et,rect:wt,pageIndex:M}=t(this,g);return V.value!==dt||V.fontSize!==mt||V.rect.some((i,o)=>Math.abs(i-wt[o])>=1)||V.color.some((i,o)=>i!==Et[o])||V.pageIndex!==M},z=new WeakSet,on=function(V=!1){if(!this.annotationElementId)return;if(Y(this,O,ve).call(this),!V&&(this.width===0||this.height===0)){setTimeout(()=>Y(this,z,on).call(this,!0),0);return}const dt=X._internalPadding*this.parentScale;t(this,g).rect=this.getRect(dt,dt)},ne(X,"_freeTextDefaultContent",""),ne(X,"_internalPadding",0),ne(X,"_defaultColor",null),ne(X,"_defaultFontSize",10),ne(X,"_type","freetext");let rt=X;e.FreeTextEditor=rt},(p,e,D)=>{var o,h,he,T,In,W,it,tt,et,ht,bt,ut,Ft,Bt,St,Lt,gt,nt,st,pt,Tt,Ct,Ut,Nn,Wt,Fe,Gt,ln,Xt,cn,Z,K,At,vt,ee,te,Q,hn,It,Pt,Nt,jt,jn,yt,dn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=D(1),d=D(6),$=D(3),I=D(30),rt=D(31),k=D(32);const A=1e3,m=9,L=new WeakSet;function N(Ot){return{width:Ot[2]-Ot[0],height:Ot[3]-Ot[1]}}class P{static create(B){switch(B.data.annotationType){case n.AnnotationType.LINK:return new w(B);case n.AnnotationType.TEXT:return new g(B);case n.AnnotationType.WIDGET:switch(B.data.fieldType){case"Tx":return new R(B);case"Btn":return B.data.radioButton?new l(B):B.data.checkBox?new y(B):new u(B);case"Ch":return new O(B);case"Sig":return new C(B)}return new v(B);case n.AnnotationType.POPUP:return new _(B);case n.AnnotationType.FREETEXT:return new F(B);case n.AnnotationType.LINE:return new b(B);case n.AnnotationType.SQUARE:return new G(B);case n.AnnotationType.CIRCLE:return new z(B);case n.AnnotationType.POLYLINE:return new E(B);case n.AnnotationType.CARET:return new at(B);case n.AnnotationType.INK:return new ct(B);case n.AnnotationType.POLYGON:return new X(B);case n.AnnotationType.HIGHLIGHT:return new V(B);case n.AnnotationType.UNDERLINE:return new dt(B);case n.AnnotationType.SQUIGGLY:return new mt(B);case n.AnnotationType.STRIKEOUT:return new Et(B);case n.AnnotationType.STAMP:return new wt(B);case n.AnnotationType.FILEATTACHMENT:return new M(B);default:return new x(B)}}}const a=class a{constructor(B,{isRenderable:s=!1,ignoreBorder:S=!1,createQuadrilaterals:U=!1}={}){H(this,o,!1);this.isRenderable=s,this.data=B.data,this.layer=B.layer,this.linkService=B.linkService,this.downloadManager=B.downloadManager,this.imageResourcesPath=B.imageResourcesPath,this.renderForms=B.renderForms,this.svgFactory=B.svgFactory,this.annotationStorage=B.annotationStorage,this.enableScripting=B.enableScripting,this.hasJSActions=B.hasJSActions,this._fieldObjects=B.fieldObjects,this.parent=B.parent,s&&(this.container=this._createContainer(S)),U&&this._createQuadrilaterals()}static _hasPopupData({titleObj:B,contentsObj:s,richText:S}){return!!(B!=null&&B.str||s!=null&&s.str||S!=null&&S.str)}get hasPopupData(){return a._hasPopupData(this.data)}_createContainer(B){const{data:s,parent:{page:S,viewport:U}}=this,q=document.createElement("section");q.setAttribute("data-annotation-id",s.id),this instanceof v||(q.tabIndex=A),q.style.zIndex=this.parent.zIndex++,this.data.popupRef&&q.setAttribute("aria-haspopup","dialog"),s.noRotate&&q.classList.add("norotate");const{pageWidth:J,pageHeight:lt,pageX:_t,pageY:kt}=U.rawDims;if(!s.rect||this instanceof _){const{rotation:$t}=s;return!s.hasOwnCanvas&&$t!==0&&this.setRotation($t,q),q}const{width:Rt,height:qt}=N(s.rect),Mt=n.Util.normalizeRect([s.rect[0],S.view[3]-s.rect[1]+S.view[1],s.rect[2],S.view[3]-s.rect[3]+S.view[1]]);if(!B&&s.borderStyle.width>0){q.style.borderWidth=`${s.borderStyle.width}px`;const $t=s.borderStyle.horizontalCornerRadius,Yt=s.borderStyle.verticalCornerRadius;if($t>0||Yt>0){const Zt=`calc(${$t}px * var(--scale-factor)) / calc(${Yt}px * var(--scale-factor))`;q.style.borderRadius=Zt}else if(this instanceof l){const Zt=`calc(${Rt}px * var(--scale-factor)) / calc(${qt}px * var(--scale-factor))`;q.style.borderRadius=Zt}switch(s.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:q.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:q.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:q.style.borderBottomStyle="solid";break}const Jt=s.borderColor||null;Jt?(ot(this,o,!0),q.style.borderColor=n.Util.makeHexColor(Jt[0]|0,Jt[1]|0,Jt[2]|0)):q.style.borderWidth=0}q.style.left=`${100*(Mt[0]-_t)/J}%`,q.style.top=`${100*(Mt[1]-kt)/lt}%`;const{rotation:Dt}=s;return s.hasOwnCanvas||Dt===0?(q.style.width=`${100*Rt/J}%`,q.style.height=`${100*qt/lt}%`):this.setRotation(Dt,q),q}setRotation(B,s=this.container){if(!this.data.rect)return;const{pageWidth:S,pageHeight:U}=this.parent.viewport.rawDims,{width:q,height:J}=N(this.data.rect);let lt,_t;B%180===0?(lt=100*q/S,_t=100*J/U):(lt=100*J/S,_t=100*q/U),s.style.width=`${lt}%`,s.style.height=`${_t}%`,s.setAttribute("data-main-rotation",(360-B)%360)}get _commonActions(){const B=(s,S,U)=>{const q=U.detail[s],J=q[0],lt=q.slice(1);U.target.style[S]=I.ColorConverters[`${J}_HTML`](lt),this.annotationStorage.setValue(this.data.id,{[S]:I.ColorConverters[`${J}_rgb`](lt)})};return(0,n.shadow)(this,"_commonActions",{display:s=>{const{display:S}=s.detail,U=S%2===1;this.container.style.visibility=U?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:U,noPrint:S===1||S===2})},print:s=>{this.annotationStorage.setValue(this.data.id,{noPrint:!s.detail.print})},hidden:s=>{const{hidden:S}=s.detail;this.container.style.visibility=S?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:S,noView:S})},focus:s=>{setTimeout(()=>s.target.focus({preventScroll:!1}),0)},userName:s=>{s.target.title=s.detail.userName},readonly:s=>{s.target.disabled=s.detail.readonly},required:s=>{this._setRequired(s.target,s.detail.required)},bgColor:s=>{B("bgColor","backgroundColor",s)},fillColor:s=>{B("fillColor","backgroundColor",s)},fgColor:s=>{B("fgColor","color",s)},textColor:s=>{B("textColor","color",s)},borderColor:s=>{B("borderColor","borderColor",s)},strokeColor:s=>{B("strokeColor","borderColor",s)},rotation:s=>{const S=s.detail.rotation;this.setRotation(S),this.annotationStorage.setValue(this.data.id,{rotation:S})}})}_dispatchEventFromSandbox(B,s){const S=this._commonActions;for(const U of Object.keys(s.detail)){const q=B[U]||S[U];q==null||q(s)}}_setDefaultPropertiesFromJS(B){if(!this.enableScripting)return;const s=this.annotationStorage.getRawValue(this.data.id);if(!s)return;const S=this._commonActions;for(const[U,q]of Object.entries(s)){const J=S[U];if(J){const lt={detail:{[U]:q},target:B};J(lt),delete s[U]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:B}=this.data;if(!B)return;const[s,S,U,q]=this.data.rect;if(B.length===1){const[,{x:Yt,y:Jt},{x:Zt,y:ie}]=B[0];if(U===Yt&&q===Jt&&s===Zt&&S===ie)return}const{style:J}=this.container;let lt;if(t(this,o)){const{borderColor:Yt,borderWidth:Jt}=J;J.borderWidth=0,lt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Yt}" stroke-width="${Jt}">`],this.container.classList.add("hasBorder")}const _t=U-s,kt=q-S,{svgFactory:Rt}=this,qt=Rt.createElement("svg");qt.classList.add("quadrilateralsContainer"),qt.setAttribute("width",0),qt.setAttribute("height",0);const Mt=Rt.createElement("defs");qt.append(Mt);const Dt=Rt.createElement("clipPath"),$t=`clippath_${this.data.id}`;Dt.setAttribute("id",$t),Dt.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(Dt);for(const[,{x:Yt,y:Jt},{x:Zt,y:ie}]of B){const se=Rt.createElement("rect"),re=(Zt-s)/_t,le=(q-Jt)/kt,ce=(Yt-Zt)/_t,yn=(Jt-ie)/kt;se.setAttribute("x",re),se.setAttribute("y",le),se.setAttribute("width",ce),se.setAttribute("height",yn),Dt.append(se),lt==null||lt.push(`<rect vector-effect="non-scaling-stroke" x="${re}" y="${le}" width="${ce}" height="${yn}"/>`)}t(this,o)&&(lt.push("</g></svg>')"),J.backgroundImage=lt.join("")),this.container.append(qt),this.container.style.clipPath=`url(#${$t})`}_createPopup(){const{container:B,data:s}=this;B.setAttribute("aria-haspopup","dialog");const S=new _({data:{color:s.color,titleObj:s.titleObj,modificationDate:s.modificationDate,contentsObj:s.contentsObj,richText:s.richText,parentRect:s.rect,borderStyle:0,id:`popup_${s.id}`,rotation:s.rotation},parent:this.parent,elements:[this]});this.parent.div.append(S.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(B,s=null){const S=[];if(this._fieldObjects){const U=this._fieldObjects[B];if(U)for(const{page:q,id:J,exportValues:lt}of U){if(q===-1||J===s)continue;const _t=typeof lt=="string"?lt:null,kt=document.querySelector(`[data-element-id="${J}"]`);if(kt&&!L.has(kt)){(0,n.warn)(`_getElementsByName - element not allowed: ${J}`);continue}S.push({id:J,exportValue:_t,domElement:kt})}return S}for(const U of document.getElementsByName(B)){const{exportValue:q}=U,J=U.getAttribute("data-element-id");J!==s&&L.has(U)&&S.push({id:J,exportValue:q,domElement:U})}return S}show(){var B;this.container&&(this.container.hidden=!1),(B=this.popup)==null||B.maybeShow()}hide(){var B;this.container&&(this.container.hidden=!0),(B=this.popup)==null||B.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const B=this.getElementsToTriggerPopup();if(Array.isArray(B))for(const s of B)s.classList.add("highlightArea");else B.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:B,data:{id:s}}=this;this.container.addEventListener("dblclick",()=>{var S;(S=this.linkService.eventBus)==null||S.dispatch("switchannotationeditormode",{source:this,mode:B,editId:s})})}};o=new WeakMap;let x=a;class w extends x{constructor(s,S=null){super(s,{isRenderable:!0,ignoreBorder:!!(S!=null&&S.ignoreBorder),createQuadrilaterals:!0});H(this,h);H(this,T);this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:S}=this,U=document.createElement("a");U.setAttribute("data-element-id",s.id);let q=!1;return s.url?(S.addLinkAttributes(U,s.url,s.newWindow),q=!0):s.action?(this._bindNamedAction(U,s.action),q=!0):s.attachment?(this._bindAttachment(U,s.attachment),q=!0):s.setOCGState?(Y(this,T,In).call(this,U,s.setOCGState),q=!0):s.dest?(this._bindLink(U,s.dest),q=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(U,s),q=!0),s.resetForm?(this._bindResetFormAction(U,s.resetForm),q=!0):this.isTooltipOnly&&!q&&(this._bindLink(U,""),q=!0)),this.container.classList.add("linkAnnotation"),q&&this.container.append(U),this.container}_bindLink(s,S){s.href=this.linkService.getDestinationHash(S),s.onclick=()=>(S&&this.linkService.goToDestination(S),!1),(S||S==="")&&Y(this,h,he).call(this)}_bindNamedAction(s,S){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(S),!1),Y(this,h,he).call(this)}_bindAttachment(s,S){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>{var U;return(U=this.downloadManager)==null||U.openOrDownloadData(this.container,S.content,S.filename),!1},Y(this,h,he).call(this)}_bindJSAction(s,S){s.href=this.linkService.getAnchorUrl("");const U=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(S.actions)){const J=U.get(q);J&&(s[J]=()=>{var lt;return(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:S.id,name:q}}),!1})}s.onclick||(s.onclick=()=>!1),Y(this,h,he).call(this)}_bindResetFormAction(s,S){const U=s.onclick;if(U||(s.href=this.linkService.getAnchorUrl("")),Y(this,h,he).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),U||(s.onclick=()=>!1);return}s.onclick=()=>{var qt;U==null||U();const{fields:q,refs:J,include:lt}=S,_t=[];if(q.length!==0||J.length!==0){const Mt=new Set(J);for(const Dt of q){const $t=this._fieldObjects[Dt]||[];for(const{id:Yt}of $t)Mt.add(Yt)}for(const Dt of Object.values(this._fieldObjects))for(const $t of Dt)Mt.has($t.id)===lt&&_t.push($t)}else for(const Mt of Object.values(this._fieldObjects))_t.push(...Mt);const kt=this.annotationStorage,Rt=[];for(const Mt of _t){const{id:Dt}=Mt;switch(Rt.push(Dt),Mt.type){case"text":{const Yt=Mt.defaultValue||"";kt.setValue(Dt,{value:Yt});break}case"checkbox":case"radiobutton":{const Yt=Mt.defaultValue===Mt.exportValues;kt.setValue(Dt,{value:Yt});break}case"combobox":case"listbox":{const Yt=Mt.defaultValue||"";kt.setValue(Dt,{value:Yt});break}default:continue}const $t=document.querySelector(`[data-element-id="${Dt}"]`);if($t){if(!L.has($t)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Dt}`);continue}}else continue;$t.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Rt,name:"ResetForm"}})),!1}}}h=new WeakSet,he=function(){this.container.setAttribute("data-internal-link","")},T=new WeakSet,In=function(s,S){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeSetOCGState(S),!1),Y(this,h,he).call(this)};class g extends x{constructor(B){super(B,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const B=document.createElement("img");return B.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",B.alt="[{{type}} Annotation]",B.dataset.l10nId="text_annotation_type",B.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(B),this.container}}class v extends x{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(B){var s;this.data.hasOwnCanvas&&(((s=B.previousSibling)==null?void 0:s.nodeName)==="CANVAS"&&(B.previousSibling.hidden=!0),B.hidden=!1)}_getKeyModifier(B){const{isWin:s,isMac:S}=n.FeatureTest.platform;return s&&B.ctrlKey||S&&B.metaKey}_setEventListener(B,s,S,U,q){S.includes("mouse")?B.addEventListener(S,J=>{var lt;(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(J),shift:J.shiftKey,modifier:this._getKeyModifier(J)}})}):B.addEventListener(S,J=>{var lt;if(S==="blur"){if(!s.focused||!J.relatedTarget)return;s.focused=!1}else if(S==="focus"){if(s.focused)return;s.focused=!0}q&&((lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:U,value:q(J)}}))})}_setEventListeners(B,s,S,U){var q,J,lt;for(const[_t,kt]of S)(kt==="Action"||(q=this.data.actions)!=null&&q[kt])&&((kt==="Focus"||kt==="Blur")&&(s||(s={focused:!1})),this._setEventListener(B,s,_t,kt,U),kt==="Focus"&&!((J=this.data.actions)!=null&&J.Blur)?this._setEventListener(B,s,"blur","Blur",null):kt==="Blur"&&!((lt=this.data.actions)!=null&&lt.Focus)&&this._setEventListener(B,s,"focus","Focus",null))}_setBackgroundColor(B){const s=this.data.backgroundColor||null;B.style.backgroundColor=s===null?"transparent":n.Util.makeHexColor(s[0],s[1],s[2])}_setTextStyle(B){const s=["left","center","right"],{fontColor:S}=this.data.defaultAppearanceData,U=this.data.defaultAppearanceData.fontSize||m,q=B.style;let J;const lt=2,_t=kt=>Math.round(10*kt)/10;if(this.data.multiLine){const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-lt),Rt=Math.round(kt/(n.LINE_FACTOR*U))||1,qt=kt/Rt;J=Math.min(U,_t(qt/n.LINE_FACTOR))}else{const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-lt);J=Math.min(U,_t(kt/n.LINE_FACTOR))}q.fontSize=`calc(${J}px * var(--scale-factor))`,q.color=n.Util.makeHexColor(S[0],S[1],S[2]),this.data.textAlignment!==null&&(q.textAlign=s[this.data.textAlignment])}_setRequired(B,s){s?B.setAttribute("required",!0):B.removeAttribute("required"),B.setAttribute("aria-required",s)}}class R extends v{constructor(B){const s=B.renderForms||!B.data.hasAppearance&&!!B.data.fieldValue;super(B,{isRenderable:s})}setPropertyOnSiblings(B,s,S,U){const q=this.annotationStorage;for(const J of this._getElementsByName(B.name,B.id))J.domElement&&(J.domElement[s]=S),q.setValue(J.id,{[U]:S})}render(){var U,q;const B=this.annotationStorage,s=this.data.id;this.container.classList.add("textWidgetAnnotation");let S=null;if(this.renderForms){const J=B.getValue(s,{value:this.data.fieldValue});let lt=J.value||"";const _t=B.getValue(s,{charLimit:this.data.maxLen}).charLimit;_t&&lt.length>_t&&(lt=lt.slice(0,_t));let kt=J.formattedValue||((U=this.data.textContent)==null?void 0:U.join(`
`))||null;kt&&this.data.comb&&(kt=kt.replaceAll(/\s+/g,""));const Rt={userValue:lt,formattedValue:kt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(S=document.createElement("textarea"),S.textContent=kt??lt,this.data.doNotScroll&&(S.style.overflowY="hidden")):(S=document.createElement("input"),S.type="text",S.setAttribute("value",kt??lt),this.data.doNotScroll&&(S.style.overflowX="hidden")),this.data.hasOwnCanvas&&(S.hidden=!0),L.add(S),S.setAttribute("data-element-id",s),S.disabled=this.data.readOnly,S.name=this.data.fieldName,S.tabIndex=A,this._setRequired(S,this.data.required),_t&&(S.maxLength=_t),S.addEventListener("input",Mt=>{B.setValue(s,{value:Mt.target.value}),this.setPropertyOnSiblings(S,"value",Mt.target.value,"value"),Rt.formattedValue=null}),S.addEventListener("resetform",Mt=>{const Dt=this.data.defaultFieldValue??"";S.value=Rt.userValue=Dt,Rt.formattedValue=null});let qt=Mt=>{const{formattedValue:Dt}=Rt;Dt!=null&&(Mt.target.value=Dt),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){S.addEventListener("focus",Dt=>{if(Rt.focused)return;const{target:$t}=Dt;Rt.userValue&&($t.value=Rt.userValue),Rt.lastCommittedValue=$t.value,Rt.commitKey=1,Rt.focused=!0}),S.addEventListener("updatefromsandbox",Dt=>{this.showElementAndHideCanvas(Dt.target);const $t={value(Yt){Rt.userValue=Yt.detail.value??"",B.setValue(s,{value:Rt.userValue.toString()}),Yt.target.value=Rt.userValue},formattedValue(Yt){const{formattedValue:Jt}=Yt.detail;Rt.formattedValue=Jt,Jt!=null&&Yt.target!==document.activeElement&&(Yt.target.value=Jt),B.setValue(s,{formattedValue:Jt})},selRange(Yt){Yt.target.setSelectionRange(...Yt.detail.selRange)},charLimit:Yt=>{var se;const{charLimit:Jt}=Yt.detail,{target:Zt}=Yt;if(Jt===0){Zt.removeAttribute("maxLength");return}Zt.setAttribute("maxLength",Jt);let ie=Rt.userValue;!ie||ie.length<=Jt||(ie=ie.slice(0,Jt),Zt.value=Rt.userValue=ie,B.setValue(s,{value:ie}),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:ie,willCommit:!0,commitKey:1,selStart:Zt.selectionStart,selEnd:Zt.selectionEnd}}))}};this._dispatchEventFromSandbox($t,Dt)}),S.addEventListener("keydown",Dt=>{var Jt;Rt.commitKey=1;let $t=-1;if(Dt.key==="Escape"?$t=0:Dt.key==="Enter"&&!this.data.multiLine?$t=2:Dt.key==="Tab"&&(Rt.commitKey=3),$t===-1)return;const{value:Yt}=Dt.target;Rt.lastCommittedValue!==Yt&&(Rt.lastCommittedValue=Yt,Rt.userValue=Yt,(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Yt,willCommit:!0,commitKey:$t,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}}))});const Mt=qt;qt=null,S.addEventListener("blur",Dt=>{var Yt;if(!Rt.focused||!Dt.relatedTarget)return;Rt.focused=!1;const{value:$t}=Dt.target;Rt.userValue=$t,Rt.lastCommittedValue!==$t&&((Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:$t,willCommit:!0,commitKey:Rt.commitKey,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}})),Mt(Dt)}),(q=this.data.actions)!=null&&q.Keystroke&&S.addEventListener("beforeinput",Dt=>{var le;Rt.lastCommittedValue=null;const{data:$t,target:Yt}=Dt,{value:Jt,selectionStart:Zt,selectionEnd:ie}=Yt;let se=Zt,re=ie;switch(Dt.inputType){case"deleteWordBackward":{const ce=Jt.substring(0,Zt).match(/\w*[^\w]*$/);ce&&(se-=ce[0].length);break}case"deleteWordForward":{const ce=Jt.substring(Zt).match(/^[^\w]*\w*/);ce&&(re+=ce[0].length);break}case"deleteContentBackward":Zt===ie&&(se-=1);break;case"deleteContentForward":Zt===ie&&(re+=1);break}Dt.preventDefault(),(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Jt,change:$t||"",willCommit:!1,selStart:se,selEnd:re}})}),this._setEventListeners(S,Rt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Dt=>Dt.target.value)}if(qt&&S.addEventListener("blur",qt),this.data.comb){const Dt=(this.data.rect[2]-this.data.rect[0])/_t;S.classList.add("comb"),S.style.letterSpacing=`calc(${Dt}px * var(--scale-factor) - 1ch)`}}else S=document.createElement("div"),S.textContent=this.data.fieldValue,S.style.verticalAlign="middle",S.style.display="table-cell";return this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}class C extends v{constructor(B){super(B,{isRenderable:!!B.data.hasOwnCanvas})}}class y extends v{constructor(B){super(B,{isRenderable:B.renderForms})}render(){const B=this.annotationStorage,s=this.data,S=s.id;let U=B.getValue(S,{value:s.exportValue===s.fieldValue}).value;typeof U=="string"&&(U=U!=="Off",B.setValue(S,{value:U})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const q=document.createElement("input");return L.add(q),q.setAttribute("data-element-id",S),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="checkbox",q.name=s.fieldName,U&&q.setAttribute("checked",!0),q.setAttribute("exportValue",s.exportValue),q.tabIndex=A,q.addEventListener("change",J=>{const{name:lt,checked:_t}=J.target;for(const kt of this._getElementsByName(lt,S)){const Rt=_t&&kt.exportValue===s.exportValue;kt.domElement&&(kt.domElement.checked=Rt),B.setValue(kt.id,{value:Rt})}B.setValue(S,{value:_t})}),q.addEventListener("resetform",J=>{const lt=s.defaultFieldValue||"Off";J.target.checked=lt===s.exportValue}),this.enableScripting&&this.hasJSActions&&(q.addEventListener("updatefromsandbox",J=>{const lt={value(_t){_t.target.checked=_t.detail.value!=="Off",B.setValue(S,{value:_t.target.checked})}};this._dispatchEventFromSandbox(lt,J)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)),this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class l extends v{constructor(B){super(B,{isRenderable:B.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const B=this.annotationStorage,s=this.data,S=s.id;let U=B.getValue(S,{value:s.fieldValue===s.buttonValue}).value;typeof U=="string"&&(U=U!==s.buttonValue,B.setValue(S,{value:U}));const q=document.createElement("input");if(L.add(q),q.setAttribute("data-element-id",S),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="radio",q.name=s.fieldName,U&&q.setAttribute("checked",!0),q.tabIndex=A,q.addEventListener("change",J=>{const{name:lt,checked:_t}=J.target;for(const kt of this._getElementsByName(lt,S))B.setValue(kt.id,{value:!1});B.setValue(S,{value:_t})}),q.addEventListener("resetform",J=>{const lt=s.defaultFieldValue;J.target.checked=lt!=null&&lt===s.buttonValue}),this.enableScripting&&this.hasJSActions){const J=s.buttonValue;q.addEventListener("updatefromsandbox",lt=>{const _t={value:kt=>{const Rt=J===kt.detail.value;for(const qt of this._getElementsByName(kt.target.name)){const Mt=Rt&&qt.id===S;qt.domElement&&(qt.domElement.checked=Mt),B.setValue(qt.id,{value:Mt})}}};this._dispatchEventFromSandbox(_t,lt)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],lt=>lt.target.checked)}return this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class u extends w{constructor(B){super(B,{ignoreBorder:B.data.hasAppearance})}render(){const B=super.render();B.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(B.title=this.data.alternativeText);const s=B.lastChild;return this.enableScripting&&this.hasJSActions&&s&&(this._setDefaultPropertiesFromJS(s),s.addEventListener("updatefromsandbox",S=>{this._dispatchEventFromSandbox({},S)})),B}}class O extends v{constructor(B){super(B,{isRenderable:B.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const B=this.annotationStorage,s=this.data.id,S=B.getValue(s,{value:this.data.fieldValue}),U=document.createElement("select");L.add(U),U.setAttribute("data-element-id",s),U.disabled=this.data.readOnly,this._setRequired(U,this.data.required),U.name=this.data.fieldName,U.tabIndex=A;let q=this.data.combo&&this.data.options.length>0;this.data.combo||(U.size=this.data.options.length,this.data.multiSelect&&(U.multiple=!0)),U.addEventListener("resetform",Rt=>{const qt=this.data.defaultFieldValue;for(const Mt of U.options)Mt.selected=Mt.value===qt});for(const Rt of this.data.options){const qt=document.createElement("option");qt.textContent=Rt.displayValue,qt.value=Rt.exportValue,S.value.includes(Rt.exportValue)&&(qt.setAttribute("selected",!0),q=!1),U.append(qt)}let J=null;if(q){const Rt=document.createElement("option");Rt.value=" ",Rt.setAttribute("hidden",!0),Rt.setAttribute("selected",!0),U.prepend(Rt),J=()=>{Rt.remove(),U.removeEventListener("input",J),J=null},U.addEventListener("input",J)}const lt=Rt=>{const qt=Rt?"value":"textContent",{options:Mt,multiple:Dt}=U;return Dt?Array.prototype.filter.call(Mt,$t=>$t.selected).map($t=>$t[qt]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][qt]};let _t=lt(!1);const kt=Rt=>{const qt=Rt.target.options;return Array.prototype.map.call(qt,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(U.addEventListener("updatefromsandbox",Rt=>{const qt={value(Mt){J==null||J();const Dt=Mt.detail.value,$t=new Set(Array.isArray(Dt)?Dt:[Dt]);for(const Yt of U.options)Yt.selected=$t.has(Yt.value);B.setValue(s,{value:lt(!0)}),_t=lt(!1)},multipleSelection(Mt){U.multiple=!0},remove(Mt){const Dt=U.options,$t=Mt.detail.remove;Dt[$t].selected=!1,U.remove($t),Dt.length>0&&Array.prototype.findIndex.call(Dt,Jt=>Jt.selected)===-1&&(Dt[0].selected=!0),B.setValue(s,{value:lt(!0),items:kt(Mt)}),_t=lt(!1)},clear(Mt){for(;U.length!==0;)U.remove(0);B.setValue(s,{value:null,items:[]}),_t=lt(!1)},insert(Mt){const{index:Dt,displayValue:$t,exportValue:Yt}=Mt.detail.insert,Jt=U.children[Dt],Zt=document.createElement("option");Zt.textContent=$t,Zt.value=Yt,Jt?Jt.before(Zt):U.append(Zt),B.setValue(s,{value:lt(!0),items:kt(Mt)}),_t=lt(!1)},items(Mt){const{items:Dt}=Mt.detail;for(;U.length!==0;)U.remove(0);for(const $t of Dt){const{displayValue:Yt,exportValue:Jt}=$t,Zt=document.createElement("option");Zt.textContent=Yt,Zt.value=Jt,U.append(Zt)}U.options.length>0&&(U.options[0].selected=!0),B.setValue(s,{value:lt(!0),items:kt(Mt)}),_t=lt(!1)},indices(Mt){const Dt=new Set(Mt.detail.indices);for(const $t of Mt.target.options)$t.selected=Dt.has($t.index);B.setValue(s,{value:lt(!0)}),_t=lt(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(qt,Rt)}),U.addEventListener("input",Rt=>{var Mt;const qt=lt(!0);B.setValue(s,{value:qt}),Rt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:_t,changeEx:qt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(U,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Rt=>Rt.target.value)):U.addEventListener("input",function(Rt){B.setValue(s,{value:lt(!0)})}),this.data.combo&&this._setTextStyle(U),this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class _ extends x{constructor(B){const{data:s,elements:S}=B;super(B,{isRenderable:x._hasPopupData(s)}),this.elements=S}render(){this.container.classList.add("popupAnnotation");const B=new c({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const S of this.elements)S.popup=B,s.push(S.data.id),S.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(S=>`${n.AnnotationPrefix}${S}`).join(",")),this.container}}class c{constructor({container:B,color:s,elements:S,titleObj:U,modificationDate:q,contentsObj:J,richText:lt,parent:_t,rect:kt,parentRect:Rt,open:qt}){H(this,Ut);H(this,Wt);H(this,Gt);H(this,Xt);H(this,W,null);H(this,it,Y(this,Ut,Nn).bind(this));H(this,tt,Y(this,Xt,cn).bind(this));H(this,et,Y(this,Gt,ln).bind(this));H(this,ht,Y(this,Wt,Fe).bind(this));H(this,bt,null);H(this,ut,null);H(this,Ft,null);H(this,Bt,null);H(this,St,null);H(this,Lt,null);H(this,gt,!1);H(this,nt,null);H(this,st,null);H(this,pt,null);H(this,Tt,null);H(this,Ct,!1);var Dt;ot(this,ut,B),ot(this,Tt,U),ot(this,Ft,J),ot(this,pt,lt),ot(this,St,_t),ot(this,bt,s),ot(this,st,kt),ot(this,Lt,Rt),ot(this,Bt,S);const Mt=d.PDFDateString.toDateObject(q);Mt&&ot(this,W,_t.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=S.flatMap($t=>$t.getElementsToTriggerPopup());for(const $t of this.trigger)$t.addEventListener("click",t(this,ht)),$t.addEventListener("mouseenter",t(this,et)),$t.addEventListener("mouseleave",t(this,tt)),$t.classList.add("popupTriggerArea");for(const $t of S)(Dt=$t.container)==null||Dt.addEventListener("keydown",t(this,it));t(this,ut).hidden=!0,qt&&Y(this,Wt,Fe).call(this)}render(){if(t(this,nt))return;const{page:{view:B},viewport:{rawDims:{pageWidth:s,pageHeight:S,pageX:U,pageY:q}}}=t(this,St),J=ot(this,nt,document.createElement("div"));if(J.className="popup",t(this,bt)){const se=J.style.outlineColor=n.Util.makeHexColor(...t(this,bt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?J.style.backgroundColor=`color-mix(in srgb, ${se} 30%, white)`:J.style.backgroundColor=n.Util.makeHexColor(...t(this,bt).map(le=>Math.floor(.7*(255-le)+le)))}const lt=document.createElement("span");lt.className="header";const _t=document.createElement("h1");if(lt.append(_t),{dir:_t.dir,str:_t.textContent}=t(this,Tt),J.append(lt),t(this,W)){const se=document.createElement("span");se.classList.add("popupDate"),t(this,W).then(re=>{se.textContent=re}),lt.append(se)}const kt=t(this,Ft),Rt=t(this,pt);if(Rt!=null&&Rt.str&&(!(kt!=null&&kt.str)||kt.str===Rt.str))k.XfaLayer.render({xfaHtml:Rt.html,intent:"richText",div:J}),J.lastChild.classList.add("richText","popupContent");else{const se=this._formatContents(kt);J.append(se)}let qt=!!t(this,Lt),Mt=qt?t(this,Lt):t(this,st);for(const se of t(this,Bt))if(!Mt||n.Util.intersect(se.data.rect,Mt)!==null){Mt=se.data.rect,qt=!0;break}const Dt=n.Util.normalizeRect([Mt[0],B[3]-Mt[1]+B[1],Mt[2],B[3]-Mt[3]+B[1]]),$t=5,Yt=qt?Mt[2]-Mt[0]+$t:0,Jt=Dt[0]+Yt,Zt=Dt[1],{style:ie}=t(this,ut);ie.left=`${100*(Jt-U)/s}%`,ie.top=`${100*(Zt-q)/S}%`,t(this,ut).append(J)}_formatContents({str:B,dir:s}){const S=document.createElement("p");S.classList.add("popupContent"),S.dir=s;const U=B.split(/(?:\r\n?|\n)/);for(let q=0,J=U.length;q<J;++q){const lt=U[q];S.append(document.createTextNode(lt)),q<J-1&&S.append(document.createElement("br"))}return S}forceHide(){ot(this,Ct,this.isVisible),t(this,Ct)&&(t(this,ut).hidden=!0)}maybeShow(){t(this,Ct)&&(ot(this,Ct,!1),t(this,ut).hidden=!1)}get isVisible(){return t(this,ut).hidden===!1}}W=new WeakMap,it=new WeakMap,tt=new WeakMap,et=new WeakMap,ht=new WeakMap,bt=new WeakMap,ut=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,St=new WeakMap,Lt=new WeakMap,gt=new WeakMap,nt=new WeakMap,st=new WeakMap,pt=new WeakMap,Tt=new WeakMap,Ct=new WeakMap,Ut=new WeakSet,Nn=function(B){B.altKey||B.shiftKey||B.ctrlKey||B.metaKey||(B.key==="Enter"||B.key==="Escape"&&t(this,gt))&&Y(this,Wt,Fe).call(this)},Wt=new WeakSet,Fe=function(){ot(this,gt,!t(this,gt)),t(this,gt)?(Y(this,Gt,ln).call(this),t(this,ut).addEventListener("click",t(this,ht)),t(this,ut).addEventListener("keydown",t(this,it))):(Y(this,Xt,cn).call(this),t(this,ut).removeEventListener("click",t(this,ht)),t(this,ut).removeEventListener("keydown",t(this,it)))},Gt=new WeakSet,ln=function(){t(this,nt)||this.render(),this.isVisible?t(this,gt)&&t(this,ut).classList.add("focused"):(t(this,ut).hidden=!1,t(this,ut).style.zIndex=parseInt(t(this,ut).style.zIndex)+1e3)},Xt=new WeakSet,cn=function(){t(this,ut).classList.remove("focused"),!(t(this,gt)||!this.isVisible)&&(t(this,ut).hidden=!0,t(this,ut).style.zIndex=parseInt(t(this,ut).style.zIndex)-1e3)};class F extends x{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0}),this.textContent=B.data.textContent,this.textPosition=B.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const B=document.createElement("div");B.classList.add("annotationTextContent"),B.setAttribute("role","comment");for(const s of this.textContent){const S=document.createElement("span");S.textContent=s,B.append(S)}this.container.append(B)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=F;class b extends x{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,Z,null)}render(){this.container.classList.add("lineAnnotation");const s=this.data,{width:S,height:U}=N(s.rect),q=this.svgFactory.create(S,U,!0),J=ot(this,Z,this.svgFactory.createElement("svg:line"));return J.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),J.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),J.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),J.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),J.setAttribute("stroke-width",s.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),q.append(J),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Z)}addHighlightArea(){this.container.classList.add("highlightArea")}}Z=new WeakMap;class G extends x{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,K,null)}render(){this.container.classList.add("squareAnnotation");const s=this.data,{width:S,height:U}=N(s.rect),q=this.svgFactory.create(S,U,!0),J=s.borderStyle.width,lt=ot(this,K,this.svgFactory.createElement("svg:rect"));return lt.setAttribute("x",J/2),lt.setAttribute("y",J/2),lt.setAttribute("width",S-J),lt.setAttribute("height",U-J),lt.setAttribute("stroke-width",J||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap;class z extends x{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,At,null)}render(){this.container.classList.add("circleAnnotation");const s=this.data,{width:S,height:U}=N(s.rect),q=this.svgFactory.create(S,U,!0),J=s.borderStyle.width,lt=ot(this,At,this.svgFactory.createElement("svg:ellipse"));return lt.setAttribute("cx",S/2),lt.setAttribute("cy",U/2),lt.setAttribute("rx",S/2-J/2),lt.setAttribute("ry",U/2-J/2),lt.setAttribute("stroke-width",J||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,At)}addHighlightArea(){this.container.classList.add("highlightArea")}}At=new WeakMap;class E extends x{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,vt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:S,height:U}=N(s.rect),q=this.svgFactory.create(S,U,!0);let J=[];for(const _t of s.vertices){const kt=_t.x-s.rect[0],Rt=s.rect[3]-_t.y;J.push(kt+","+Rt)}J=J.join(" ");const lt=ot(this,vt,this.svgFactory.createElement(this.svgElementName));return lt.setAttribute("points",J),lt.setAttribute("stroke-width",s.borderStyle.width||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,vt)}addHighlightArea(){this.container.classList.add("highlightArea")}}vt=new WeakMap;class X extends E{constructor(B){super(B),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class at extends x{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ct extends x{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});H(this,ee,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:S,height:U}=N(s.rect),q=this.svgFactory.create(S,U,!0);for(const J of s.inkLists){let lt=[];for(const kt of J){const Rt=kt.x-s.rect[0],qt=s.rect[3]-kt.y;lt.push(`${Rt},${qt}`)}lt=lt.join(" ");const _t=this.svgFactory.createElement(this.svgElementName);t(this,ee).push(_t),_t.setAttribute("points",lt),_t.setAttribute("stroke-width",s.borderStyle.width||1),_t.setAttribute("stroke","transparent"),_t.setAttribute("fill","transparent"),!s.popupRef&&this.hasPopupData&&this._createPopup(),q.append(_t)}return this.container.append(q),this.container}getElementsToTriggerPopup(){return t(this,ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}ee=new WeakMap,e.InkAnnotationElement=ct;class V extends x{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class dt extends x{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class mt extends x{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Et extends x{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class wt extends x{constructor(B){super(B,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=wt;class M extends x{constructor(s){var q;super(s,{isRenderable:!0});H(this,Q);H(this,te,null);const{filename:S,content:U}=this.data.file;this.filename=(0,d.getFilenameFromUrl)(S,!0),this.content=U,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,filename:S,content:U})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:s,data:S}=this;let U;S.hasAppearance||S.fillAlpha===0?U=document.createElement("div"):(U=document.createElement("img"),U.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(S.name)?"paperclip":"pushpin"}.svg`,S.fillAlpha&&S.fillAlpha<1&&(U.style=`filter: opacity(${Math.round(S.fillAlpha*100)}%);`)),U.addEventListener("dblclick",Y(this,Q,hn).bind(this)),ot(this,te,U);const{isMac:q}=n.FeatureTest.platform;return s.addEventListener("keydown",J=>{J.key==="Enter"&&(q?J.metaKey:J.ctrlKey)&&Y(this,Q,hn).call(this)}),!S.popupRef&&this.hasPopupData?this._createPopup():U.classList.add("popupTriggerArea"),s.append(U),s}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,Q=new WeakSet,hn=function(){var s;(s=this.downloadManager)==null||s.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:B,accessibilityManager:s,annotationCanvasMap:S,l10n:U,page:q,viewport:J}){H(this,jt);H(this,yt);H(this,It,null);H(this,Pt,null);H(this,Nt,new Map);this.div=B,ot(this,It,s),ot(this,Pt,S),this.l10n=U,this.page=q,this.viewport=J,this.zIndex=0,this.l10n||(this.l10n=rt.NullL10n)}async render(B){const{annotations:s}=B,S=this.div;(0,d.setLayerDimensions)(S,this.viewport);const U=new Map,q={data:null,layer:S,linkService:B.linkService,downloadManager:B.downloadManager,imageResourcesPath:B.imageResourcesPath||"",renderForms:B.renderForms!==!1,svgFactory:new d.DOMSVGFactory,annotationStorage:B.annotationStorage||new $.AnnotationStorage,enableScripting:B.enableScripting===!0,hasJSActions:B.hasJSActions,fieldObjects:B.fieldObjects,parent:this,elements:null};for(const J of s){if(J.noHTML)continue;const lt=J.annotationType===n.AnnotationType.POPUP;if(lt){const Rt=U.get(J.id);if(!Rt)continue;q.elements=Rt}else{const{width:Rt,height:qt}=N(J.rect);if(Rt<=0||qt<=0)continue}q.data=J;const _t=P.create(q);if(!_t.isRenderable)continue;if(!lt&&J.popupRef){const Rt=U.get(J.popupRef);Rt?Rt.push(_t):U.set(J.popupRef,[_t])}_t.annotationEditorType>0&&t(this,Nt).set(_t.data.id,_t);const kt=_t.render();J.hidden&&(kt.style.visibility="hidden"),Y(this,jt,jn).call(this,kt,J.id)}Y(this,yt,dn).call(this),await this.l10n.translate(S)}update({viewport:B}){const s=this.div;this.viewport=B,(0,d.setLayerDimensions)(s,{rotation:B.rotation}),Y(this,yt,dn).call(this),s.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Nt).values())}getEditableAnnotation(B){return t(this,Nt).get(B)}}It=new WeakMap,Pt=new WeakMap,Nt=new WeakMap,jt=new WeakSet,jn=function(B,s){var U;const S=B.firstChild||B;S.id=`${n.AnnotationPrefix}${s}`,this.div.append(B),(U=t(this,It))==null||U.moveElementInDOM(this.div,B,S,!1)},yt=new WeakSet,dn=function(){if(!t(this,Pt))return;const B=this.div;for(const[s,S]of t(this,Pt)){const U=B.querySelector(`[data-annotation-id="${s}"]`);if(!U)continue;const{firstChild:q}=U;q?q.nodeName==="CANVAS"?q.replaceWith(S):q.before(S):U.append(S)}t(this,Pt).clear()},e.AnnotationLayer=i},(p,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function D($){return Math.floor(Math.max(0,Math.min(1,$))*255).toString(16).padStart(2,"0")}function n($){return Math.max(0,Math.min(255,255*$))}class d{static CMYK_G([I,rt,k,A]){return["G",1-Math.min(1,.3*I+.59*k+.11*rt+A)]}static G_CMYK([I]){return["CMYK",0,0,0,1-I]}static G_RGB([I]){return["RGB",I,I,I]}static G_rgb([I]){return I=n(I),[I,I,I]}static G_HTML([I]){const rt=D(I);return`#${rt}${rt}${rt}`}static RGB_G([I,rt,k]){return["G",.3*I+.59*rt+.11*k]}static RGB_rgb(I){return I.map(n)}static RGB_HTML(I){return`#${I.map(D).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([I,rt,k,A]){return["RGB",1-Math.min(1,I+A),1-Math.min(1,k+A),1-Math.min(1,rt+A)]}static CMYK_rgb([I,rt,k,A]){return[n(1-Math.min(1,I+A)),n(1-Math.min(1,k+A)),n(1-Math.min(1,rt+A))]}static CMYK_HTML(I){const rt=this.CMYK_RGB(I).slice(1);return this.RGB_HTML(rt)}static RGB_CMYK([I,rt,k]){const A=1-I,m=1-rt,L=1-k,N=Math.min(A,m,L);return["CMYK",A,m,L,N]}}e.ColorConverters=d},(p,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const D={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};D.print_progress_percent="{{progress}}%";function n(I,rt){switch(I){case"find_match_count":I=`find_match_count[${rt.total===1?"one":"other"}]`;break;case"find_match_count_limit":I=`find_match_count_limit[${rt.limit===1?"one":"other"}]`;break}return D[I]||""}function d(I,rt){return rt?I.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(k,A)=>A in rt?rt[A]:"{{"+A+"}}"):I}const $={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(I,rt=null,k=n(I,rt)){return d(k,rt)},async translate(I){}};e.NullL10n=$},(p,e,D)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=D(25);class d{static setupStorage(I,rt,k,A,m){const L=A.getValue(rt,{value:null});switch(k.name){case"textarea":if(L.value!==null&&(I.textContent=L.value),m==="print")break;I.addEventListener("input",N=>{A.setValue(rt,{value:N.target.value})});break;case"input":if(k.attributes.type==="radio"||k.attributes.type==="checkbox"){if(L.value===k.attributes.xfaOn?I.setAttribute("checked",!0):L.value===k.attributes.xfaOff&&I.removeAttribute("checked"),m==="print")break;I.addEventListener("change",N=>{A.setValue(rt,{value:N.target.checked?N.target.getAttribute("xfaOn"):N.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&I.setAttribute("value",L.value),m==="print")break;I.addEventListener("input",N=>{A.setValue(rt,{value:N.target.value})})}break;case"select":if(L.value!==null){I.setAttribute("value",L.value);for(const N of k.children)N.attributes.value===L.value?N.attributes.selected=!0:N.attributes.hasOwnProperty("selected")&&delete N.attributes.selected}I.addEventListener("input",N=>{const P=N.target.options,x=P.selectedIndex===-1?"":P[P.selectedIndex].value;A.setValue(rt,{value:x})});break}}static setAttributes({html:I,element:rt,storage:k=null,intent:A,linkService:m}){const{attributes:L}=rt,N=I instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${A}`);for(const[P,x]of Object.entries(L))if(x!=null)switch(P){case"class":x.length&&I.setAttribute(P,x.join(" "));break;case"dataId":break;case"id":I.setAttribute("data-element-id",x);break;case"style":Object.assign(I.style,x);break;case"textContent":I.textContent=x;break;default:(!N||P!=="href"&&P!=="newWindow")&&I.setAttribute(P,x)}N&&m.addLinkAttributes(I,L.href,L.newWindow),k&&L.dataId&&this.setupStorage(I,L.dataId,rt,k)}static render(I){var w;const rt=I.annotationStorage,k=I.linkService,A=I.xfaHtml,m=I.intent||"display",L=document.createElement(A.name);A.attributes&&this.setAttributes({html:L,element:A,intent:m,linkService:k});const N=[[A,-1,L]],P=I.div;if(P.append(L),I.viewport){const g=`matrix(${I.viewport.transform.join(",")})`;P.style.transform=g}m!=="richText"&&P.setAttribute("class","xfaLayer xfaFont");const x=[];for(;N.length>0;){const[g,v,R]=N.at(-1);if(v+1===g.children.length){N.pop();continue}const C=g.children[++N.at(-1)[1]];if(C===null)continue;const{name:y}=C;if(y==="#text"){const u=document.createTextNode(C.value);x.push(u),R.append(u);continue}const l=(w=C==null?void 0:C.attributes)!=null&&w.xmlns?document.createElementNS(C.attributes.xmlns,y):document.createElement(y);if(R.append(l),C.attributes&&this.setAttributes({html:l,element:C,storage:rt,intent:m,linkService:k}),C.children&&C.children.length>0)N.push([C,-1,l]);else if(C.value){const u=document.createTextNode(C.value);n.XfaText.shouldBuildText(y)&&x.push(u),l.append(u)}}for(const g of P.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:x}}static update(I){const rt=`matrix(${I.viewport.transform.join(",")})`;I.div.style.transform=rt,I.div.hidden=!1}}e.XfaLayer=d},(p,e,D)=>{var A,m,L,N,P,x,w,g,v,R,C,y,l,u,O,Bn,c,Un,b,Wn,z,Hn,X,un,ct,$n,dt,fn,Et,Gn,M,Vn,o,zn,h,Xn,T,qn,W,oe,tt,pn,ht,Me,ut,De,Bt,pe,Lt,gn,nt,Le,pt,Yn,Ct,mn,Vt,Kn,zt,Jn,Ht,bn,ft,Oe,K,ge;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=D(1),d=D(4),$=D(29),I=D(6),rt=D(5);const vt=class vt extends d.AnnotationEditor{constructor(Q){super({...Q,name:"inkEditor"});H(this,O);H(this,c);H(this,b);H(this,z);H(this,X);H(this,ct);H(this,dt);H(this,Et);H(this,M);H(this,o);H(this,h);H(this,T);H(this,W);H(this,tt);H(this,ht);H(this,ut);H(this,Bt);H(this,Lt);H(this,nt);H(this,zt);H(this,Ht);H(this,ft);H(this,K);H(this,A,0);H(this,m,0);H(this,L,this.canvasPointermove.bind(this));H(this,N,this.canvasPointerleave.bind(this));H(this,P,this.canvasPointerup.bind(this));H(this,x,this.canvasPointerdown.bind(this));H(this,w,new Path2D);H(this,g,!1);H(this,v,!1);H(this,R,!1);H(this,C,null);H(this,y,0);H(this,l,0);H(this,u,null);this.color=Q.color||null,this.thickness=Q.thickness||null,this.opacity=Q.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Q){d.AnnotationEditor.initialize(Q,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Q,xt){switch(Q){case n.AnnotationEditorParamsType.INK_THICKNESS:vt._defaultThickness=xt;break;case n.AnnotationEditorParamsType.INK_COLOR:vt._defaultColor=xt;break;case n.AnnotationEditorParamsType.INK_OPACITY:vt._defaultOpacity=xt/100;break}}updateParams(Q,xt){switch(Q){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,O,Bn).call(this,xt);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,c,Un).call(this,xt);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,b,Wn).call(this,xt);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,vt._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,vt._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(vt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||vt._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||vt._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??vt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,ht,Me).call(this),Y(this,ut,De).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,Bt,pe).call(this)),Y(this,K,ge).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,C).disconnect(),ot(this,C,null),super.remove())}setParent(Q){!this.parent&&Q?this._uiManager.removeShouldRescale(this):this.parent&&Q===null&&this._uiManager.addShouldRescale(this),super.setParent(Q)}onScaleChanging(){const[Q,xt]=this.parentDimensions,It=this.width*Q,Pt=this.height*xt;this.setDimensions(It,Pt)}enableEditMode(){t(this,g)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,x)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,x)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,g)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ot(this,g,!0),this.div.classList.add("disabled"),Y(this,K,ge).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Q){this._focusEventsAllowed&&(super.focusin(Q),this.enableEditMode())}canvasPointerdown(Q){Q.button!==0||!this.isInEditMode()||t(this,g)||(this.setInForeground(),Q.preventDefault(),Q.type!=="mouse"&&this.div.focus(),Y(this,ct,$n).call(this,Q.offsetX,Q.offsetY))}canvasPointermove(Q){Q.preventDefault(),Y(this,dt,fn).call(this,Q.offsetX,Q.offsetY)}canvasPointerup(Q){Q.preventDefault(),Y(this,tt,pn).call(this,Q)}canvasPointerleave(Q){Y(this,tt,pn).call(this,Q)}get isResizable(){return!this.isEmpty()&&t(this,g)}render(){if(this.div)return this.div;let Q,xt;this.width&&(Q=this.x,xt=this.y),super.render(),d.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Qt=>{var yt;return(yt=this.div)==null?void 0:yt.setAttribute("aria-label",Qt)});const[It,Pt,Nt,jt]=Y(this,z,Hn).call(this);if(this.setAt(It,Pt,0,0),this.setDims(Nt,jt),Y(this,ht,Me).call(this),this.width){const[Qt,yt]=this.parentDimensions;this.setAspectRatio(this.width*Qt,this.height*yt),this.setAt(Q*Qt,xt*yt,this.width*Qt,this.height*yt),ot(this,R,!0),Y(this,Bt,pe).call(this),this.setDims(this.width*Qt,this.height*yt),Y(this,W,oe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,ut,De).call(this),this.div}setDimensions(Q,xt){const It=Math.round(Q),Pt=Math.round(xt);if(t(this,y)===It&&t(this,l)===Pt)return;ot(this,y,It),ot(this,l,Pt),this.canvas.style.visibility="hidden";const[Nt,jt]=this.parentDimensions;this.width=Q/Nt,this.height=xt/jt,this.fixAndSetPosition(),t(this,g)&&Y(this,Lt,gn).call(this,Q,xt),Y(this,Bt,pe).call(this),Y(this,W,oe).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Q,xt,It){var q,J,lt;if(Q instanceof $.InkAnnotationElement)return null;const Pt=super.deserialize(Q,xt,It);Pt.thickness=Q.thickness,Pt.color=n.Util.makeHexColor(...Q.color),Pt.opacity=Q.opacity;const[Nt,jt]=Pt.pageDimensions,Qt=Pt.width*Nt,yt=Pt.height*jt,Kt=Pt.parentScale,Ot=Q.thickness/2;ot(Pt,g,!0),ot(Pt,y,Math.round(Qt)),ot(Pt,l,Math.round(yt));const{paths:B,rect:s,rotation:S}=Q;for(let{bezier:_t}of B){_t=Y(q=vt,Vt,Kn).call(q,_t,s,S);const kt=[];Pt.paths.push(kt);let Rt=Kt*(_t[0]-Ot),qt=Kt*(_t[1]-Ot);for(let Dt=2,$t=_t.length;Dt<$t;Dt+=6){const Yt=Kt*(_t[Dt]-Ot),Jt=Kt*(_t[Dt+1]-Ot),Zt=Kt*(_t[Dt+2]-Ot),ie=Kt*(_t[Dt+3]-Ot),se=Kt*(_t[Dt+4]-Ot),re=Kt*(_t[Dt+5]-Ot);kt.push([[Rt,qt],[Yt,Jt],[Zt,ie],[se,re]]),Rt=se,qt=re}const Mt=Y(this,pt,Yn).call(this,kt);Pt.bezierPath2D.push(Mt)}const U=Y(J=Pt,Ht,bn).call(J);return ot(Pt,m,Math.max(d.AnnotationEditor.MIN_SIZE,U[2]-U[0])),ot(Pt,A,Math.max(d.AnnotationEditor.MIN_SIZE,U[3]-U[1])),Y(lt=Pt,Lt,gn).call(lt,Qt,yt),Pt}serialize(){if(this.isEmpty())return null;const Q=this.getRect(0,0),xt=d.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:xt,thickness:this.thickness,opacity:this.opacity,paths:Y(this,zt,Jn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Q),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};A=new WeakMap,m=new WeakMap,L=new WeakMap,N=new WeakMap,P=new WeakMap,x=new WeakMap,w=new WeakMap,g=new WeakMap,v=new WeakMap,R=new WeakMap,C=new WeakMap,y=new WeakMap,l=new WeakMap,u=new WeakMap,O=new WeakSet,Bn=function(Q){const xt=this.thickness;this.addCommands({cmd:()=>{this.thickness=Q,Y(this,K,ge).call(this)},undo:()=>{this.thickness=xt,Y(this,K,ge).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},c=new WeakSet,Un=function(Q){const xt=this.color;this.addCommands({cmd:()=>{this.color=Q,Y(this,W,oe).call(this)},undo:()=>{this.color=xt,Y(this,W,oe).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},b=new WeakSet,Wn=function(Q){Q/=100;const xt=this.opacity;this.addCommands({cmd:()=>{this.opacity=Q,Y(this,W,oe).call(this)},undo:()=>{this.opacity=xt,Y(this,W,oe).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},z=new WeakSet,Hn=function(){const{parentRotation:Q,parentDimensions:[xt,It]}=this;switch(Q){case 90:return[0,It,It,xt];case 180:return[xt,It,xt,It];case 270:return[xt,0,It,xt];default:return[0,0,xt,It]}},X=new WeakSet,un=function(){const{ctx:Q,color:xt,opacity:It,thickness:Pt,parentScale:Nt,scaleFactor:jt}=this;Q.lineWidth=Pt*Nt/jt,Q.lineCap="round",Q.lineJoin="round",Q.miterLimit=10,Q.strokeStyle=`${xt}${(0,rt.opacityToHex)(It)}`},ct=new WeakSet,$n=function(Q,xt){this.canvas.addEventListener("contextmenu",I.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,N)),this.canvas.addEventListener("pointermove",t(this,L)),this.canvas.addEventListener("pointerup",t(this,P)),this.canvas.removeEventListener("pointerdown",t(this,x)),this.isEditing=!0,t(this,R)||(ot(this,R,!0),Y(this,Bt,pe).call(this),this.thickness||(this.thickness=vt._defaultThickness),this.color||(this.color=vt._defaultColor||d.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=vt._defaultOpacity)),this.currentPath.push([Q,xt]),ot(this,v,!1),Y(this,X,un).call(this),ot(this,u,()=>{Y(this,o,zn).call(this),t(this,u)&&window.requestAnimationFrame(t(this,u))}),window.requestAnimationFrame(t(this,u))},dt=new WeakSet,fn=function(Q,xt){const[It,Pt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Q===It&&xt===Pt)return;const Nt=this.currentPath;let jt=t(this,w);if(Nt.push([Q,xt]),ot(this,v,!0),Nt.length<=2){jt.moveTo(...Nt[0]),jt.lineTo(Q,xt);return}Nt.length===3&&(ot(this,w,jt=new Path2D),jt.moveTo(...Nt[0])),Y(this,h,Xn).call(this,jt,...Nt.at(-3),...Nt.at(-2),Q,xt)},Et=new WeakSet,Gn=function(){if(this.currentPath.length===0)return;const Q=this.currentPath.at(-1);t(this,w).lineTo(...Q)},M=new WeakSet,Vn=function(Q,xt){ot(this,u,null),Q=Math.min(Math.max(Q,0),this.canvas.width),xt=Math.min(Math.max(xt,0),this.canvas.height),Y(this,dt,fn).call(this,Q,xt),Y(this,Et,Gn).call(this);let It;if(this.currentPath.length!==1)It=Y(this,T,qn).call(this);else{const yt=[Q,xt];It=[[yt,yt.slice(),yt.slice(),yt]]}const Pt=t(this,w),Nt=this.currentPath;this.currentPath=[],ot(this,w,new Path2D);const jt=()=>{this.allRawPaths.push(Nt),this.paths.push(It),this.bezierPath2D.push(Pt),this.rebuild()},Qt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,ht,Me).call(this),Y(this,ut,De).call(this)),Y(this,K,ge).call(this))};this.addCommands({cmd:jt,undo:Qt,mustExec:!0})},o=new WeakSet,zn=function(){if(!t(this,v))return;ot(this,v,!1);const Q=Math.ceil(this.thickness*this.parentScale),xt=this.currentPath.slice(-3),It=xt.map(jt=>jt[0]),Pt=xt.map(jt=>jt[1]);Math.min(...It)-Q,Math.max(...It)+Q,Math.min(...Pt)-Q,Math.max(...Pt)+Q;const{ctx:Nt}=this;Nt.save(),Nt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const jt of this.bezierPath2D)Nt.stroke(jt);Nt.stroke(t(this,w)),Nt.restore()},h=new WeakSet,Xn=function(Q,xt,It,Pt,Nt,jt,Qt){const yt=(xt+Pt)/2,Kt=(It+Nt)/2,Ot=(Pt+jt)/2,B=(Nt+Qt)/2;Q.bezierCurveTo(yt+2*(Pt-yt)/3,Kt+2*(Nt-Kt)/3,Ot+2*(Pt-Ot)/3,B+2*(Nt-B)/3,Ot,B)},T=new WeakSet,qn=function(){const Q=this.currentPath;if(Q.length<=2)return[[Q[0],Q[0],Q.at(-1),Q.at(-1)]];const xt=[];let It,[Pt,Nt]=Q[0];for(It=1;It<Q.length-2;It++){const[s,S]=Q[It],[U,q]=Q[It+1],J=(s+U)/2,lt=(S+q)/2,_t=[Pt+2*(s-Pt)/3,Nt+2*(S-Nt)/3],kt=[J+2*(s-J)/3,lt+2*(S-lt)/3];xt.push([[Pt,Nt],_t,kt,[J,lt]]),[Pt,Nt]=[J,lt]}const[jt,Qt]=Q[It],[yt,Kt]=Q[It+1],Ot=[Pt+2*(jt-Pt)/3,Nt+2*(Qt-Nt)/3],B=[yt+2*(jt-yt)/3,Kt+2*(Qt-Kt)/3];return xt.push([[Pt,Nt],Ot,B,[yt,Kt]]),xt},W=new WeakSet,oe=function(){if(this.isEmpty()){Y(this,nt,Le).call(this);return}Y(this,X,un).call(this);const{canvas:Q,ctx:xt}=this;xt.setTransform(1,0,0,1,0,0),xt.clearRect(0,0,Q.width,Q.height),Y(this,nt,Le).call(this);for(const It of this.bezierPath2D)xt.stroke(It)},tt=new WeakSet,pn=function(Q){this.canvas.removeEventListener("pointerleave",t(this,N)),this.canvas.removeEventListener("pointermove",t(this,L)),this.canvas.removeEventListener("pointerup",t(this,P)),this.canvas.addEventListener("pointerdown",t(this,x)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",I.noContextMenu)},10),Y(this,M,Vn).call(this,Q.offsetX,Q.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ht=new WeakSet,Me=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",d.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Q=>{var xt;return(xt=this.canvas)==null?void 0:xt.setAttribute("aria-label",Q)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ut=new WeakSet,De=function(){ot(this,C,new ResizeObserver(Q=>{const xt=Q[0].contentRect;xt.width&&xt.height&&this.setDimensions(xt.width,xt.height)})),t(this,C).observe(this.div)},Bt=new WeakSet,pe=function(){if(!t(this,R))return;const[Q,xt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Q),this.canvas.height=Math.ceil(this.height*xt),Y(this,nt,Le).call(this)},Lt=new WeakSet,gn=function(Q,xt){const It=Y(this,ft,Oe).call(this),Pt=(Q-It)/t(this,m),Nt=(xt-It)/t(this,A);this.scaleFactor=Math.min(Pt,Nt)},nt=new WeakSet,Le=function(){const Q=Y(this,ft,Oe).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Q,this.translationY*this.scaleFactor+Q)},pt=new WeakSet,Yn=function(Q){const xt=new Path2D;for(let It=0,Pt=Q.length;It<Pt;It++){const[Nt,jt,Qt,yt]=Q[It];It===0&&xt.moveTo(...Nt),xt.bezierCurveTo(jt[0],jt[1],Qt[0],Qt[1],yt[0],yt[1])}return xt},Ct=new WeakSet,mn=function(Q,xt,It){const[Pt,Nt,jt,Qt]=xt;switch(It){case 0:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]+=Pt,Q[yt+1]=Qt-Q[yt+1];break;case 90:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=Q[yt+1]+Pt,Q[yt+1]=Ot+Nt}break;case 180:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]=jt-Q[yt],Q[yt+1]+=Nt;break;case 270:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=jt-Q[yt+1],Q[yt+1]=Qt-Ot}break;default:throw new Error("Invalid rotation")}return Q},Vt=new WeakSet,Kn=function(Q,xt,It){const[Pt,Nt,jt,Qt]=xt;switch(It){case 0:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]-=Pt,Q[yt+1]=Qt-Q[yt+1];break;case 90:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=Q[yt+1]-Nt,Q[yt+1]=Ot-Pt}break;case 180:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2)Q[yt]=jt-Q[yt],Q[yt+1]-=Nt;break;case 270:for(let yt=0,Kt=Q.length;yt<Kt;yt+=2){const Ot=Q[yt];Q[yt]=Qt-Q[yt+1],Q[yt+1]=jt-Ot}break;default:throw new Error("Invalid rotation")}return Q},zt=new WeakSet,Jn=function(Q,xt,It,Pt){var Kt,Ot;const Nt=[],jt=this.thickness/2,Qt=Q*xt+jt,yt=Q*It+jt;for(const B of this.paths){const s=[],S=[];for(let U=0,q=B.length;U<q;U++){const[J,lt,_t,kt]=B[U],Rt=Q*J[0]+Qt,qt=Q*J[1]+yt,Mt=Q*lt[0]+Qt,Dt=Q*lt[1]+yt,$t=Q*_t[0]+Qt,Yt=Q*_t[1]+yt,Jt=Q*kt[0]+Qt,Zt=Q*kt[1]+yt;U===0&&(s.push(Rt,qt),S.push(Rt,qt)),s.push(Mt,Dt,$t,Yt,Jt,Zt),S.push(Mt,Dt),U===q-1&&S.push(Jt,Zt)}Nt.push({bezier:Y(Kt=vt,Ct,mn).call(Kt,s,Pt,this.rotation),points:Y(Ot=vt,Ct,mn).call(Ot,S,Pt,this.rotation)})}return Nt},Ht=new WeakSet,bn=function(){let Q=1/0,xt=-1/0,It=1/0,Pt=-1/0;for(const Nt of this.paths)for(const[jt,Qt,yt,Kt]of Nt){const Ot=n.Util.bezierBoundingBox(...jt,...Qt,...yt,...Kt);Q=Math.min(Q,Ot[0]),It=Math.min(It,Ot[1]),xt=Math.max(xt,Ot[2]),Pt=Math.max(Pt,Ot[3])}return[Q,It,xt,Pt]},ft=new WeakSet,Oe=function(){return t(this,g)?Math.ceil(this.thickness*this.parentScale):0},K=new WeakSet,ge=function(Q=!1){if(this.isEmpty())return;if(!t(this,g)){Y(this,W,oe).call(this);return}const xt=Y(this,Ht,bn).call(this),It=Y(this,ft,Oe).call(this);ot(this,m,Math.max(d.AnnotationEditor.MIN_SIZE,xt[2]-xt[0])),ot(this,A,Math.max(d.AnnotationEditor.MIN_SIZE,xt[3]-xt[1]));const Pt=Math.ceil(It+t(this,m)*this.scaleFactor),Nt=Math.ceil(It+t(this,A)*this.scaleFactor),[jt,Qt]=this.parentDimensions;this.width=Pt/jt,this.height=Nt/Qt,this.setAspectRatio(Pt,Nt);const yt=this.translationX,Kt=this.translationY;this.translationX=-xt[0],this.translationY=-xt[1],Y(this,Bt,pe).call(this),Y(this,W,oe).call(this),ot(this,y,Pt),ot(this,l,Nt),this.setDims(Pt,Nt);const Ot=Q?It/this.scaleFactor/2:0;this.translate(yt-this.translationX-Ot,Kt-this.translationY-Ot)},H(vt,pt),H(vt,Ct),H(vt,Vt),ne(vt,"_defaultColor",null),ne(vt,"_defaultOpacity",1),ne(vt,"_defaultThickness",1),ne(vt,"_type","ink");let k=vt;e.InkEditor=k},(p,e,D)=>{var k,A,m,L,N,P,x,w,g,v,R,Ee,y,Se,u,Ie,_,_n,F,Qn,G,Zn,E,An,at,Ne,V,ts;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=D(1),d=D(4),$=D(6),I=D(29);const mt=class mt extends d.AnnotationEditor{constructor(M){super({...M,name:"stampEditor"});H(this,R);H(this,y);H(this,u);H(this,_);H(this,F);H(this,G);H(this,E);H(this,at);H(this,V);H(this,k,null);H(this,A,null);H(this,m,null);H(this,L,null);H(this,N,null);H(this,P,null);H(this,x,null);H(this,w,null);H(this,g,!1);H(this,v,!1);ot(this,L,M.bitmapUrl),ot(this,N,M.bitmapFile)}static initialize(M){d.AnnotationEditor.initialize(M)}static get supportedTypes(){const M=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",M.map(i=>`image/${i}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(M){return this.supportedTypes.includes(M)}static paste(M,i){i.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:M.getAsFile()})}remove(){var M,i;t(this,A)&&(ot(this,k,null),this._uiManager.imageManager.deleteId(t(this,A)),(M=t(this,P))==null||M.remove(),ot(this,P,null),(i=t(this,x))==null||i.disconnect(),ot(this,x,null)),super.remove()}rebuild(){if(!this.parent){t(this,A)&&Y(this,u,Ie).call(this);return}super.rebuild(),this.div!==null&&(t(this,A)&&Y(this,u,Ie).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,m)||t(this,k)||t(this,L)||t(this,N))}get isResizable(){return!0}render(){if(this.div)return this.div;let M,i;if(this.width&&(M=this.x,i=this.y),super.render(),this.div.hidden=!0,t(this,k)?Y(this,_,_n).call(this):Y(this,u,Ie).call(this),this.width){const[o,a]=this.parentDimensions;this.setAt(M*o,i*a,this.width*o,this.height*a)}return this.div}static deserialize(M,i,o){if(M instanceof I.StampAnnotationElement)return null;const a=super.deserialize(M,i,o),{rect:h,bitmapUrl:f,bitmapId:T,isSvg:j,accessibilityData:W}=M;T&&o.imageManager.isValidId(T)?ot(a,A,T):ot(a,L,f),ot(a,g,j);const[it,tt]=a.pageDimensions;return a.width=(h[2]-h[0])/it,a.height=(h[3]-h[1])/tt,W&&(a.altTextData=W),a}serialize(M=!1,i=null){if(this.isEmpty())return null;const o={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,A),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,g),structTreeParentId:this._structTreeParentId};if(M)return o.bitmapUrl=Y(this,at,Ne).call(this,!0),o.accessibilityData=this.altTextData,o;const{decorative:a,altText:h}=this.altTextData;if(!a&&h&&(o.accessibilityData={type:"Figure",alt:h}),i===null)return o;i.stamps||(i.stamps=new Map);const f=t(this,g)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!i.stamps.has(t(this,A)))i.stamps.set(t(this,A),{area:f,serialized:o}),o.bitmap=Y(this,at,Ne).call(this,!1);else if(t(this,g)){const T=i.stamps.get(t(this,A));f>T.area&&(T.area=f,T.serialized.bitmap.close(),T.serialized.bitmap=Y(this,at,Ne).call(this,!1))}return o}};k=new WeakMap,A=new WeakMap,m=new WeakMap,L=new WeakMap,N=new WeakMap,P=new WeakMap,x=new WeakMap,w=new WeakMap,g=new WeakMap,v=new WeakMap,R=new WeakSet,Ee=function(M,i=!1){if(!M){this.remove();return}ot(this,k,M.bitmap),i||(ot(this,A,M.id),ot(this,g,M.isSvg)),Y(this,_,_n).call(this)},y=new WeakSet,Se=function(){ot(this,m,null),this._uiManager.enableWaiting(!1),t(this,P)&&this.div.focus()},u=new WeakSet,Ie=function(){if(t(this,A)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,A)).then(i=>Y(this,R,Ee).call(this,i,!0)).finally(()=>Y(this,y,Se).call(this));return}if(t(this,L)){const i=t(this,L);ot(this,L,null),this._uiManager.enableWaiting(!0),ot(this,m,this._uiManager.imageManager.getFromUrl(i).then(o=>Y(this,R,Ee).call(this,o)).finally(()=>Y(this,y,Se).call(this)));return}if(t(this,N)){const i=t(this,N);ot(this,N,null),this._uiManager.enableWaiting(!0),ot(this,m,this._uiManager.imageManager.getFromFile(i).then(o=>Y(this,R,Ee).call(this,o)).finally(()=>Y(this,y,Se).call(this)));return}const M=document.createElement("input");M.type="file",M.accept=mt.supportedTypesStr,ot(this,m,new Promise(i=>{M.addEventListener("change",async()=>{if(!M.files||M.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(M.files[0]);Y(this,R,Ee).call(this,o)}i()}),M.addEventListener("cancel",()=>{this.remove(),i()})}).finally(()=>Y(this,y,Se).call(this))),M.click()},_=new WeakSet,_n=function(){const{div:M}=this;let{width:i,height:o}=t(this,k);const[a,h]=this.pageDimensions,f=.75;if(this.width)i=this.width*a,o=this.height*h;else if(i>f*a||o>f*h){const it=Math.min(f*a/i,f*h/o);i*=it,o*=it}const[T,j]=this.parentDimensions;this.setDims(i*T/a,o*j/h),this._uiManager.enableWaiting(!1);const W=ot(this,P,document.createElement("canvas"));M.append(W),M.hidden=!1,Y(this,E,An).call(this,i,o),Y(this,V,ts).call(this),t(this,v)||(this.parent.addUndoableEditor(this),ot(this,v,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},F=new WeakSet,Qn=function(M,i){var f;const[o,a]=this.parentDimensions;this.width=M/o,this.height=i/a,this.setDims(M,i),(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,w)!==null&&clearTimeout(t(this,w)),ot(this,w,setTimeout(()=>{ot(this,w,null),Y(this,E,An).call(this,M,i)},200))},G=new WeakSet,Zn=function(M,i){const{width:o,height:a}=t(this,k);let h=o,f=a,T=t(this,k);for(;h>2*M||f>2*i;){const j=h,W=f;h>2*M&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2)),f>2*i&&(f=f>=16384?Math.floor(f/2)-1:Math.ceil(f/2));const it=new OffscreenCanvas(h,f);it.getContext("2d").drawImage(T,0,0,j,W,0,0,h,f),T=it.transferToImageBitmap()}return T},E=new WeakSet,An=function(M,i){M=Math.ceil(M),i=Math.ceil(i);const o=t(this,P);if(!o||o.width===M&&o.height===i)return;o.width=M,o.height=i;const a=t(this,g)?t(this,k):Y(this,G,Zn).call(this,M,i),h=o.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(a,0,0,a.width,a.height,0,0,M,i)},at=new WeakSet,Ne=function(M){if(M){if(t(this,g)){const a=this._uiManager.imageManager.getSvgUrl(t(this,A));if(a)return a}const i=document.createElement("canvas");return{width:i.width,height:i.height}=t(this,k),i.getContext("2d").drawImage(t(this,k),0,0),i.toDataURL()}if(t(this,g)){const[i,o]=this.pageDimensions,a=Math.round(this.width*i*$.PixelsPerInch.PDF_TO_CSS_UNITS),h=Math.round(this.height*o*$.PixelsPerInch.PDF_TO_CSS_UNITS),f=new OffscreenCanvas(a,h);return f.getContext("2d").drawImage(t(this,k),0,0,t(this,k).width,t(this,k).height,0,0,a,h),f.transferToImageBitmap()}return structuredClone(t(this,k))},V=new WeakSet,ts=function(){ot(this,x,new ResizeObserver(M=>{const i=M[0].contentRect;i.width&&i.height&&Y(this,F,Qn).call(this,i.width,i.height)})),t(this,x).observe(this.div)},ne(mt,"_type","stamp");let rt=mt;e.StampEditor=rt}],__webpack_module_cache__={};function __w_pdfjs_require__(p){var e=__webpack_module_cache__[p];if(e!==void 0)return e.exports;var D=__webpack_module_cache__[p]={exports:{}};return __webpack_modules__[p](D,D.exports,__w_pdfjs_require__),D.exports}var __webpack_exports__={};return(()=>{var p=__webpack_exports__;Object.defineProperty(p,"__esModule",{value:!0}),Object.defineProperty(p,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(p,"AnnotationEditorLayer",{enumerable:!0,get:function(){return $.AnnotationEditorLayer}}),Object.defineProperty(p,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(p,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(p,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return I.AnnotationEditorUIManager}}),Object.defineProperty(p,"AnnotationLayer",{enumerable:!0,get:function(){return rt.AnnotationLayer}}),Object.defineProperty(p,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(p,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(p,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(p,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(p,"GlobalWorkerOptions",{enumerable:!0,get:function(){return k.GlobalWorkerOptions}}),Object.defineProperty(p,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(p,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(p,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(p,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(p,"PDFDataRangeTransport",{enumerable:!0,get:function(){return D.PDFDataRangeTransport}}),Object.defineProperty(p,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(p,"PDFWorker",{enumerable:!0,get:function(){return D.PDFWorker}}),Object.defineProperty(p,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(p,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(p,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(p,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(p,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(p,"SVGGraphics",{enumerable:!0,get:function(){return D.SVGGraphics}}),Object.defineProperty(p,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(p,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(p,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(p,"XfaLayer",{enumerable:!0,get:function(){return A.XfaLayer}}),Object.defineProperty(p,"build",{enumerable:!0,get:function(){return D.build}}),Object.defineProperty(p,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(p,"getDocument",{enumerable:!0,get:function(){return D.getDocument}}),Object.defineProperty(p,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(p,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(p,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(p,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(p,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(p,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(p,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(p,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(p,"renderTextLayer",{enumerable:!0,get:function(){return d.renderTextLayer}}),Object.defineProperty(p,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(p,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(p,"updateTextLayer",{enumerable:!0,get:function(){return d.updateTextLayer}}),Object.defineProperty(p,"version",{enumerable:!0,get:function(){return D.version}});var e=__w_pdfjs_require__(1),D=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),d=__w_pdfjs_require__(26),$=__w_pdfjs_require__(27),I=__w_pdfjs_require__(5),rt=__w_pdfjs_require__(29),k=__w_pdfjs_require__(14),A=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;var __spreadArray=globalThis&&globalThis.__spreadArray||function(p,e,D){if(D||arguments.length===2)for(var n=0,d=e.length,$;n<d;n++)($||!(n in e))&&($||($=Array.prototype.slice.call(e,0,n)),$[n]=e[n]);return p.concat($||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(p,e){var D={};return allEvents.forEach(function(n){var d=p[n];d&&(e?D[n]=function($){return d($,e(n))}:D[n]=d)}),D}function makeCancellablePromise(p){var e=!1,D=new Promise(function(n,d){p.then(function($){return!e&&n($)}).catch(function($){return!e&&d($)})});return{promise:D,cancel:function(){e=!0}}}function r(p){var e,D,n="";if(typeof p=="string"||typeof p=="number")n+=p;else if(typeof p=="object")if(Array.isArray(p))for(e=0;e<p.length;e++)p[e]&&(D=r(p[e]))&&(n&&(n+=" "),n+=D);else for(e in p)p[e]&&(n&&(n+=" "),n+=e);return n}function clsx(){for(var p,e,D=0,n="";D<arguments.length;)(p=arguments[D++])&&(e=r(p))&&(n&&(n+=" "),n+=e);return n}const DocumentContext=reactExports.createContext(null);function Message({children:p,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},p)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(D=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(e,"Destination is not specified."),typeof e=="string"?this.pdfDocument.getDestination(e).then(D):Array.isArray(e)?D(e):e.then(D)}).then(D=>{invariant(Array.isArray(D),`"${D}" is not a valid destination array.`);const n=D[0];new Promise(d=>{invariant(this.pdfDocument,"PDF document not loaded."),n instanceof Object?this.pdfDocument.getPageIndex(n).then($=>{d($)}).catch(()=>{invariant(!1,`"${n}" is not a valid page reference.`)}):typeof n=="number"?d(n):invariant(!1,`"${n}" is not a valid destination reference.`)}).then(d=>{const $=d+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant($>=1&&$<=this.pagesCount,`"${$}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:D,pageIndex:d,pageNumber:$})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const D=e-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(e>=1&&e<=this.pagesCount,`"${e}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:D,pageNumber:e})}addLinkAttributes(e,D,n){e.href=D,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(p){return typeof p<"u"}function isProvided(p){return isDefined(p)&&p!==null}function isString(p){return typeof p=="string"}function isArrayBuffer(p){return p instanceof ArrayBuffer}function isBlob(p){return invariant(isBrowser,"isBlob can only be used in a browser environment"),p instanceof Blob}function isDataURI(p){return isString(p)&&/^data:/.test(p)}function dataURItoByteString(p){invariant(isDataURI(p),"Invalid data URI.");const[e="",D=""]=p.split(",");return e.split(";").indexOf("base64")!==-1?atob(D):unescape(D)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(p){p&&p.cancel&&p.cancel()}function makePageCallback(p,e){return Object.defineProperty(p,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(p,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(p,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(p,"originalHeight",{get(){return this.view[3]},configurable:!0}),p}function isCancelException(p){return p.name==="RenderingCancelledException"}function loadFromFile(p){return new Promise((e,D)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return D(new Error("Error while reading a file."));e(n.result)},n.onerror=d=>{if(!d.target)return D(new Error("Error while reading a file."));const{error:$}=d.target;if(!$)return D(new Error("Error while reading a file."));switch($.code){case $.NOT_FOUND_ERR:return D(new Error("Error while reading a file: File not found."));case $.SECURITY_ERR:return D(new Error("Error while reading a file: Security error."));case $.ABORT_ERR:return D(new Error("Error while reading a file: Aborted."));default:return D(new Error("Error while reading a file."))}},n.readAsArrayBuffer(p)})}function reducer(p,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return p}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs$1,eventProps=(()=>{const p={};return allEvents.forEach(e=>{p[e]=_pt.func}),p})(),isTypedArray=_pt.oneOfType([_pt.instanceOf(Int8Array),_pt.instanceOf(Uint8Array),_pt.instanceOf(Uint8ClampedArray),_pt.instanceOf(Int16Array),_pt.instanceOf(Uint16Array),_pt.instanceOf(Int32Array),_pt.instanceOf(Uint32Array),_pt.instanceOf(Float32Array),_pt.instanceOf(Float64Array)]),fileTypes=[_pt.string,_pt.instanceOf(ArrayBuffer),_pt.shape({data:_pt.oneOfType([_pt.string,_pt.instanceOf(ArrayBuffer),_pt.arrayOf(_pt.number.isRequired),isTypedArray]).isRequired}),_pt.shape({range:_pt.instanceOf(PDFDataRangeTransport$1).isRequired}),_pt.shape({url:_pt.string.isRequired})];typeof Blob<"u"&&fileTypes.push(_pt.instanceOf(Blob));const isClassName=_pt.oneOfType([_pt.string,_pt.arrayOf(_pt.string)]),isFile=_pt.oneOfType(fileTypes);_pt.instanceOf(LinkService);_pt.oneOf(["_self","_blank","_parent","_top"]);_pt.shape({commonObjs:_pt.shape({}).isRequired,getAnnotations:_pt.func.isRequired,getTextContent:_pt.func.isRequired,getViewport:_pt.func.isRequired,render:_pt.func.isRequired});const isPageIndex=function p(e,D,n){const{[D]:d,pageNumber:$,pdf:I}=e;if(!isDefined(I))return null;if(isDefined(d)){if(typeof d!="number")return new Error(`\`${D}\` of type \`${typeof d}\` supplied to \`${n}\`, expected \`number\`.`);if(d<0)return new Error(`Expected \`${D}\` to be greater or equal to 0.`);const{numPages:rt}=I;if(d+1>rt)return new Error(`Expected \`${D}\` to be less or equal to ${rt-1}.`)}else if(!isDefined($))return new Error(`\`${D}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPageNumber=function p(e,D,n){const{[D]:d,pageIndex:$,pdf:I}=e;if(!isDefined(I))return null;if(isDefined(d)){if(typeof d!="number")return new Error(`\`${D}\` of type \`${typeof d}\` supplied to \`${n}\`, expected \`number\`.`);if(d<1)return new Error(`Expected \`${D}\` to be greater or equal to 1.`);const{numPages:rt}=I;if(d>rt)return new Error(`Expected \`${D}\` to be less or equal to ${rt}.`)}else if(!isDefined($))return new Error(`\`${D}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPdf=_pt.oneOfType([_pt.any,_pt.oneOf([!1])]),isRef=_pt.oneOfType([_pt.func,_pt.exact({current:_pt.any})]),isRenderMode=_pt.oneOf(["canvas","custom","none","svg"]),isRotate=_pt.oneOf([0,90,180,270]);var __awaiter=globalThis&&globalThis.__awaiter||function(p,e,D,n){function d($){return $ instanceof D?$:new D(function(I){I($)})}return new(D||(D=Promise))(function($,I){function rt(m){try{A(n.next(m))}catch(L){I(L)}}function k(m){try{A(n.throw(m))}catch(L){I(L)}}function A(m){m.done?$(m.value):d(m.value).then(rt,k)}A((n=n.apply(p,e||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(p,e){var D={};for(var n in p)Object.prototype.hasOwnProperty.call(p,n)&&e.indexOf(n)<0&&(D[n]=p[n]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(p);d<n.length;d++)e.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(p,n[d])&&(D[n[d]]=p[n[d]]);return D};const{PDFDataRangeTransport}=pdfjs$1,defaultOnPassword=(p,e)=>{switch(e){case PasswordResponses$1.NEED_PASSWORD:{const D=prompt("Enter the password to open this PDF file.");p(D);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const D=prompt("Invalid password. Please try again.");p(D);break}}},Document=reactExports.forwardRef(function p(e,D){var{children:n,className:d,error:$="Failed to load PDF file.",externalLinkRel:I,externalLinkTarget:rt,file:k,inputRef:A,imageResourcesPath:m,loading:L="Loading PDF…",noData:N="No PDF file specified.",onItemClick:P,onLoadError:x,onLoadProgress:w,onLoadSuccess:g,onPassword:v=defaultOnPassword,onSourceError:R,onSourceSuccess:C,options:y,renderMode:l,rotate:u}=e,O=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[_,c]=useResolver(),{value:F,error:b}=_,[G,z]=useResolver(),{value:E,error:X}=G,at=reactExports.useRef(new LinkService),ct=reactExports.useRef([]),V=reactExports.useRef({scrollPageIntoView:et=>{const{dest:ht,pageNumber:bt,pageIndex:ut=bt-1}=et;if(P){P({dest:ht,pageIndex:ut,pageNumber:bt});return}const Ft=ct.current[ut];if(Ft){Ft.scrollIntoView();return}warning(!1,`An internal link leading to page ${bt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(D,()=>({linkService:at,pages:ct,viewer:V}),[]);function dt(){C&&C()}function mt(){b&&(warning(!1,b.toString()),R&&R(b))}function Et(){c({type:"RESET"})}reactExports.useEffect(Et,[k,c]);const wt=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!k)return null;if(typeof k=="string")return isDataURI(k)?{data:dataURItoByteString(k)}:(displayCORSWarning(),{url:k});if(k instanceof PDFDataRangeTransport)return{range:k};if(isArrayBuffer(k))return{data:k};if(isBrowser&&isBlob(k))return{data:yield loadFromFile(k)};if(invariant(typeof k=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant("data"in k||"range"in k||"url"in k,"Invalid parameter object: need either .data, .range or .url"),"url"in k&&typeof k.url=="string"){if(isDataURI(k.url)){const{url:et}=k,ht=__rest$1(k,["url"]),bt=dataURItoByteString(et);return Object.assign({data:bt},ht)}displayCORSWarning()}return k}),[k]);reactExports.useEffect(()=>{const et=makeCancellablePromise(wt());return et.promise.then(ht=>{c({type:"RESOLVE",value:ht})}).catch(ht=>{c({type:"REJECT",error:ht})}),()=>{cancelRunningTask(et)}},[wt,c]),reactExports.useEffect(()=>{if(!(typeof F>"u")){if(F===!1){mt();return}dt()}},[F]);function M(){E&&(g&&g(E),ct.current=new Array(E.numPages),at.current.setDocument(E))}function i(){X&&(warning(!1,X.toString()),x&&x(X))}function o(){z({type:"RESET"})}reactExports.useEffect(o,[z,F]);function a(){if(!F)return;const et=y?Object.assign(Object.assign({},F),y):F,ht=pdfjs$1.getDocument(et);w&&(ht.onProgress=w),v&&(ht.onPassword=v);const bt=ht;return bt.promise.then(ut=>{z({type:"RESOLVE",value:ut})}).catch(ut=>{bt.destroyed||z({type:"REJECT",error:ut})}),()=>{bt.destroy()}}reactExports.useEffect(a,[y,z,F]),reactExports.useEffect(()=>{if(!(typeof E>"u")){if(E===!1){i();return}M()}},[E]);function h(){at.current.setViewer(V.current),at.current.setExternalLinkRel(I),at.current.setExternalLinkTarget(rt)}reactExports.useEffect(h,[I,rt]);function f(et,ht){ct.current[et]=ht}function T(et){delete ct.current[et]}const j=reactExports.useMemo(()=>({imageResourcesPath:m,linkService:at.current,onItemClick:P,pdf:E,registerPage:f,renderMode:l,rotate:u,unregisterPage:T}),[m,P,E,l,u]),W=reactExports.useMemo(()=>makeEventProps(O,()=>E),[O,E]);function it(){return React.createElement(DocumentContext.Provider,{value:j},n)}function tt(){return k?E==null?React.createElement(Message,{type:"loading"},typeof L=="function"?L():L):E===!1?React.createElement(Message,{type:"error"},typeof $=="function"?$():$):it():React.createElement(Message,{type:"no-data"},typeof N=="function"?N():N)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",d),ref:A,style:{"--scale-factor":"1"}},W),tt())}),isFunctionOrNode$1=_pt.oneOfType([_pt.func,_pt.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:_pt.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:_pt.string,externalLinkTarget:_pt.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:_pt.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:_pt.func,onLoadError:_pt.func,onLoadProgress:_pt.func,onLoadSuccess:_pt.func,onPassword:_pt.func,onSourceError:_pt.func,onSourceSuccess:_pt.func,options:_pt.shape({canvasFactory:_pt.any,canvasMaxAreaInBytes:_pt.number,cMapPacked:_pt.bool,CMapReaderFactory:_pt.any,cMapUrl:_pt.string,disableAutoFetch:_pt.bool,disableFontFace:_pt.bool,disableRange:_pt.bool,disableStream:_pt.bool,docBaseUrl:_pt.string,enableXfa:_pt.bool,filterFactory:_pt.any,fontExtraProperties:_pt.bool,httpHeaders:_pt.object,isEvalSupported:_pt.bool,isOffscreenCanvasSupported:_pt.bool,length:_pt.number,maxImageSize:_pt.number,ownerDocument:_pt.any,password:_pt.string,pdfBug:_pt.bool,rangeChunkSize:_pt.number,StandardFontDataFactory:_pt.any,standardFontDataUrl:_pt.string,stopAtErrors:_pt.bool,useSystemFonts:_pt.bool,useWorkerFetch:_pt.bool,verbosity:_pt.number,withCredentials:_pt.bool,worker:_pt.any}),rotate:_pt.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var p=[],e=0;e<arguments.length;e++)p[e]=arguments[e];var D=p.filter(Boolean);if(D.length<=1){var n=D[0];return n||null}return function($){D.forEach(function(I){typeof I=="function"?I($):I&&(I.current=$)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(p){return p in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(p){return"children"in p}function isStructTreeNodeWithOnlyContentChild(p){return isStructTreeNode(p)?p.children.length===1&&0 in p.children&&"id"in p.children[0]:!1}function getRoleAttributes(p){const e={};if(isStructTreeNode(p)){const{role:D}=p,n=D.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(D)){const d=PDF_ROLE_TO_HTML_ROLE[D];d&&(e.role=d)}}return e}function getBaseAttributes(p){const e={};if(isStructTreeNode(p)){if(p.alt!==void 0&&(e["aria-label"]=p.alt),p.lang!==void 0&&(e.lang=p.lang),isStructTreeNodeWithOnlyContentChild(p)){const[D]=p.children;if(D){const n=getBaseAttributes(D);return Object.assign(Object.assign({},e),n)}}}else"id"in p&&(e["aria-owns"]=p.id);return e}function getAttributes(p){return p?Object.assign(Object.assign({},getRoleAttributes(p)),getBaseAttributes(p)):null}function StructTreeItem({className:p,node:e}){const D=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((d,$)=>React.createElement(StructTreeItem,{key:$,node:d})),[e]);return React.createElement("span",Object.assign({className:p},D),n)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const p=usePageContext();invariant(p,"Unable to find Page context.");const{onGetStructTreeError:e,onGetStructTreeSuccess:D}=p,[n,d]=useResolver(),{value:$,error:I}=n,{customTextRenderer:rt,page:k}=p;function A(){$&&D&&D($)}function m(){I&&(warning(!1,I.toString()),e&&e(I))}function L(){d({type:"RESET"})}reactExports.useEffect(L,[d,k]);function N(){if(rt||!k)return;const P=makeCancellablePromise(k.getStructTree()),x=P;return P.promise.then(w=>{d({type:"RESOLVE",value:w})}).catch(w=>{d({type:"REJECT",error:w})}),()=>cancelRunningTask(x)}return reactExports.useEffect(N,[rt,k,d]),reactExports.useEffect(()=>{if($!==void 0){if($===!1){m();return}A()}},[$]),$?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:$}):null}const ANNOTATION_MODE=pdfjs$1.AnnotationMode;function PageCanvas(p){const e=usePageContext();invariant(e,"Unable to find Page context.");const D=Object.assign(Object.assign({},e),p),{_className:n,canvasBackground:d,devicePixelRatio:$=getDevicePixelRatio(),onRenderError:I,onRenderSuccess:rt,page:k,renderForms:A,renderTextLayer:m,rotate:L,scale:N}=D,{canvasRef:P}=p;invariant(k,"Attempted to render page canvas, but no page was specified.");const x=reactExports.useRef(null);function w(){k&&rt&&rt(makePageCallback(k,N))}function g(l){isCancelException(l)||(warning(!1,l.toString()),I&&I(l))}const v=reactExports.useMemo(()=>k.getViewport({scale:N*$,rotation:L}),[$,k,L,N]),R=reactExports.useMemo(()=>k.getViewport({scale:N,rotation:L}),[k,L,N]);function C(){if(!k)return;k.cleanup();const{current:l}=x;if(!l)return;l.width=v.width,l.height=v.height,l.style.width=`${Math.floor(R.width)}px`,l.style.height=`${Math.floor(R.height)}px`,l.style.visibility="hidden";const u={annotationMode:A?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:l.getContext("2d",{alpha:!1}),viewport:v};d&&(u.background=d);const O=k.render(u),_=O;return O.promise.then(()=>{l.style.visibility="",w()}).catch(g),()=>cancelRunningTask(_)}reactExports.useEffect(C,[d,x,$,k,A,v,R]);const y=reactExports.useCallback(()=>{const{current:l}=x;l&&(l.width=0,l.height=0)},[x]);return reactExports.useEffect(()=>y,[y]),React.createElement("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(P,x),style:{display:"block",userSelect:"none"}},m?React.createElement(StructTree,null):null)}function PageSVG(){const p=usePageContext();invariant(p,"Unable to find Page context.");const{_className:e,onRenderSuccess:D,onRenderError:n,page:d,rotate:$,scale:I}=p;invariant(d,"Attempted to render page SVG, but no page was specified.");const[rt,k]=useResolver(),{value:A,error:m}=rt;function L(){d&&D&&D(makePageCallback(d,I))}function N(){m&&(isCancelException(m)||(warning(!1,m.toString()),n&&n(m)))}const P=reactExports.useMemo(()=>d.getViewport({scale:I,rotation:$}),[d,$,I]);function x(){k({type:"RESET"})}reactExports.useEffect(x,[d,k,P]);function w(){if(!d)return;const C=makeCancellablePromise(d.getOperatorList());return C.promise.then(y=>{new pdfjs$1.SVGGraphics(d.commonObjs,d.objs).getSVG(y,P).then(u=>{if(!(u instanceof SVGElement))throw new Error("getSVG returned unexpected result.");k({type:"RESOLVE",value:u})}).catch(u=>{k({type:"REJECT",error:u})})}).catch(y=>{k({type:"REJECT",error:y})}),()=>cancelRunningTask(C)}reactExports.useEffect(w,[d,k,P]),reactExports.useEffect(()=>{if(A!==void 0){if(A===!1){N();return}L()}},[A]);function g(C){if(!C||!A)return;C.firstElementChild||C.appendChild(A);const{width:y,height:l}=P;A.setAttribute("width",`${y}`),A.setAttribute("height",`${l}`)}const{width:v,height:R}=P;return React.createElement("div",{className:`${e}__svg`,ref:C=>g(C),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:v,height:R,userSelect:"none"}})}function isTextItem(p){return"str"in p}function TextLayer$1(){const p=usePageContext();invariant(p,"Unable to find Page context.");const{customTextRenderer:e,onGetTextError:D,onGetTextSuccess:n,onRenderTextLayerError:d,onRenderTextLayerSuccess:$,page:I,pageIndex:rt,pageNumber:k,rotate:A,scale:m}=p;invariant(I,"Attempted to load page text content, but no page was specified.");const[L,N]=useResolver(),{value:P,error:x}=L,w=reactExports.useRef(null),g=reactExports.useRef();warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function v(){P&&n&&n(P)}function R(){x&&(warning(!1,x.toString()),D&&D(x))}function C(){N({type:"RESET"})}reactExports.useEffect(C,[I,N]);function y(){if(!I)return;const b=makeCancellablePromise(I.getTextContent()),G=b;return b.promise.then(z=>{N({type:"RESOLVE",value:z})}).catch(z=>{N({type:"REJECT",error:z})}),()=>cancelRunningTask(G)}reactExports.useEffect(y,[I,N]),reactExports.useEffect(()=>{if(P!==void 0){if(P===!1){R();return}v()}},[P]);const l=reactExports.useCallback(()=>{$&&$()},[$]),u=reactExports.useCallback(b=>{warning(!1,b.toString()),d&&d(b)},[d]);function O(){const b=g.current;b&&b.classList.add("active")}function _(){const b=g.current;b&&b.classList.remove("active")}const c=reactExports.useMemo(()=>I.getViewport({scale:m,rotation:A}),[I,A,m]);function F(){if(!I||!P)return;const{current:b}=w;if(!b)return;b.innerHTML="";const G=I.streamTextContent({includeMarkedContent:!0}),z={container:b,textContentSource:G,viewport:c},E=pdfjs$1.renderTextLayer(z),X=E;return E.promise.then(()=>{const at=document.createElement("div");at.className="endOfContent",b.append(at),g.current=at;const ct=b.querySelectorAll('[role="presentation"]');if(e){let V=0;P.items.forEach((dt,mt)=>{if(!isTextItem(dt))return;const Et=ct[V];if(!Et)return;const wt=e(Object.assign({pageIndex:rt,pageNumber:k,itemIndex:mt},dt));Et.innerHTML=wt,V+=dt.str&&dt.hasEOL?2:1})}l()}).catch(u),()=>cancelRunningTask(X)}return reactExports.useLayoutEffect(F,[e,u,l,I,rt,k,P,c]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:_,onMouseDown:O,ref:w})}function AnnotationLayer$1(){const p=useDocumentContext();invariant(p,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const e=usePageContext();invariant(e,"Unable to find Page context.");const D=Object.assign(Object.assign({},p),e),{imageResourcesPath:n,linkService:d,onGetAnnotationsError:$,onGetAnnotationsSuccess:I,onRenderAnnotationLayerError:rt,onRenderAnnotationLayerSuccess:k,page:A,pdf:m,renderForms:L,rotate:N,scale:P=1}=D;invariant(A,"Attempted to load page annotations, but no page was specified.");const[x,w]=useResolver(),{value:g,error:v}=x,R=reactExports.useRef(null);warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function C(){g&&I&&I(g)}function y(){v&&(warning(!1,v.toString()),$&&$(v))}function l(){w({type:"RESET"})}reactExports.useEffect(l,[w,A]);function u(){if(!A)return;const b=makeCancellablePromise(A.getAnnotations()),G=b;return b.promise.then(z=>{w({type:"RESOLVE",value:z})}).catch(z=>{w({type:"REJECT",error:z})}),()=>{cancelRunningTask(G)}}reactExports.useEffect(u,[w,A,L]),reactExports.useEffect(()=>{if(g!==void 0){if(g===!1){y();return}C()}},[g]);function O(){k&&k()}function _(b){warning(!1,`${b}`),rt&&rt(b)}const c=reactExports.useMemo(()=>A.getViewport({scale:P,rotation:N}),[A,N,P]);function F(){if(!m||!A||!g)return;const{current:b}=R;if(!b)return;const G=c.clone({dontFlip:!0}),z={accessibilityManager:null,annotationCanvasMap:null,div:b,l10n:null,page:A,viewport:G},E={annotations:g,annotationStorage:m.annotationStorage,div:b,downloadManager:null,imageResourcesPath:n,linkService:d,page:A,renderForms:L,viewport:G};b.innerHTML="";try{new pdfjs$1.AnnotationLayer(z).render(E),O()}catch(X){_(X)}return()=>{}}return reactExports.useEffect(F,[g,n,d,A,L,c]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:R})}var __rest=globalThis&&globalThis.__rest||function(p,e){var D={};for(var n in p)Object.prototype.hasOwnProperty.call(p,n)&&e.indexOf(n)<0&&(D[n]=p[n]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(p);d<n.length;d++)e.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(p,n[d])&&(D[n[d]]=p[n[d]]);return D};const defaultScale=1,Page=function p(e){const D=useDocumentContext();invariant(D,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const n=Object.assign(Object.assign({},D),e),{_className:d="react-pdf__Page",_enableRegisterUnregisterPage:$=!0,canvasBackground:I,canvasRef:rt,children:k,className:A,customRenderer:m,customTextRenderer:L,devicePixelRatio:N,error:P="Failed to load the page.",height:x,inputRef:w,loading:g="Loading page…",noData:v="No page specified.",onGetAnnotationsError:R,onGetAnnotationsSuccess:C,onGetStructTreeError:y,onGetStructTreeSuccess:l,onGetTextError:u,onGetTextSuccess:O,onLoadError:_,onLoadSuccess:c,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:b,onRenderError:G,onRenderSuccess:z,onRenderTextLayerError:E,onRenderTextLayerSuccess:X,pageIndex:at,pageNumber:ct,pdf:V,registerPage:dt,renderAnnotationLayer:mt=!0,renderForms:Et=!1,renderMode:wt="canvas",renderTextLayer:M=!0,rotate:i,scale:o=defaultScale,unregisterPage:a,width:h}=n,f=__rest(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[T,j]=useResolver(),{value:W,error:it}=T,tt=reactExports.useRef(null);invariant(V,"Attempted to load a page, but no document was specified.");const et=isProvided(ct)?ct-1:at??null,ht=ct??(isProvided(at)?at+1:null),bt=i??(W?W.rotate:null),ut=reactExports.useMemo(()=>{if(!W)return null;let Gt=1;const Ht=o??defaultScale;if(h||x){const Xt=W.getViewport({scale:1,rotation:bt});h?Gt=h/Xt.width:x&&(Gt=x/Xt.height)}return Ht*Gt},[x,W,bt,o,h]);function Ft(){return()=>{isProvided(et)&&$&&a&&a(et)}}reactExports.useEffect(Ft,[$,V,et,a]);function Bt(){if(c){if(!W||!ut)return;c(makePageCallback(W,ut))}if($&&dt){if(!isProvided(et)||!tt.current)return;dt(et,tt.current)}}function St(){it&&(warning(!1,it.toString()),_&&_(it))}function Lt(){j({type:"RESET"})}reactExports.useEffect(Lt,[j,V,et]);function gt(){if(!V||!ht)return;const Gt=makeCancellablePromise(V.getPage(ht)),Ht=Gt;return Gt.promise.then(Xt=>{j({type:"RESOLVE",value:Xt})}).catch(Xt=>{j({type:"REJECT",error:Xt})}),()=>cancelRunningTask(Ht)}reactExports.useEffect(gt,[j,V,et,ht,dt]),reactExports.useEffect(()=>{if(W!==void 0){if(W===!1){St();return}Bt()}},[W,ut]);const nt=reactExports.useMemo(()=>W&&isProvided(et)&&ht&&isProvided(bt)&&isProvided(ut)?{_className:d,canvasBackground:I,customTextRenderer:L,devicePixelRatio:N,onGetAnnotationsError:R,onGetAnnotationsSuccess:C,onGetStructTreeError:y,onGetStructTreeSuccess:l,onGetTextError:u,onGetTextSuccess:O,onRenderAnnotationLayerError:F,onRenderAnnotationLayerSuccess:b,onRenderError:G,onRenderSuccess:z,onRenderTextLayerError:E,onRenderTextLayerSuccess:X,page:W,pageIndex:et,pageNumber:ht,renderForms:Et,renderTextLayer:M,rotate:bt,scale:ut}:null,[d,I,L,N,R,C,y,l,u,O,F,b,G,z,E,X,W,et,ht,Et,M,bt,ut]),st=reactExports.useMemo(()=>makeEventProps(f,()=>W&&(ut?makePageCallback(W,ut):void 0)),[f,W,ut]),pt=`${et}@${ut}/${bt}`,Tt=`${et}/${bt}`;function Ct(){switch(wt){case"custom":return invariant(m,'renderMode was set to "custom", but no customRenderer was passed.'),React.createElement(m,{key:`${pt}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${Tt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${pt}_canvas`,canvasRef:rt})}}function Ut(){return M?React.createElement(TextLayer$1,{key:`${pt}_text`}):null}function Vt(){return mt?React.createElement(AnnotationLayer$1,{key:`${pt}_annotations`}):null}function Wt(){return React.createElement(PageContext.Provider,{value:nt},Ct(),Ut(),Vt(),k)}function zt(){return ht?V===null||W===void 0||W===null?React.createElement(Message,{type:"loading"},typeof g=="function"?g():g):V===!1||W===!1?React.createElement(Message,{type:"error"},typeof P=="function"?P():P):Wt():React.createElement(Message,{type:"no-data"},typeof v=="function"?v():v)}return React.createElement("div",Object.assign({className:clsx(d,A),"data-page-number":ht,ref:mergeRefs(w,tt),style:{"--scale-factor":`${ut}`,backgroundColor:I||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},st),zt())},isFunctionOrNode=_pt.oneOfType([_pt.func,_pt.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:_pt.string,canvasRef:isRef,children:_pt.node,className:isClassName,customRenderer:_pt.func,customTextRenderer:_pt.func,devicePixelRatio:_pt.number,error:isFunctionOrNode,height:_pt.number,imageResourcesPath:_pt.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:_pt.func,onGetTextSuccess:_pt.func,onLoadError:_pt.func,onLoadSuccess:_pt.func,onRenderError:_pt.func,onRenderSuccess:_pt.func,onRenderTextLayerError:_pt.func,onRenderTextLayerSuccess:_pt.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:_pt.bool,renderForms:_pt.bool,renderMode:isRenderMode,renderTextLayer:_pt.bool,rotate:isRotate,scale:_pt.number,width:_pt.number});const Page$1=Page;displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(p){if(p==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}function shouldUseNative(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de",Object.getOwnPropertyNames(p)[0]==="5")return!1;for(var e={},D=0;D<10;D++)e["_"+String.fromCharCode(D)]=D;var n=Object.getOwnPropertyNames(e).map(function($){return e[$]});if(n.join("")!=="0123456789")return!1;var d={};return"abcdefghijklmnopqrst".split("").forEach(function($){d[$]=$}),Object.keys(Object.assign({},d)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var objectAssign=shouldUseNative()?Object.assign:function(p,e){for(var D,n=toObject(p),d,$=1;$<arguments.length;$++){D=Object(arguments[$]);for(var I in D)hasOwnProperty.call(D,I)&&(n[I]=D[I]);if(getOwnPropertySymbols){d=getOwnPropertySymbols(D);for(var rt=0;rt<d.length;rt++)propIsEnumerable.call(D,d[rt])&&(n[d[rt]]=D[d[rt]])}}return n};const objectAssign$1=getDefaultExportFromCjs(objectAssign),Iframe=({url:p,allowFullScreen:e,position:D,display:n,height:d,width:$,overflow:I,styles:rt,onLoad:k,onMouseOver:A,onMouseOut:m,scrolling:L,id:N,frameBorder:P,ariaHidden:x,sandbox:w,allow:g,className:v,title:R,ariaLabel:C,ariaLabelledby:y,name:l,target:u,loading:O,importance:_,referrerpolicy:c,allowpaymentrequest:F,src:b,key:G})=>{const z=objectAssign$1({src:b||p,target:u||null,style:{position:D||null,display:n||"initial",overflow:I||null},scrolling:L||null,allowpaymentrequest:F||null,importance:_||null,sandbox:w&&[...w].join(" ")||null,loading:O||null,styles:rt||null,name:l||null,className:v||null,allowFullScreen:"allowFullScreen",referrerpolicy:c||null,title:R||null,allow:g||null,id:N||null,"aria-labelledby":y||null,"aria-hidden":x||null,"aria-label":C||null,width:$||null,height:d||null,onLoad:k||null,onMouseOver:A||null,onMouseOut:m||null,key:G||"iframe"});let E=Object.create(null);for(let X of Object.keys(z))z[X]!=null&&(E[X]=z[X]);for(let X of Object.keys(E.style))E.style[X]==null&&delete E.style[X];if(E.styles)for(let X of Object.keys(E.styles))E.styles.hasOwnProperty(X)&&(E.style[X]=E.styles[X]),Object.keys(E.styles).pop()==X&&delete E.styles;if(e)if("allow"in E){const X=E.allow.replace("fullscreen","");E.allow=`fullscreen ${X.trim()}`.trim()}else E.allow="fullscreen";return P>=0&&(E.style.hasOwnProperty("border")||(E.style.border=P)),React.createElement("iframe",Object.assign({},E))},AnnotationLayer="",TextLayer="";pdfjs$1.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs$1.version}/pdf.worker.js`;const DocumentViewer=({url:p})=>{const[e,D]=reactExports.useState(null),n=["pdf","jpg","jpeg","png","gif"],d=p.split(".").pop();reactExports.useEffect(()=>{d&&(console.log({fileExtension:d}),n.includes(d.toLowerCase())&&D(d.toLowerCase()))},[p]),reactExports.useEffect(()=>{console.log({fileType:e,url:p})},[e]);const $=e==="jpg"||e==="png"||e==="jpeg"||e==="gif";return jsxRuntimeExports.jsxs("div",{className:"document-viewer",children:[e==="pdf"&&jsxRuntimeExports.jsx(PDFViewer,{url:p}),$&&jsxRuntimeExports.jsx(ImageViewer,{imageUrl:p}),!e&&jsxRuntimeExports.jsx(IframeViewer,{url:p})]})},PDFViewer=({url:p})=>{const[e,D]=reactExports.useState(null);reactExports.useState(1);const[n,d]=reactExports.useState(null),$=({numPages:rt})=>{D(rt)},I=rt=>{d(rt)};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Document$1,{file:{url:p},onLoadSuccess:$,onLoadError:I,children:jsxRuntimeExports.jsx(Page$1,{pageNumber:1})}),jsxRuntimeExports.jsx("style",{children:`
            .react-pdf__Page .react-pdf__Page__canvas{
              width: 100% !important;
              height: 100% !important;
            }
      `})]})},ImageViewer=({imageUrl:p})=>jsxRuntimeExports.jsx("img",{src:p,alt:"Document"}),IframeViewer=({url:p})=>jsxRuntimeExports.jsx(Iframe,{url:p,width:"100%",height:"500px"});injectReducer("crmTaskDetails",reducer$1);const TaskDetail=()=>{const p=useAppDispatch(),e=useParams(),{id:D}=e,n=useAppSelector(N=>{var P,x;return(x=(P=N==null?void 0:N.crmTaskDetails)==null?void 0:P.data)==null?void 0:x.task}),d=n==null?void 0:n.data,$=useAppSelector(N=>N.crmTaskDetails.data.loading),I=useCheckEditUpdate("tasks","canModify");reactExports.useEffect(()=>{rt()},[]);const rt=async()=>{D&&p(getTaskById(D)),await p(getTasks())},k=N=>{p(toggleAddForm(!0)),p(setSelectedNote(N)),p(setDialogMode("Edit"))},A=N=>{p(setSelectedNote(N)),p(toggleDeleteConfirmation(!0))},m=()=>{p(toggleAddForm(!0)),p(setDialogMode("Add"))},L=()=>{window.history.back()};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"15px"},children:[jsxRuntimeExports.jsx("span",{className:"cursor-pointer hover:text-indigo-500 items-center lg mr-2 mt-0",style:{fontSize:"2.5rem",fontWeight:"bold",color:"black"},onClick:L,children:jsxRuntimeExports.jsx(IoIosArrowRoundBack,{})}),jsxRuntimeExports.jsx("h3",{children:"Task Details"})]}),jsxRuntimeExports.jsxs(Container,{className:"h-full",children:[jsxRuntimeExports.jsx(Loading,{loading:$,children:!isEmpty(d)&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(TaskProfile,{data:d}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 lg:grid-cols-4 gap-4 mt-2",children:[jsxRuntimeExports.jsxs(AdaptableCard,{className:"col-span-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between mb-2",children:[jsxRuntimeExports.jsx("h5",{children:"Notes"}),I&&jsxRuntimeExports.jsx(Button,{size:"xs",type:"button",className:"!px-2 !text-lg",onClick:m,children:jsxRuntimeExports.jsx(BiSolidMessageSquareAdd,{})})]}),jsxRuntimeExports.jsx(NoteTimeline,{notes:(d==null?void 0:d.taskNotes)||[],canEdit:I,onEdit:k,onDelete:A})]}),(d==null?void 0:d.attachments)&&jsxRuntimeExports.jsxs(AdaptableCard,{className:"col-span-1 select-none",children:[jsxRuntimeExports.jsx("h5",{className:"mb-2",children:"Attachments"}),jsxRuntimeExports.jsx(DocumentViewer,{url:(d==null?void 0:d.attachments)||""})]}),jsxRuntimeExports.jsxs(AdaptableCard,{className:"col-span-1",children:[jsxRuntimeExports.jsx("h5",{children:"Task Activity"}),jsxRuntimeExports.jsx(LeadActivity,{activity:(d==null?void 0:d.taskActivities)||[]})]})]})]})}),!$&&isEmpty(d)&&jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx(DoubleSidedImage,{src:"/img/others/img-2.png",darkModeSrc:"/img/others/img-2-dark.png",alt:"No user found!"}),jsxRuntimeExports.jsx("h3",{className:"mt-8",children:"No user found!"})]}),jsxRuntimeExports.jsx(NotesAddFormTask,{}),jsxRuntimeExports.jsx(NotesDeleteConfirmationTask,{})]})]})};export{TaskDetail as default};
