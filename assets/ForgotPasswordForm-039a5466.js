import{r as d,a3 as R,j as a,ap as M,aS as $,aT as B}from"./index-4b23f9f2.js";import{F as T,a as S}from"./FormItem-83b1322c.js";import{I as V}from"./Input-6deb6f13.js";import{B as b}from"./Button-a87a2e46.js";import{A as w}from"./Alert-fa9d0487.js";import{A as D}from"./ActionLink-34e07094.js";import{u as K}from"./useTimeOutMessage-a88d7e11.js";import{F as q,a as G,b as z}from"./formik.esm-25368bc5.js";import{c as L,a as U}from"./index.esm-dc2ded9f.js";import"./index-e9d5fe85.js";import"./Badge-84757ba5.js";import"./RangeCalendar-208190e3.js";import"./Card-74d89d1e.js";import"./index-5f058379.js";import"./index-8d3acbcc.js";import"./Dialog-3deb7f0e.js";import"./Drawer-7cb84764.js";import"./index-61dfa989.js";import"./toString-808a232b.js";import"./index-f452e3c1.js";import"./index-16ecbf84.js";import"./index-c20d3f97.js";import"./toast-01acb463.js";import"./Pagination-b7445f7d.js";import"./Progress-26519a5b.js";import"./index-61b07bb6.js";import"./ScrollBar-9c634026.js";import"./index-b2764899.js";import{S as W}from"./Select-4aee735d.js";import"./Skeleton-d609680e.js";import"./index-de1abaee.js";import"./Switcher-031290dc.js";import"./index-1a8e49e3.js";import"./index-61e0f5b7.js";import"./Tag-31cf62c8.js";import"./index-a6566abb.js";import"./index-c6827dae.js";import"./Tooltip-7118406c.js";import"./Upload-75447e1c.js";import{b as H}from"./SuperAdminServices-b7b5c315.js";const J=({onInputChange:x})=>{const[s,h]=d.useState(["","","","","",""]),g=Array.from({length:6},()=>R.createRef()),f=(i,r)=>{var u;const n=r.target.value;/^\d$/.test(n)?(s[i]=n,h([...s]),i<5&&((u=g[i+1].current)==null||u.focus()),x(s.join(""))):(s[i]="",h([...s]))},y=(i,r)=>{var n;r.key==="Backspace"&&i>0&&!s[i]&&((n=g[i-1].current)==null||n.focus(),s[i-1]="",h([...s]),x(s.join("")))};return a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:s.map((i,r)=>a.jsx("input",{type:"text",value:i,onChange:n=>f(r,n),onKeyDown:n=>y(r,n),ref:g[r],style:{width:"2em",height:"2em",textAlign:"center",fontSize:"1.2em",border:"1px solid #ccc",borderRadius:"4px",margin:"0 0.2em",outline:"none"}},r))})},Q=L().shape({email:U().required("Please enter your email")}),Ba=x=>{const{disableSubmit:s=!1,className:h,signInUrl:g="/sign-in"}=x,[f,y]=d.useState(!1),[i,r]=K(),[n,u]=d.useState(!1),[F,k]=d.useState(""),[N,C]=d.useState([]),[j,O]=d.useState([]),I=M(),E=async(t,e)=>{var m,l;e(!0);try{(await $(t)).data&&(e(!1),y(!0))}catch(o){r(((l=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:l.message)||o.toString()),e(!1)}};d.useEffect(()=>{P()},[]);const P=async()=>{var e,m,l,o,c;const t=await H();if((e=t==null?void 0:t.data)!=null&&e.data&&((l=(m=t==null?void 0:t.data)==null?void 0:m.data)!=null&&l.length)){const p=(c=(o=t==null?void 0:t.data)==null?void 0:o.data)==null?void 0:c.map(v=>({label:v.organizationName,value:v.id}));console.log(p),C(p)}};console.log("wed",j);const A=async(t,e)=>{var m,l,o;try{u(!0);const p=await B({otp:t,organization:e});console.log("ed",p),p.data&&(u(!1),y(!0),I(`/reset-password?organization=${e}&token=${(m=p==null?void 0:p.data)==null?void 0:m.token}`))}catch(c){r(((o=(l=c==null?void 0:c.response)==null?void 0:l.data)==null?void 0:o.message)||c.toString()),u(!1)}};return a.jsxs("div",{className:h,children:[a.jsx("div",{className:"mb-6",children:f?a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"mb-1",children:"Check your email"}),a.jsx("p",{children:"We have sent a password recovery instruction to your email"}),i&&a.jsx(w,{showIcon:!0,className:"mb-4 mt-4",type:"danger",children:i}),a.jsx("div",{className:"mb-6 mt-6",children:a.jsx(J,{onInputChange:t=>k(t)})}),a.jsx(b,{block:!0,loading:n,variant:"solid",onClick:()=>A(F,j==null?void 0:j.value),children:"Verify"})]}):a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"mb-1",children:"Forgot Password"}),a.jsx("p",{children:"Please enter your email address to receive a verification code"}),i&&a.jsx(w,{showIcon:!0,className:"mb-4 mt-4",type:"danger",children:i})]})}),a.jsx(q,{initialValues:{email:"dhwani.shah@sarvadhi.com",organization:""},validationSchema:Q,onSubmit:(t,{setSubmitting:e})=>{s?e(!1):E(t,e)},children:({touched:t,errors:e,isSubmitting:m,setFieldValue:l})=>a.jsx(G,{children:a.jsxs(T,{children:[a.jsxs("div",{className:f?"hidden":"",children:[a.jsx(S,{invalid:e.email&&t.email,errorMessage:e.email,children:a.jsx(z,{type:"email",autoComplete:"off",name:"email",placeholder:"Email",component:V})}),a.jsx(S,{label:"Organization",invalid:e.organization&&t.organization,errorMessage:e.organization,children:a.jsx(z,{autoComplete:"off",name:"organization",placeholder:"Organization",component:W,options:N,value:j,onChange:o=>{l("organization",o.value),O(o)}})})]}),a.jsx(b,{block:!0,loading:m,variant:"solid",type:"submit",children:f?"Resend Email":"Send Email"}),a.jsxs("div",{className:"mt-4 text-center",children:[a.jsx("span",{children:"Back to "}),a.jsx(D,{to:g,children:"Sign in"})]})]})})})]})};export{Ba as F};
