import{a as q,r as m,j as t}from"./index-2a02f09f.js";import{T as H}from"./index-bb34e564.js";import{a as n,F as E}from"./FormItem-c05bb264.js";import{u as $,b as r,F as z,a as _}from"./formik.esm-dba0dfcc.js";import{c as G,a as I,f as J,b as K}from"./index.esm-d97e517c.js";import{I as d}from"./Input-4032ba6b.js";import{A as Q}from"./index-5ca6dc5a.js";import{U as W}from"./Upload-21ca1a8f.js";import{I as X,a6 as Y,a7 as Z,a8 as ee}from"./index.esm-c61f0406.js";import{A as te}from"./index.esm-1c4998f8.js";import{a as ae,T as se,b as oe}from"./index.esm-9f9c71ef.js";import{u as O,D as ie,A as ne,j as re,k as le,t as ce,c as de,l as me,s as u,g,m as pe}from"./AdditionalTag-4259bcb6.js";/* empty css              */import{B as xe,a as fe,b as he,c as ue}from"./index.esm-c0bac851.js";import{t as L,N as S}from"./toast-66eca971.js";const ge=p=>{const{touched:o,errors:e}=p,j=q(),[s,b]=m.useState(!1);m.useState("#808080");const[A,y]=m.useState(!1),[l,f]=m.useState([]),[R,U]=m.useState([]),v=()=>{b(!s),y(!1)},[k,D]=m.useState("");m.useEffect(()=>{(async()=>{var x,T;try{const{payload:c}=await j(re());console.log(c,"send Me The Id And The Payload");const w=(x=c==null?void 0:c.data)==null?void 0:x.find(h=>(h==null?void 0:h.moduleName)==="clients");if(D(w.id),w){const{payload:h}=await j(le({id:(T=w==null?void 0:w.id)==null?void 0:T.toString()})),P=ce(h.data),V=de(h.data);U(V),f(P)}}catch(c){console.error("Error fetching module data:",c)}})()},[j]);const N=O(i=>i.crmCustomers.data.selectedCustomer),[M,F]=m.useState(N?N.tags||[]:[]),C=$(),a=i=>{console.log(i),F(i);const x=[i.value];C.setFieldValue("tagId",x)};return t.jsxs(t.Fragment,{children:[t.jsx(n,{invalid:e.upload&&o.upload,errorMessage:e.upload,children:t.jsx(r,{name:"img",children:({field:i,form:x})=>{const T=i.value?{src:i.value}:{};return t.jsx("div",{className:"flex justify-center",children:t.jsx(W,{className:"cursor-pointer",showList:!1,uploadLimit:1,onChange:c=>x.setFieldValue(i.name,URL.createObjectURL(c[0])),onFileRemove:c=>x.setFieldValue(i.name,URL.createObjectURL(c[0])),children:t.jsx(Q,{className:"border-2 border-white dark:border-gray-800 shadow-lg",size:100,shape:"circle",icon:t.jsx(X,{}),...T})})})}})}),t.jsx(n,{label:"Customer Name",invalid:e.clientName&&o.clientName,errorMessage:e.clientName,children:t.jsx(r,{type:"text",autoComplete:"off",name:"clientName",placeholder:"Customer Name",component:d,prefix:t.jsx(Y,{className:"text-xl"})})}),t.jsx(n,{label:"Contact Number",invalid:e.contactInfo&&o.contactInfo,errorMessage:e.contactInfo,children:t.jsx(r,{type:"text",autoComplete:"off",name:"contactInfo",placeholder:"contactInfo",component:d,prefix:t.jsx(Z,{className:"text-xl"})})}),t.jsx(n,{label:"Address",invalid:e.address&&o.address,errorMessage:e.address,children:t.jsx(r,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:d,prefix:t.jsx(ee,{className:"text-xl"})})}),t.jsx(n,{label:"Billing Details",invalid:e.billingDetails&&o.billingDetails,errorMessage:e.billingDetails,children:t.jsx(r,{type:"text",autoComplete:"off",name:"billingDetails",placeholder:"Billing Details",component:d,prefix:t.jsx(ae,{className:"text-xl"})})}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx(n,{label:"TagId",invalid:e.history&&o.history,errorMessage:e.history,children:t.jsxs("div",{style:{position:"relative"},children:[t.jsx(r,{name:"Tag",component:ie,options:l,placeholder:"Select a Tag",value:C.initialValues.tagName,onChange:a}),t.jsx(se,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{v(),y(!0)}})]})}),t.jsx(ne,{isOpen:s,moduleName:k,categoryList:R,onOpenChange:i=>b(i)})]}),t.jsx(n,{label:"History",invalid:e.history&&o.history,errorMessage:e.history,children:t.jsx(r,{type:"text",autoComplete:"off",name:"history",placeholder:"History",component:d,prefix:t.jsx(te,{className:"text-xl"})})}),t.jsx(n,{label:"Notes",invalid:e.notes&&o.notes,errorMessage:e.notes,children:t.jsx(r,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:d,prefix:t.jsx(oe,{className:"text-xl"})})})]})},je=p=>{const{touched:o,errors:e}=p;return t.jsxs(t.Fragment,{children:[t.jsx(n,{label:"Facebook link",invalid:e.facebook&&o.facebook,errorMessage:e.facebook,children:t.jsx(r,{type:"text",autoComplete:"off",name:"facebook",placeholder:"URL",component:d,prefix:t.jsx(xe,{className:"text-xl text-[#1773ea]"})})}),t.jsx(n,{label:"Twitter link",invalid:e.twitter&&o.twitter,errorMessage:e.twitter,children:t.jsx(r,{type:"text",autoComplete:"off",name:"twitter",placeholder:"URL",component:d,prefix:t.jsx(fe,{className:"text-xl text-[#1da1f3]"})})}),t.jsx(n,{label:"Pinterest link",invalid:e.pinterest&&o.pinterest,errorMessage:e.pinterest,children:t.jsx(r,{type:"text",autoComplete:"off",name:"pinterest",placeholder:"URL",component:d,prefix:t.jsx(he,{className:"text-xl text-[#df0018]"})})}),t.jsx(n,{label:"LinkedIn link",invalid:e.linkedIn&&o.linkedIn,errorMessage:e.linkedIn,children:t.jsx(r,{type:"text",autoComplete:"off",name:"linkedIn",placeholder:"URL",component:d,prefix:t.jsx(ue,{className:"text-xl text-[#0077b5]"})})})]})},be=G().shape({clientName:I().required("Customer Name is required"),contactInfo:J().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",p=>!isNaN(p)).test("is-ten-digits","Contact must be exactly 10 digits",p=>/^\d{10}$/.test(p)),address:I().required("Address is required"),billingDetails:I().required("Billing Details is required"),history:I(),notes:I(),tagId:K()}),{TabNav:ye,TabList:Ne,TabContent:B}=H,Ce=m.forwardRef((p,o)=>{var b,A,y;const e=O(l=>l.crmCustomers.data.selectedCustomer),j=!!e.id,s=q();return t.jsx(z,{innerRef:o,initialValues:{clientName:(e==null?void 0:e.clientName)||"",contactInfo:(e==null?void 0:e.contactInfo)||"",address:(e==null?void 0:e.address)||"",billingDetails:(e==null?void 0:e.billingDetails)||"",history:(e==null?void 0:e.history)||"",notes:(e==null?void 0:e.notes)||"",tagName:((A=(b=e==null?void 0:e.tags)==null?void 0:b[0])==null?void 0:A.tagName)||"",tagId:((y=e==null?void 0:e.tags)==null?void 0:y.map(l=>l.id))||[],colorName:e!=null&&e.tags&&(e==null?void 0:e.tags.length)>0?e==null?void 0:e.tags[0].colorName:""},validationSchema:be,onSubmit:async(l,{setSubmitting:f})=>{var k,D,N,M,F,C;const{colorName:R,tagName:U,...v}=l;if(j){const a=await s(me({customerId:(e==null?void 0:e.id)||"",updatedData:v}));(k=a==null?void 0:a.payload)!=null&&k.success?(await s(u()),await s(g()),L.push(t.jsx(S,{title:"Successfully Added",type:"success",duration:2500,children:(D=a==null?void 0:a.payload)==null?void 0:D.message}),{placement:"top-center"})):(L.push(t.jsx(S,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(N=a==null?void 0:a.payload)==null?void 0:N.message}),{placement:"top-center"}),await s(u()),await s(g())),await s(g()),await s(u())}else{const a=await s(pe(v));(M=a==null?void 0:a.payload)!=null&&M.success?(await s(u()),await s(g()),L.push(t.jsx(S,{title:"Successfully Added",type:"success",duration:2500,children:(F=a==null?void 0:a.payload)==null?void 0:F.message}),{placement:"top-center"})):(L.push(t.jsx(S,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(C=a==null?void 0:a.payload)==null?void 0:C.message}),{placement:"top-center"}),await s(u()),await s(g())),await s(g()),await s(u())}f(!1)},children:({touched:l,errors:f})=>t.jsx(_,{children:t.jsx(E,{children:t.jsxs(H,{defaultValue:"personalInfo",children:[t.jsx(Ne,{children:t.jsx(ye,{value:"personalInfo",children:"Custometer Detail"})}),t.jsxs("div",{className:"p-6",children:[t.jsx(B,{value:"personalInfo",children:t.jsx(ge,{touched:l,errors:f})}),t.jsx(B,{value:"social",children:t.jsx(je,{touched:l,errors:f})})]})]})})})})});Ce.displayName="CustomerForm";export{Ce as C};
