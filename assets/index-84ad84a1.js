import{am as b,an as de,ao as me,ap as pe,a as w,r as d,j as e,ai as ue,ar as xe}from"./index-21d7ce34.js";import{A as ge}from"./AdaptableCard-1403a507.js";import{D as he}from"./DataTable-2fc93372.js";import{c as fe,d as je,e as Ce,f as Le,g as be,h as we,i as ye,j as J,k as ve}from"./CrmService-ca976601.js";import{u as Q}from"./useThemeClass-103b190c.js";import{B as E}from"./Button-6c3081fd.js";import{D as De}from"./Drawer-08bde54d.js";import{T as W}from"./index-cfa1d7b1.js";import{u as Ne,c as C,d as L,F as Se,a as ke,b as Ie}from"./formik.esm-b31c216f.js";import{c as Te,a as R,b as Fe}from"./index.esm-078c9db1.js";import{I as D}from"./Input-b18c5be2.js";import{A as X}from"./index-60ecab9e.js";import{U as Ae}from"./Upload-a60754e4.js";import{I as Re,a7 as Oe,a6 as Ee,a8 as G,z as Me,B as Be,d as ze,a9 as Ue,r as Ve}from"./index.esm-3f5f076a.js";import{D as U,A as He,t as $e,c as Pe}from"./AdditionalTag-ee745a24.js";/* empty css              */import{T as qe}from"./index.esm-1004ce28.js";import{B as Ge,a as Ke,b as _e,c as Je}from"./index.esm-a8cf6609.js";import{c as A}from"./cloneDeep-c49c3d8a.js";import{d as Qe}from"./debounce-4303ffbd.js";import{S as We,c as Xe}from"./Select-6e523134.js";import{B as Y}from"./Badge-0547788a.js";import{C as Ye}from"./Card-c016d7e4.js";import{M as Ze}from"./MediaSkeleton-caa70ad7.js";import{N as ea}from"./react-number-format.es-4ce1f76b.js";import"./index-83ec9673.js";import"./index.esm-b042e3c5.js";import"./Pagination-d1806156.js";import"./index-0bf67457.js";import"./_Uint8Array-00b9b100.js";import"./_MapCache-e6bfd31d.js";import"./Views-aa9d3067.js";import"./_baseIsEqual-06f63cf1.js";import"./get-db5a0269.js";import"./toString-839cbc0d.js";import"./TableRowSkeleton-e0a9e899.js";import"./Skeleton-5f2460b7.js";import"./index-dfd66886.js";import"./context-ff20449e.js";import"./index-e63aba64.js";import"./CloseButton-8f19e7bd.js";import"./useControllableState-3f0dec55.js";import"./index-99dab15c.js";import"./isNil-e652d611.js";import"./useMergeRef-788c4cb0.js";import"./Tooltip-1a8549c9.js";import"./usePopper-50e8ad5a.js";import"./index.esm-4dac136d.js";import"./toast-60e590e4.js";import"./useTimeout-c424fd3c.js";import"./StatusIcon-cb41def8.js";import"./chainedFunction-070f832c.js";import"./Alert-bd43990b.js";import"./Calendar-d76733e5.js";import"./index-d0bd679a.js";import"./useRootClose-aa5c19cb.js";import"./RangeCalendar-b8d72020.js";import"./TimeInput-53379264.js";import"./useUniqueId-18384f8e.js";import"./useDidUpdate-d17bf275.js";import"./Dialog-fcbd4cee.js";import"./index-cbaf419c.js";import"./useUncertainRef-1f87b20a.js";import"./index-a936af3e.js";import"./index-5f8b7824.js";import"./index-24a2595e.js";import"./Progress-1f726e4f.js";import"./index-489c77b3.js";import"./ScrollBar-83d9acc4.js";import"./index-97d1b97f.js";import"./index-de8563c1.js";import"./mapCloneElement-18ca430e.js";import"./Switcher-25855834.js";import"./Tag-49702b6e.js";import"./index-f9e4d97b.js";import"./index-c82bc72a.js";import"./_getPrototype-2575ec81.js";import"./toConsumableArray-26f6508e.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";const aa="crmLeads",H=b("crmLeads/data/getLeadsStatistic",async()=>(await fe()).data),N=b("crmLeads/data/getLeads",async()=>(await je()).data),$=b("crmContact/data/getContact",async()=>(await Ce()).data),ta=b("crmLeads/data/editLeads",async({leadsId:s,updatedData:a})=>(await Le(s,a)).data),sa=b("crmLeads/data/deleteLeads",async s=>await be(s)),oa=b("crmLeads/data/createLeads",async s=>(await we(s)).data),ra=b("crmLeads/data/module",async()=>(await ye()).data),na=b("tag-category",async({id:s})=>(await J(s)).data);b("crmLeads/data/fetchTag",async({id:s})=>(await J(s)).data);b("crmLeads/data/createTag",async({masterId:s,colorName:a,tagName:t,tagCategoryId:o})=>(await ve({colorName:a,tagName:t,masterId:s,tagCategoryId:o})).data);const ia={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},la={status:""},ca={loading:!1,statisticLoading:!1,leadsList:[],statisticData:{},tableData:ia,filterData:la,drawerOpen:!1,selectedLeads:{}},Z=de({name:`${aa}/state`,initialState:ca,reducers:{setTableData:(s,a)=>{s.tableData=a.payload},setLeadsList:(s,a)=>{s.leadsList=a.payload},setFilterData:(s,a)=>{s.filterData=a.payload},setSelectedLeads:(s,a)=>{s.selectedLeads=a.payload},setDrawerOpen:s=>{s.drawerOpen=!0},setDrawerClose:s=>{s.drawerOpen=!1}},extraReducers:s=>{s.addCase(N.fulfilled,(a,t)=>{a.leadsList=t.payload.data,a.loading=!1}).addCase(N.pending,a=>{a.loading=!0}).addCase(H.fulfilled,(a,t)=>{a.statisticData=t.payload,a.statisticLoading=!1}).addCase(H.pending,a=>{a.statisticLoading=!0}).addCase($.fulfilled,(a,t)=>{a.contactList=t.payload.data,a.loading=!1}).addCase($.pending,a=>{a.loading=!0})}}),{setTableData:O,setLeadsList:as,setFilterData:ee,setSelectedLeads:ae,setDrawerOpen:te,setDrawerClose:P}=Z.actions,da=Z.reducer,ma=me({data:da}),h=pe,pa=s=>{const{touched:a,errors:t}=s,o=w(),r=Ne(),[i,l]=d.useState(!1),[c,x]=d.useState(!1),[u,g]=d.useState([]),[I,y]=d.useState([]),M=()=>{l(!i),x(!1)},B=["active","deactive"],[n,f]=d.useState([]);d.useEffect(()=>{(async()=>{try{const{payload:p}=await o($()),S=p.data.map(j=>({value:j.id,label:j.name}));f(S)}catch(p){console.error(p)}})()},[o]);const[z,T]=d.useState("");d.useEffect(()=>{(async()=>{var p,S;try{const{payload:j}=await o(ra()),F=(p=j==null?void 0:j.data)==null?void 0:p.find(k=>(k==null?void 0:k.moduleName)==="leads");if(T(F.id),F){const{payload:k}=await o(na({id:(S=F==null?void 0:F.id)==null?void 0:S.toString()})),le=$e(k.data),ce=Pe(k.data);y(ce),g(le)}}catch(j){console.error("Error fetching module data:",j)}})()},[o]);const v=h(m=>m.crmLeads.data.selectedLeads),[q,ne]=d.useState(v?v.tags||[]:[]),ie=m=>{ne(m);const p=[m.value];r.setFieldValue("tagId",p)};return e.jsxs(e.Fragment,{children:[e.jsx(C,{invalid:t.upload&&a.upload,errorMessage:t.upload,children:e.jsx(L,{name:"img",children:({field:m,form:p})=>{const S=m.value?{src:m.value}:{};return e.jsx("div",{className:"flex justify-center",children:e.jsx(Ae,{className:"cursor-pointer",showList:!1,uploadLimit:1,onChange:j=>p.setFieldValue(m.name,URL.createObjectURL(j[0])),onFileRemove:j=>p.setFieldValue(m.name,URL.createObjectURL(j[0])),children:e.jsx(X,{className:"border-2 border-white dark:border-gray-800 shadow-lg",size:100,shape:"circle",icon:e.jsx(Re,{}),...S})})})}})}),e.jsx(C,{label:"Contact Name",children:e.jsx(L,{autoComplete:"off",name:"contactsDataId",placeholder:"Contact Name",options:n,id:"contactsDataId",value:r.initialValues.name,component:U,prefix:e.jsx(Oe,{className:"text-xl"}),onChange:m=>{const p=m.value;r.setFieldValue("contactsDataId",p)}})}),e.jsx(C,{label:"Details",invalid:t.details&&a.details,errorMessage:t.details,children:e.jsx(L,{type:"text",autoComplete:"off",name:"details",placeholder:"Details",component:D,prefix:e.jsx(Ee,{className:"text-xl"})})}),e.jsx(C,{label:"Status",invalid:t.status&&a.status,errorMessage:t.status,children:e.jsx(L,{type:"text",autoComplete:"off",name:"status",placeholder:"Status",component:U,options:B,id:"status",value:r.initialValues.status,prefix:e.jsx(G,{className:"text-xl"}),onChange:m=>{const p=m.value;r.setFieldValue("status",p)}})}),e.jsx(C,{label:"notes",invalid:t.notes&&a.notes,errorMessage:t.notes,children:e.jsx(L,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:D,prefix:e.jsx(G,{className:"text-xl"})})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(C,{label:"Tag",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(L,{name:"Tag",component:U,value:r.initialValues.tagName,options:u,placeholder:"Select a Tag",onChange:ie}),e.jsx(qe,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{M(),x(!0)}})]})}),e.jsx(He,{isOpen:i,categoryList:I,moduleName:z,onOpenChange:m=>l(m)})]})]})},ua=s=>{const{touched:a,errors:t}=s;return e.jsxs(e.Fragment,{children:[e.jsx(C,{label:"Facebook link",invalid:t.facebook&&a.facebook,errorMessage:t.facebook,children:e.jsx(L,{type:"text",autoComplete:"off",name:"facebook",placeholder:"URL",component:D,prefix:e.jsx(Ge,{className:"text-xl text-[#1773ea]"})})}),e.jsx(C,{label:"Twitter link",invalid:t.twitter&&a.twitter,errorMessage:t.twitter,children:e.jsx(L,{type:"text",autoComplete:"off",name:"twitter",placeholder:"URL",component:D,prefix:e.jsx(Ke,{className:"text-xl text-[#1da1f3]"})})}),e.jsx(C,{label:"Pinterest link",invalid:t.pinterest&&a.pinterest,errorMessage:t.pinterest,children:e.jsx(L,{type:"text",autoComplete:"off",name:"pinterest",placeholder:"URL",component:D,prefix:e.jsx(_e,{className:"text-xl text-[#df0018]"})})}),e.jsx(C,{label:"LinkedIn link",invalid:t.linkedIn&&a.linkedIn,errorMessage:t.linkedIn,children:e.jsx(L,{type:"text",autoComplete:"off",name:"linkedIn",placeholder:"URL",component:D,prefix:e.jsx(Je,{className:"text-xl text-[#0077b5]"})})})]})},xa=Te().shape({details:R().required("Details are required"),status:R().required("Status is required"),contactsDataId:R(),notes:R(),tagId:Fe()}),{TabNav:ga,TabList:ha,TabContent:K}=W,se=d.forwardRef((s,a)=>{var i,l,c,x;const t=h(u=>u.crmLeads.data.selectedLeads),o=!!t.id;console.log(o,"Editing Done");const r=w();return e.jsx(Se,{innerRef:a,initialValues:{contactsDataId:t.contactsDataId||null,details:(t==null?void 0:t.details)||"",status:(t==null?void 0:t.status)||"",notes:(t==null?void 0:t.notes)||"",tagName:((l=(i=t==null?void 0:t.tags)==null?void 0:i[0])==null?void 0:l.tagName)||"",name:((c=t==null?void 0:t.contactData)==null?void 0:c.name)||"",tagId:((x=t==null?void 0:t.tags)==null?void 0:x.map(u=>u.id))||[]},validationSchema:xa,onSubmit:async(u,{setSubmitting:g})=>{const{colorName:I,...y}=u;console.log(I),o===!0?(console.log(u,"Bhai testing kar"),await r(ta({leadsId:(t==null?void 0:t.id)||"",updatedData:y})),await r(N()),await r(P())):(console.log(y,"Maat Aa"),await r(oa(y)),await r(N()),await r(P())),console.log("on submit called "),g(!1)},children:({touched:u,errors:g})=>e.jsx(ke,{children:e.jsx(Ie,{children:e.jsxs(W,{defaultValue:"personalInfo",children:[e.jsx(ha,{children:e.jsx(ga,{value:"personalInfo",children:"Custometer Detail"})}),e.jsxs("div",{className:"p-6",children:[e.jsx(K,{value:"personalInfo",children:e.jsx(pa,{touched:u,errors:g})}),e.jsx(K,{value:"social",children:e.jsx(ua,{touched:u,errors:g})})]})]})})})})});se.displayName="LeadsForm";const oe=d.forwardRef((s,a)=>{w();const t=h(i=>i.crmLeads.data.selectedLeads),o=h(i=>i.crmLeads.data.leadsList);console.log(o,"Here Is The Data");const r=async i=>{try{console.log("Edited Content Change")}catch(l){console.error("Error updating leads:",l)}};return e.jsx(se,{ref:a,leads:t,onFormSubmit:r})});oe.displayName="LeadsEditContent";const fa=({onSaveClick:s,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(E,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(E,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),ja=()=>{const s=w(),a=h(i=>i.crmLeads.data.drawerOpen),t=()=>{s(P()),s(ae({}))},o=d.useRef(null),r=()=>{var i,l;console.log("formSubmit function called",(i=o.current)==null?void 0:i.values),(l=o.current)==null||l.submitForm()};return e.jsx(De,{isOpen:a,closable:!1,bodyClass:"p-0",footer:e.jsx(fa,{onCancel:t,onSaveClick:r}),onClose:t,onRequestClose:t,children:e.jsx(oe,{ref:o})})},Ca=({row:s})=>{const{textTheme:a}=Q(),t=w(),o=()=>{t(te()),t(ae(s))};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},La=({row:s})=>{const{textTheme:a}=Q(),t=w(),o=async()=>{console.log(s,"Bhai Agaya"),await t(sa(s.id)),await t(N())};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold text-red-500`,onClick:o,children:"Delete"})},ba=()=>{const s=w(),a=h(n=>n.crmLeads.data.leadsList);console.log("Getting Leads List",a);const t=h(n=>n.crmLeads.data.loading),o=h(n=>n.crmLeads.data.filterData),{pageIndex:r,pageSize:i,sort:l,query:c,total:x}=h(n=>n.crmLeads.data.tableData),u=d.useCallback(()=>{s(N())},[s]);d.useEffect(()=>{u()},[u,r,i,l,o]);const g=d.useMemo(()=>({pageIndex:r,pageSize:i,sort:l,query:c,total:x}),[r,i,l,c,x]),I=d.useMemo(()=>[{header:"Details",accessorKey:"details",cell:n=>n.row.original.details,width:200},{header:"Contact Number",accessorKey:"contactNumber",cell:n=>n.row.original.contactData.contactNumber,width:200},{header:"Status",accessorKey:"status",cell:n=>n.row.original.status,width:200},{header:"Tag Name",accessorKey:"tagName",width:200,cell:n=>{const z=(n.row.original.tags||[]).map(T=>{const v=T.colorName||"#000000",q={backgroundColor:`rgba(${parseInt(v.slice(1,3),16)}, ${parseInt(v.slice(3,5),16)}, ${parseInt(v.slice(5,7),16)}, 0.2)`,color:v,padding:"4px 8px",borderRadius:"4px",marginRight:"4px",marginBottom:"4px"};return e.jsx("div",{style:q,children:T.tagName},T.id)});return e.jsx("div",{children:z})}},{header:"Notes",accessorKey:"notes",cell:n=>n.row.original.notes,width:200},{header:"Edit",id:"action",cell:n=>e.jsx(Ca,{row:n.row.original})},{header:"Delete",id:"action",cell:n=>e.jsx(La,{row:n.row.original})}],[]),y=n=>{const f=A(g);f.pageIndex=n,s(O(f))},M=n=>{const f=A(g);f.pageSize=Number(n),f.pageIndex=1,s(O(f))},B=n=>{const f=A(g);f.sort=n,s(O(f))};return e.jsxs("div",{children:[e.jsx(he,{columns:I,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:g.total,pageIndex:g.pageIndex,pageSize:g.pageSize},onPaginationChange:y,onSelectChange:M,onSort:B}),e.jsx(ja,{})]})},re=d.forwardRef((s,a)=>{const{onInputChange:t}=s,o=Qe(r,500);function r(l){t==null||t(l)}const i=l=>{o(l.target.value)};return e.jsx(D,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(Me,{className:"text-lg"}),onChange:i})});re.displayName="LeadsTableSearch";const{Control:wa}=Xe,_=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],ya=({innerProps:s,label:a,data:t,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{innerClass:t.color}),e.jsx("span",{children:a})]}),o&&e.jsx(Be,{className:"text-emerald-500 text-xl"})]}),va=({children:s,...a})=>{const t=a.getValue()[0];return e.jsxs(wa,{...a,children:[t&&e.jsx(Y,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),s]})},Da=()=>{const s=w(),{status:a}=h(o=>o.crmLeads.data.filterData),t=o=>{s(ee({status:o==null?void 0:o.value}))};return e.jsx(We,{options:_,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:ya,Control:va},value:_.filter(o=>o.value===a),onChange:t})},Na=()=>{const s=w(),a=d.useRef(null),t=h(c=>c.crmLeads.data.tableData),o=c=>{const x=A(t);x.query=c,x.pageIndex=1,typeof c=="string"&&c.length>1&&r(x),typeof c=="string"&&c.length===0&&r(x)},r=c=>{s(O(c)),s(N())},i=()=>{const c=A(t);c.query="",a.current&&(a.current.value=""),s(ee({status:""})),r(c)},l=()=>{s(te())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(re,{ref:a,onInputChange:o}),e.jsx(Da,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(E,{size:"sm",className:"me-2",onClick:i,children:"Clear All"}),e.jsx(E,{size:"sm",onClick:l,children:"Add New"})]})]})},V=s=>{const{icon:a,avatarClass:t,label:o,value:r,loading:i}=s,l=55;return e.jsx(Ye,{bordered:!0,children:e.jsx(ue,{loading:i,customLoader:e.jsx(Ze,{avatarProps:{className:"rounded",width:l,height:l}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(X,{className:t,size:l,icon:a}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(ea,{thousandSeparator:!0,displayType:"text",value:r})})]})]})})})})},Sa=()=>{const s=w(),a=h(o=>o.crmLeads.data.statisticData);console.log(a.totalLeads,"Araha Hai Bhai");const t=h(o=>o.crmLeads.data.statisticLoading);return d.useEffect(()=>{s(H())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(V,{icon:e.jsx(ze,{}),avatarClass:"!bg-indigo-600",label:"Total Leads",value:a.totalLeads,growthRate:a==null?void 0:a.totalLeads,loading:t}),e.jsx(V,{icon:e.jsx(Ue,{}),avatarClass:"!bg-blue-500",label:"Active Leads",value:a.activeLeads,growthRate:a.activeLeads,loading:t}),e.jsx(V,{icon:e.jsx(Ve,{}),avatarClass:"!bg-emerald-500",label:"New Leads",value:a==null?void 0:a.newLeads,growthRate:a==null?void 0:a.newLeads,loading:t})]})};xe("crmLeads",ma);const ka=()=>e.jsxs(e.Fragment,{children:[e.jsx(Sa,{}),e.jsxs(ge,{bodyClass:"h-full",children:[e.jsx(Na,{}),e.jsx(ba,{})]})]}),ts=ka;export{ts as default};
