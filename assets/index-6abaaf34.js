import{am as I,an as te,ao as ie,ap as se,r as f,j as e,a as C,aq as oe,ah as ne}from"./index-dd430329.js";import{b as re,c as le,d as ce,a as me}from"./SuperAdminServices-54788ba0.js";import{B as R}from"./Button-477f78d2.js";import{c as S}from"./cloneDeep-7dd50aa7.js";import{I as x}from"./Input-2ae5f21f.js";import{b as de,N as pe,O as ge}from"./index.esm-8a75a52d.js";import{d as ue}from"./debounce-ea0d38a8.js";import{D as xe}from"./DataTable-b28d1e98.js";import"./Alert-40c008c9.js";import"./index-1bec26b5.js";import"./Badge-81ec6aad.js";import"./RangeCalendar-c7dd44b3.js";import"./Card-7303f1d6.js";import{C as fe}from"./index-4953df19.js";import"./index-e8664bdc.js";import"./Dialog-4e683d85.js";import{D as he}from"./Drawer-851dfb0e.js";import"./index-273b73f2.js";import{F as be,a as b}from"./FormItem-c5d9f12d.js";import"./toString-45c45754.js";import"./index-ad4d109a.js";import"./index-1e6ea035.js";import"./index-5ad45768.js";import{t as P,N as B}from"./toast-7520b143.js";import"./Pagination-a183170a.js";import"./Progress-65bff4d5.js";import"./index-9685374c.js";import"./ScrollBar-efe95462.js";import"./index-a7fee107.js";import"./Select-a638e837.js";import"./Skeleton-0435d2db.js";import"./index-0bd5fcc8.js";import"./Switcher-46a64a8e.js";import"./index-03531cf7.js";import"./index-f4b545fd.js";import"./Tag-a01d1848.js";import"./index-c88fea13.js";import"./index-f57ef06e.js";import{T as ye}from"./Tooltip-4f6c910c.js";import"./Upload-79efa750.js";import{u as je}from"./useThemeClass-c67d9527.js";import{F as ze,a as Ce,b as y}from"./formik.esm-97667c88.js";import{c as Ne}from"./index.esm-9e83db4a.js";import{c as Oe,a as q,d as we}from"./index.esm-27140c16.js";import{b as De}from"./index.esm-2c41f11e.js";import{T as Se}from"./index.esm-a9ffcd74.js";import{a as ve}from"./index.esm-2e0dcea3.js";import{a as Ae}from"./index.esm-cdf5a269.js";import{A as Ie}from"./AdaptableCard-aab5007a.js";import"./Views-969b82ff.js";import"./chart.constant-b89d4d9a.js";import"./GrowShrinkTag-7614f549.js";import"./react-tooltip.min-90b0da4a.js";import"./RichTextEditor-ab8d719f.js";import"./SegmentItemOption-4eb9f4d2.js";import"./SvgIcon-0e5d590b.js";import{F as Ee}from"./FormDesription-400d98a5.js";import"./_MapCache-787d0444.js";import"./_getPrototype-a234e5e0.js";import"./isNil-ba5dd027.js";import"./get-f4ce3646.js";import"./index-387d3e60.js";import"./useTimeout-8cc7d1d0.js";import"./CloseButton-be129446.js";import"./StatusIcon-1c9455ce.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-3d893585.js";import"./_baseIsEqual-da2ece8d.js";import"./useRootClose-c59d452a.js";import"./usePopper-ad874619.js";import"./TimeInput-d81057f6.js";import"./useUniqueId-abd97dae.js";import"./useDidUpdate-0f1ffc2f.js";import"./index-ab79e894.js";import"./useUncertainRef-b3ab91cc.js";import"./index-59261ffa.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-2ef3e469.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-7a029c07.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-c4c40043.js";import"./index.esm-075cf0f7.js";import"./index.esm-7dc546a5.js";const Te="superOrganizations",j=I("superOrganizations/data/getOrganizations",async()=>(await re()).data),H=I("superOrganizations/data/editOrganization",async({organizationId:t,updatedData:a})=>{var o,n;try{return(await le(t,a)).data}catch(i){throw new Error((n=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:n.message)}});I("superOrganizations/data/deleteOrganization",async t=>{var a,o;try{return await ce(t)}catch(n){throw new Error((o=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:o.message)}});const Me=I("superOrganizations/data/createOrganization",async t=>{var a,o;try{return(await me(t)).data}catch(n){throw new Error((o=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:o.message)}}),Fe={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},qe={organizationData:[],loading:!1,isDialogOpen:!1,selectedOrganization:{},deleteConfirmation:!1,dialogMode:"Add",tableData:Fe,displayedOrganizationsList:[]},Z=te({name:`${Te}/state`,initialState:qe,reducers:{setTableData:(t,a)=>{var n;t.tableData=a.payload;const o=(n=t.organizationData)==null?void 0:n.filter(i=>i.organizationName.toLowerCase().includes(a.payload.query.toLowerCase()));t.displayedOrganizationsList=o.slice(a.payload.pageSize*(a.payload.pageIndex-1),a.payload.pageSize*a.payload.pageIndex)},setSelectedOrganization:(t,a)=>{t.selectedOrganization=a.payload},setDialogToggle:(t,a)=>{t.isDialogOpen=a.payload},toggleDeleteConfirmation:(t,a)=>{t.deleteConfirmation=a.payload},setDialogMode:(t,a)=>{t.dialogMode=a.payload}},extraReducers:t=>{t.addCase(j.fulfilled,(a,o)=>{var n,i,m,s,c,p,d,u;a.organizationData=o.payload.data,a.tableData.total=(i=(n=o.payload)==null?void 0:n.data)==null?void 0:i.length,a.displayedOrganizationsList=(u=(m=o.payload)==null?void 0:m.data)==null?void 0:u.slice(((s=a==null?void 0:a.tableData)==null?void 0:s.pageSize)*(((c=a==null?void 0:a.tableData)==null?void 0:c.pageIndex)-1),((p=a==null?void 0:a.tableData)==null?void 0:p.pageSize)*((d=a==null?void 0:a.tableData)==null?void 0:d.pageIndex)),a.loading=!1}).addCase(j.pending,a=>{a.loading=!0})}}),{setDialogToggle:A,setDialogMode:_,setSelectedOrganization:W,toggleDeleteConfirmation:jt,setTableData:v}=Z.actions,Re=Z.reducer,ke=ie({data:Re}),h=se,G=f.forwardRef((t,a)=>{const{onInputChange:o}=t,n=ue(i,500);function i(s){o==null||o(s)}const m=s=>{n(s.target.value)};return e.jsx(x,{ref:a,className:"max-w-lg md:w-52 mb-4",size:"md",placeholder:"Search by organization name",prefix:e.jsx(de,{className:"text-lg"}),onChange:m})});G.displayName="OrganizationTableSearch";const Le=()=>{const t=C(),a=f.useRef(null),o=h(m=>m.superOrganizations.data.tableData),n=m=>{const s=S(o);s.query=m,s.pageIndex=1,typeof m=="string"&&m.length>1&&i(s),typeof m=="string"&&m.length===0&&i(s)},i=m=>{t(m?v(m):j())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(G,{ref:a,onInputChange:n})}),e.jsx("div",{className:"mb-4",children:e.jsx(R,{size:"sm",onClick:()=>{t(A(!0)),t(_("Add"))},children:"Add New"})})]})},$e=Oe().shape({organizationName:q().required("Organization Name Required"),industry:q().required("Industry Required"),contact:we().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",t=>!isNaN(t)).test("is-ten-digits"," Contact must be exactly 10 digits",t=>{if(t){const a=Number(t);return/^\d{10}$/.test(a.toString())}return!0}).test("is-not-more-than-ten-digits","Contact must not exceed 10 digits",t=>t?Number(t).toString().length<=10:!0),email:q().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required")}),U=f.forwardRef((t,a)=>{const o=C(),n=h(s=>s.superOrganizations.data.dialogMode),i=h(s=>s.superOrganizations.data.selectedOrganization),m=async(s,c,p)=>{var O,w,D;console.log({actionType:s,values:c,selectedOrganization:p});const d=await o(s==="Add"?Me(c):H({organizationId:p==null?void 0:p.id,updatedData:c}));let u="",z="",N="danger";(O=d==null?void 0:d.payload)!=null&&O.success?(u="Successfully Added",z=(w=d==null?void 0:d.payload)==null?void 0:w.message,N="success"):(u="Something went wrong !!!",z=(D=d==null?void 0:d.error)==null?void 0:D.message),P.push(e.jsx(B,{title:u,type:N,duration:2500,children:z}),{placement:"top-end"}),o(A(!1)),o(j())};return e.jsx(ze,{innerRef:a,initialValues:{organizationName:(i==null?void 0:i.organizationName)||"",industry:(i==null?void 0:i.industry)||"",contact:(i==null?void 0:i.contact)||null,website:(i==null?void 0:i.website)||"",numberOfEmployees:(i==null?void 0:i.numberOfEmployees)||0,notes:(i==null?void 0:i.notes)||"",email:(i==null?void 0:i.email)||""},validationSchema:$e,onSubmit:async(s,{setSubmitting:c})=>{n==="Add"?await m("Add",s,null):await m("Edit",s,i),c(!1)},children:({touched:s,errors:c,values:p,setFieldValue:d})=>e.jsx(Ce,{children:e.jsx(be,{children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 ",children:e.jsxs("div",{className:"lg:col-span-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(b,{label:"Organization Name*",invalid:c.organizationName&&s.organizationName,errorMessage:c.organizationName,children:e.jsx(y,{type:"text",autoComplete:"off",name:"organizationName",placeholder:"Organization Name",component:x,prefix:e.jsx(ve,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(b,{label:"Industry*",invalid:c.industry&&s.industry,errorMessage:c.industry,children:e.jsx(y,{type:"text",autoComplete:"off",name:"industry",value:p.industry,placeholder:"Organization Industry",component:x,prefix:e.jsx(Ae,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(b,{label:"Contact*",invalid:c.contact&&s.contact,errorMessage:c.contact,children:e.jsx(y,{type:"number",autoComplete:"off",name:"contact",placeholder:"Contact",component:x,prefix:e.jsx(Se,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(b,{label:"Email*",invalid:c.email&&s.email,errorMessage:c.email,children:e.jsx(y,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:x,prefix:e.jsx(pe,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(b,{label:"Website",invalid:c.website&&s.website,errorMessage:c.website,children:e.jsx(y,{type:"text",autoComplete:"off",name:"website",placeholder:"Website",component:x,prefix:e.jsx(De,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(b,{label:"Number Of Employees",invalid:c.numberOfEmployees&&s.numberOfEmployees,errorMessage:c.numberOfEmployees,children:e.jsx(y,{type:"number",autoComplete:"off",name:"numberOfEmployees",placeholder:"Number Of Employees",component:x,prefix:e.jsx(Ne,{className:"text-xl"})})})})]}),e.jsx(b,{label:"Description",labelClass:"!justify-start",invalid:c.notes&&s.notes,errorMessage:c.notes,children:e.jsx(y,{textArea:!0,type:"text",autoComplete:"off",name:"notes",placeholder:"Description",component:x})})]})})})})})});U.displayName="OrganizationForm";const Ke=({onSaveClick:t,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(R,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(R,{size:"sm",variant:"solid",onClick:t,children:"Save"})]}),Ve=()=>{const t=C(),a=h(l=>l.superOrganizations.data.loading),{pageIndex:o,pageSize:n,sort:i,query:m,total:s}=h(l=>l.superOrganizations.data.tableData),c=h(l=>l.superOrganizations.data.displayedOrganizationsList),p=({row:l})=>{const r=C(),{textTheme:Q}=je();let T=(l==null?void 0:l.isActive)||!1;const X=()=>{r(W(l)),r(A(!0)),r(_("Edit"))},Y=async ee=>{var $,K,V;T=!T;const ae={organizationId:l==null?void 0:l.id,updatedData:{isActive:ee}},g=await r(H(ae));let M="",F="",L="danger";($=g==null?void 0:g.payload)!=null&&$.success?(M="Successfully Added",F=(K=g==null?void 0:g.payload)==null?void 0:K.message,L="success"):(M="Something went wrong !!!",F=(V=g==null?void 0:g.error)==null?void 0:V.message),P.push(e.jsx(B,{title:M,type:L,duration:2500,children:F}),{placement:"top-end"}),await r(j())};return e.jsxs("div",{className:"flex text-base items-center",children:[e.jsx("span",{className:`cursor-pointer hover:${Q} circle items-center`,onClick:X,children:e.jsx(ge,{})}),e.jsx("span",{className:"cursor-pointer mx-2 text-2xl",children:e.jsx(ye,{title:"Active Or InActive Organization",children:e.jsx(fe,{checked:T,onChange:Y})},l.email)})]})},d=f.useMemo(()=>({pageIndex:o,pageSize:n,sort:i,query:m,total:s}),[o,n,i,m,s]),u=f.useMemo(()=>[{header:"Action",id:"action",cell:r=>e.jsx(p,{row:r.row.original})},{header:"Organization Name",accessorKey:"organizationName",cell:r=>r.row.original.organizationName},{header:"email",accessorKey:"email",cell:r=>r.row.original.email},{header:"contact",accessorKey:"contact",cell:r=>r.row.original.contact},{header:"industry",accessorKey:"industry",cell:r=>r.row.original.industry},{header:"website",accessorKey:"website",cell:r=>r.row.original.website}],[]),z=l=>{const r=S(d);r.pageIndex=l,t(v(r))},N=l=>{const r=S(d);r.pageSize=Number(l),r.pageIndex=1,t(v(r))},O=l=>{const r=S(d);r.sort=l,t(v(r))},w=h(l=>l.superOrganizations.data.isDialogOpen),[D,Pe]=f.useState(window.innerWidth/2),E=()=>{t(A(!1)),t(W({}))},k=f.useRef(null),J=()=>{var l;(l=k.current)==null||l.submitForm()};return e.jsxs("div",{children:[e.jsx(xe,{columns:u,data:c,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:a,pagingData:{total:d.total,pageIndex:d.pageIndex,pageSize:d.pageSize},onPaginationChange:z,onSelectChange:N,onSort:O}),e.jsx(he,{isOpen:w,closable:!1,bodyClass:"p-0",width:D,footer:e.jsx(Ke,{onCancel:E,onSaveClick:J}),onClose:E,onRequestClose:E,children:e.jsxs("div",{className:"m-4",children:[e.jsx("h5",{children:"Organizations"}),e.jsx("p",{className:"mb-6",children:"Section to config the organizations attribute"}),e.jsx(U,{ref:k})]})})]})};oe("superOrganizations",ke);const We=()=>{const t=C(),a=h(o=>{o.superOrganizations.data.loading});return f.useEffect(()=>{t(j())},[t]),e.jsx(e.Fragment,{children:e.jsxs(Ie,{bodyClass:"h-full",children:[e.jsx(Ee,{title:"Organizations",desc:"",className:"mb-2"}),e.jsx(Le,{}),e.jsx(ne,{loading:a,children:e.jsx(Ve,{})})]})})},zt=We;export{zt as default};
