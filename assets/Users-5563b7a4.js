import{a as y,j as e,r as h,p as ee,aq as te}from"./index-01b42c77.js";import{D as ae}from"./DataTable-2544ad05.js";import"./Alert-ba84ad42.js";import"./index-b609fa7a.js";import"./Badge-6cc907e6.js";import{B as O}from"./Button-a5544b15.js";import"./RangeCalendar-7e850f6c.js";import"./Card-039a9ed6.js";import"./index-dab07eaf.js";import"./index-a9a60eee.js";import"./Dialog-b7c1600d.js";import{D as se}from"./Drawer-a351bd90.js";import"./index-71de6292.js";import{a as N,F as re}from"./FormItem-4a386e6f.js";import"./toString-228d794c.js";import{I}from"./Input-b0748b3e.js";import"./index-2bfb9d4e.js";import"./index-ca28e0d9.js";import"./index-a6a0da8c.js";import{t as R,N as z}from"./toast-9d39500f.js";import"./Pagination-d57e7c83.js";import"./Progress-613f4d7f.js";import"./index-8ad179bb.js";import"./ScrollBar-349c0130.js";import"./index-92468997.js";import{f as A}from"./Select-2cf95561.js";import"./Skeleton-cf28f7d5.js";import"./index-b9cef8bb.js";import"./Switcher-cf39306f.js";import"./index-f7318691.js";import{T as Z}from"./index-0fe1020b.js";import{T as H}from"./Tag-989e3abd.js";import"./index-8359d520.js";import"./index-3b362267.js";import"./Tooltip-06c83e8f.js";import"./Upload-b982e753.js";import{u as L}from"./checkEditUpdate-27f908f6.js";import{u as oe}from"./useThemeClass-42da9995.js";import{c as U}from"./cloneDeep-29f2aae8.js";import{Q as Y,O as ie,P as ne,b as le}from"./index.esm-587e89d5.js";import{u as p,t as P,d as ce,g as $,p as _,a as me,s as B,b as de,e as K,f as F,h as W,i as G,r as pe}from"./index-99289558.js";import{C as ue}from"./ConfirmDialog-a691c410.js";import{i as he}from"./Views-0a1f8861.js";import{b as D,F as fe,a as xe}from"./formik.esm-a8cc53a4.js";import{c as ge,a as C}from"./index.esm-d51743a0.js";/* empty css              */import{t as be}from"./index.esm-b7456581.js";import{n as je}from"./index.esm-afe81195.js";import{d as Ne}from"./debounce-9cff76d4.js";import"./index-ffd8f14d.js";import"./useTimeout-459c0c98.js";import"./CloseButton-f0093569.js";import"./StatusIcon-f4c9b6a3.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-6df01025.js";import"./_baseIsEqual-e4dc226f.js";import"./_MapCache-466adbaa.js";import"./get-4bda1c07.js";import"./useRootClose-25e3e193.js";import"./usePopper-f47dd5aa.js";import"./TimeInput-1e7df44b.js";import"./useUniqueId-3c39e5d6.js";import"./useDidUpdate-172f95a0.js";import"./index-07bde89e.js";import"./useUncertainRef-9e1ddaf5.js";import"./isNil-93830b79.js";import"./index-5bdc2e1d.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-0eb2b673.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-f54b4040.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-830eb65c.js";import"./index.esm-30f67dfd.js";import"./index.esm-68702517.js";import"./moment-fbc5633a.js";import"./_getPrototype-583e3aad.js";import"./CrmService-fb54ad5b.js";const Ce=()=>{const r=y(),l=p(s=>s.crmUsers.data.deleteConfirmation),a=p(s=>s.crmUsers.data.selectedUser),o=()=>{r(P(!1))},n=async()=>{var c,t,d;r(P(!1));const s=await r(ce(a.id));(c=s==null?void 0:s.payload)!=null&&c.success?R.push(e.jsx(z,{title:"Successfuly Deleted",type:"success",duration:2500,children:(t=s==null?void 0:s.payload)==null?void 0:t.message}),{placement:"top-end"}):R.push(e.jsx(z,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(d=s==null?void 0:s.error)==null?void 0:d.message}),{placement:"top-end"}),await r($())};return e.jsx(ue,{isOpen:l,type:"danger",title:"Delete User",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:n,children:e.jsx("p",{children:"Are you sure you want to delete this user? All record related to this user will be deleted as well. This action cannot be undone."})})},S=[],V=[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"Others",value:"other"}],we=r=>{const{touched:l,errors:a,setFieldValue:o,values:n}=r,s=p(t=>t.crmUsers.data.rolesList);S.length=0,s.forEach(t=>{S.push({label:t.roleName,value:t.id})});const c=[{label:"active",value:"active"},{label:"inactive",value:"inactive"}];return e.jsxs(e.Fragment,{children:[e.jsx(N,{label:"First Name",invalid:a.firstName&&l.firstName,errorMessage:a.firstName,children:e.jsx(D,{type:"text",autoComplete:"off",name:"firstName",component:I,prefix:e.jsx(Y,{className:"text-xl"})})}),e.jsx(N,{label:"Last Name",invalid:a.lastName&&l.lastName,errorMessage:a.lastName,children:e.jsx(D,{type:"text",autoComplete:"off",name:"lastName",component:I,prefix:e.jsx(Y,{className:"text-xl"})})}),e.jsx(N,{label:"Email",invalid:a.email&&l.email,errorMessage:a.email,children:e.jsx(D,{type:"text",autoComplete:"off",name:"email",component:I,prefix:e.jsx(je,{className:"text-xl"})})}),e.jsx(N,{label:"Phone",invalid:a.phone&&l.phone,errorMessage:a.phone,children:e.jsx(D,{type:"text",autoComplete:"off",name:"phone",component:I,prefix:e.jsx(be,{className:"text-xl"})})}),e.jsx(N,{label:"Gender",invalid:a.gender&&l.gender,errorMessage:a.gender,children:e.jsx(D,{name:"gender",children:()=>e.jsx(A,{id:"gender",options:V,value:V.filter(t=>(t==null?void 0:t.value)===(n==null?void 0:n.gender)),onChange:t=>{o("gender",t.value||"")}})})}),e.jsx(N,{label:"Role",invalid:a.roleId&&l.roleId,errorMessage:a.roleId,children:e.jsx(A,{name:"roleId",id:"roleId",value:S.find(t=>(t==null?void 0:t.value)===(n==null?void 0:n.roleId)),options:S,onChange:t=>{o("roleId",t.value||"")}})}),e.jsx(N,{label:"Status",invalid:a.status&&l.status,errorMessage:a.status,children:e.jsx(A,{name:"status",id:"status",value:c.find(t=>(t==null?void 0:t.value)===(n==null?void 0:n.status)),options:c,onChange:t=>{o("status",t.value||"")}})})]})},ve=ge().shape({firstName:C().required("First name is required"),lastName:C().required("Last name is required"),email:C().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),phone:C().matches(/^\d{10}$/,"Phone number must be 10 digits").required("Phone is required"),gender:C().required("Please enter your gender"),status:C().required("Status is required").oneOf(["active","inactive"]),roleId:C().required("Role is required")}),{TabNav:ye,TabList:De,TabContent:Ie}=Z,Q=h.forwardRef((r,l)=>{const a=p(s=>s.crmUsers.data.selectedUser),o=p(s=>s.crmUsers.data.drawerMode),n=y();return e.jsx(fe,{innerRef:l,initialValues:{firstName:o==="Edit"&&(a==null?void 0:a.firstName)||"",lastName:o==="Edit"&&(a==null?void 0:a.lastName)||"",email:o==="Edit"&&(a==null?void 0:a.email)||"",phone:o==="Edit"&&(a==null?void 0:a.phone)||"",gender:o==="Edit"&&(a==null?void 0:a.gender)||"",status:o==="Add"?"inactive":(a==null?void 0:a.status)||"",roleId:o==="Edit"&&(a==null?void 0:a.roleId)||""},validationSchema:ve,onSubmit:async(s,{setSubmitting:c})=>{var f,x,g,u;const t=o==="Edit"?await n(_({id:a.id,data:s})):await n(me(s)),d=(f=t==null?void 0:t.payload)!=null&&f.success?"Successfully Updated":"Something went wrong !!!";R.push(e.jsx(z,{title:d,type:(x=t==null?void 0:t.payload)!=null&&x.success?"success":"danger",duration:2500,children:((g=t==null?void 0:t.payload)==null?void 0:g.message)||((u=t==null?void 0:t.error)==null?void 0:u.message)}),{placement:"top-end"}),n(B()),await n($()),c(!1)},children:({touched:s,errors:c,setFieldValue:t,values:d})=>e.jsx(xe,{children:e.jsx(re,{children:e.jsxs(Z,{defaultValue:"usersInfo",children:[e.jsx(De,{children:e.jsx(ye,{value:"usersInfo",children:"Users Info"})}),e.jsx("div",{className:"p-6",children:e.jsx(Ie,{value:"usersInfo",children:e.jsx(we,{touched:s,errors:c,setFieldValue:t,values:d})})})]})})})})});Q.displayName="UsersForm";const J=h.forwardRef((r,l)=>{const a=y(),o=p(t=>t.crmUsers.data.selectedUser),n=p(t=>t.crmUsers.data.usersList),{id:s}=o,c=t=>{const{name:d,birthday:f,email:x,img:g,location:u,title:E,phoneNumber:T,facebook:M,twitter:k,pinterest:q,linkedIn:m}=t,i={name:d,email:x,img:g},w={location:u,title:E,birthday:ee(f).format("DD/MM/YYYY"),phoneNumber:T,facebook:M,twitter:k,pinterest:q,linkedIn:m};let v=U(n),b={};v=v.map(j=>(j.id===s&&(j={...j,...i},j.personalInfo={...j.personalInfo,...w},b=j),j)),he(b)||a(_(b)),a(B()),a(de(v))};return e.jsx(Q,{ref:l,users:o,onFormSubmit:c})});J.displayName="UsersEditContent";const Ue=({onSaveClick:r,onCancel:l})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(O,{size:"sm",className:"mr-2",onClick:l,children:"Cancel"}),e.jsx(O,{size:"sm",variant:"solid",onClick:r,children:"Save"})]}),Se=()=>{const r=y(),l=p(s=>s.crmUsers.data.drawerOpen),a=()=>{r(B()),r(K({}))},o=h.useRef(null),n=async()=>{var s,c;(s=o.current)==null||s.values,(c=o.current)==null||c.submitForm()};return e.jsx(se,{isOpen:l,closable:!1,bodyClass:"p-0",footer:e.jsx(Ue,{onCancel:a,onSaveClick:n}),onClose:a,onRequestClose:a,children:e.jsx(J,{ref:o})})},Fe=({status:r})=>{switch(r){case"active":return e.jsx(H,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100  border-0 rounded",children:"Active"});case"inactive":return e.jsx(H,{className:"text-amber-600 bg-amber-100 dark:text-amber-100 dark:bg-amber-500/20  border-0 rounded",children:"Inactive"});default:return e.jsx(e.Fragment,{})}},Ee=()=>{const r=y(),l=p(m=>m.crmUsers.data.displayedUsersList),a=p(m=>m.crmUsers.data.loading),o=p(m=>m.crmUsers.data.rolesList),n=L("users","canModify"),s=L("users","canDelete"),{pageIndex:c,pageSize:t,sort:d,query:f,total:x}=p(m=>m.crmUsers.data.tableData),g=h.useCallback(()=>{r($())},[r]);h.useEffect(()=>{g()},[g]);const u=h.useMemo(()=>({pageIndex:c,pageSize:t,sort:d,query:f,total:x}),[c,t,d,f,x]),E=({row:m})=>{oe();const i=()=>{r(W()),r(K(m)),r(G("Edit"))},w=async()=>{await r(K(m)),r(P(!0))};return e.jsxs("div",{className:"flex text-base items-center",children:[n&&e.jsx("button",{className:"circle items-center  cursor-pointer hover:text-indigo-500",onClick:i,children:e.jsx(ie,{})}),s&&e.jsx("span",{className:"cursor-pointer hover:text-red-500 mx-1 circle items-center",onClick:w,children:e.jsx(ne,{})})]})},T=h.useMemo(()=>[{header:"Action",id:"action",cell:i=>e.jsx(E,{row:i.row.original})},{header:"First Name",accessorKey:"firstName",cell:i=>i.row.original.firstName},{header:"Last Name",accessorKey:"lastName",cell:i=>i.row.original.lastName},{header:"Role",accessorKey:"role",cell:i=>{var v;return((v=o==null?void 0:o.find(b=>(b==null?void 0:b.id)===(i==null?void 0:i.row.original.roleId)))==null?void 0:v.roleName)||"-"}},{header:"Email",accessorKey:"email",cell:i=>i.row.original.email},{header:"Phone",accessorKey:"phone",cell:i=>i.row.original.phone},{header:"Status",accessorKey:"status",cell:i=>{const w=i.row.original;return e.jsx(Fe,{status:w.status})}}],[n,s,o]),M=m=>{const i=U(u);i.pageIndex=m,r(F(i))},k=m=>{const i=U(u);i.pageSize=Number(m),i.pageIndex=1,r(F(i))},q=m=>{const i=U(u);i.sort=m,r(F(i))};return e.jsxs("div",{children:[e.jsx(ae,{columns:T,data:l,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:a,pagingData:{total:u.total,pageIndex:u.pageIndex,pageSize:u.pageSize},onPaginationChange:M,onSelectChange:k,onSort:q}),e.jsx(Se,{}),e.jsx(Ce,{})]})},X=h.forwardRef((r,l)=>{const{onInputChange:a}=r,o=Ne(n,500);function n(c){a==null||a(c)}const s=c=>{o(c.target.value)};return e.jsx(I,{ref:l,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(le,{className:"text-lg"}),onChange:s})});X.displayName="UsersTableSearch";const Te=()=>{const r=y(),l=h.useRef(null),a=p(t=>t.crmUsers.data.tableData),o=L("users","canCreate"),n=t=>{const d=U(a);d.query=t,d.pageIndex=1,typeof t=="string"&&t.length>1&&s(d),typeof t=="string"&&t.length===0&&s(d)},s=t=>{r(F(t))},c=()=>{r(W()),r(G("ADD"))};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(X,{ref:l,onInputChange:n})}),e.jsx("div",{className:"mb-4",children:o&&e.jsx(O,{size:"sm",onClick:c,children:"Add New"})})]})};te("crmUsers",pe);const aa=()=>e.jsxs(e.Fragment,{children:[e.jsx(Te,{}),e.jsx(Ee,{})]});export{aa as default};
