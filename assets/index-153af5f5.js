import{a as M,r as b,j as e,ah as we,al as Se,aq as ve}from"./index-f0c7b593.js";import{A as Ie}from"./AdaptableCard-af2a9d2e.js";import{F as ne}from"./FormDesription-d6834b2f.js";import{C as Te}from"./Card-d2bb7bb1.js";import{A as Ee}from"./index-e46ae74f.js";import{M as Ae}from"./MediaSkeleton-3f77a65b.js";import{u as C,g as ae,t as te,d as Fe,a as q,b as ke,c as Me,f as ie,e as ce,h as se,i as Re,s as de,j as W,k as Z,l as Oe,m as P,n as Ve,o as le,r as $e}from"./index-23540ecb.js";import{o as qe,M as ze,C as Be,N as _e,O as We,P as Pe,b as He}from"./index.esm-e5bc54ff.js";import{N as Ke}from"./react-number-format.es-558e8b89.js";import{D as Ue}from"./DataTable-b0d71643.js";import{T as Ge}from"./TagsList-b3e5bee2.js";import{T as H}from"./TextTruncate-a320edf5.js";import{u as X}from"./checkEditUpdate-a8d8ed64.js";import{u as Je}from"./useThemeClass-a90261c9.js";import{c as Y}from"./cloneDeep-a7f8bdaf.js";import{t as U,N as G}from"./toast-98ab077b.js";import{C as Qe}from"./ConfirmDialog-a2f5c181.js";import{B as J}from"./Button-7f5aeb19.js";import{D as Xe}from"./Drawer-3213f845.js";import{a as V,F as me}from"./FormItem-39c4f499.js";import{T as ue}from"./index-0fbd5995.js";import{u as Ye,b as $,F as pe,a as ge}from"./formik.esm-251b655f.js";import{c as he,a as _,d as Ze,e as et}from"./index.esm-36ab1692.js";import{I as O}from"./Input-b0936f40.js";/* empty css              */import"./Alert-6365923a.js";import"./Badge-eb9394bd.js";import"./RangeCalendar-4446a681.js";import"./index-3454c4af.js";import"./index-7fb568e6.js";import{D as tt}from"./Dialog-863f25dc.js";import"./index-096ca5d8.js";import"./toString-15315b0c.js";import"./index-cae4e5da.js";import"./index-cd4a639d.js";import"./index-e9f2e738.js";import"./Pagination-4451079e.js";import"./Progress-c215b6a7.js";import"./index-aa5943b4.js";import"./ScrollBar-af66e651.js";import"./index-2d35600c.js";import{S as at}from"./Select-20b819a9.js";import"./Skeleton-3fb87948.js";import"./index-681acbb6.js";import"./Switcher-52adaf57.js";import"./index-b0e56b87.js";import{T as st}from"./Tag-c0e1c031.js";import"./index-11547d1a.js";import"./index-ff0fc04f.js";import{T as Q}from"./Tooltip-c002e367.js";import"./Upload-652ef9c2.js";import{B as rt,a as ot}from"./index.esm-6eb7bfab.js";import{M as nt}from"./index.esm-6d11550f.js";import{T as it,a as ct}from"./index.esm-648d214b.js";import{B as oe}from"./index.esm-b8b882c0.js";import{u as dt}from"./useGetModule-0613f8e4.js";import{D as lt}from"./DynamicDropDown-021caa73.js";import{A as mt,a as ut}from"./index.esm-08433e05.js";import"./Views-f075be69.js";import"./chart.constant-02b58366.js";import"./GrowShrinkTag-527a2d3f.js";import"./react-tooltip.min-71b0b431.js";import"./RichTextEditor-5416da31.js";import"./SegmentItemOption-59370a59.js";import{S as pt}from"./StickyFooter-e5abd172.js";import"./SvgIcon-586bfa82.js";import{S as gt}from"./Status-a803e133.js";import{s as ht}from"./index-4b96ad31.js";import{d as xt}from"./debounce-cfdc19d0.js";import"./useMergeRef-788c4cb0.js";import"./CrmService-dbe6e33f.js";import"./index-d3141ad9.js";import"./moment-fbc5633a.js";import"./_MapCache-0e9047d5.js";import"./_getPrototype-0af54c7c.js";import"./useTimeout-dc84f5ca.js";import"./CloseButton-0049a26a.js";import"./StatusIcon-ee78f8c3.js";import"./chainedFunction-070f832c.js";import"./index-3b8a3b80.js";import"./index-18282a3b.js";import"./useControllableState-2e915fdc.js";import"./isNil-f2b7492f.js";import"./get-f1462f52.js";import"./_baseIsEqual-cd068756.js";import"./useRootClose-30d78bea.js";import"./usePopper-a15905d1.js";import"./TimeInput-3420c0cd.js";import"./useUniqueId-b4c9cc1b.js";import"./useDidUpdate-99adc2ba.js";import"./useUncertainRef-d24e847b.js";import"./slicedToArray-4d193841.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-4b0cd007.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-4930eeca.js";import"./index.esm-7aedf532.js";import"./index.esm-cdcdcd5a.js";import"./index-fc80bde3.js";import"./index.esm-e9a42a23.js";import"./index-ce046e2b.js";const ee=a=>{const{icon:o,avatarClass:t,label:h,value:p,loading:c}=a,l=55;return e.jsx(Te,{bordered:!0,children:e.jsx(we,{loading:c,customLoader:e.jsx(Ae,{avatarProps:{className:"rounded",width:l,height:l}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ee,{className:t,size:l,icon:o}),e.jsxs("div",{children:[e.jsx("span",{children:h}),e.jsx("h3",{children:e.jsx(Ke,{thousandSeparator:!0,displayType:"text",value:p})})]})]})})})})},ft=()=>{const a=M(),o=C(h=>h.crmLeads.data.statisticData),t=C(h=>h.crmLeads.data.statisticLoading);return b.useEffect(()=>{a(ae())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(ee,{icon:e.jsx(qe,{}),avatarClass:"!bg-indigo-600",label:"Total Leads",value:o.totalLeads,growthRate:o==null?void 0:o.totalLeads,loading:t}),e.jsx(ee,{icon:e.jsx(ze,{}),avatarClass:"!bg-blue-500",label:"Open Leads",value:o.openLeads,growthRate:o.openLeads,loading:t}),e.jsx(ee,{icon:e.jsx(Be,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Leads",value:o==null?void 0:o.newLeads,growthRate:o==null?void 0:o.newLeads,loading:t})]})},jt=()=>{const a=M(),o=C(c=>c.crmLeads.data.deleteConfirmation),t=C(c=>c.crmLeads.data.selectedLeads),h=()=>{a(te(!1))},p=async()=>{var l,u,f;a(te(!1));const c=await a(Fe(t.id));await a(q()),(l=c==null?void 0:c.payload)!=null&&l.success?U.push(e.jsx(G,{title:"Successfuly Deleted",type:"success",duration:2500,children:(u=c==null?void 0:c.payload)==null?void 0:u.message}),{placement:"top-end"}):U.push(e.jsx(G,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(f=c==null?void 0:c.error)==null?void 0:f.message}),{placement:"top-end"}),await a(q()),await a(ae())};return e.jsx(Qe,{isOpen:o,type:"danger",title:"Delete Lead",confirmButtonColor:"red-600",onClose:h,onRequestClose:h,onCancel:h,onConfirm:p,children:e.jsx("p",{children:"Are you sure you want to delete this Lead? All record related to this lead will be deleted as well. This action cannot be undone."})})},K=[],bt=a=>{const{touched:o,errors:t,setFieldValue:h,values:p}=a,c=M(),l=Ye(),[u,f]=b.useState(null),[T,S]=b.useState([]),[A,k]=b.useState(!1),r=C(s=>s.crmLeads.data.contactList);K.length=0;const j={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},d=C(s=>{var L;return(L=s.crmLeads.data.customField)==null?void 0:L.data});C(s=>s.crmLeads.data.leadsList),r==null||r.forEach(s=>{K.push({value:s==null?void 0:s.id,label:`${s==null?void 0:s.firstName} ${s==null?void 0:s.lastName}`})});const{getModule:g}=dt();b.useEffect(()=>{const s=async()=>{var N,z;try{const{payload:F}=await c(ie()),B=(N=F==null?void 0:F.data)==null?void 0:N.find(R=>(R==null?void 0:R.moduleName)==="leads");if(B){const{payload:R}=await c(ce({id:(z=B==null?void 0:B.id)==null?void 0:z.toString()}));S(R==null?void 0:R.data)}}catch(F){console.error("Error fetching module data:",F)}};(async()=>{const N=await g("leads");f(p.contactsDataId),s(),await c(ke()),await c(Me(N))})()},[c]),C(s=>{var L,N;return(N=(L=s.crmLeads)==null?void 0:L.data)==null?void 0:N.selectedLeads});const I=async(s,L)=>{await l.setFieldValue(`tagId_${L}`,s),k(!A)},E=async()=>{const s=new Set;T==null||T.forEach(N=>{p&&p[`tagId_${N.id}`]&&p[`tagId_${N.id}`].length&&p[`tagId_${N.id}`].map(F=>F.value).forEach(F=>{s.add(F)})});const L=[...s];await l.setFieldValue("tagId",L)};return b.useMemo(()=>{E()},[A,T]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Contact Name",invalid:t.contactsDataId&&o.contactsDataId,errorMessage:t.contactsDataId,children:e.jsx(at,{name:"contactsDataId",placeholder:"Contact Name",options:K,id:"contactsDataId",value:K.find(s=>(s==null?void 0:s.value)===(p==null?void 0:p.contactsDataId)),onChange:s=>{const L=s.value;h("email",""),h("contactNumber",""),f(L),h("contactsDataId",L)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Title*",invalid:t.title&&o.title,errorMessage:t.title,children:e.jsx($,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:O,prefix:e.jsx(nt,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[!u&&e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Email*",invalid:t.email&&o.email,errorMessage:t.email,children:e.jsx($,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:O,prefix:e.jsx(_e,{className:"text-xl"})})})}),!u&&e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Contact Number*",invalid:t.contactNumber&&o.contactNumber,errorMessage:t.contactNumber,children:e.jsx($,{type:"text",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:O,prefix:e.jsx(rt,{className:"text-xl"})})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"Budget",invalid:t.budget&&o.budget,errorMessage:t.budget,children:e.jsx($,{type:"number",autoComplete:"off",name:"budget",placeholder:"Budget",component:O,prefix:e.jsx(ot,{className:"text-xl"})})})})}),e.jsx(V,{label:"Notes",invalid:t.notes&&o.notes,errorMessage:t.notes,children:e.jsx($,{textArea:!0,type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:O,prefix:e.jsx(it,{className:"text-xl"})})}),e.jsx(lt,{data:T,handleTagChange:I}),(d==null?void 0:d.length)>0?e.jsxs(e.Fragment,{children:[" ",e.jsx(ne,{title:"Additional Details",desc:"",className:"mb-2"}),e.jsx("div",{style:j,children:d==null?void 0:d.map(s=>e.jsx("div",{children:e.jsx(V,{label:s==null?void 0:s.label,children:s.inputType==="textArea"?e.jsx($,{textArea:!0,type:"text",autoComplete:"off",name:s.name,placeholder:s==null?void 0:s.label,defaultValue:s.defaultValue,component:O,prefix:e.jsx(oe,{className:"text-xl"})}):e.jsx($,{type:s.inputType,autoComplete:"off",name:s.name,placeholder:s==null?void 0:s.label,defaultValue:s.defaultValue,component:O,prefix:e.jsx(oe,{className:"text-xl"})})})},s.id))})]}):null]})},yt=he().shape({title:_().required("Title is required"),notes:_(),contactNumber:_().test("validateContactNumber","Invalid contact number",function(a){if(!this.parent.contactsDataId){if(!a)return this.createError({message:"Contact is required"});const t=Number(a);if(isNaN(t))return this.createError({message:"Contact must be a number"});if(a.length!==10)return this.createError({message:"Contact must have exactly 10 digits"});if(a.startsWith("0"))return this.createError({message:"Contact number cannot start with 0"})}return!0}),email:_().test("validateEmail","Invalid email",function(a){return this.parent.contactsDataId?!0:!!a||this.createError({message:"Email is required"})}),budget:Ze().test("greaterThanOne","Budget must be greater than 1",a=>a>0).required("Budget is required"),tagId:et(),contactsDataId:_().test("is-valid-contact","Invalid contact selected",function(a){return this.parent.contactsDataId&&this.parent.contactsDataId.length>0?!!K.find(o=>o.value===a):!0})}),{TabNav:Ct,TabList:Lt,TabContent:Nt}=ue,xe=b.forwardRef((a,o)=>{var S,A,k;const t=C(r=>r.crmLeads.data.selectedLeads);(S=t==null?void 0:t.tags)==null||S.reduce((r,j)=>(r[`tagId_${j.id}`]=[],r),{});const h=b.useMemo(()=>{var r;return(r=t==null?void 0:t.tags)==null?void 0:r.reduce((j,d)=>{const g=d.tagCategoryId;return j[`tagId_${g}`]||(j[`tagId_${g}`]=[]),j[`tagId_${g}`].push({label:d.tagName,value:d.id}),j},{})},[t.tags]),p=!!t.id,c=C(r=>{var j,d,g;return(g=(d=(j=r.crmLeads)==null?void 0:j.data)==null?void 0:d.customField)==null?void 0:g.data}),l=M(),u=async(r,j,d)=>{var E,s,L,N;const g=(E=r==null?void 0:r.payload)!=null&&E.success?j:"Something went wrong !!!",I=(s=r==null?void 0:r.payload)!=null&&s.success?(L=r==null?void 0:r.payload)==null?void 0:L.message:d;U.push(e.jsx(G,{title:g,type:(N=r==null?void 0:r.payload)!=null&&N.success?"success":"danger",duration:2500,children:I}),{placement:"top-end"})},f=async(r,{setSubmitting:j})=>{const d=c.reduce((g,I)=>(g[I.name]=r[I.name],g),{});try{const g={title:r.title,contactsDataId:r.contactsDataId,email:r.email,contactNumber:r.contactNumber,budget:r.budget.toString(),description:r.notes,tagId:r==null?void 0:r.tagId,...d,...h},{name:I,tagName:E,...s}=r,L=p?await l(se({leadsId:(t==null?void 0:t.id)||"",updatedData:g})):await l(Re(g));await u(L,p?"Successfully Updated":"Successfully Added","An error occurred."),l(de()),await Promise.all([l(q()),l(ae())])}catch(g){console.error("An error occurred:",g)}finally{j(!1)}},T=b.useMemo(()=>c==null?void 0:c.reduce((j,d)=>{var I;const g=(I=t==null?void 0:t.leadFields)==null?void 0:I.find(E=>(E==null?void 0:E.name)===(d==null?void 0:d.name));return j[d==null?void 0:d.name]=g?g==null?void 0:g.value:d!=null&&d.defaultValue?d==null?void 0:d.defaultValue:"",j},{}),[c]);return e.jsx(pe,{innerRef:o,initialValues:{contactsDataId:((A=t.contactData)==null?void 0:A.id)||"",title:(t==null?void 0:t.title)||"",notes:(t==null?void 0:t.description)||"",tagId:((k=t==null?void 0:t.tags)==null?void 0:k.map(r=>({label:r.tagName,value:r.id})))||[],budget:(t==null?void 0:t.budget)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",email:(t==null?void 0:t.email)||"",...T,...h},validationSchema:yt,onSubmit:f,children:({touched:r,errors:j,values:d,setFieldValue:g})=>e.jsx(ge,{children:e.jsx(me,{children:e.jsxs(ue,{defaultValue:"leadsInfo",children:[e.jsx(Lt,{children:e.jsx(Ct,{value:"leadsInfo",children:"Leads Detail"})}),e.jsx("div",{className:"p-6",children:e.jsx(Nt,{value:"leadsInfo",children:e.jsx(bt,{touched:r,errors:j,setFieldValue:g,values:d})})})]})})})})});xe.displayName="LeadsForm";const fe=b.forwardRef((a,o)=>{M();const t=C(p=>{var c,l;return(l=(c=p.crmLeads)==null?void 0:c.data)==null?void 0:l.selectedLeads});C(p=>p.crmLeads.data.leadsList);const h=async p=>{};return e.jsx(xe,{ref:o,leads:t,onFormSubmit:h})});fe.displayName="LeadsEditContent";const Dt=({onSaveClick:a,onCancel:o})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(J,{size:"sm",className:"mr-2",onClick:o,children:"Cancel"}),e.jsx(J,{size:"sm",variant:"solid",onClick:a,children:"Save"})]}),wt=()=>{const a=M(),o=C(f=>f.crmLeads.data.drawerOpen),[t,h]=b.useState(window.innerWidth/2),p=()=>{a(de()),a(W({}))},c=b.useRef(null),l=()=>{var f;(f=c.current)==null||f.submitForm()};b.useEffect(()=>(window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}),[]);const u=()=>{h(window.innerWidth/2)};return e.jsx(Xe,{isOpen:o,closable:!1,bodyClass:"p-0",width:t,footer:e.jsx(Dt,{onCancel:p,onSaveClick:l}),onClose:p,onRequestClose:p,children:e.jsx(fe,{ref:c})})},St=he().shape({reason:_().required("Reason is required")}),je=b.forwardRef((a,o)=>{const t=M(),h=C(l=>{var u,f;return(f=(u=l.crmLeads)==null?void 0:u.data)==null?void 0:f.selectedLeads}),p=()=>{t(Z(!1))},c=async(l,u,f,T)=>{var j,d,g;const S=await f(se({leadsId:u==null?void 0:u.id,updatedData:{reason:l.reason,status:a.id}}));let A="",k="",r="danger";(j=S==null?void 0:S.payload)!=null&&j.success?(A="Successfully Added",k=(d=S==null?void 0:S.payload)==null?void 0:d.message,r="success"):(A="Something went wrong !!!",k=(g=S==null?void 0:S.error)==null?void 0:g.message),T.push(e.jsx(G,{title:A,type:r,duration:2500,children:k}),{placement:"top-end"}),f(Z(!1)),await f(q())};return e.jsx(pe,{innerRef:o,initialValues:{reason:"",status:""},validationSchema:St,onSubmit:async(l,{setSubmitting:u})=>{await c(l,h,t,U),u(!1)},children:({touched:l,errors:u,values:f,setFieldValue:T})=>e.jsxs(ge,{children:[e.jsx(me,{children:e.jsx(V,{label:"Reason",invalid:u.reason&&l.reason,errorMessage:u.reason,children:e.jsx($,{type:"text",autoComplete:"off",name:"reason",placeholder:"Reason",component:O,prefix:e.jsx(ct,{className:"text-xl"})})})}),e.jsx(pt,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(J,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:p,children:"Cancel"}),e.jsx(J,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(mt,{}),children:"Save"})]})})]})})});je.displayName="LeadForm";const vt=()=>{const a=M(),[o,t]=b.useState([]),[h,p]=b.useState([]),[c,l]=b.useState(null);b.useEffect(()=>{a(Oe(c))},[c]);const[u,f]=b.useState(""),T=C(n=>n.crmLeads.data.displayedLeadsList),S=C(n=>n.crmLeads.data.loading),A=C(n=>n.crmLeads.data.isDialogOpen),k=C(n=>n.crmLeads.data.tableData),{pageIndex:r,pageSize:j,sort:d,query:g,total:I}=C(n=>n.crmLeads.data.tableData),E=b.useCallback(()=>{ye(),a(q())},[a]);b.useEffect(()=>(E(),()=>{window.location.pathname.includes("lead")||a(P({...k,query:""}))}),[E]);const s=b.useMemo(()=>({pageIndex:r,pageSize:j,sort:d,query:g,total:I}),[r,j,d,g,I]);C(n=>n.crmLeads.data.selectedLeads);const L=X("leads","canDelete"),N=X("leads","canModify"),z=X("leads","canView"),F=Se(),B=async(n,i)=>{var m,w,D;if((i==null?void 0:i.statusName)==="closed_lost")f(i==null?void 0:i.id),a(W(n)),a(Z(!0));else{const x=await a(se({leadsId:n==null?void 0:n.id,updatedData:{status:i==null?void 0:i.id}}));let y="",v="",re="danger";(m=x==null?void 0:x.payload)!=null&&m.success?(y="Successfully Added",v=(w=x==null?void 0:x.payload)==null?void 0:w.message,re="success"):(y="Something went wrong !!!",v=(D=x==null?void 0:x.error)==null?void 0:D.message),U.push(e.jsx(G,{title:y,type:re,duration:2500,children:v}),{placement:"top-end"})}await a(q())},R=({row:n})=>{const i=M();Je();const m=()=>{i(le()),i(W(n))},w=async()=>{await i(W(n)),i(te(!0))},D=()=>{var y;l((y=n==null?void 0:n.leadStatus)==null?void 0:y.id)},x=()=>{i(W(n));const y=`/app/crm/lead-details/${n.id}`;F(y)};return e.jsxs("div",{className:"flex text-base items-center",onClick:D,children:[N&&h&&e.jsx(gt,{statusList:h,module:"leads",row:n,orgStatus:n==null?void 0:n.leadStatus,handleStatusChange:B}),N&&e.jsx("button",{disabled:(n==null?void 0:n.status)!=="open",className:`circle items-center mx-1 ${(n==null?void 0:n.status)!=="open"?"!cursor-not-allowed":"cursor-pointer hover:text-indigo-500"}`,onClick:m,children:e.jsx(We,{})}),L&&e.jsx("span",{className:"cursor-pointer hover:text-red-500 circle items-center",onClick:w,children:e.jsx(Pe,{})}),z&&e.jsx("span",{className:"cursor-pointer hover:text-green-500 circle mx-1 items-center text-lg",onClick:x,children:e.jsx(ut,{})})]})},ye=async()=>{var n,i,m,w;try{const{payload:D}=await a(ie()),x=(n=D==null?void 0:D.data)==null?void 0:n.find(y=>(y==null?void 0:y.moduleName)==="leads");if(x){const{payload:y}=await a(ce({id:(i=x==null?void 0:x.id)==null?void 0:i.toString()})),v=await a(Ve((m=x==null?void 0:x.id)==null?void 0:m.toString()));p((w=v==null?void 0:v.payload)==null?void 0:w.data),t(y==null?void 0:y.data)}}catch(D){console.error("Error fetching module data:",D)}},Ce=b.useMemo(()=>{const n=[{header:"Action",id:"action",cell:i=>e.jsx(R,{row:i.row.original})},{header:"Contact Name",accessorKey:"contactName",cell:i=>{var w,D,x,y,v;const m=(w=i.row.original)!=null&&w.contactData?((x=(D=i.row.original)==null?void 0:D.contactData)==null?void 0:x.firstName)+" "+((v=(y=i.row.original)==null?void 0:y.contactData)==null?void 0:v.lastName):"-";return e.jsx(Q,{title:m,children:e.jsx(H,{text:m,maxLength:15})},m)}},{header:"Title",accessorKey:"title",cell:i=>{const m=i.row.original.title;return e.jsx(Q,{title:m,children:e.jsx(H,{text:m,maxLength:20})},m)}},{header:"Budget",accessorKey:"budget",cell:i=>{const m=i.row.original;return e.jsx(H,{text:m.budget,maxLength:20})}},{header:"Status",accessorKey:"status",cell:i=>{var D,x,y;const m=i.row.original,w={backgroundColor:`${((D=m==null?void 0:m.leadStatus)==null?void 0:D.colorCode)||"red"}10`};return e.jsx(e.Fragment,{children:e.jsx(st,{style:w,className:"border-0 rounded",children:e.jsx("p",{style:{color:((x=m==null?void 0:m.leadStatus)==null?void 0:x.colorCode)||"red"},children:(y=m==null?void 0:m.leadStatus)==null?void 0:y.statusName})})})}},{header:"Reason",accessorKey:"reason",cell:i=>{var w;const m=(w=i.row.original)==null?void 0:w.reason;return m?e.jsx(Q,{title:m,children:e.jsx(H,{text:m,maxLength:20})},m):e.jsx(Q,{title:m,children:e.jsx(H,{text:"NA",maxLength:20})},m)}}];return o.map((i,m)=>{const w={header:i.categoryName,id:i.id,accessorKey:"tagCategory.categoryName",cell:D=>{var y;const x=(y=D.row.original.tags)==null?void 0:y.filter(v=>(v==null?void 0:v.tagCategoryId)===i.id);return x&&x.length?e.jsx(Ge,{tags:x}):"-"}};n.splice(m+3,0,w)}),n},[N,L,o]),Le=n=>{const i=Y(s);i.pageIndex=n,a(P(i))},Ne=n=>{const i=Y(s);i.pageSize=Number(n),i.pageIndex=1,a(P(i))},De=n=>{const i=Y(s);i.sort=n,a(P(i))};return e.jsxs("div",{children:[e.jsx(Ue,{columns:Ce,data:T,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:S,pagingData:{total:s.total,pageIndex:s.pageIndex,pageSize:s.pageSize},onPaginationChange:Le,onSelectChange:Ne,onSort:De}),e.jsx(wt,{}),e.jsx(jt,{}),e.jsxs(tt,{isOpen:A,onClose:()=>a(Z(!1)),children:[e.jsx("h5",{className:"mb-4",children:"Enter Reason"}),e.jsx(je,{id:u})]})]})},be=b.forwardRef((a,o)=>{const{onInputChange:t}=a,h=xt(p,500);function p(l){t==null||t(l)}const c=l=>{h(l.target.value)};return e.jsx(O,{ref:o,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search by name or title",prefix:e.jsx(He,{className:"text-lg"}),onChange:c})});be.displayName="LeadsTableSearch";const It=()=>{const a=M(),o=b.useRef(null),t=C(u=>u.crmLeads.data.tableData),h=X("leads","canCreate"),p=u=>{const f=Y(t);f.query=u,f.pageIndex=1,typeof u=="string"&&u.length>1&&c(f),typeof u=="string"&&u.length===0&&c(f)},c=u=>{a(u?P(u):q())},l=()=>{a(le()),a(W({})),a(ht("Add"))};return b.useEffect(()=>{o.current&&(o.current.value=t.query||"",a(P(t)))},[t==null?void 0:t.query]),e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(be,{ref:o,onInputChange:p})}),e.jsx("div",{className:"mb-4",children:h&&e.jsx(J,{size:"sm",onClick:l,children:"Add New"})})]})};ve("crmLeads",$e);const Tt=()=>{const a=C(o=>o.crmLeads.data.tableData);return e.jsxs(e.Fragment,{children:[e.jsx(ft,{}),e.jsxs(Ie,{bodyClass:"h-full",children:[e.jsx(ne,{title:`Leads (${(a==null?void 0:a.total)||0})`,desc:"",className:"mb-2"}),e.jsx(It,{}),e.jsx(vt,{})]})]})},Ns=Tt;export{Ns as default};
