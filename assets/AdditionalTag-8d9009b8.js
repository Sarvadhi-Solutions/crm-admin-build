import{r as $,au as ne,x as oe,am as y,an as ie,ao as le,ap as ce,a as ue,j as p}from"./index-6767ac81.js";import{F as de,a as pe,c as M,d as R}from"./formik.esm-35003a33.js";import"./Alert-c9b22c70.js";import"./index-688b9e70.js";import"./Badge-1f68c9c2.js";import{B as G}from"./Button-edcd26d9.js";import"./Calendar-defcfa74.js";import"./Card-da872ceb.js";import"./index-5c02b9f9.js";import"./index-6bf19af2.js";import"./Dialog-b04dbbb3.js";import"./Drawer-95c21b15.js";import"./index-787c9736.js";import"./toString-5f976032.js";import{I as me}from"./Input-736c9e0d.js";import"./index-5e02ae30.js";import"./index-375da5f6.js";import"./index-9fee79d2.js";import"./toast-33e99923.js";import"./Pagination-3af44538.js";import"./Progress-b13c43d8.js";import"./index-18c6d586.js";import"./RangeCalendar-2da4f4e1.js";import"./ScrollBar-e8750282.js";import"./index-bf30d0ca.js";import{S as fe}from"./Select-3d321c37.js";import"./Skeleton-f6501194.js";import"./index-8c6f1de1.js";import"./Switcher-becc3d78.js";import"./index-d5eb49a4.js";import"./index-149a53e8.js";import"./Tag-28e3c136.js";import"./index-d9614e75.js";import"./index-70261eaf.js";import"./Tooltip-777f9f9c.js";import"./Upload-1c01a3b3.js";import{c as he,d as ve}from"./index.esm-da94fd5f.js";import{z as ye,A as ge,h as Ce,g as be,B as we,m as Oe,n as B,o as De}from"./CrmService-e70a4be4.js";var H={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=P($),d=m(ne);function m(t){return t&&t.__esModule?t:{default:t}}function w(){if(typeof WeakMap!="function")return null;var t=new WeakMap;return w=function(){return t},t}function P(t){if(t&&t.__esModule)return t;if(t===null||f(t)!=="object"&&typeof t!="function")return{default:t};var r=w();if(r&&r.has(t))return r.get(t);var a={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var i=e?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(a,o,i):a[o]=t[o]}return a.default=t,r&&r.set(t,a),a}function f(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?f=function(a){return typeof a}:f=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f(t)}function g(){return g=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(t[e]=a[e])}return t},g.apply(this,arguments)}function C(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,e)}return a}function x(t){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?C(a,!0).forEach(function(e){l(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):C(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function l(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function S(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function N(t,r){for(var a=0;a<r.length;a++){var e=r[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function E(t,r,a){return r&&N(t.prototype,r),a&&N(t,a),t}function b(t,r){return r&&(f(r)==="object"||typeof r=="function")?r:j(t)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},k(t)}function j(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function K(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&T(t,r)}function T(t,r){return T=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e},T(t,r)}var L="Select...",F=function(t){K(r,t);function r(a){var e;return S(this,r),e=b(this,k(r).call(this,a)),e.state={selected:e.parseValue(a.value,a.options)||{label:typeof a.placeholder>"u"?L:a.placeholder,value:""},isOpen:!1},e.dropdownRef=(0,s.createRef)(),e.mounted=!0,e.handleDocumentClick=e.handleDocumentClick.bind(j(e)),e.fireChangeEvent=e.fireChangeEvent.bind(j(e)),e}return E(r,[{key:"componentDidUpdate",value:function(e){if(this.props.value!==e.value)if(this.props.value){var o=this.parseValue(this.props.value,this.props.options);o!==this.state.selected&&this.setState({selected:o})}else this.setState({selected:{label:typeof this.props.placeholder>"u"?L:this.props.placeholder,value:""}})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocumentClick,!1),document.addEventListener("touchend",this.handleDocumentClick,!1)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,document.removeEventListener("click",this.handleDocumentClick,!1),document.removeEventListener("touchend",this.handleDocumentClick,!1)}},{key:"handleMouseDown",value:function(e){this.props.onFocus&&typeof this.props.onFocus=="function"&&this.props.onFocus(this.state.isOpen),!(e.type==="mousedown"&&e.button!==0)&&(e.stopPropagation(),e.preventDefault(),this.props.disabled||this.setState({isOpen:!this.state.isOpen}))}},{key:"parseValue",value:function(e,o){var i;if(typeof e=="string")for(var c=0,h=o.length;c<h;c++)if(o[c].type==="group"){var u=o[c].items.filter(function(v){return v.value===e});u.length&&(i=u[0])}else typeof o[c].value<"u"&&o[c].value===e&&(i=o[c]);return i||e}},{key:"setValue",value:function(e,o){var i={selected:{value:e,label:o},isOpen:!1};this.fireChangeEvent(i),this.setState(i)}},{key:"fireChangeEvent",value:function(e){e.selected!==this.state.selected&&this.props.onChange&&this.props.onChange(e.selected)}},{key:"renderOption",value:function(e){var o,i=e.value;typeof i>"u"&&(i=e.label||e);var c=e.label||e.value||e,h=i===this.state.selected.value||i===this.state.selected,u=(o={},l(o,"".concat(this.props.baseClassName,"-option"),!0),l(o,e.className,!!e.className),l(o,"is-selected",h),o),v=(0,d.default)(u),O=Object.keys(e.data||{}).reduce(function(D,_){return x({},D,l({},"data-".concat(_),e.data[_]))},{});return s.default.createElement("div",g({key:i,className:v,onMouseDown:this.setValue.bind(this,i,c),onClick:this.setValue.bind(this,i,c),role:"option","aria-selected":h?"true":"false"},O),c)}},{key:"buildMenu",value:function(){var e=this,o=this.props,i=o.options,c=o.baseClassName,h=i.map(function(u){if(u.type==="group"){var v=s.default.createElement("div",{className:"".concat(c,"-title")},u.name),O=u.items.map(function(D){return e.renderOption(D)});return s.default.createElement("div",{className:"".concat(c,"-group"),key:u.name,role:"listbox",tabIndex:"-1"},v,O)}else return e.renderOption(u)});return h.length?h:s.default.createElement("div",{className:"".concat(c,"-noresults")},"No options found")}},{key:"handleDocumentClick",value:function(e){this.mounted&&(this.dropdownRef.current.contains(e.target)||this.state.isOpen&&this.setState({isOpen:!1}))}},{key:"isValueSelected",value:function(){return typeof this.state.selected=="string"||this.state.selected.value!==""}},{key:"render",value:function(){var e,o,i,c,h,u=this.props,v=u.baseClassName,O=u.controlClassName,D=u.placeholderClassName,_=u.menuClassName,V=u.arrowClassName,A=u.arrowClosed,I=u.arrowOpen,W=u.className,z=this.props.disabled?"Dropdown-disabled":"",X=typeof this.state.selected=="string"?this.state.selected:this.state.selected.label,Y=(0,d.default)((e={},l(e,"".concat(v,"-root"),!0),l(e,W,!!W),l(e,"is-open",this.state.isOpen),e)),Z=(0,d.default)((o={},l(o,"".concat(v,"-control"),!0),l(o,O,!!O),l(o,z,!!z),o)),ee=(0,d.default)((i={},l(i,"".concat(v,"-placeholder"),!0),l(i,D,!!D),l(i,"is-selected",this.isValueSelected()),i)),te=(0,d.default)((c={},l(c,"".concat(v,"-menu"),!0),l(c,_,!!_),c)),ae=(0,d.default)((h={},l(h,"".concat(v,"-arrow"),!0),l(h,V,!!V),h)),re=s.default.createElement("div",{className:ee},X),se=this.state.isOpen?s.default.createElement("div",{className:te,"aria-expanded":"true"},this.buildMenu()):null;return s.default.createElement("div",{ref:this.dropdownRef,className:Y},s.default.createElement("div",{className:Z,onMouseDown:this.handleMouseDown.bind(this),onTouchEnd:this.handleMouseDown.bind(this),"aria-haspopup":"listbox"},re,s.default.createElement("div",{className:"".concat(v,"-arrow-wrapper")},I&&A?this.state.isOpen?I:A:s.default.createElement("span",{className:ae}))),se)}}]),r}(s.Component);F.defaultProps={baseClassName:"Dropdown"};var Q=F;n.default=Q})(H);const vt=oe(H),Ne="crmCustomers",q=y("crmCustomers/data/getCustomerStatistic",async()=>(await ye()).data),U=y("crmCustomers/data/getCustomers",async()=>(await ge()).data),yt=y("crmCustomers/data/editCustomer",async({customerId:n,updatedData:s})=>(await Ce(n,s)).data),gt=y("crmCustomers/data/deleteCustomer",async n=>await be(n)),Ct=y("crmCustomers/data/createCustomer",async n=>(await we(n)).data),_e=y("crmCustomers/data/module",async()=>{const n=await Oe();return console.log(n.data,"response"),n.data}),bt=y("tag-category",async({id:n})=>{const s=await B(n);return console.log(s.data,"Getting Data"),s.data});y("crmCustomers/data/fetchTag",async({id:n})=>(await B(n)).data);const xe=y("crmCustomers/data/createTag",async({masterId:n,colorName:s,tagName:d,tagCategoryId:m})=>(await De({colorName:s,tagName:d,masterId:n,tagCategoryId:m})).data),Se={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Ee={status:""},Pe={loading:!1,statisticLoading:!1,customerList:[],statisticData:{},tableData:Se,filterData:Ee,drawerOpen:!1,selectedCustomer:{}},J=ie({name:`${Ne}/state`,initialState:Pe,reducers:{setTableData:(n,s)=>{n.tableData=s.payload},setCustomerList:(n,s)=>{n.customerList=s.payload},setFilterData:(n,s)=>{n.filterData=s.payload},setSelectedCustomer:(n,s)=>{n.selectedCustomer=s.payload},setDrawerOpen:n=>{n.drawerOpen=!0},setDrawerClose:n=>{n.drawerOpen=!1}},extraReducers:n=>{n.addCase(U.fulfilled,(s,d)=>{s.customerList=d.payload.data,s.loading=!1}).addCase(U.pending,s=>{s.loading=!0}).addCase(q.fulfilled,(s,d)=>{s.statisticData=d.payload,s.statisticLoading=!1}).addCase(q.pending,s=>{s.statisticLoading=!0})}}),{setTableData:wt,setCustomerList:Ot,setFilterData:Dt,setSelectedCustomer:Nt,setDrawerOpen:_t,setDrawerClose:xt}=J.actions,ke=J.reducer,St=le({data:ke}),Et=ce;function Pt(n){return n.map(d=>({type:"group",name:d.categoryName,items:d.tags.map(m=>({value:m.id,label:m.tagName}))}))}function kt(n){return n.map(s=>({value:s.id,label:s.categoryName}))}const je=({onCancel:n,onSave:s})=>p.jsxs("div",{className:"text-right w-full",children:[p.jsx(G,{size:"sm",className:"mr-2",onClick:n,children:"Cancel"}),p.jsx(G,{size:"sm",variant:"solid",type:"button",onClick:s,children:"Save"})]}),jt=({isOpen:n,onOpenChange:s,categoryList:d})=>{const m=$.useRef(null),w=ue(),P=async()=>{var C,x,l,S,N,E;const{payload:f}=await w(_e()),g=(C=f==null?void 0:f.data)==null?void 0:C.find(b=>(b==null?void 0:b.moduleName)==="company");if(g){const b=(x=g.id)==null?void 0:x.toString();await w(xe({masterId:b,tagName:(l=m.current)==null?void 0:l.values.tag,colorName:(S=m.current)==null?void 0:S.values.tagColor,tagCategoryId:(N=m.current)==null?void 0:N.values.category.value})),s(!1),console.log((E=m.current)==null?void 0:E.values)}};return p.jsx("div",{className:`${n?"flex":"hidden"} justify-center items-center top-16 left-0 z-10 bg-white p-4 border border-gray-300 w-full absolute rounded-8`,children:n&&p.jsx(de,{innerRef:m,initialValues:{category:"",tag:"",tagColor:"#808080"},onSubmit:f=>{console.log("values",f," ==== > Here The Value Is Prinitng")},children:({values:f,setFieldValue:g})=>p.jsxs(pe,{children:[p.jsx(p.Fragment,{children:p.jsx(M,{label:"Category",children:p.jsx(R,{type:"text",autoComplete:"off",name:"category",placeholder:"Category",options:d,component:fe,prefix:p.jsx(he,{className:"text-xl"}),onChange:C=>{g("category",C)}})})}),p.jsxs("div",{className:"flex items-center justify-center",children:[p.jsx(M,{label:"Tag",children:p.jsx(R,{type:"text",autoComplete:"off",name:"tag",placeholder:"Additional Tag Name",component:me,prefix:p.jsx(ve,{className:"text-xl"})})}),p.jsx(M,{children:p.jsx(R,{type:"color",name:"tagColor",className:"w-8 ml-2 p-2 rounded-full h-8 mt-6"})})]}),p.jsx(je,{onCancel:()=>s(!1),onSave:P})]})})})};export{jt as A,vt as D,Nt as a,wt as b,_t as c,gt as d,Dt as e,q as f,U as g,_e as h,bt as i,kt as j,yt as k,Ct as l,St as r,xt as s,Pt as t,Et as u};
