import{r as m,j as r,a as A,$ as V,au as se,av as Ye,aw as O,p as Ue,ai as Ke,ar as Xe}from"./index-c3e9fa7c.js";import{A as Je}from"./AdaptableCard-8cba0fc7.js";import{u as D,a as Ne,b as oe,g as Y,c as ke,s as we,t as fe,d as Qe,e as le,f as Ze,h as et,i as tt,j as ce,p as Me,k as at,l as Te,r as nt}from"./index-ae49a4e7.js";import{B as de}from"./Button-d0ef02c0.js";import{c as W}from"./cloneDeep-5b29fb06.js";import{I as Q}from"./Input-1486261f.js";import{b as rt,d as st,a6 as it,a5 as Se,m as ot,ab as lt,A as ct}from"./index.esm-291b3c8a.js";import{d as dt}from"./debounce-6f865841.js";import{S as ut,c as mt,m as pt,d as ft,a as ie}from"./Select-6cb5654e.js";import{B as Ae}from"./Badge-d747266e.js";import{u as he}from"./checkEditUpdate-55a161ed.js";import{D as ht}from"./DataTable-3befe403.js";import{S as be}from"./StatusCapsule-1ee735b9.js";import{T as gt}from"./TagsList-b2e99a1b.js";import{T as Ce}from"./TextTruncate-6ff3213a.js";import{u as Ie}from"./useThemeClass-9aa299d0.js";import{C as xt}from"./ConfirmDialog-4403793d.js";import{t as B,N as G}from"./toast-1384448d.js";import{D as vt}from"./Drawer-7a9af9bc.js";import{i as Tt}from"./Views-4498dec6.js";import{a as I,F as Et}from"./FormItem-f92cf688.js";import{T as Oe}from"./index-9d0fdf21.js";import{u as Dt,b as J,F as St,a as bt}from"./formik.esm-fd2d5cfd.js";import{c as Ve,a as M,b as Fe}from"./index.esm-3fafb1c1.js";import{D as Ct,t as yt,c as jt}from"./tagAndCategory-6419337c.js";/* empty css              */import{A as Nt}from"./index.esm-eb9baf9a.js";import{T as kt}from"./index.esm-033639b6.js";import{_ as U}from"./objectWithoutProperties-8e2777d0.js";import{_ as P}from"./extends-98964cd2.js";import{_ as ge}from"./slicedToArray-83ee2bb3.js";import{_ as Pe}from"./objectWithoutPropertiesLoose-4f48578a.js";import{_ as $e}from"./inheritsLoose-4ab94981.js";import{A as wt}from"./AdditionalTag-f9697404.js";import{g as Mt}from"./index-977ffddf.js";import{g as At}from"./index-2fd0a504.js";import{M as It}from"./MediaSkeleton-5dc333db.js";import{A as Ot}from"./index-7489ac47.js";import{C as Vt}from"./Card-f5c778fb.js";import{N as Ft}from"./react-number-format.es-095c36ce.js";import"./CrmService-65bc7d18.js";import"./context-c2e517f5.js";import"./_Uint8Array-10296907.js";import"./_MapCache-018d5ff9.js";import"./_getPrototype-9846d01d.js";import"./isNil-cc11ed44.js";import"./get-b06143cc.js";import"./toString-8d06d124.js";import"./toConsumableArray-ab33ca8c.js";import"./floating-ui.dom-bef9cea3.js";import"./index-b1456952.js";import"./index.esm-e2831cf6.js";import"./Pagination-191f69e3.js";import"./index-f23338ff.js";import"./_baseIsEqual-523cf8f9.js";import"./TableRowSkeleton-bd2148ae.js";import"./Skeleton-0356863b.js";import"./index-ce3e799d.js";import"./Alert-1e0e8bff.js";import"./useTimeout-d6c2414e.js";import"./CloseButton-b3d6dc71.js";import"./StatusIcon-9d0bc889.js";import"./Calendar-3dc19a88.js";import"./useControllableState-a53f6e69.js";import"./index-d82f0d5a.js";import"./useMergeRef-788c4cb0.js";import"./useRootClose-ed59e0fc.js";import"./usePopper-26945918.js";import"./RangeCalendar-82a1c17a.js";import"./TimeInput-70c59d46.js";import"./useUniqueId-5b8bcb2e.js";import"./useDidUpdate-edee1e5d.js";import"./Dialog-29c1e818.js";import"./index-7c779fd2.js";import"./index-bca9904a.js";import"./useUncertainRef-ada2461c.js";import"./index-203bcdc0.js";import"./chainedFunction-070f832c.js";import"./index-bb719d81.js";import"./index-cdf7d65c.js";import"./index-299dc733.js";import"./Progress-7f6be63e.js";import"./index-96af533f.js";import"./ScrollBar-fd95dfb9.js";import"./index-ae673476.js";import"./index-769df92d.js";import"./mapCloneElement-67555f28.js";import"./Switcher-b542533c.js";import"./Tag-758ab856.js";import"./index-04bb5a46.js";import"./index-afdeca35.js";import"./Tooltip-0d302304.js";import"./index.esm-fe639564.js";import"./Upload-462d13c7.js";import"./index.esm-fdc3a9c5.js";const Re=m.forwardRef((o,n)=>{const{onInputChange:e}=o,s=dt(a,500);function a(i){e==null||e(i)}const t=i=>{s(i.target.value)};return r.jsx(Q,{ref:n,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:r.jsx(rt,{className:"text-lg"}),onChange:t})});Re.displayName="TasksTableSearch";const{Control:Pt}=mt,ye=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],$t=({innerProps:o,label:n,data:e,isSelected:s})=>r.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${s?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...o,children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ae,{innerClass:e.color}),r.jsx("span",{children:n})]}),s&&r.jsx(st,{className:"text-emerald-500 text-xl"})]}),Rt=({children:o,...n})=>{const e=n.getValue()[0];return r.jsxs(Pt,{...n,children:[e&&r.jsx(Ae,{className:"ltr:ml-4 rtl:mr-4",innerClass:e.color}),o]})},qt=()=>{const o=A(),{status:n}=D(s=>s.crmTasks.data.filterData),e=s=>{o(Ne({status:s==null?void 0:s.value}))};return r.jsx(ut,{options:ye,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:$t,Control:Rt},value:ye.filter(s=>s.value===n),onChange:e})},Lt=()=>{const o=A(),n=m.useRef(null),e=D(c=>c.crmTasks.data.tableData),s=he("tasks","canCreate"),a=c=>{const p=W(e);p.query=c,p.pageIndex=1,typeof c=="string"&&c.length>1&&t(p),typeof c=="string"&&c.length===0&&t(p)},t=c=>{o(oe(c)),o(Y())},i=()=>{const c=W(e);c.query="",n.current&&(n.current.value=""),o(Ne({status:""})),t(c)},l=()=>{o(ke()),o(we("Add"))};return r.jsxs("div",{className:"md:flex items-center justify-between",children:[r.jsxs("div",{className:"md:flex items-center gap-4",children:[r.jsx(Re,{ref:n,onInputChange:a}),r.jsx(qt,{})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx(de,{size:"sm",className:"me-2",onClick:i,children:"Clear All"}),s&&r.jsx(de,{size:"sm",onClick:l,children:"Add New"})]})]})},_t=()=>{const o=A(),n=D(t=>t.crmTasks.data.deleteConfirmation),e=D(t=>t.crmTasks.data.selectedTask),s=()=>{o(fe(!1))},a=async()=>{var i,l,c;o(fe(!1));const t=await o(Qe(e.id));await o(Y()),(i=t==null?void 0:t.payload)!=null&&i.success?B.push(r.jsx(G,{title:"Successfuly Deleted",type:"success",duration:2500,children:(l=t==null?void 0:t.payload)==null?void 0:l.message}),{placement:"top-end"}):B.push(r.jsx(G,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(c=t==null?void 0:t.error)==null?void 0:c.message}),{placement:"top-end"}),await o(Y()),await o(le())};return r.jsx(xt,{isOpen:n,type:"danger",title:"Delete Task",confirmButtonColor:"red-600",onClose:s,onRequestClose:s,onCancel:s,onConfirm:a,children:r.jsx("p",{children:"Are you sure you want to delete this Task? All record related to this task will be deleted as well. This action cannot be undone."})})},je={disabled:!1},ue=V.createContext(null);var zt=function(n){return n.scrollTop},Z="unmounted",R="exited",q="entering",H="entered",xe="exiting",F=function(o){$e(n,o);function n(s,a){var t;t=o.call(this,s,a)||this;var i=a,l=i&&!i.isMounting?s.enter:s.appear,c;return t.appearStatus=null,s.in?l?(c=R,t.appearStatus=q):c=H:s.unmountOnExit||s.mountOnEnter?c=Z:c=R,t.state={status:c},t.nextCallback=null,t}n.getDerivedStateFromProps=function(a,t){var i=a.in;return i&&t.status===Z?{status:R}:null};var e=n.prototype;return e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},e.componentDidUpdate=function(a){var t=null;if(a!==this.props){var i=this.state.status;this.props.in?i!==q&&i!==H&&(t=q):(i===q||i===H)&&(t=xe)}this.updateStatus(!1,t)},e.componentWillUnmount=function(){this.cancelNextCallback()},e.getTimeouts=function(){var a=this.props.timeout,t,i,l;return t=i=l=a,a!=null&&typeof a!="number"&&(t=a.exit,i=a.enter,l=a.appear!==void 0?a.appear:i),{exit:t,enter:i,appear:l}},e.updateStatus=function(a,t){if(a===void 0&&(a=!1),t!==null)if(this.cancelNextCallback(),t===q){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:se.findDOMNode(this);i&&zt(i)}this.performEnter(a)}else this.performExit();else this.props.unmountOnExit&&this.state.status===R&&this.setState({status:Z})},e.performEnter=function(a){var t=this,i=this.props.enter,l=this.context?this.context.isMounting:a,c=this.props.nodeRef?[l]:[se.findDOMNode(this),l],p=c[0],x=c[1],v=this.getTimeouts(),f=l?v.appear:v.enter;if(!a&&!i||je.disabled){this.safeSetState({status:H},function(){t.props.onEntered(p)});return}this.props.onEnter(p,x),this.safeSetState({status:q},function(){t.props.onEntering(p,x),t.onTransitionEnd(f,function(){t.safeSetState({status:H},function(){t.props.onEntered(p,x)})})})},e.performExit=function(){var a=this,t=this.props.exit,i=this.getTimeouts(),l=this.props.nodeRef?void 0:se.findDOMNode(this);if(!t||je.disabled){this.safeSetState({status:R},function(){a.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:xe},function(){a.props.onExiting(l),a.onTransitionEnd(i.exit,function(){a.safeSetState({status:R},function(){a.props.onExited(l)})})})},e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},e.safeSetState=function(a,t){t=this.setNextCallback(t),this.setState(a,t)},e.setNextCallback=function(a){var t=this,i=!0;return this.nextCallback=function(l){i&&(i=!1,t.nextCallback=null,a(l))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},e.onTransitionEnd=function(a,t){this.setNextCallback(t);var i=this.props.nodeRef?this.props.nodeRef.current:se.findDOMNode(this),l=a==null&&!this.props.addEndListener;if(!i||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],p=c[0],x=c[1];this.props.addEndListener(p,x)}a!=null&&setTimeout(this.nextCallback,a)},e.render=function(){var a=this.state.status;if(a===Z)return null;var t=this.props,i=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var l=Pe(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return V.createElement(ue.Provider,{value:null},typeof i=="function"?i(a,l):V.cloneElement(V.Children.only(i),l))},n}(V.Component);F.contextType=ue;F.propTypes={};function z(){}F.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:z,onEntering:z,onEntered:z,onExit:z,onExiting:z,onExited:z};F.UNMOUNTED=Z;F.EXITED=R;F.ENTERING=q;F.ENTERED=H;F.EXITING=xe;const qe=F;function Ee(o,n){var e=function(t){return n&&m.isValidElement(t)?n(t):t},s=Object.create(null);return o&&m.Children.map(o,function(a){return a}).forEach(function(a){s[a.key]=e(a)}),s}function Ht(o,n){o=o||{},n=n||{};function e(x){return x in n?n[x]:o[x]}var s=Object.create(null),a=[];for(var t in o)t in n?a.length&&(s[t]=a,a=[]):a.push(t);var i,l={};for(var c in n){if(s[c])for(i=0;i<s[c].length;i++){var p=s[c][i];l[s[c][i]]=e(p)}l[c]=e(c)}for(i=0;i<a.length;i++)l[a[i]]=e(a[i]);return l}function L(o,n,e){return e[n]!=null?e[n]:o.props[n]}function Bt(o,n){return Ee(o.children,function(e){return m.cloneElement(e,{onExited:n.bind(null,e),in:!0,appear:L(e,"appear",o),enter:L(e,"enter",o),exit:L(e,"exit",o)})})}function Gt(o,n,e){var s=Ee(o.children),a=Ht(n,s);return Object.keys(a).forEach(function(t){var i=a[t];if(m.isValidElement(i)){var l=t in n,c=t in s,p=n[t],x=m.isValidElement(p)&&!p.props.in;c&&(!l||x)?a[t]=m.cloneElement(i,{onExited:e.bind(null,i),in:!0,exit:L(i,"exit",o),enter:L(i,"enter",o)}):!c&&l&&!x?a[t]=m.cloneElement(i,{in:!1}):c&&l&&m.isValidElement(p)&&(a[t]=m.cloneElement(i,{onExited:e.bind(null,i),in:p.props.in,exit:L(i,"exit",o),enter:L(i,"enter",o)}))}}),a}var Wt=Object.values||function(o){return Object.keys(o).map(function(n){return o[n]})},Yt={component:"div",childFactory:function(n){return n}},De=function(o){$e(n,o);function n(s,a){var t;t=o.call(this,s,a)||this;var i=t.handleExited.bind(Ye(t));return t.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},t}var e=n.prototype;return e.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},e.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(a,t){var i=t.children,l=t.handleExited,c=t.firstRender;return{children:c?Bt(a,l):Gt(a,i,l),firstRender:!1}},e.handleExited=function(a,t){var i=Ee(this.props.children);a.key in i||(a.props.onExited&&a.props.onExited(t),this.mounted&&this.setState(function(l){var c=P({},l.children);return delete c[a.key],{children:c}}))},e.render=function(){var a=this.props,t=a.component,i=a.childFactory,l=Pe(a,["component","childFactory"]),c=this.state.contextValue,p=Wt(this.state.children).map(i);return delete l.appear,delete l.enter,delete l.exit,t===null?V.createElement(ue.Provider,{value:c},p):V.createElement(ue.Provider,{value:c},V.createElement(t,l,p))},n}(V.Component);De.propTypes={};De.defaultProps=Yt;const Le=De;var Ut=["in","onExited","appear","enter","exit"],Kt=function(n){return function(e){e.in,e.onExited,e.appear,e.enter,e.exit;var s=U(e,Ut);return m.createElement(n,s)}},Xt=Kt,Jt=["component","duration","in","onExited"],_e=function(n){var e=n.component,s=n.duration,a=s===void 0?1:s,t=n.in;n.onExited;var i=U(n,Jt),l=m.useRef(null),c={entering:{opacity:0},entered:{opacity:1,transition:"opacity ".concat(a,"ms")},exiting:{opacity:0},exited:{opacity:0}};return m.createElement(qe,{mountOnEnter:!0,unmountOnExit:!0,in:t,timeout:a,nodeRef:l},function(p){var x={style:O({},c[p]),ref:l};return m.createElement(e,P({innerProps:x},i))})},ve=260,Qt=function(n){var e=n.children,s=n.in,a=n.onExited,t=m.useRef(null),i=m.useState("auto"),l=ge(i,2),c=l[0],p=l[1];m.useEffect(function(){var v=t.current;if(v){var f=window.requestAnimationFrame(function(){return p(v.getBoundingClientRect().width)});return function(){return window.cancelAnimationFrame(f)}}},[]);var x=function(f){switch(f){default:return{width:c};case"exiting":return{width:0,transition:"width ".concat(ve,"ms ease-out")};case"exited":return{width:0}}};return m.createElement(qe,{enter:!1,mountOnEnter:!0,unmountOnExit:!0,in:s,onExited:function(){var f=t.current;f&&(a==null||a(f))},timeout:ve,nodeRef:t},function(v){return m.createElement("div",{ref:t,style:O({overflow:"hidden",whiteSpace:"nowrap"},x(v))},e)})},Zt=["in","onExited"],ea=function(n){return function(e){var s=e.in,a=e.onExited,t=U(e,Zt);return m.createElement(Qt,{in:s,onExited:a},m.createElement(n,P({cropWithEllipsis:s},t)))}},ta=ea,aa=function(n){return function(e){return m.createElement(_e,P({component:n,duration:e.isMulti?ve:1},e))}},na=aa,ra=function(n){return function(e){return m.createElement(_e,P({component:n},e))}},sa=ra,ia=["component"],oa=["children"],la=function(n){return function(e){return e.isMulti?m.createElement(ca,P({component:n},e)):m.createElement(Le,P({component:n},e))}},ca=function(n){var e=n.component,s=U(n,ia),a=da(s);return m.createElement(Le,P({component:e},a))},da=function(n){var e=n.children,s=U(n,oa),a=s.isMulti,t=s.hasValue,i=s.innerProps,l=s.selectProps,c=l.components,p=l.controlShouldRenderValue,x=m.useState(a&&p&&t),v=ge(x,2),f=v[0],T=v[1],j=m.useState(!1),C=ge(j,2),N=C[0],g=C[1];m.useEffect(function(){t&&!f&&T(!0)},[t,f]),m.useEffect(function(){N&&!t&&f&&T(!1),g(!1)},[N,t,f]);var u=function(){return g(!0)},h=function(E){if(a&&m.isValidElement(E)){if(E.type===c.MultiValue)return m.cloneElement(E,{onExited:u});if(E.type===c.Placeholder&&f)return null}return E},S=O(O({},i),{},{style:O(O({},i==null?void 0:i.style),{},{display:a&&t||f?"flex":"grid"})}),b=O(O({},s),{},{innerProps:S,children:m.Children.toArray(e).map(h)});return b},ua=la,ma=["Input","MultiValue","Placeholder","SingleValue","ValueContainer"],ze=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=ft({components:n}),s=e.Input,a=e.MultiValue,t=e.Placeholder,i=e.SingleValue,l=e.ValueContainer,c=U(e,ma);return O({Input:Xt(s),MultiValue:ta(a),Placeholder:na(t),SingleValue:sa(i),ValueContainer:ua(l)},c)},ae=ze();ae.Input;ae.MultiValue;ae.Placeholder;ae.SingleValue;ae.ValueContainer;var pa=pt(ze);const ee=[],te=[],fa=o=>{const{touched:n,errors:e,setFieldValue:s,values:a}=o,t=A(),[i,l]=m.useState(!1),[c,p]=m.useState(!1),[x,v]=m.useState([]),[f,T]=m.useState([]),j=()=>{l(!i),p(!1)},[C,N]=m.useState("");m.useEffect(()=>{const d=async()=>{var X,me;try{const{payload:$}=await t(Ze()),y=(X=$==null?void 0:$.data)==null?void 0:X.find(_=>(_==null?void 0:_.moduleName)==="tasks");if(N(y.id),y){const{payload:_}=await t(et({id:(me=y==null?void 0:y.id)==null?void 0:me.toString()})),Ge=yt(_.data),We=jt(_.data);T(We),v(Ge)}}catch($){console.error("Error fetching module data:",$)}};t(At()),t(Mt()),d()},[t]);const g=D(d=>d.crmTasks.data.selectedTask),u=D(d=>d.crmTasks.data.drawerMode),[h,S]=m.useState(g?g.tags||[]:[]),b=Dt(),k=d=>{S(d);const X=[d.value];b.setFieldValue("tagId",X)},E=[{label:"None",value:"none"},{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"}],K=[{label:"Pending",value:"pending"},{label:"Completed",value:"completed"},{label:"Rejected",value:"rejected"}],ne=pa(),re=D(d=>d.crmTasks.data.usersList);ee.length=0,re.forEach(d=>{ee.push({label:`${d==null?void 0:d.firstName} ${d==null?void 0:d.lastName}`,value:d.id})});const w=D(d=>d.crmTasks.data.contactsList);return te.length=0,w.forEach(d=>{te.push({label:`${d==null?void 0:d.firstName} ${d==null?void 0:d.lastName}`,value:d.id})}),r.jsxs(r.Fragment,{children:[r.jsx(I,{label:"Task Name",invalid:e.tasksName&&n.tasksName,errorMessage:e.tasksName,children:r.jsx(J,{type:"text",autoComplete:"off",name:"tasksName",placeholder:"Task Name",component:Q,prefix:r.jsx(it,{className:"text-xl"})})}),r.jsx(I,{label:"Due Date",invalid:e.dueDate&&n.dueDate,errorMessage:e.dueDate,children:r.jsx(J,{isDisabled:u==="Edit",type:"datetime-local",autoComplete:"off",name:"dueDate",component:Q,prefix:r.jsx(Se,{className:"text-xl"})})}),r.jsx(I,{label:"Close Date",invalid:e.closeTime&&n.closeTime,errorMessage:e.closeTime,children:r.jsx(J,{type:"datetime-local",autoComplete:"off",name:"closeTime",component:Q,prefix:r.jsx(Se,{className:"text-xl"})})}),r.jsx(I,{label:"Priority",invalid:e.priority&&n.priority,errorMessage:e.priority,children:r.jsx(ie,{name:"priority",id:"priority",components:ne,value:E.find(d=>(d==null?void 0:d.value)===(a==null?void 0:a.priority)),options:E,onChange:d=>{s("priority",d.value||"")}})}),r.jsx(I,{label:"Completation Status",invalid:e.completionStatus&&n.completionStatus,errorMessage:e.completionStatus,children:r.jsx(ie,{name:"completionStatus",id:"completionStatus",value:K.find(d=>(d==null?void 0:d.value)===(a==null?void 0:a.completionStatus)),options:K,isDisabled:u==="Add",onChange:d=>{s("completionStatus",d.value||"")}})}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx(I,{label:"Tags",children:r.jsxs("div",{style:{position:"relative"},children:[r.jsx(J,{name:"tagId",component:Ct,options:x,placeholder:"Select a Tag",value:b.initialValues.tagName,onChange:k}),r.jsx(kt,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{j(),p(!0)}})]})}),r.jsx(wt,{moduleName:C,isOpen:i,categoryList:f,onOpenChange:d=>l(d)})]}),r.jsx(I,{label:"Assigned To",invalid:e.assignedTo&&n.assignedTo,errorMessage:e.assignedTo,children:r.jsx(ie,{name:"assignedTo",id:"assignedTo",value:ee.find(d=>(d==null?void 0:d.value)===(a==null?void 0:a.assignedTo)),options:ee,onChange:d=>{s("assignedTo",d.value||"")}})}),r.jsx(I,{label:"Related To",invalid:e.relatedTo&&n.relatedTo,errorMessage:e.relatedTo,children:r.jsx(ie,{name:"relatedTo",id:"relatedTo",value:te.find(d=>(d==null?void 0:d.value)===(a==null?void 0:a.relatedTo)),options:te,onChange:d=>{s("relatedTo",d.value||"")}})}),r.jsx(I,{label:"Description",invalid:e.descriptions&&n.descriptions,errorMessage:e.descriptions,children:r.jsx(J,{type:"text",autoComplete:"off",name:"descriptions",placeholder:"Description",component:Q,prefix:r.jsx(Nt,{className:"text-xl"})})})]})},ha=Ve().shape({tasksName:M().required("Task Name is required"),closeTime:M().required("Closing Date and Time is required").test("futureDate","Closing Date and Time must be in the future",function(o){return new Date(o)>=new Date}).test("greaterThanDueDate","Closing Date must be greater than Due Date",function(o){const n=this.parent.dueDate;return new Date(o)>new Date(n)}),tagId:Fe(),descriptions:M().required("Description is requied"),priority:M().oneOf(["none","low","medium","high"]).required("Priority is required"),completionStatus:M().oneOf(["rejected","pending","completed"]).required("status is required")}),ga=Ve().shape({tasksName:M().required("Task Name is required"),dueDate:M().required("Due Date is required"),tagId:Fe(),descriptions:M().required("Description is requied"),relatedTo:M().required("Contact is required").test("is-valid-contatc","Invalid contact selected",o=>!!te.find(n=>n.value==o)),assignedTo:M().required("User is required").test("is-valid-user","Invalid user selected",o=>!!ee.find(n=>n.value==o)),priority:M().oneOf(["none","low","medium","high"]).required("Priority is required"),completionStatus:M().oneOf(["rejected","pending","completed"]).required("status is required")}),{TabNav:xa,TabList:va,TabContent:Ta}=Oe,He=m.forwardRef((o,n)=>{var l,c,p,x,v;const e=D(f=>f.crmTasks.data.selectedTask),s=D(f=>f.crmTasks.data.drawerMode),a=A();function t(f){if(!f)return"";const T=f.split("T");if(T.length!==2)return"";const j=T[0],C=T[1].slice(0,5);return`${j}T${C}`}const i=f=>{const T=new Date(f);if(isNaN(T.getTime()))return"";const j=T.getFullYear(),C=(T.getMonth()+1).toString().padStart(2,"0"),N=T.getDate().toString().padStart(2,"0"),g=T.getHours().toString().padStart(2,"0"),u=T.getMinutes().toString().padStart(2,"0");return`${j}-${C}-${N} ${g}:${u}`};return r.jsx(St,{innerRef:n,initialValues:{tasksName:(e==null?void 0:e.tasksName)||"",closeTime:t(e==null?void 0:e.closeTime)||"",dueDate:t(e==null?void 0:e.dueDate)||"",descriptions:(e==null?void 0:e.descriptions)||"",tagId:((l=e==null?void 0:e.tags)==null?void 0:l.map(f=>f.id))||[],tagName:((p=(c=e==null?void 0:e.tags)==null?void 0:c[0])==null?void 0:p.tagName)||"",priority:(e==null?void 0:e.priority)||"",completionStatus:(e==null?void 0:e.completionStatus)||"pending",assignedTo:((x=e==null?void 0:e.assignedToData)==null?void 0:x.id)||"",relatedTo:((v=e==null?void 0:e.relatedToData)==null?void 0:v.id)||"",colorName:e!=null&&e.tags&&(e==null?void 0:e.tags.length)>0?e==null?void 0:e.tags[0].colorName:""},validationSchema:s==="Edit"?ha:ga,onSubmit:async(f,{setSubmitting:T})=>{var b,k,E,K,ne,re;const{colorName:j,tagName:C,closeTime:N,dueDate:g,...u}=f,h=i(g),S=i(N);if(s==="Add"){const w=await a(tt({closeTime:S,dueDate:h,...u}));(b=w==null?void 0:w.payload)!=null&&b.success?B.push(r.jsx(G,{title:"Successfully Added",type:"success",duration:2500,children:(k=w==null?void 0:w.payload)==null?void 0:k.message}),{placement:"top-end"}):B.push(r.jsx(G,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(E=w==null?void 0:w.error)==null?void 0:E.message}),{placement:"top-end"}),a(ce()),await a(Y()),await a(le())}else{const{colorName:w,closeTime:d,dueDate:X,tagName:me,...$}=f,y=await a(Me({taskId:e==null?void 0:e.id,data:{...$,closeTime:S}}));(K=y==null?void 0:y.payload)!=null&&K.success?B.push(r.jsx(G,{title:"Successfully Update",type:"success",duration:2500,children:(ne=y==null?void 0:y.payload)==null?void 0:ne.message}),{placement:"top-end"}):B.push(r.jsx(G,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(re=y==null?void 0:y.error)==null?void 0:re.message}),{placement:"top-end"}),a(ce()),await a(Y()),await a(le())}T(!1)},children:({touched:f,errors:T,setFieldValue:j,values:C})=>r.jsx(bt,{children:r.jsx(Et,{children:r.jsxs(Oe,{defaultValue:"taskDetails",children:[r.jsx(va,{children:r.jsx(xa,{value:"taskDetails",children:"Tasks details"})}),r.jsx("div",{className:"p-6",children:r.jsx(Ta,{value:"taskDetails",children:r.jsx(fa,{touched:f,errors:T,values:C,setFieldValue:j})})})]})})})})});He.displayName="TasksForm";const Be=m.forwardRef((o,n)=>{const e=A(),s=D(l=>l.crmTasks.data.selectedTask),a=D(l=>l.crmTasks.data.tasksList),{id:t}=s,i=l=>{const{name:c,birthday:p,email:x,img:v,location:f,title:T,phoneNumber:j,facebook:C,twitter:N,pinterest:g,linkedIn:u}=l,h={name:c,email:x,img:v},S={location:f,title:T,birthday:Ue(p).format("DD/MM/YYYY"),phoneNumber:j,facebook:C,twitter:N,pinterest:g,linkedIn:u};let b=W(a),k={};b=b.map(E=>(E.id===t&&(E={...E,...h},E.personalInfo={...E.personalInfo,...S},k=E),E)),Tt(k)||e(Me(k)),e(ce()),e(at(b))};return r.jsx(He,{ref:n,tasks:s,onFormSubmit:i})});Be.displayName="TasksEditContent";const Ea=({onSaveClick:o,onCancel:n})=>r.jsxs("div",{className:"text-right w-full",children:[r.jsx(de,{size:"sm",className:"mr-2",onClick:n,children:"Cancel"}),r.jsx(de,{size:"sm",variant:"solid",onClick:o,children:"Save"})]}),Da=()=>{const o=A(),n=D(t=>t.crmTasks.data.drawerOpen);D(t=>t.crmTasks.data.drawerMode),D(t=>t.crmTasks.data.selectedTask);const e=()=>{o(ce()),o(Te({}))},s=m.useRef(null),a=async()=>{var t;(t=s.current)==null||t.submitForm()};return r.jsx(vt,{isOpen:n,closable:!1,bodyClass:"p-0",footer:r.jsx(Ea,{onCancel:e,onSaveClick:a}),onClose:e,onRequestClose:e,children:r.jsx(Be,{ref:s})})},Sa=({row:o})=>{const{textTheme:n}=Ie(),e=A(),s=()=>{e(ke()),e(Te(o)),e(we("Edit"))};return r.jsx("div",{className:`${n} cursor-pointer select-none font-semibold`,onClick:s,children:"Edit"})},ba=({row:o})=>{const{textTheme:n}=Ie(),e=A(),s=async()=>{await e(Te(o)),e(fe(!0))};return r.jsx("div",{className:`${n} cursor-pointer select-none font-semibold text-red-500`,onClick:s,children:"Delete"})},Ca=()=>{const o=A(),n=D(g=>g.crmTasks.data.displayedTasksList),e=D(g=>g.crmTasks.data.loading);D(g=>g.crmTasks.data.filterData);const s=he("tasks","canDelete"),a=he("tasks","canModify"),{pageIndex:t,pageSize:i,sort:l,query:c,total:p}=D(g=>g.crmTasks.data.tableData),x=m.useCallback(()=>{o(Y())},[o]);m.useEffect(()=>{x()},[x]);const v=m.useMemo(()=>({pageIndex:t,pageSize:i,sort:l,query:c,total:p}),[t,i,l,c,p]),f=g=>{if(g){const u=new Date(g),h=String(u.getDate()).padStart(2,"0"),S=String(u.getMonth()+1).padStart(2,"0"),b=u.getFullYear(),k=String(u.getHours()).padStart(2,"0"),E=String(u.getMinutes()).padStart(2,"0");return`${h}/${S}/${b} ${k}:${E}`}else return"-"},T=m.useMemo(()=>{const g=[{header:"Tasks Name",accessorKey:"tasksName",cell:u=>{const h=u.row.original.tasksName;return r.jsx(Ce,{text:h,maxLength:20})}},{header:"Due Date",accessorKey:"dueDate",cell:u=>{var h;return f((h=u.row.original)==null?void 0:h.dueDate)}},{header:"Closing Date",accessorKey:"closeTime",cell:u=>{var h;return f((h=u.row.original)==null?void 0:h.closeTime)}},{header:"assignedTo",accessorKey:"assignedTo",cell:u=>{const{firstName:h,lastName:S}=u.row.original.assignedToData||{};return h&&S?`${h} ${S}`:"-"}},{header:"assignedBy",accessorKey:"assignedBy",cell:u=>{const{firstName:h,lastName:S}=u.row.original.assignedByData||{};return h&&S?`${h} ${S}`:"-"}},{header:"relatedTo",accessorKey:"relatedTo",cell:u=>{const{name:h,firstName:S,lastName:b}=u.row.original.relatedToData||{};return h||(S&&b?`${S} ${b}`:"-")}},{header:"Tag Name",accessorKey:"tagName",cell:u=>{const h=u.row.original.tags||[];return h.length===0?"-":r.jsx(gt,{tags:h})}},{header:"priority",accessorKey:"priority",cell:u=>{const h=u.row.original.priority;return r.jsx(be,{status:h})}},{header:"completionStatus",accessorKey:"completionStatus",cell:u=>{const h=u.row.original.completionStatus;return r.jsx(be,{status:h})}},{header:"descriptions",accessorKey:"descriptions",cell:u=>{const h=u.row.original.descriptions;return r.jsx(Ce,{text:h,maxLength:20})}}];return s&&g.unshift({header:"Delete",id:"action",cell:u=>r.jsx(ba,{row:u.row.original})}),a&&g.unshift({header:"Edit",id:"action",cell:u=>r.jsx(Sa,{row:u.row.original})}),g},[a,s]),j=g=>{const u=W(v);u.pageIndex=g,o(oe(u))},C=g=>{const u=W(v);u.pageSize=Number(g),u.pageIndex=1,o(oe(u))},N=g=>{const u=W(v);u.sort=g,o(oe(u))};return r.jsxs("div",{children:[r.jsx(ht,{columns:T,data:n,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:e,pagingData:{total:v.total,pageIndex:v.pageIndex,pageSize:v.pageSize},onPaginationChange:j,onSelectChange:C,onSort:N}),r.jsx(Da,{}),r.jsx(_t,{})]})},pe=o=>{const{icon:n,avatarClass:e,label:s,value:a,growthRate:t,loading:i}=o,l=55;return r.jsx(Vt,{bordered:!0,children:r.jsx(Ke,{loading:i,customLoader:r.jsx(It,{avatarProps:{className:"rounded",width:l,height:l}}),children:r.jsx("div",{className:"flex justify-between items-center",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Ot,{className:e,size:l,icon:n}),r.jsxs("div",{children:[r.jsx("span",{children:s}),r.jsx("h3",{children:r.jsx(Ft,{thousandSeparator:!0,displayType:"text",value:a})})]})]})})})})},ya=()=>{const o=A(),n=D(s=>s.crmTasks.data.statisticData),e=D(s=>s.crmTasks.data.statisticLoading);return m.useEffect(()=>{o(le())},[]),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[r.jsx(pe,{icon:r.jsx(ot,{}),avatarClass:"!bg-indigo-600",label:"Total Tasks",value:n==null?void 0:n.totalTasks,loading:e}),r.jsx(pe,{icon:r.jsx(lt,{}),avatarClass:"!bg-blue-500",label:"Completed Tasks",value:n==null?void 0:n.completedTasks,loading:e}),r.jsx(pe,{icon:r.jsx(ct,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Tasks",value:n==null?void 0:n.newTasks,loading:e})]})};Xe("crmTasks",nt);const ja=()=>r.jsxs(r.Fragment,{children:[r.jsx(ya,{}),r.jsxs(Je,{bodyClass:"h-full",children:[r.jsx(Lt,{}),r.jsx(Ca,{})]})]}),hr=ja;export{hr as default};
