import{a as v,r as C,j as e,ah as ye,ap as Le,as as Ne,aq as De}from"./index-349191dc.js";import{A as ve}from"./AdaptableCard-1a4629af.js";import{F as le}from"./FormDesription-3b9c3d06.js";import{C as we}from"./Card-28c96ca5.js";import{A as Se}from"./index-a4111542.js";import{M as Te}from"./MediaSkeleton-ffc14eef.js";import{u as f,g as te,t as ee,d as Ie,a as M,b as Ae,c as Fe,f as Ee,e as ke,h as ae,i as Me,s as de,j as Oe,k,l as B,m as q,n as me,r as Re}from"./index-125c1e42.js";import{o as qe,M as ze,C as Ve,N as Be,O as $e,P as We,b as Pe}from"./index.esm-cb282f8a.js";import{N as He}from"./react-number-format.es-5a2a1489.js";import{D as Ke}from"./DataTable-0bfcdf38.js";import{S as Ge}from"./StatusCapsule-52e97a8b.js";import{T as Ue}from"./TagsList-ae45dbbc.js";import{T as z}from"./TextTruncate-02b9540a.js";import{u as _}from"./checkEditUpdate-e45bc255.js";import{u as _e}from"./useThemeClass-f9532959.js";import{c as J}from"./cloneDeep-0ea42d87.js";import{t as $,N as W}from"./toast-22e26df2.js";import{C as Je}from"./ConfirmDialog-39fce23c.js";import{B as P}from"./Button-3a7fe992.js";import{D as Qe}from"./Drawer-7ce7fbf1.js";import{a as T,F as ue}from"./FormItem-ada43054.js";import{T as pe}from"./index-369a3f9a.js";import{u as Xe,b as I,F as xe,a as he}from"./formik.esm-0a2a543c.js";import{c as ge,a as R,d as Ye,e as Ze}from"./index.esm-7424d503.js";import{I as A}from"./Input-afbe9815.js";/* empty css              */import"./Alert-126231d9.js";import"./Badge-225dc15b.js";import"./RangeCalendar-816f5a4f.js";import"./index-eacc5424.js";import"./index-637053ed.js";import{D as et}from"./Dialog-a838aabb.js";import"./index-6e1d0772.js";import"./toString-35a63a87.js";import"./index-d55a343a.js";import"./index-af467029.js";import"./index-453239c5.js";import"./Pagination-23f3c5b5.js";import"./Progress-1ed9a6b3.js";import"./index-917384b7.js";import"./ScrollBar-8904d44c.js";import"./index-3cbb8aa8.js";import{S as ie}from"./Select-458bca4a.js";import"./Skeleton-f03c4bda.js";import"./index-9c7facbb.js";import"./Switcher-22f53fed.js";import"./index-47f4c906.js";import"./Tag-328b5d04.js";import"./index-7ba3168f.js";import"./index-e6396df9.js";import{T as O}from"./Tooltip-23ad192d.js";import"./Upload-65222499.js";import{t as tt}from"./tagAndCategory-228f57e7.js";import{B as at,a as st}from"./index.esm-aca805d3.js";import{G as rt}from"./index.esm-1db85578.js";import{M as ot}from"./index.esm-944ea57c.js";import{T as nt,a as it}from"./index.esm-4a90aaeb.js";import{B as ce}from"./index.esm-31ed7983.js";import{A as ct,a as lt}from"./index.esm-42f4dc22.js";import"./Views-868e2d5a.js";import"./chart.constant-23ccb1ca.js";import"./GrowShrinkTag-9d65134b.js";import"./react-tooltip.min-8a8ba578.js";import"./RichTextEditor-24216af1.js";import"./SegmentItemOption-80c4b266.js";import{S as dt}from"./StickyFooter-b1c943e1.js";import"./SvgIcon-33512ec4.js";import{G as mt}from"./index.esm-ae7ee98b.js";import{s as ut}from"./index-f015f70c.js";import{d as pt}from"./debounce-87b5e1b4.js";import"./useMergeRef-788c4cb0.js";import"./CrmService-b4c86536.js";import"./index-6e08045b.js";import"./moment-fbc5633a.js";import"./_MapCache-42d00265.js";import"./_getPrototype-b4480593.js";import"./useTimeout-347d1b2d.js";import"./CloseButton-1ed6055a.js";import"./StatusIcon-e5b5845a.js";import"./chainedFunction-070f832c.js";import"./index-0d45b98c.js";import"./index-c4329762.js";import"./useControllableState-ee8d0ef8.js";import"./isNil-56876d1f.js";import"./get-22ee623a.js";import"./_baseIsEqual-ed7cd79a.js";import"./useRootClose-dd4766ca.js";import"./usePopper-d4c6aba4.js";import"./TimeInput-9e1c7587.js";import"./useUniqueId-f14775f3.js";import"./useDidUpdate-24428a30.js";import"./useUncertainRef-623d138e.js";import"./slicedToArray-5444e40d.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-8479c0f8.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-4a1493ed.js";import"./index.esm-a1ed04fe.js";import"./index.esm-6c1eb267.js";import"./index-6e055210.js";import"./index-542dea98.js";const Z=a=>{const{icon:n,avatarClass:t,label:p,value:h,loading:i}=a,d=55;return e.jsx(we,{bordered:!0,children:e.jsx(ye,{loading:i,customLoader:e.jsx(Te,{avatarProps:{className:"rounded",width:d,height:d}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Se,{className:t,size:d,icon:n}),e.jsxs("div",{children:[e.jsx("span",{children:p}),e.jsx("h3",{children:e.jsx(He,{thousandSeparator:!0,displayType:"text",value:h})})]})]})})})})},xt=()=>{const a=v(),n=f(p=>p.crmLeads.data.statisticData),t=f(p=>p.crmLeads.data.statisticLoading);return C.useEffect(()=>{a(te())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(Z,{icon:e.jsx(qe,{}),avatarClass:"!bg-indigo-600",label:"Total Leads",value:n.totalLeads,growthRate:n==null?void 0:n.totalLeads,loading:t}),e.jsx(Z,{icon:e.jsx(ze,{}),avatarClass:"!bg-blue-500",label:"Open Leads",value:n.openLeads,growthRate:n.openLeads,loading:t}),e.jsx(Z,{icon:e.jsx(Ve,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Leads",value:n==null?void 0:n.newLeads,growthRate:n==null?void 0:n.newLeads,loading:t})]})},ht=()=>{const a=v(),n=f(i=>i.crmLeads.data.deleteConfirmation),t=f(i=>i.crmLeads.data.selectedLeads),p=()=>{a(ee(!1))},h=async()=>{var d,l,m;a(ee(!1));const i=await a(Ie(t.id));await a(M()),(d=i==null?void 0:i.payload)!=null&&d.success?$.push(e.jsx(W,{title:"Successfuly Deleted",type:"success",duration:2500,children:(l=i==null?void 0:i.payload)==null?void 0:l.message}),{placement:"top-end"}):$.push(e.jsx(W,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(m=i==null?void 0:i.error)==null?void 0:m.message}),{placement:"top-end"}),await a(M()),await a(te())};return e.jsx(Je,{isOpen:n,type:"danger",title:"Delete Lead",confirmButtonColor:"red-600",onClose:p,onRequestClose:p,onCancel:p,onConfirm:h,children:e.jsx("p",{children:"Are you sure you want to delete this Lead? All record related to this lead will be deleted as well. This action cannot be undone."})})},V=[],gt=a=>{const{touched:n,errors:t,setFieldValue:p,values:h}=a,i=v(),d=Xe(),[l,m]=C.useState(null),[D,r]=C.useState([]),x=f(s=>s.crmLeads.data.contactList);V.length=0;const j={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},u=f(s=>{var b;return(b=s.crmLeads.data.customField)==null?void 0:b.data});f(s=>s.crmLeads.data.leadsList),x==null||x.forEach(s=>{V.push({value:s==null?void 0:s.id,label:`${s==null?void 0:s.firstName} ${s==null?void 0:s.lastName}`})}),C.useEffect(()=>{const s=async()=>{var b,L;try{const{payload:N}=await i(Ee()),F=(b=N==null?void 0:N.data)==null?void 0:b.find(w=>(w==null?void 0:w.moduleName)==="leads");if(F){const{payload:w}=await i(ke({id:(L=F==null?void 0:F.id)==null?void 0:L.toString()})),o=tt(w.data);r(o)}}catch(N){console.error("Error fetching module data:",N)}};m(h.contactsDataId),s(),i(Ae()),i(Fe())},[i]),f(s=>{var b,L;return(L=(b=s.crmLeads)==null?void 0:b.data)==null?void 0:L.selectedLeads});const y=s=>{d.setFieldValue("tagId",s)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Contact Name",invalid:t.contactsDataId&&n.contactsDataId,errorMessage:t.contactsDataId,children:e.jsx(ie,{name:"contactsDataId",placeholder:"Contact Name",options:V,id:"contactsDataId",value:V.find(s=>(s==null?void 0:s.value)===(h==null?void 0:h.contactsDataId)),onChange:s=>{const b=s.value;p("email",""),p("contactNumber",""),m(b),p("contactsDataId",b)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Title*",invalid:t.title&&n.title,errorMessage:t.title,children:e.jsx(I,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:A,prefix:e.jsx(ot,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[!l&&e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Email*",invalid:t.email&&n.email,errorMessage:t.email,children:e.jsx(I,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:A,prefix:e.jsx(Be,{className:"text-xl"})})})}),!l&&e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Contact Number*",invalid:t.contactNumber&&n.contactNumber,errorMessage:t.contactNumber,children:e.jsx(I,{type:"text",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:A,prefix:e.jsx(at,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Budget",invalid:t.budget&&n.budget,errorMessage:t.budget,children:e.jsx(I,{type:"number",autoComplete:"off",name:"budget",placeholder:"Budget",component:A,prefix:e.jsx(st,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Tag",children:e.jsx(I,{isClearable:!0,isMulti:!0,type:"text",autoComplete:"off",name:"tagId",placeholder:"Select tags",component:ie,options:D,prefix:e.jsx(rt,{className:"text-xl"}),closeMenuOnSelect:!1,onChange:y})})})]}),e.jsx(T,{label:"Notes",invalid:t.notes&&n.notes,errorMessage:t.notes,children:e.jsx(I,{textArea:!0,type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:A,prefix:e.jsx(nt,{className:"text-xl"})})}),(u==null?void 0:u.length)>0?e.jsxs(e.Fragment,{children:[" ",e.jsx(le,{title:"Additional Details",desc:"",className:"mb-2"}),e.jsx("div",{style:j,children:u==null?void 0:u.map(s=>e.jsx("div",{children:e.jsx(T,{label:s==null?void 0:s.label,children:s.inputType==="textArea"?e.jsx(I,{textArea:!0,type:"text",autoComplete:"off",name:s.name,placeholder:s==null?void 0:s.label,defaultValue:s.defaultValue,component:A,prefix:e.jsx(ce,{className:"text-xl"})}):e.jsx(I,{type:s.inputType,autoComplete:"off",name:s.name,placeholder:s==null?void 0:s.label,defaultValue:s.defaultValue,component:A,prefix:e.jsx(ce,{className:"text-xl"})})})},s.id))})]}):null]})},ft=ge().shape({title:R().required("Title is required"),notes:R(),contactNumber:R().test("validateContactNumber","Invalid contact number",function(a){if(!this.parent.contactsDataId){if(!a)return this.createError({message:"Contact is required"});const t=Number(a);if(isNaN(t))return this.createError({message:"Contact must be a number"});if(a.length!==10)return this.createError({message:"Contact must have exactly 10 digits"});if(a.startsWith("0"))return this.createError({message:"Contact number cannot start with 0"})}return!0}),email:R().test("validateEmail","Invalid email",function(a){return this.parent.contactsDataId?!0:!!a||this.createError({message:"Email is required"})}),budget:Ye().test("greaterThanOne","Budget must be greater than 1",a=>a>0).required("Budget is required"),tagId:Ze(),contactsDataId:R().test("is-valid-contact","Invalid contact selected",function(a){return this.parent.contactsDataId&&this.parent.contactsDataId.length>0?!!V.find(n=>n.value===a):!0})}),{TabNav:jt,TabList:bt,TabContent:Ct}=pe,fe=C.forwardRef((a,n)=>{var m,D;const t=f(r=>r.crmLeads.data.selectedLeads),p=!!t.id,h=f(r=>{var x,j,u;return(u=(j=(x=r.crmLeads)==null?void 0:x.data)==null?void 0:j.customField)==null?void 0:u.data}),i=v(),d=async(r,x,j)=>{var s,b,L,N;const u=(s=r==null?void 0:r.payload)!=null&&s.success?x:"Something went wrong !!!",y=(b=r==null?void 0:r.payload)!=null&&b.success?(L=r==null?void 0:r.payload)==null?void 0:L.message:j;$.push(e.jsx(W,{title:u,type:(N=r==null?void 0:r.payload)!=null&&N.success?"success":"danger",duration:2500,children:y}),{placement:"top-end"})},l=async(r,{setSubmitting:x})=>{const j=h.reduce((u,y)=>(u[y.name]=r[y.name],u),{});try{const u={title:r.title,contactsDataId:r.contactsDataId,email:r.email,contactNumber:r.contactNumber,budget:r.budget.toString(),description:r.notes,tagId:r==null?void 0:r.tagId.map(w=>w.value),...j},{name:y,tagName:s,...b}=r,L=p?await i(ae({leadsId:(t==null?void 0:t.id)||"",updatedData:u})):await i(Me(u));await d(L,p?"Successfully Updated":"Successfully Added","An error occurred."),i(de()),await Promise.all([i(M()),i(te())])}catch(u){console.error("An error occurred:",u)}finally{x(!1)}};return e.jsx(xe,{innerRef:n,initialValues:{contactsDataId:t.contactsDataId||"",title:(t==null?void 0:t.title)||"",notes:(t==null?void 0:t.description)||"",tagId:((m=t==null?void 0:t.tags)==null?void 0:m.map(r=>({label:r.tagName,value:r.id})))||[],budget:(t==null?void 0:t.budget)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",email:(t==null?void 0:t.email)||"",...(D=t==null?void 0:t.leadFields)==null?void 0:D.reduce((r,x)=>{var j;return r[(j=x==null?void 0:x.customKey)==null?void 0:j.name]=x.value||"",r},{})},validationSchema:ft,onSubmit:l,children:({touched:r,errors:x,values:j,setFieldValue:u})=>e.jsx(he,{children:e.jsx(ue,{children:e.jsxs(pe,{defaultValue:"leadsInfo",children:[e.jsx(bt,{children:e.jsx(jt,{value:"leadsInfo",children:"Leads Detail"})}),e.jsx("div",{className:"p-6",children:e.jsx(Ct,{value:"leadsInfo",children:e.jsx(gt,{touched:r,errors:x,setFieldValue:u,values:j})})})]})})})})});fe.displayName="LeadsForm";const je=C.forwardRef((a,n)=>{v();const t=f(h=>{var i,d;return(d=(i=h.crmLeads)==null?void 0:i.data)==null?void 0:d.selectedLeads});f(h=>h.crmLeads.data.leadsList);const p=async h=>{};return e.jsx(fe,{ref:n,leads:t,onFormSubmit:p})});je.displayName="LeadsEditContent";const yt=({onSaveClick:a,onCancel:n})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(P,{size:"sm",className:"mr-2",onClick:n,children:"Cancel"}),e.jsx(P,{size:"sm",variant:"solid",onClick:a,children:"Save"})]}),Lt=()=>{const a=v(),n=f(m=>m.crmLeads.data.drawerOpen),[t,p]=C.useState(window.innerWidth/2),h=()=>{a(de()),a(k({}))},i=C.useRef(null),d=()=>{var m;(m=i.current)==null||m.submitForm()};C.useEffect(()=>(window.addEventListener("resize",l),a(Oe()),()=>{window.removeEventListener("resize",l)}),[]);const l=()=>{p(window.innerWidth/2)};return e.jsx(Qe,{isOpen:n,closable:!1,bodyClass:"p-0",width:t,footer:e.jsx(yt,{onCancel:h,onSaveClick:d}),onClose:h,onRequestClose:h,children:e.jsx(je,{ref:i})})},Nt=ge().shape({reason:R().required("Reason is required")}),be=C.forwardRef((a,n)=>{const t=v(),p=f(d=>{var l,m;return(m=(l=d.crmLeads)==null?void 0:l.data)==null?void 0:m.selectedLeads}),h=()=>{t(B(!1))},i=async(d,l,m,D)=>{var y,s,b;const r=await m(ae({leadsId:l==null?void 0:l.id,updatedData:{reason:d.reason,status:d.status}}));let x="",j="",u="danger";(y=r==null?void 0:r.payload)!=null&&y.success?(x="Successfully Added",j=(s=r==null?void 0:r.payload)==null?void 0:s.message,u="success"):(x="Something went wrong !!!",j=(b=r==null?void 0:r.error)==null?void 0:b.message),D.push(e.jsx(W,{title:x,type:u,duration:2500,children:j}),{placement:"top-end"}),m(B(!1)),await m(M())};return e.jsx(xe,{innerRef:n,initialValues:{reason:"",status:"closed_lost"},validationSchema:Nt,onSubmit:async(d,{setSubmitting:l})=>{await i(d,p,t,$),l(!1)},children:({touched:d,errors:l,values:m,setFieldValue:D})=>e.jsxs(he,{children:[e.jsx(ue,{children:e.jsx(T,{label:"Reason",invalid:l.reason&&d.reason,errorMessage:l.reason,children:e.jsx(I,{type:"text",autoComplete:"off",name:"reason",placeholder:"Reason",component:A,prefix:e.jsx(it,{className:"text-xl"})})})}),e.jsx(dt,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(P,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:h,children:"Cancel"}),e.jsx(P,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(ct,{}),children:"Save"})]})})]})})});be.displayName="LeadForm";const Dt=()=>{const a=v(),n=f(o=>o.crmLeads.data.displayedLeadsList),t=f(o=>o.crmLeads.data.loading),p=f(o=>o.crmLeads.data.isDialogOpen),h=f(o=>o.crmLeads.data.tableData),{pageIndex:i,pageSize:d,sort:l,query:m,total:D}=f(o=>o.crmLeads.data.tableData),r=C.useCallback(()=>{a(M())},[a]);C.useEffect(()=>(r(),()=>{window.location.pathname.includes("lead")||a(q({...h,query:""}))}),[r]);const x=C.useMemo(()=>({pageIndex:i,pageSize:d,sort:l,query:m,total:D}),[i,d,l,m,D]);f(o=>o.crmLeads.data.selectedLeads);const j=_("leads","canDelete"),u=_("leads","canModify"),y=_("leads","canView"),s=Le(),b=({row:o})=>{const c=v();_e();const g=()=>{c(me()),c(k(o))},E=async()=>{await c(k(o)),c(ee(!0))},H=()=>{c(k(o));const Q=`/app/crm/lead-details/${o.id}`;s(Q)},K=()=>{c(k(o)),c(B(!0))},G=async()=>{await c(k(o)),await U(o==null?void 0:o.id)},U=async Q=>{var re,oe,ne;const S=await c(ae({leadsId:Q,updatedData:{status:"closed_won"}}));let X="",Y="",se="danger";(re=S==null?void 0:S.payload)!=null&&re.success?(X="Successfully Added",Y=(oe=S==null?void 0:S.payload)==null?void 0:oe.message,se="success"):(X="Something went wrong !!!",Y=(ne=S==null?void 0:S.error)==null?void 0:ne.message),$.push(e.jsx(W,{title:X,type:se,duration:2500,children:Y}),{placement:"top-end"}),c(B(!1)),await c(M())};return e.jsxs("div",{className:"flex text-base items-center",children:[u&&e.jsx("button",{disabled:(o==null?void 0:o.status)!=="open",className:`circle items-center mx-1 ${(o==null?void 0:o.status)!=="open"?"!cursor-not-allowed":"cursor-pointer hover:text-indigo-500"}`,onClick:g,children:e.jsx($e,{})}),j&&e.jsx("span",{className:"cursor-pointer hover:text-red-500 circle items-center",onClick:E,children:e.jsx(We,{})}),y&&e.jsx("span",{className:"cursor-pointer hover:text-green-500 circle mx-1 items-center text-lg",onClick:H,children:e.jsx(lt,{})}),u&&e.jsx(O,{title:"Close To Won",children:e.jsx("button",{className:` circle items-center ${(o==null?void 0:o.status)!=="open"?"!cursor-not-allowed":"cursor-pointer hover:text-indigo-500"}`,disabled:(o==null?void 0:o.status)!=="open",onClick:G,children:e.jsx(mt,{})})},o.id+"won"),u&&e.jsx(O,{title:"Close To Lost",children:e.jsx("button",{className:`${(o==null?void 0:o.status)!=="open"?"!cursor-not-allowed":"cursor-pointer hover:text-orange-500"} mx-1 circle items-center `,disabled:(o==null?void 0:o.status)!=="open",onClick:K,children:e.jsx(Ne,{})})},o.id+"lost")]})},L=C.useMemo(()=>[{header:"Action",id:"action",cell:c=>e.jsx(b,{row:c.row.original})},{header:"Contact Name",accessorKey:"contactName",cell:c=>{var E,H,K,G,U;const g=(E=c.row.original)!=null&&E.contactData?((K=(H=c.row.original)==null?void 0:H.contactData)==null?void 0:K.firstName)+" "+((U=(G=c.row.original)==null?void 0:G.contactData)==null?void 0:U.lastName):"-";return e.jsx(O,{title:g,children:e.jsx(z,{text:g,maxLength:15})},g)}},{header:"Title",accessorKey:"title",cell:c=>{const g=c.row.original.title;return e.jsx(O,{title:g,children:e.jsx(z,{text:g,maxLength:20})},g)}},{header:"Budget",accessorKey:"budget",cell:c=>{const g=c.row.original;return e.jsx(z,{text:g.budget,maxLength:20})}},{header:"Status",accessorKey:"status",cell:c=>{const g=c.row.original;return e.jsx(Ge,{status:g.status})}},{header:"Tag Name",accessorKey:"tagName",cell:c=>{const g=c.row.original.tags;return g!=null&&g.length>0?e.jsx(Ue,{tags:g}):"-"}},{header:"Reason",accessorKey:"reason",cell:c=>{var E;const g=(E=c.row.original)==null?void 0:E.reason;return g?e.jsx(O,{title:g,children:e.jsx(z,{text:g,maxLength:20})},g):e.jsx(O,{title:g,children:e.jsx(z,{text:"NA",maxLength:20})},g)}}],[u,j]),N=o=>{const c=J(x);c.pageIndex=o,a(q(c))},F=o=>{const c=J(x);c.pageSize=Number(o),c.pageIndex=1,a(q(c))},w=o=>{const c=J(x);c.sort=o,a(q(c))};return e.jsxs("div",{children:[e.jsx(Ke,{columns:L,data:n,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:x.total,pageIndex:x.pageIndex,pageSize:x.pageSize},onPaginationChange:N,onSelectChange:F,onSort:w}),e.jsx(Lt,{}),e.jsx(ht,{}),e.jsxs(et,{isOpen:p,onClose:()=>a(B(!1)),children:[e.jsx("h5",{className:"mb-4",children:"Enter Reason"}),e.jsx(be,{})]})]})},Ce=C.forwardRef((a,n)=>{const{onInputChange:t}=a,p=pt(h,500);function h(d){t==null||t(d)}const i=d=>{p(d.target.value)};return e.jsx(A,{ref:n,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search by name or title",prefix:e.jsx(Pe,{className:"text-lg"}),onChange:i})});Ce.displayName="LeadsTableSearch";const vt=()=>{const a=v(),n=C.useRef(null),t=f(l=>l.crmLeads.data.tableData),p=_("leads","canCreate"),h=l=>{const m=J(t);m.query=l,m.pageIndex=1,typeof l=="string"&&l.length>1&&i(m),typeof l=="string"&&l.length===0&&i(m)},i=l=>{a(l?q(l):M())},d=()=>{a(me()),a(k({})),a(ut("Add"))};return C.useEffect(()=>{n.current&&(n.current.value=t.query||"",a(q(t)))},[t==null?void 0:t.query]),e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(Ce,{ref:n,onInputChange:h})}),e.jsx("div",{className:"mb-4",children:p&&e.jsx(P,{size:"sm",onClick:d,children:"Add New"})})]})};De("crmLeads",Re);const wt=()=>{const a=f(n=>n.crmLeads.data.tableData);return e.jsxs(e.Fragment,{children:[e.jsx(xt,{}),e.jsxs(ve,{bodyClass:"h-full",children:[e.jsx(le,{title:`Leads (${(a==null?void 0:a.total)||0})`,desc:"",className:"mb-2"}),e.jsx(vt,{}),e.jsx(Dt,{})]})]})},Cs=wt;export{Cs as default};
