import{a as q,j as e,r as f,al as me,aq as pe}from"./index-b5c96d6f.js";import{A as ue}from"./AdaptableCard-7a44f03d.js";import{F as V}from"./FormDesription-5679cf79.js";import{D as xe}from"./DataTable-81997107.js";import"./Alert-94514008.js";import"./index-bcfa2e40.js";import"./Badge-1a8ca56b.js";import{B as U}from"./Button-da51d2ac.js";import"./RangeCalendar-9a53402d.js";import"./Card-c42b1469.js";import"./index-982187c3.js";import"./index-20a15026.js";import"./Dialog-fa8d09a4.js";import{D as ge}from"./Drawer-1133a348.js";import"./index-f6e3e571.js";import{a as I,F as he}from"./FormItem-37a1eee9.js";import"./toString-7113ae37.js";import{I as F}from"./Input-caf25bb9.js";import"./index-491f8d75.js";import"./index-086985ce.js";import"./index-3e540662.js";import{t as G,N as J}from"./toast-d18b180d.js";import"./Pagination-6b86cff6.js";import"./Progress-129ff5fc.js";import"./index-cc973a23.js";import"./ScrollBar-5b47d6b7.js";import"./index-5d71cd0c.js";import{S as B}from"./Select-3ec74fb5.js";import"./Skeleton-84c1526f.js";import"./index-89155a90.js";import"./Switcher-271d4057.js";import"./index-d386bcd8.js";import{T as ee}from"./index-b228c068.js";import"./Tag-72aa2236.js";import"./index-c8d246ba.js";import"./index-f714a4bf.js";import{T as H}from"./Tooltip-997e0ead.js";import"./Upload-ed09c80a.js";import{T as fe}from"./TagsList-810ab61c.js";import{T as O}from"./TextTruncate-18129649.js";import{u as W}from"./checkEditUpdate-f02d2b7d.js";import{u as Ce}from"./useThemeClass-fc02f5de.js";import{c as Z}from"./cloneDeep-7f6fd88e.js";import{a as je}from"./index.esm-9702f6b8.js";import{N as Ne,O as be,P as ye,b as we}from"./index.esm-940af124.js";import{u as N,t as Q,d as Ie,g as P,a as te,b as ve,c as Se,e as Te,f as De,h as ae,i as se,j as Ae,k as re,l as Fe,m as Me,n as oe,s as K,o as R,p as ne,r as Ee}from"./index-b7306a89.js";import{C as $e}from"./ConfirmDialog-f08bba8c.js";import{b as D,u as ze,F as Le,a as qe}from"./formik.esm-c273ee2f.js";import{c as ke,a as v,e as _e}from"./index.esm-57a69e71.js";/* empty css              */import{T as Re,e as Oe}from"./index.esm-f5550316.js";import{B as Ve}from"./index.esm-bceff657.js";import{F as Be}from"./index.esm-bb1b8dcb.js";import{F as X}from"./index.esm-0d79c540.js";import{G as ie}from"./index.esm-d697353e.js";import{M as Ke}from"./index.esm-13d2307f.js";import{C as We}from"./react-select-creatable.esm-510760be.js";import{B as Y}from"./index.esm-77f062aa.js";import{d as Ze}from"./debounce-1246d026.js";import"./index-711951cc.js";import"./useTimeout-b86b6b88.js";import"./CloseButton-b7f862f3.js";import"./StatusIcon-e35990f8.js";import"./Views-d078b8aa.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-4f0ccac4.js";import"./_baseIsEqual-c7c4333f.js";import"./_MapCache-0312ac18.js";import"./get-c9359669.js";import"./useRootClose-982e050e.js";import"./usePopper-f50095fa.js";import"./TimeInput-60271795.js";import"./useUniqueId-cbe73990.js";import"./useDidUpdate-c567335c.js";import"./index-2eae398d.js";import"./useUncertainRef-b93ee1d7.js";import"./isNil-c0353fb3.js";import"./index-7bdb92b7.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-45d68868.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-07900fbb.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-05afbc30.js";import"./index.esm-e9e1ad9d.js";import"./moment-fbc5633a.js";import"./_getPrototype-e2865bce.js";import"./CrmService-47552c0d.js";const Pe=()=>{const o=q(),c=N(m=>m.crmContact.data.deleteConfirmation),t=N(m=>m.crmContact.data.selectedContact),i=()=>{o(Q(!1))},x=async()=>{var g,h,j;o(Q(!1));const m=await o(Ie(t==null?void 0:t.id));(g=m==null?void 0:m.payload)!=null&&g.success?G.push(e.jsx(J,{title:"Successfuly Deleted",type:"success",duration:2500,children:(h=m==null?void 0:m.payload)==null?void 0:h.message}),{placement:"top-end"}):G.push(e.jsx(J,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(j=m==null?void 0:m.error)==null?void 0:j.message}),{placement:"top-end"}),await o(P()),await o(te())};return e.jsx($e,{isOpen:c,type:"danger",title:"Delete Contact",confirmButtonColor:"red-600",onClose:i,onRequestClose:i,onCancel:i,onConfirm:x,children:e.jsx("p",{children:"Are you sure you want to delete this Contact? All record related to this contact will be deleted as well. This action cannot be undone."})})},He=({data:o,handleTagChange:c})=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(t=>e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:t.categoryName.toLowerCase().replace(/(^\w{1})|(\s{1}\w{1})/g,i=>i.toUpperCase()),children:e.jsx(D,{isClearable:!0,isMulti:!0,type:"text",autoComplete:"off",name:`tagId_${t.id}`,placeholder:`Select ${t.categoryName} tags`,component:B,options:t.tags.map(i=>({label:i.tagName,value:i.id})),prefix:e.jsx(ie,{className:"text-xl"}),closeMenuOnSelect:!1,onChange:i=>c(i,t.id)})})},t.id))}),Ue=o=>{const{touched:c,errors:t,values:i,setFieldValue:x,customFieldData:m}=o,g=q(),[h,j]=f.useState([]),[A,M]=f.useState(null);f.useState([]);const S=N(a=>{var s;return(s=a.crmContact.data)==null?void 0:s.customField});N(a=>a.crmContact.data.contactList);const E=N(a=>a.crmContact.data.companyList),$=N(a=>a.crmContact.data.sources),w=N(a=>a.crmContact.data.states);N(a=>a.crmContact.data.cities);const p=f.useMemo(()=>E==null?void 0:E.map(a=>({value:a.id,label:a.companyName})),[E]),l=f.useMemo(()=>w==null?void 0:w.map(a=>({value:a.id,label:a.stateName})),[w]),d=f.useMemo(()=>{var s;const a=w==null?void 0:w.find(n=>n.id===i.stateId);return((s=a==null?void 0:a.cities)==null?void 0:s.map(n=>({value:n.id,label:n.cityName})))||[]},[w,A]),b=f.useMemo(()=>$==null?void 0:$.map(s=>({label:s.sources,value:s.id})),[$]),z={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};f.useEffect(()=>{(async()=>{var s,n;try{const{payload:u}=await g(ae()),r=(s=u==null?void 0:u.data)==null?void 0:s.find(C=>(C==null?void 0:C.moduleName)==="contacts");if(r){const{payload:C}=await g(se({id:(n=r==null?void 0:r.id)==null?void 0:n.toString()}));j(C==null?void 0:C.data)}}catch(u){console.error("Error fetching module data:",u)}})(),g(ve()),g(Se()),g(Te()),g(De())},[g]);const T=ze(),k=async(a,s)=>{await T.setFieldValue(`tagId_${s}`,a);const n=new Set;h==null||h.forEach(r=>{if(i&&i[`tagId_${r.id}`]&&i[`tagId_${r.id}`].length){let C=[];`tagId_${s}`==`tagId_${r.id}`?C=a.map(y=>y.value):C=i[`tagId_${r.id}`].map(y=>y.value),C.forEach(y=>{n.add(y)})}});const u=[...n];T.setFieldValue("tagId",u)},_=async(a,s)=>{const n={sources:a==null?void 0:a.label};switch(s.action){case"create-option":await g(Ae(n)),await g(re());break;case"select-option":x("sourceId",a);break;case"clear":x("sourceId",null);break}};return f.useEffect(()=>{const a=new Set;h==null||h.forEach(n=>{i&&i[`tagId_${n.id}`]&&i[`tagId_${n.id}`].length&&i[`tagId_${n.id}`].map(r=>r.value).forEach(r=>{a.add(r)})});const s=[...a];T.setFieldValue("tagId",s)},[]),e.jsxs(e.Fragment,{children:[e.jsx(V,{title:"Contact Basic Information",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"First Name *",invalid:t.firstName&&c.firstName,errorMessage:t.firstName,children:e.jsx(D,{type:"text",autoComplete:"off",name:"firstName",placeholder:"First Name",component:F,prefix:e.jsx(X,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Last Name *",invalid:t.lastName&&c.lastName,errorMessage:t.lastName,children:e.jsx(D,{type:"text",autoComplete:"off",name:"lastName",placeholder:"Last Name",component:F,prefix:e.jsx(X,{className:"text-xl"})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Email *",invalid:t.email&&c.email,errorMessage:t.email,children:e.jsx(D,{type:"text",autoComplete:"off",name:"email",placeholder:"Email",component:F,prefix:e.jsx(Ne,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Contact Number *",invalid:t.contactNumber&&c.contactNumber,errorMessage:t.contactNumber,children:e.jsx(D,{type:"tel",autoComplete:"off",name:"contactNumber",placeholder:"Contact Number",component:F,prefix:e.jsx(Ve,{className:"text-xl"})})})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Title",invalid:t.title&&c.title,errorMessage:t.title,children:e.jsx(D,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:F,prefix:e.jsx(Ke,{className:"text-xl"})})})})}),e.jsx(I,{label:"Notes",invalid:t.description&&c.description,errorMessage:t.description,children:e.jsx(D,{textArea:!0,type:"text",autoComplete:"off",name:"description",placeholder:"Notes",component:F,prefix:e.jsx(Re,{className:"text-xl"})})}),e.jsx(V,{title:"Address",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Address",invalid:t.address&&c.address,errorMessage:t.address,children:e.jsx(D,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:F,prefix:e.jsx(Be,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"State",invalid:t.stateId&&c.stateId,errorMessage:t.stateId,children:e.jsx(B,{name:"stateId",placeholder:"Select State",options:l,id:"stateId",value:l==null?void 0:l.find(a=>(a==null?void 0:a.value)==(i==null?void 0:i.stateId)),onChange:a=>{const s=a.value;i.stateId!==s&&x("cityId",""),x("stateId",s||""),M(s)}})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"City",invalid:t.cityId&&c.cityId,errorMessage:t.cityId,children:e.jsx(B,{name:"cityId",placeholder:"Select City",options:d,id:"cityId",value:(d==null?void 0:d.find(a=>(a==null?void 0:a.value)===(i==null?void 0:i.cityId)))||{value:"",label:"Select City"},onChange:a=>{const s=a.value;s!==i.cityId&&x("cityId",s||"")}})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{style:{position:"relative"},children:e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"ZipCode",invalid:t.zipcode&&c.zipcode,errorMessage:t.zipcode,children:e.jsx(D,{type:"text",autoComplete:"off",name:"zipcode",placeholder:"ZipCode",component:F,prefix:e.jsx(Oe,{className:"text-xl"})})})})})})]}),e.jsx(V,{title:"Contact Others Details",desc:"",className:"mb-2"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Company Name",invalid:t.companiesId&&c.companiesId,errorMessage:t.companiesId,children:e.jsx(B,{name:"companiesId",placeholder:"Company Name",options:p,id:"companiesId",value:p==null?void 0:p.find(a=>(a==null?void 0:a.value)==(i==null?void 0:i.companiesId)),onChange:a=>{const s=a.value;x("companiesId",s||"")}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{label:"Source",invalid:t.source&&c.source,errorMessage:t.source,children:e.jsx(D,{isClearable:!0,type:"text",autoComplete:"off",name:"sourceId",placeholder:"Source",component:B,componentAs:We,options:b,prefix:e.jsx(ie,{className:"text-xl"}),onChange:_})})})]}),e.jsx(He,{data:h,handleTagChange:k}),(S==null?void 0:S.length)>0?e.jsxs(e.Fragment,{children:[e.jsx(V,{title:"Additional Details",desc:"",className:"mb-2"}),e.jsx("div",{style:z,children:S==null?void 0:S.map(a=>e.jsx("div",{children:e.jsx(I,{label:a==null?void 0:a.label,children:a.inputType==="textArea"?e.jsx(D,{textArea:!0,type:"text",autoComplete:"off",name:a.name,placeholder:a==null?void 0:a.label,defaultValue:a==null?void 0:a.defaultValue,component:F,prefix:e.jsx(Y,{className:"text-xl"})}):e.jsx(D,{type:a.inputType,autoComplete:"off",name:a.name,placeholder:a==null?void 0:a.label,defaultValue:a==null?void 0:a.defaultValue,component:F,prefix:e.jsx(Y,{className:"text-xl"})})})},a.id))})]}):null]})},Ge=ke().shape({firstName:v().required("First Name is required"),lastName:v().required("Last Name is required"),title:v(),contactNumber:v().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",o=>!isNaN(o)).test("is-ten-digits","Contact must be exactly 10 digits",o=>{if(o){const c=Number(o);return/^\d{10}$/.test(c.toString())}return!0}).test("is-ten-digits","Contact number cannot start with 0",o=>o?!o.startsWith("0"):!0),email:v().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),address:v(),stateId:v(),cityId:v(),zipcode:v().test("is-number","ZipCode must be a number",o=>!(o&&isNaN(Number(o)))).test("is-six-digits","ZipCode must be exactly 6 digits",o=>!(o&&o.length!==6)),companiesId:v().nullable(),companyName:v(),source:v().nullable(),description:v(),tagId:_e()}),{TabNav:Je,TabList:Qe,TabContent:Xe}=ee,ce=f.forwardRef((o,c)=>{var M,S,E,$,w;const t=N(p=>{var l,d;return(d=(l=p.crmContact)==null?void 0:l.data)==null?void 0:d.selectedContact});(M=t==null?void 0:t.tags)==null||M.reduce((p,l)=>(p[`tagId_${l.id}`]=[],p),{});const i=f.useMemo(()=>{var p;return(p=t==null?void 0:t.tags)==null?void 0:p.reduce((l,d)=>{const b=d.tagCategoryId;return l[`tagId_${b}`]||(l[`tagId_${b}`]=[]),l[`tagId_${b}`].push({label:d.tagName,value:d.id}),l},{})},[t.tags]),x=N(p=>{var l;return(l=p.crmContact.data)==null?void 0:l.customField}),m=N(p=>{var l,d;return(d=(l=p.crmContact)==null?void 0:l.data)==null?void 0:d.sources}),g=f.useMemo(()=>m.map(l=>({label:l.sources,value:l.id})),[m]),h=!!t.id,j=q(),A=f.useMemo(()=>x==null?void 0:x.reduce((l,d)=>{var z;const b=(z=t==null?void 0:t.contactFields)==null?void 0:z.find(T=>(T==null?void 0:T.name)===(d==null?void 0:d.name));return l[d==null?void 0:d.name]=b?b==null?void 0:b.value:d!=null&&d.defaultValue?d==null?void 0:d.defaultValue:"",l},{}),[x]);return e.jsx(Le,{innerRef:c,initialValues:{firstName:(t==null?void 0:t.firstName)||"",lastName:(t==null?void 0:t.lastName)||"",title:(t==null?void 0:t.title)||"",email:(t==null?void 0:t.email)||"",contactNumber:(t==null?void 0:t.contactNumber)||"",description:(t==null?void 0:t.description)||"",companyName:((S=t==null?void 0:t.company)==null?void 0:S.companyName)||"",sourceId:t!=null&&t.sourceId?g.find(p=>p.value===(t==null?void 0:t.sourceId)):null,address:(t==null?void 0:t.address)||"",stateId:(t==null?void 0:t.stateId)||"",cityId:(t==null?void 0:t.cityId)||"",zipcode:(t==null?void 0:t.zipcode)||"",tagName:(($=(E=t==null?void 0:t.tags)==null?void 0:E[0])==null?void 0:$.tagName)||"",tagId:((w=t==null?void 0:t.tags)==null?void 0:w.map(p=>({label:p.tagName,value:p.id})))||[],companiesId:(t==null?void 0:t.companiesId)||"",...A,...i},validationSchema:Ge,onSubmit:async(p,{setSubmitting:l})=>{var d,b,z,T,k,_,a;try{const{tagName:s,...n}=p,u={...n,sourceId:(d=n==null?void 0:n.sourceId)==null?void 0:d.value,tagId:n==null?void 0:n.tagId},r=h?await j(Fe({contactId:(t==null?void 0:t.id)||"",updatedData:u})):await j(Me(u)),C=(b=r==null?void 0:r.payload)!=null&&b.success?"Successfully Added":"Something went wrong !!!",y=(z=r==null?void 0:r.payload)!=null&&z.success?"success":"danger",L=(T=r==null?void 0:r.payload)!=null&&T.success?(k=r==null?void 0:r.payload)==null?void 0:k.message:(_=r==null?void 0:r.error)==null?void 0:_.message;G.push(e.jsx(J,{title:C,type:y,duration:2500,children:L}),{placement:"top-end"}),(a=r==null?void 0:r.payload)!=null&&a.success&&j(oe()),await j(P()),await j(te())}catch(s){console.error(s)}finally{l(!1)}},children:({touched:p,errors:l,values:d,setFieldValue:b})=>e.jsx(qe,{children:e.jsx(he,{children:e.jsxs(ee,{defaultValue:"personalInfo",children:[e.jsx(Qe,{children:e.jsx(Je,{value:"personalInfo",children:"Contact Details"})}),e.jsx("div",{className:"p-6",children:e.jsx(Xe,{value:"personalInfo",children:e.jsx(Ue,{touched:p,errors:l,values:d,setFieldValue:b})})})]})})})})});ce.displayName="ContactForm";const le=f.forwardRef((o,c)=>{q();const t=N(x=>{var m,g;return(g=(m=x.crmContact)==null?void 0:m.data)==null?void 0:g.selectedContact});N(x=>x.crmContact.data.contactList);const i=async x=>{};return e.jsx(ce,{ref:c,contact:t,onFormSubmit:i})});le.displayName="ContactEditContent";const Ye=({onSaveClick:o,onCancel:c})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(U,{size:"sm",className:"mr-2",onClick:c,children:"Cancel"}),e.jsx(U,{size:"sm",variant:"solid",onClick:o,children:"Save"})]}),et=()=>{const o=q(),[c,t]=f.useState(window.innerWidth/2),i=N(j=>{var A,M;return(M=(A=j.crmContact)==null?void 0:A.data)==null?void 0:M.drawerOpen}),x=()=>{o(oe()),o(K({}))},m=f.useRef(null),g=()=>{var j,A;console.log("formSubmit function called",(j=m.current)==null?void 0:j.values),(A=m.current)==null||A.submitForm()},h=()=>{t(window.innerWidth/2)};return f.useEffect(()=>(window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}),[]),e.jsx(ge,{isOpen:i,closable:!1,bodyClass:"p-0",width:c,footer:e.jsx(Ye,{onCancel:x,onSaveClick:g}),onClose:x,onRequestClose:x,children:e.jsx(le,{ref:m})})},tt=()=>{const o=q(),[c,t]=f.useState([]),i=N(a=>a.crmContact.data.displayedContactList),x=N(a=>a.crmContact.data.tableData),m=W("contacts","canModify"),g=W("contacts","canDelete"),h=W("contacts","canView"),j=N(a=>a.crmContact.data.loading),A=me(),{pageIndex:M,pageSize:S,sort:E,query:$,total:w}=N(a=>a.crmContact.data.tableData),p=f.useCallback(()=>{b(),o(P()),o(re())},[o]);f.useEffect(()=>(p(),()=>{window.location.pathname.includes("contact")||o(R({...x,query:""}))}),[]);const l=f.useMemo(()=>({pageIndex:M,pageSize:S,sort:E,query:$,total:w}),[M,S,E,$,w]),d=({row:a})=>{const s=q();Ce();const n=()=>{s(ne()),s(K(a))},u=async()=>{s(K(a)),s(Q(!0))},r=()=>{s(K(a));const C=`/app/crm/contact-details/${a.id}`;A(C)};return e.jsxs("div",{className:"flex text-base items-center",children:[m&&e.jsx("span",{className:"cursor-pointer hover:text-indigo-500 circle items-center",onClick:n,children:e.jsx(be,{})}),g&&e.jsx("span",{className:"cursor-pointer hover:text-red-500 circle mx-1 items-center",onClick:u,children:e.jsx(ye,{})}),h&&e.jsx("span",{className:"cursor-pointer hover:text-green-500 circle items-center text-lg",onClick:r,children:e.jsx(je,{})})]})},b=async()=>{var a,s;try{const{payload:n}=await o(ae()),u=(a=n==null?void 0:n.data)==null?void 0:a.find(r=>(r==null?void 0:r.moduleName)==="contacts");if(u){const{payload:r}=await o(se({id:(s=u==null?void 0:u.id)==null?void 0:s.toString()}));t(r==null?void 0:r.data)}}catch(n){console.error("Error fetching module data:",n)}},z=f.useMemo(()=>{const a=[{header:"Action",id:"action",cell:s=>e.jsx(d,{row:s.row.original})},{header:"Name",accessorKey:"firstName",cell:s=>{const{firstName:n,lastName:u}=s.row.original,r=`${n} ${u}`;return e.jsx(H,{title:r,children:e.jsx(O,{text:r,maxLength:15})},r)}},{header:"email",accessorKey:"email",cell:s=>s.row.original.email},{header:"Number",accessorKey:"contactNumber",cell:s=>s.row.original.contactNumber},{header:"source",accessorKey:"sourceId",cell:s=>{var u,r,C,y;const n=(r=(u=s.row.original)==null?void 0:u.source)!=null&&r.sources?(y=(C=s.row.original)==null?void 0:C.source)==null?void 0:y.sources:"-";return e.jsx(O,{text:n,maxLength:15})}},{header:"Title",accessorKey:"title",cell:s=>{const n=s.row.original.title?s.row.original.title:"-";return e.jsx(H,{title:n,children:e.jsx(O,{text:n,maxLength:15})},n)}},{header:"Company",accessorKey:"companyName",cell:s=>{const n=s.row.original.company?s.row.original.company.companyName:"-";return e.jsx(O,{text:n,maxLength:15})}},{header:"Address",accessorKey:"address",cell:s=>{const{address:n,cityData:u,stateData:r,zipcode:C}=s.row.original,y=[n,u==null?void 0:u.cityName,r==null?void 0:r.stateName,C].filter(L=>L!=null).join(" ");return e.jsx(H,{title:y||"-",children:e.jsx(O,{text:y||"-",maxLength:20})},y)}}];return c.map((s,n)=>{const u={header:s.categoryName,id:s.id,accessorKey:"tagCategory.categoryName",cell:r=>{var y;const C=(y=r.row.original.tags)==null?void 0:y.filter(L=>(L==null?void 0:L.tagCategoryId)===s.id);return C&&C.length?e.jsx(fe,{tags:C}):"-"}};a.splice(n+6,0,u)}),a},[m,g,c]),T=a=>{const s=Z(l);s.pageIndex=a,o(R(s))},k=a=>{const s=Z(l);s.pageSize=Number(a),s.pageIndex=1,o(R(s))},_=a=>{const s=Z(l);s.sort=a,o(R(s))};return e.jsxs("div",{children:[e.jsx(xe,{columns:z,data:i,loading:j,pagingData:{total:l.total,pageIndex:l.pageIndex,pageSize:l.pageSize},onPaginationChange:T,onSelectChange:k,onSort:_}),e.jsx(et,{}),e.jsx(Pe,{})]})},de=f.forwardRef((o,c)=>{const{onInputChange:t}=o,i=Ze(x,500);function x(g){t==null||t(g)}const m=g=>{i(g.target.value)};return e.jsx(F,{ref:c,className:"max-w-md md:w-56 mb-4",size:"sm",placeholder:"Search by name or email",prefix:e.jsx(we,{className:"text-lg"}),onChange:m})});de.displayName="ContactTableSearch";const at=()=>{const o=q(),c=f.useRef(null),t=N(h=>h.crmContact.data.tableData),i=W("contacts","canCreate"),x=h=>{const j=Z(t);j.query=h,j.pageIndex=1,typeof h=="string"&&h.length>1&&m(j),typeof h=="string"&&h.length===0&&m(j)},m=h=>{o(h?R(h):P())},g=()=>{o(ne()),o(K({}))};return f.useEffect(()=>{c.current&&(c.current.value=t.query||"",o(R(t)))},[t==null?void 0:t.query]),e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(de,{ref:c,onInputChange:x})}),e.jsx("div",{className:"mb-4",children:i&&e.jsx(U,{size:"sm",onClick:g,children:"Add New"})})]})};pe("crmContact",Ee);const st=()=>{const o=N(c=>c.crmContact.data.tableData);return e.jsx(e.Fragment,{children:e.jsxs(ue,{bodyClass:"h-full",children:[e.jsx(V,{title:`Contacts (${(o==null?void 0:o.total)||0})`,desc:"",className:"mb-2"}),e.jsx(at,{}),e.jsx(tt,{})]})})},_a=st;export{_a as default};
