import{a as V,r as n,j as t}from"./index-a75c2214.js";import{T as $}from"./index-1e228cad.js";import{a as l,F as R}from"./FormItem-e7510cc7.js";import{u as U,b as d,F as _,a as z}from"./formik.esm-3c1d58de.js";import{c as G,a as N,f as J,b as K}from"./index.esm-c3869bde.js";import{u as B,D as Q,A as W,j as X,k as Y,t as Z,c as ee,l as te,s as L,g as E,e as H,m as ae}from"./AdditionalTag-9ab7e90c.js";import{t as v,N as S}from"./toast-9ba48d0f.js";import{I as g}from"./Input-8164dacf.js";import{a6 as se,ab as oe,a7 as ie}from"./index.esm-ba9f59e9.js";import{A as ne}from"./index.esm-29ce9f56.js";import{a as re,T as le,b as de}from"./index.esm-f6b05d17.js";/* empty css              */const ce=c=>{const{touched:o,errors:e}=c,x=V(),[s,u]=n.useState(!1);n.useState("#808080");const[F,h]=n.useState(!1),[i,f]=n.useState([]),[M,k]=n.useState([]),b=()=>{u(!s),h(!1)},[D,I]=n.useState("");n.useEffect(()=>{(async()=>{var T,q;try{const{payload:m}=await x(X());console.log(m,"send Me The Id And The Payload");const C=(T=m==null?void 0:m.data)==null?void 0:T.find(p=>(p==null?void 0:p.moduleName)==="clients");if(I(C.id),C){const{payload:p}=await x(Y({id:(q=C==null?void 0:C.id)==null?void 0:q.toString()})),O=Z(p.data),P=ee(p.data);k(P),f(O)}}catch(m){console.error("Error fetching module data:",m)}})()},[x]);const y=B(r=>r.crmCustomers.data.selectedCustomer),[A,w]=n.useState(y?y.tags||[]:[]),j=U(),a=r=>{console.log(r),w(r);const T=[r.value];j.setFieldValue("tagId",T)};return t.jsxs(t.Fragment,{children:[t.jsx(l,{label:"Client Name",invalid:e.clientName&&o.clientName,errorMessage:e.clientName,children:t.jsx(d,{type:"text",autoComplete:"off",name:"clientName",placeholder:"Client Name",component:g,prefix:t.jsx(se,{className:"text-xl"})})}),t.jsx(l,{label:"Contact Number",invalid:e.contactInfo&&o.contactInfo,errorMessage:e.contactInfo,children:t.jsx(d,{type:"text",autoComplete:"off",name:"contactInfo",placeholder:"Contact Number",component:g,prefix:t.jsx(oe,{className:"text-xl"})})}),t.jsx(l,{label:"Address",invalid:e.address&&o.address,errorMessage:e.address,children:t.jsx(d,{type:"text",autoComplete:"off",name:"address",placeholder:"Address",component:g,prefix:t.jsx(ie,{className:"text-xl"})})}),t.jsx(l,{label:"Billing Details",invalid:e.billingDetails&&o.billingDetails,errorMessage:e.billingDetails,children:t.jsx(d,{type:"text",autoComplete:"off",name:"billingDetails",placeholder:"Billing Details",component:g,prefix:t.jsx(re,{className:"text-xl"})})}),t.jsxs("div",{style:{position:"relative"},children:[t.jsx(l,{label:"Tags",invalid:e.history&&o.history,errorMessage:e.history,children:t.jsxs("div",{style:{position:"relative"},children:[t.jsx(d,{name:"Tag",component:Q,options:i,placeholder:"Select a Tag",value:j.initialValues.tagName,onChange:a}),t.jsx(le,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{b(),h(!0)}})]})}),t.jsx(W,{isOpen:s,moduleName:D,categoryList:M,onOpenChange:r=>u(r)})]}),t.jsx(l,{label:"History",invalid:e.history&&o.history,errorMessage:e.history,children:t.jsx(d,{type:"text",autoComplete:"off",name:"history",placeholder:"History",component:g,prefix:t.jsx(ne,{className:"text-xl"})})}),t.jsx(l,{label:"Notes",invalid:e.notes&&o.notes,errorMessage:e.notes,children:t.jsx(d,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:g,prefix:t.jsx(de,{className:"text-xl"})})})]})},me=G().shape({clientName:N().required("Customer Name is required"),contactInfo:J().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",c=>!isNaN(c)).test("is-ten-digits","Contact must be exactly 10 digits",c=>/^\d{10}$/.test(c)),address:N().required("Address is required"),billingDetails:N().required("Billing Details is required"),history:N(),notes:N(),tagId:K()}),{TabNav:pe,TabList:ge,TabContent:xe}=$,ue=n.forwardRef((c,o)=>{var u,F,h;const e=B(i=>i.crmCustomers.data.selectedCustomer),x=!!e.id,s=V();return t.jsx(_,{innerRef:o,initialValues:{clientName:(e==null?void 0:e.clientName)||"",contactInfo:(e==null?void 0:e.contactInfo)||"",address:(e==null?void 0:e.address)||"",billingDetails:(e==null?void 0:e.billingDetails)||"",history:(e==null?void 0:e.history)||"",notes:(e==null?void 0:e.notes)||"",tagName:((F=(u=e==null?void 0:e.tags)==null?void 0:u[0])==null?void 0:F.tagName)||"",tagId:((h=e==null?void 0:e.tags)==null?void 0:h.map(i=>i.id))||[],colorName:e!=null&&e.tags&&(e==null?void 0:e.tags.length)>0?e==null?void 0:e.tags[0].colorName:""},validationSchema:me,onSubmit:async(i,{setSubmitting:f})=>{var D,I,y,A,w,j;const{colorName:M,tagName:k,...b}=i;if(x){const a=await s(te({customerId:(e==null?void 0:e.id)||"",updatedData:b}));(D=a==null?void 0:a.payload)!=null&&D.success?v.push(t.jsx(S,{title:"Successfully Added",type:"success",duration:2500,children:(I=a==null?void 0:a.payload)==null?void 0:I.message}),{placement:"top-end"}):v.push(t.jsx(S,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(y=a==null?void 0:a.error)==null?void 0:y.message}),{placement:"top-end"}),s(L()),await s(E()),await s(H())}else{const a=await s(ae(b));(A=a==null?void 0:a.payload)!=null&&A.success?v.push(t.jsx(S,{title:"Successfully Added",type:"success",duration:2500,children:(w=a==null?void 0:a.payload)==null?void 0:w.message}),{placement:"top-end"}):v.push(t.jsx(S,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(j=a==null?void 0:a.error)==null?void 0:j.message}),{placement:"top-end"}),await s(E()),await s(L()),await s(H())}f(!1)},children:({touched:i,errors:f})=>t.jsx(z,{children:t.jsx(R,{children:t.jsxs($,{defaultValue:"customerInfo",children:[t.jsx(ge,{children:t.jsx(pe,{value:"customerInfo",children:"Client Details"})}),t.jsx("div",{className:"p-6",children:t.jsx(xe,{value:"customerInfo",children:t.jsx(ce,{touched:i,errors:f})})})]})})})})});ue.displayName="CustomerForm";export{ue as C};
