import{a as L,r as p,j as e,ai as de,ar as me}from"./index-2a02f09f.js";import{A as pe}from"./AdaptableCard-260ffff4.js";import{D as ue}from"./DataTable-76c04f2c.js";import{u as g,g as xe,f as he,a as ge,e as fe,b as w,s as N,c as je,d as G,t as W,h as be,i as V,j as Y,k as Ce,l as Z,r as we}from"./index-2b0ac188.js";import{u as ee}from"./useThemeClass-d3572517.js";import{B as H}from"./Button-3d6c325f.js";import{D as Le}from"./Drawer-aa907a2f.js";import{T as te}from"./index-bb34e564.js";import{a as y,F as ye}from"./FormItem-c05bb264.js";import{u as ve,b as v,F as De,a as Ne}from"./formik.esm-dba0dfcc.js";import{c as Se,a as B,b as ke}from"./index.esm-d97e517c.js";import{I as S}from"./Input-4032ba6b.js";import{A as ae}from"./index-5ca6dc5a.js";import{U as Te}from"./Upload-21ca1a8f.js";import{I as Ie,a7 as Fe,a6 as Ae,a8 as J,d as Re,a9 as Oe,r as Ee,z as Me,B as Ue}from"./index.esm-c61f0406.js";import{D as P,A as ze,t as Be,c as Ve}from"./AdditionalTag-4259bcb6.js";/* empty css              */import{T as He}from"./index.esm-9f9c71ef.js";import{B as qe,a as Pe,b as $e,c as Ke}from"./index.esm-c0bac851.js";import{t as R,N as O}from"./toast-66eca971.js";import{c as U}from"./cloneDeep-f2fd7982.js";import{u as _}from"./checkEditUpdate-064a00c7.js";import{T as We}from"./TagsList-da492de3.js";import{C as _e}from"./ConfirmDialog-5e3e2ca4.js";import{T as $}from"./TextTruncate-a26d8bdc.js";import{C as Ge}from"./Card-de52f0bd.js";import{M as Je}from"./MediaSkeleton-930d3682.js";import{N as Qe}from"./react-number-format.es-b6150c61.js";import{d as Xe}from"./debounce-58c5e337.js";import{S as Ye,c as Ze}from"./Select-e6a28a89.js";import{B as se}from"./Badge-ed31d9ee.js";import{g as et}from"./index-62e98478.js";import{s as tt}from"./index-ffc0a460.js";import"./index-ff9062dc.js";import"./index.esm-4f607dea.js";import"./Pagination-45470020.js";import"./index-33716023.js";import"./_Uint8Array-49dd6612.js";import"./_MapCache-dabc1c97.js";import"./Views-597fd265.js";import"./_baseIsEqual-d37b49c3.js";import"./get-c92f924e.js";import"./toString-8660963f.js";import"./TableRowSkeleton-f01debf2.js";import"./Skeleton-a1c6070d.js";import"./index-be1c4c56.js";import"./CrmService-dd365f26.js";import"./context-ccc0a902.js";import"./index-02c6e7a7.js";import"./CloseButton-1ba6d0ce.js";import"./useControllableState-1afbd3cb.js";import"./index-30fffd86.js";import"./isNil-68e69365.js";import"./useMergeRef-788c4cb0.js";import"./Tooltip-7716d794.js";import"./usePopper-1bbb94fb.js";import"./index.esm-62b86c40.js";import"./Alert-72ccf787.js";import"./useTimeout-90c2003f.js";import"./StatusIcon-19ebbef4.js";import"./Calendar-10f7bbb4.js";import"./index-cd684465.js";import"./useRootClose-245ef2ef.js";import"./RangeCalendar-f83aa7d5.js";import"./TimeInput-5e6b4bd8.js";import"./useUniqueId-5771e452.js";import"./useDidUpdate-63a48c56.js";import"./Dialog-fa942d86.js";import"./index-7d1fc360.js";import"./useUncertainRef-cde3ec19.js";import"./chainedFunction-070f832c.js";import"./index-39ff14cb.js";import"./index-09081188.js";import"./index-7060438e.js";import"./Progress-225a8f75.js";import"./index-9590e8bb.js";import"./ScrollBar-5f7786c3.js";import"./index-9436b2c1.js";import"./index-94a50ac5.js";import"./mapCloneElement-80af996d.js";import"./Switcher-b6d1bfff.js";import"./Tag-592deaaf.js";import"./index-292be09a.js";import"./index-da0bddc3.js";import"./_getPrototype-63f10215.js";import"./toConsumableArray-648e2274.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";import"./index-9626ba0d.js";import"./index-54e54528.js";const at=s=>{const{touched:a,errors:t}=s,o=L(),n=ve(),[r,l]=p.useState(!1),[C,c]=p.useState(!1),[u,f]=p.useState([]),[k,E]=p.useState([]),z=()=>{l(!r),c(!1)},D=["active","deactive"],[T,I]=p.useState([]);p.useEffect(()=>{(async()=>{try{const{payload:h}=await o(xe()),F=h.data.map(b=>({value:b.id,label:b.name}));I(F)}catch(h){console.error(h)}})()},[o]);const[d,i]=p.useState("");p.useEffect(()=>{(async()=>{var h,F;try{const{payload:b}=await o(he()),M=(h=b==null?void 0:b.data)==null?void 0:h.find(A=>(A==null?void 0:A.moduleName)==="leads");if(i(M.id),M){const{payload:A}=await o(ge({id:(F=M==null?void 0:M.id)==null?void 0:F.toString()})),le=Be(A.data),ce=Ve(A.data);E(ce),f(le)}}catch(b){console.error("Error fetching module data:",b)}})()},[o]);const j=g(x=>x.crmLeads.data.selectedLeads),[q,m]=p.useState(j?j.tags||[]:[]),ie=x=>{m(x);const h=[x.value];n.setFieldValue("tagId",h)};return e.jsxs(e.Fragment,{children:[e.jsx(y,{invalid:t.upload&&a.upload,errorMessage:t.upload,children:e.jsx(v,{name:"img",children:({field:x,form:h})=>{const F=x.value?{src:x.value}:{};return e.jsx("div",{className:"flex justify-center",children:e.jsx(Te,{className:"cursor-pointer",showList:!1,uploadLimit:1,onChange:b=>h.setFieldValue(x.name,URL.createObjectURL(b[0])),onFileRemove:b=>h.setFieldValue(x.name,URL.createObjectURL(b[0])),children:e.jsx(ae,{className:"border-2 border-white dark:border-gray-800 shadow-lg",size:100,shape:"circle",icon:e.jsx(Ie,{}),...F})})})}})}),e.jsx(y,{label:"Contact Name",children:e.jsx(v,{autoComplete:"off",name:"contactsDataId",placeholder:"Contact Name",options:T,id:"contactsDataId",value:n.initialValues.name,component:P,prefix:e.jsx(Fe,{className:"text-xl"}),onChange:x=>{const h=x.value;n.setFieldValue("contactsDataId",h)}})}),e.jsx(y,{label:"Details",invalid:t.details&&a.details,errorMessage:t.details,children:e.jsx(v,{type:"text",autoComplete:"off",name:"details",placeholder:"Details",component:S,prefix:e.jsx(Ae,{className:"text-xl"})})}),e.jsx(y,{label:"Status",invalid:t.status&&a.status,errorMessage:t.status,children:e.jsx(v,{type:"text",autoComplete:"off",name:"status",placeholder:"Status",component:P,options:D,id:"status",value:n.initialValues.status,prefix:e.jsx(J,{className:"text-xl"}),onChange:x=>{const h=x.value;n.setFieldValue("status",h)}})}),e.jsx(y,{label:"notes",invalid:t.notes&&a.notes,errorMessage:t.notes,children:e.jsx(v,{type:"text",autoComplete:"off",name:"notes",placeholder:"Notes",component:S,prefix:e.jsx(J,{className:"text-xl"})})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(y,{label:"Tag",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(v,{name:"Tag",component:P,value:n.initialValues.tagName,options:u,placeholder:"Select a Tag",onChange:ie}),e.jsx(He,{style:{position:"absolute",right:"10px",top:"10px",border:"none",background:"#FFF"},className:"text-xl",onClick:()=>{z(),c(!0)}})]})}),e.jsx(ze,{isOpen:r,categoryList:k,moduleName:d,onOpenChange:x=>l(x)})]})]})},st=s=>{const{touched:a,errors:t}=s;return e.jsxs(e.Fragment,{children:[e.jsx(y,{label:"Facebook link",invalid:t.facebook&&a.facebook,errorMessage:t.facebook,children:e.jsx(v,{type:"text",autoComplete:"off",name:"facebook",placeholder:"URL",component:S,prefix:e.jsx(qe,{className:"text-xl text-[#1773ea]"})})}),e.jsx(y,{label:"Twitter link",invalid:t.twitter&&a.twitter,errorMessage:t.twitter,children:e.jsx(v,{type:"text",autoComplete:"off",name:"twitter",placeholder:"URL",component:S,prefix:e.jsx(Pe,{className:"text-xl text-[#1da1f3]"})})}),e.jsx(y,{label:"Pinterest link",invalid:t.pinterest&&a.pinterest,errorMessage:t.pinterest,children:e.jsx(v,{type:"text",autoComplete:"off",name:"pinterest",placeholder:"URL",component:S,prefix:e.jsx($e,{className:"text-xl text-[#df0018]"})})}),e.jsx(y,{label:"LinkedIn link",invalid:t.linkedIn&&a.linkedIn,errorMessage:t.linkedIn,children:e.jsx(v,{type:"text",autoComplete:"off",name:"linkedIn",placeholder:"URL",component:S,prefix:e.jsx(Ke,{className:"text-xl text-[#0077b5]"})})})]})},ot=Se().shape({details:B().required("Details are required"),status:B().required("Status is required"),contactsDataId:B(),notes:B(),tagId:ke()}),{TabNav:rt,TabList:nt,TabContent:Q}=te,oe=p.forwardRef((s,a)=>{var r,l,C,c;const t=g(u=>u.crmLeads.data.selectedLeads),o=!!t.id;console.log(o,"Editing Done");const n=L();return e.jsx(De,{innerRef:a,initialValues:{contactsDataId:t.contactsDataId||null,details:(t==null?void 0:t.details)||"",status:(t==null?void 0:t.status)||"",notes:(t==null?void 0:t.notes)||"",tagName:((l=(r=t==null?void 0:t.tags)==null?void 0:r[0])==null?void 0:l.tagName)||"",name:((C=t==null?void 0:t.contactData)==null?void 0:C.name)||"",tagId:((c=t==null?void 0:t.tags)==null?void 0:c.map(u=>u.id))||[]},validationSchema:ot,onSubmit:async(u,{setSubmitting:f})=>{var T,I,d,i,j,q;const{colorName:k,name:E,tagName:z,...D}=u;if(console.log(k),o===!0){console.log(u,"Bhai testing kar");const m=await n(fe({leadsId:(t==null?void 0:t.id)||"",updatedData:D}));(T=m==null?void 0:m.payload)!=null&&T.success?(R.push(e.jsx(O,{title:"Successfully Added",type:"success",duration:2500,children:(I=m==null?void 0:m.payload)==null?void 0:I.message}),{placement:"top-center"}),await n(w()),await n(N())):(R.push(e.jsx(O,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(d=m==null?void 0:m.payload)==null?void 0:d.message}),{placement:"top-center"}),await n(w()),await n(N())),await n(w()),await n(N())}else{console.log(D,"Maat Aa");const m=await n(je(D));(i=m==null?void 0:m.payload)!=null&&i.success?(R.push(e.jsx(O,{title:"Successfully Added",type:"success",duration:2500,children:(j=m==null?void 0:m.payload)==null?void 0:j.message}),{placement:"top-center"}),await n(w()),await n(N())):(R.push(e.jsx(O,{title:"Something went wrong !!!",type:"danger",duration:2500,children:(q=m==null?void 0:m.payload)==null?void 0:q.message}),{placement:"top-center"}),await n(w()),await n(N())),await n(w()),await n(N())}f(!1)},children:({touched:u,errors:f})=>e.jsx(Ne,{children:e.jsx(ye,{children:e.jsxs(te,{defaultValue:"personalInfo",children:[e.jsx(nt,{children:e.jsx(rt,{value:"personalInfo",children:"Custometer Detail"})}),e.jsxs("div",{className:"p-6",children:[e.jsx(Q,{value:"personalInfo",children:e.jsx(at,{touched:u,errors:f})}),e.jsx(Q,{value:"social",children:e.jsx(st,{touched:u,errors:f})})]})]})})})})});oe.displayName="LeadsForm";const re=p.forwardRef((s,a)=>{L();const t=g(r=>r.crmLeads.data.selectedLeads),o=g(r=>r.crmLeads.data.leadsList);console.log(o,"Here Is The Data");const n=async r=>{try{console.log("Edited Content Change")}catch(l){console.error("Error updating leads:",l)}};return e.jsx(oe,{ref:a,leads:t,onFormSubmit:n})});re.displayName="LeadsEditContent";const it=({onSaveClick:s,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(H,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(H,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),lt=()=>{const s=L(),a=g(r=>r.crmLeads.data.drawerOpen),t=()=>{s(N()),s(G({}))},o=p.useRef(null),n=()=>{var r,l;console.log("formSubmit function called",(r=o.current)==null?void 0:r.values),(l=o.current)==null||l.submitForm()};return e.jsx(Le,{isOpen:a,closable:!1,bodyClass:"p-0",footer:e.jsx(it,{onCancel:t,onSaveClick:n}),onClose:t,onRequestClose:t,children:e.jsx(re,{ref:o})})},ct=()=>{const s=L(),a=g(r=>r.crmLeads.data.deleteConfirmation),t=g(r=>r.crmLeads.data.selectedLeads),o=()=>{s(W(!1))},n=async()=>{var l,C,c;s(W(!1));const r=await s(be(t.id));await s(w()),(l=r==null?void 0:r.payload)!=null&&l.success?(R.push(e.jsx(O,{title:"Successfuly Deleted",type:"success",duration:2500,children:(C=r==null?void 0:r.payload)==null?void 0:C.message}),{placement:"top-center"}),await s(w())):(R.push(e.jsx(O,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(c=r==null?void 0:r.payload)==null?void 0:c.message}),{placement:"top-center"}),await s(w()))};return e.jsx(_e,{isOpen:a,type:"danger",title:"Delete Lead",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:n,children:e.jsx("p",{children:"Are you sure you want to delete this Lead? All record related to this lead will be deleted as well. This action cannot be undone."})})},dt=({row:s})=>{const{textTheme:a}=ee(),t=L(),o=()=>{t(Y()),t(G(s))};return e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},mt=({row:s})=>{const{textTheme:a}=ee(),t=L(),o=async()=>{await t(G(s)),t(W(!0))};return e.jsx("div",{children:e.jsx("div",{className:`${a} cursor-pointer select-none font-semibold text-red-500`,onClick:o,children:"Delete"})})},pt=()=>{const s=L(),a=g(d=>d.crmLeads.data.leadsList),t=g(d=>d.crmLeads.data.loading),o=g(d=>d.crmLeads.data.filterData),{pageIndex:n,pageSize:r,sort:l,query:C,total:c}=g(d=>d.crmLeads.data.tableData),u=p.useCallback(()=>{s(w())},[s]);p.useEffect(()=>{u()},[u,n,r,l,o]);const f=p.useMemo(()=>({pageIndex:n,pageSize:r,sort:l,query:C,total:c}),[n,r,l,C,c]),k=_("Leads","canDelete"),E=_("Leads","canModify"),z=p.useMemo(()=>{const d=[{header:"Details",accessorKey:"details",cell:i=>{const j=i.row.original.details;return e.jsx($,{text:j,maxLength:20})}},{header:"Contact Name",accessorKey:"contactName",cell:i=>{const j=i.row.original.contactData.name;return e.jsx($,{text:j,maxLength:20})}},{header:"Status",accessorKey:"status",cell:i=>i.row.original.status},{header:"Tag Name",accessorKey:"tagName",cell:i=>{const j=i.row.original.tags||[];return e.jsx(We,{tags:j})}},{header:"Notes",accessorKey:"notes",cell:i=>{const j=i.row.original.notes;return e.jsx($,{text:j,maxLength:20})}}];return k&&d.unshift({header:"Delete",id:"action",cell:i=>e.jsx(mt,{row:i.row.original})}),E&&d.unshift({header:"Edit",id:"action",cell:i=>e.jsx(dt,{row:i.row.original})}),d},[E,k]),D=d=>{const i=U(f);i.pageIndex=d,s(V(i))},T=d=>{const i=U(f);i.pageSize=Number(d),i.pageIndex=1,s(V(i))},I=d=>{const i=U(f);i.sort=d,s(V(i))};return e.jsxs("div",{children:[e.jsx(ue,{columns:z,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:f.total,pageIndex:f.pageIndex,pageSize:f.pageSize},onPaginationChange:D,onSelectChange:T,onSort:I}),e.jsx(lt,{}),e.jsx(ct,{})]})},K=s=>{const{icon:a,avatarClass:t,label:o,value:n,loading:r}=s,l=55;return e.jsx(Ge,{bordered:!0,children:e.jsx(de,{loading:r,customLoader:e.jsx(Je,{avatarProps:{className:"rounded",width:l,height:l}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ae,{className:t,size:l,icon:a}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(Qe,{thousandSeparator:!0,displayType:"text",value:n})})]})]})})})})},ut=()=>{const s=L(),a=g(o=>o.crmLeads.data.statisticData),t=g(o=>o.crmLeads.data.statisticLoading);return p.useEffect(()=>{s(Ce())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(K,{icon:e.jsx(Re,{}),avatarClass:"!bg-indigo-600",label:"Total Leads",value:a.totalLeads,growthRate:a==null?void 0:a.totalLeads,loading:t}),e.jsx(K,{icon:e.jsx(Oe,{}),avatarClass:"!bg-blue-500",label:"Active Leads",value:a.activeLeads,growthRate:a.activeLeads,loading:t}),e.jsx(K,{icon:e.jsx(Ee,{}),avatarClass:"!bg-emerald-500",label:"New Leads",value:a==null?void 0:a.newLeads,growthRate:a==null?void 0:a.newLeads,loading:t})]})},ne=p.forwardRef((s,a)=>{const{onInputChange:t}=s,o=Xe(n,500);function n(l){t==null||t(l)}const r=l=>{o(l.target.value)};return e.jsx(S,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(Me,{className:"text-lg"}),onChange:r})});ne.displayName="LeadsTableSearch";const{Control:xt}=Ze,X=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],ht=({innerProps:s,label:a,data:t,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{innerClass:t.color}),e.jsx("span",{children:a})]}),o&&e.jsx(Ue,{className:"text-emerald-500 text-xl"})]}),gt=({children:s,...a})=>{const t=a.getValue()[0];return e.jsxs(xt,{...a,children:[t&&e.jsx(se,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),s]})},ft=()=>{const s=L(),{status:a}=g(o=>o.crmLeads.data.filterData),t=o=>{s(Z({status:o==null?void 0:o.value}))};return e.jsx(Ye,{options:X,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:ht,Control:gt},value:X.filter(o=>o.value===a),onChange:t})},jt=()=>{const s=L(),a=p.useRef(null),t=g(c=>c.crmLeads.data.tableData),o=_("leads","canCreate"),n=c=>{const u=U(t);u.query=c,u.pageIndex=1,typeof c=="string"&&c.length>1&&r(u),typeof c=="string"&&c.length===0&&r(u)},r=c=>{s(V(c)),s(w())},l=()=>{const c=U(t);c.query="",a.current&&(a.current.value=""),s(Z({status:""})),r(c)},C=()=>{s(Y()),s(tt("Add"))};return p.useEffect(()=>{async function c(){await s(et())}c()},[s]),e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(ne,{ref:a,onInputChange:n}),e.jsx(ft,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(H,{size:"sm",className:"me-2",onClick:l,children:"Clear All"}),o&&e.jsx(H,{size:"sm",onClick:C,children:"Add New"})]})]})};me("crmLeads",we);const bt=()=>e.jsxs(e.Fragment,{children:[e.jsx(ut,{}),e.jsxs(pe,{bodyClass:"h-full",children:[e.jsx(jt,{}),e.jsx(pt,{})]})]}),as=bt;export{as as default};
