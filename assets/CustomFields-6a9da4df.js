import{am as I,an as oe,ao as se,ap as ne,r as b,j as e,a as j,aq as le}from"./index-afeb99dd.js";import{T as Ee}from"./index-b8a0c8d7.js";import{aE as ie,aF as de,aG as re,Y as He,u as Ue,G as Qe}from"./CrmService-80eafdff.js";import{B as $}from"./Button-5e9321cd.js";import{I as D}from"./Input-fe5fc582.js";import{b as ce,O as me,P as pe,Q as T}from"./index.esm-f4f10cf9.js";import{d as ue}from"./debounce-6c864594.js";import{c as M}from"./cloneDeep-f2528b95.js";import{u as A}from"./useGetModule-41dd94e6.js";import{D as ge}from"./DataTable-3d6ba875.js";import{u as O}from"./checkEditUpdate-9f459668.js";import{u as fe}from"./useThemeClass-a6e6a15d.js";import{T as xe}from"./TextTruncate-73a85fed.js";import"./Alert-abc01096.js";import"./index-08720d19.js";import"./Badge-57260147.js";import"./RangeCalendar-c8e5e23d.js";import"./Card-a25bc86a.js";import"./index-646ce73f.js";import"./index-71f17666.js";import{D as ye}from"./Dialog-b0478122.js";import"./Drawer-6021c63b.js";import"./index-29936284.js";import{a as N}from"./FormItem-2a151033.js";import"./toString-79dd21b9.js";import"./index-ed8cb66a.js";import"./index-cf176bc9.js";import"./index-8145753b.js";import{N as B,t as q}from"./toast-b57ee67d.js";import"./Pagination-46eefec6.js";import"./Progress-65192619.js";import"./index-fde04e31.js";import"./ScrollBar-93cfd3f9.js";import"./index-b82cade4.js";import{S as he}from"./Select-2984c046.js";import"./Skeleton-1c4e4b72.js";import"./index-a70c7a57.js";import"./Switcher-83e7e292.js";import"./index-45766b4b.js";import"./Tag-f3e28a4c.js";import"./index-53e11fec.js";import"./index-16b82756.js";import"./Tooltip-46e989ae.js";import"./Upload-1e962b58.js";import"./Views-f7a9b898.js";import"./chart.constant-e1b2238d.js";import"./GrowShrinkTag-c4569aa9.js";import"./react-tooltip.min-7fdd29c0.js";import"./RichTextEditor-9ad39754.js";import"./SegmentItemOption-666cf094.js";import{S as Ce}from"./StickyFooter-f9488d76.js";import"./SvgIcon-aa33ab6d.js";import{F as be,a as je,b as w}from"./formik.esm-e70cf2ce.js";import{A as Fe}from"./index.esm-726f6b92.js";import{c as we,a as S}from"./index.esm-639db9d4.js";import{I as K}from"./helper-64c17a1c.js";import{G as De}from"./index.esm-ef32d13b.js";import{C as Te}from"./ConfirmDialog-16c69999.js";const Ye="crmCustomerFields",X=I("crm/custom-fields",async({id:o,payload:a})=>{var s,n;try{return(await ie(o,a)).data}catch(l){throw new Error((n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.message)}}),Je=I("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:a})=>{var s,n;try{return(await de(o,a)).data}catch(l){throw new Error((n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.message)}}),Xe=I("crmCustomFields/data/deleteCustomFields",async o=>{var a,s;try{return await re(o)}catch(n){throw new Error((s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message)}}),P=I("crmCustomFields/data/getcustomFields",async o=>(await He(o)).data),Ze={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ve={loading:!1,tableData:Ze,displayedCustomFields:[],customFields:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},Le=oe({name:`${Ye}/state`,initialState:ve,reducers:{setTableData:(o,a)=>{o.tableData=a.payload;const s=o.customFields.filter(n=>n.name.toLowerCase().includes(a.payload.query.toLowerCase()));o.displayedCustomFields=s.slice(a.payload.pageSize*(a.payload.pageIndex-1),a.payload.pageSize*a.payload.pageIndex)},setSelectedCustomField:(o,a)=>{o.selectedCustomField=a.payload},setDialogToggle:(o,a)=>{o.isDialogOpen=a.payload},setDialogMode:(o,a)=>{o.dialogMode=a.payload},toggleDeleteConfirmation:(o,a)=>{o.deleteConfirmation=a.payload},setLoading:(o,a)=>{o.loading=a.payload}},extraReducers:o=>{o.addCase(X.fulfilled,(a,s)=>{a.loading=!1}).addCase(X.pending,a=>{a.loading=!0}).addCase(P.fulfilled,(a,s)=>{var n;a.customFields=s==null?void 0:s.payload.data,a.tableData.total=(n=s.payload.data)==null?void 0:n.length,a.displayedCustomFields=s==null?void 0:s.payload.data.slice(0,10),a.loading=!1}).addCase(P.pending,a=>{a.loading=!0})}}),{setLoading:Ne,setTableData:Q,setDialogToggle:G,setDialogMode:$e,setSelectedCustomField:Se,toggleDeleteConfirmation:Z}=Le.actions,et=Le.reducer,tt=se({data:et}),k=ne,qe=b.forwardRef((o,a)=>{const{onInputChange:s}=o,n=ue(l,500);function l(r){s==null||s(r)}const u=r=>{n(r.target.value)};return e.jsx(D,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(ce,{className:"text-lg"}),onChange:u})});qe.displayName="CFContactTableSearch";const at=()=>{const o=j(),a=b.useRef(null),s=k(r=>r.crmCustomFields.data.tableData),n=r=>{const d=M(s);d.query=r,d.pageIndex=1,typeof r=="string"&&r.length>1&&u(d),typeof r=="string"&&r.length===0&&u(d)},{getModule:l}=A(),u=r=>{if(r)o(Q(r));else{const d=l("contacts");o(P(d))}};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(qe,{ref:a,onInputChange:n})}),e.jsx("div",{className:"mb-4",children:e.jsx($,{size:"sm",onClick:()=>{o(G(!0)),o($e("Add"))},children:"Add New"})})]})},ot=()=>{const o=j(),a=k(c=>c.crmCustomFields.data.loading),s=O("roles","canModify"),n=O("roles","canDelete"),{pageIndex:l,pageSize:u,sort:r,query:d,total:f}=k(c=>c.crmCustomFields.data.tableData),m=k(c=>c.crmCustomFields.data.displayedCustomFields),t=({row:c})=>{const i=j();fe();const h=()=>{i(Se(c)),i(G(!0)),i($e("Edit"))},C=async()=>{await i(Se(c)),i(Z(!0))};return e.jsxs("div",{className:"flex justify-start text-base",children:[e.jsx("button",{className:"circle items-center  cursor-pointer hover:text-indigo-500",onClick:h,children:e.jsx(me,{})}),e.jsx("button",{className:"cursor-pointer hover:text-red-500 mx-1 circle items-center",onClick:C,children:e.jsx(pe,{})})]})},p=b.useMemo(()=>({pageIndex:l,pageSize:u,sort:r,query:d,total:f}),[l,u,r,d,f]),x=b.useMemo(()=>[{header:"Action",id:"action",cell:i=>e.jsx(t,{row:i.row.original})},{header:"Input Type",accessorKey:"inputType",cell:i=>i.row.original.inputType},{header:"Label",accessorKey:"label",cell:i=>i.row.original.label},{header:"Name",accessorKey:"name",cell:i=>i.row.original.name},{header:"Default Value",accessorKey:"defaultValue",cell:i=>{var C,F;const h=(C=i.row.original)!=null&&C.defaultValue?(F=i.row.original)==null?void 0:F.defaultValue:"-";return e.jsx(xe,{text:h,maxLength:15})}}],[s,n]),y=c=>{const i=M(p);i.pageIndex=c,o(Q(i))},g=c=>{const i=M(p);i.pageSize=Number(c),i.pageIndex=1,o(Q(i))},V=c=>{const i=M(p);i.sort=c,o(Q(i))};return e.jsx("div",{children:e.jsx(ge,{columns:x,data:m,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:a,pagingData:{total:p.total,pageIndex:p.pageIndex,pageSize:p.pageSize},onPaginationChange:y,onSelectChange:g,onSort:V})})},ze=b.forwardRef((o,a)=>{const s=j(),n=k(m=>m.crmCustomFields.data.dialogMode),l=k(m=>{var t;return(t=m==null?void 0:m.crmCustomFields)==null?void 0:t.data.selectedCustomField}),u=()=>{s(G(!1))},{getModule:r}=A(),d=async(m,t,p,x,y)=>{var F,z,R;const g=await r("contacts"),V={inputType:t==null?void 0:t.inputType,label:t==null?void 0:t.label,type:t==null?void 0:t.type,name:t==null?void 0:t.name,option:t==null?void 0:t.option,defaultValue:t==null?void 0:t.defaultValue},c=await x(m==="Add"?X({id:g,payload:V}):Je({CustomFieldsId:p==null?void 0:p.id,updatedData:{inputType:t==null?void 0:t.inputType,label:t==null?void 0:t.label,type:t==null?void 0:t.type,name:t==null?void 0:t.name,option:t==null?void 0:t.option,defaultValue:t==null?void 0:t.defaultValue}}));let i="",h="",C="danger";(F=c==null?void 0:c.payload)!=null&&F.success?(i="Successfully Added",h=(z=c==null?void 0:c.payload)==null?void 0:z.message,C="success",x(G(!1))):(i="Something went wrong !!!",h=(R=c==null?void 0:c.error)==null?void 0:R.message),y.push(e.jsx(B,{title:i,type:C,duration:2500,children:h}),{placement:"top-end"}),await x(P(g))},f=we().shape({inputType:S().required("Input Type is required"),label:S().required("Label is required"),name:S().required("Field Name is required"),defaultValue:S()});return e.jsx(be,{innerRef:a,initialValues:{name:n==="Edit"?l==null?void 0:l.name:"",inputType:n==="Edit"?l==null?void 0:l.inputType:"",label:n==="Edit"?l==null?void 0:l.label:"",defaultValue:n==="Edit"?l==null?void 0:l.defaultValue:""},validationSchema:f,onSubmit:async(m,{setSubmitting:t})=>{n==="Add"?await d("Add",m,null,s,q):await d("Edit",m,l,s,q),t(!1)},children:({touched:m,errors:t,values:p,setFieldValue:x})=>{var y;return e.jsxs(je,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Input Type *",invalid:t.inputType&&m.inputType,errorMessage:t.inputType,children:e.jsx(w,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:he,options:K,value:(y=K)==null?void 0:y.find(g=>(g==null?void 0:g.value)==(p==null?void 0:p.inputType)),prefix:e.jsx(De,{className:"text-xl"}),onChange:g=>{x("inputType",g==null?void 0:g.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Label *",invalid:t.label&&m.label,errorMessage:t.label,children:e.jsx(w,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:D,prefix:e.jsx(T,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Name *",invalid:t.name&&m.name,errorMessage:t.name,children:e.jsx(w,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:D,prefix:e.jsx(T,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"DefaultValue",invalid:t.defaultValue&&m.defaultValue,errorMessage:t.defaultValue,children:p.inputType==="textArea"?e.jsx(w,{textArea:!0,type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:D,prefix:e.jsx(T,{className:"text-xl"})}):e.jsx(w,{type:p.inputType==="datetime-local"?"datetime-local":p.inputType==="number"?"number":"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:D,prefix:e.jsx(T,{className:"text-xl"})})})})]}),e.jsx(Ce,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx($,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:u,children:"Cancel"}),e.jsx($,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(Fe,{}),children:"Save"})]})})]})}})});ze.displayName="CFContactForm";const st=()=>{const o=j(),a=k(d=>{var f,m;return(m=(f=d.crmCustomFields)==null?void 0:f.data)==null?void 0:m.deleteConfirmation}),s=k(d=>{var f,m;return(m=(f=d.crmCustomFields)==null?void 0:f.data)==null?void 0:m.selectedCustomField}),n=()=>{o(Z(!1))},l=(d,f,m,t)=>{var x,y,g;const p=(x=d==null?void 0:d.payload)==null?void 0:x.success;f.push(e.jsx(B,{title:p?m:t,type:p?"success":"danger",duration:2500,children:p?(y=d==null?void 0:d.payload)==null?void 0:y.message:(g=d==null?void 0:d.error)==null?void 0:g.message}),{placement:"top-end"})},{getModule:u}=A(),r=async()=>{o(Z(!1));const d=await o(Xe(s==null?void 0:s.id));l(d,q,"Successfully Deleted","Something Went Wrong !!!");const f=await u("contacts");await o(P(f))};return e.jsx(Te,{isOpen:a,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:n,onRequestClose:n,onCancel:n,onConfirm:r,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Contact? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};le("crmCustomFields",tt);const nt=()=>{const o=j(),a=k(u=>u.crmCustomFields.data.isDialogOpen),s=k(u=>u.crmCustomFields.data.dialogMode),n=()=>{o(G(!1))},{getModule:l}=A();return b.useEffect(()=>{(async()=>{try{await o(Ne(!0));const r=await l("contacts");await o(P(r))}catch(r){await o(Ne(!1)),console.error("Error fetching module data:",r)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(at,{}),e.jsx(ot,{}),e.jsxs(ye,{isOpen:a,onClose:n,children:[e.jsxs("h5",{className:"mb-4",children:[s==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(ze,{})]}),e.jsx(st,{})]})},lt="crmCustomerFields",v=I("crm/custom-fields",async({id:o,payload:a})=>{var s,n;try{return(await ie(o,a)).data}catch(l){throw new Error((n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.message)}}),it=I("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:a})=>{var s,n;try{return(await de(o,a)).data}catch(l){throw new Error((n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.message)}}),dt=I("crmCustomFields/data/deleteCustomFields",async o=>{var a,s;try{return await re(o)}catch(n){throw new Error((s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message)}}),W=I("crmCustomFields/data/getcustomFields",async o=>{const a=await Ue(o);return console.log({response:a}),a.data}),rt={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ct={loading:!1,tableData:rt,displayedCustomFields:[],customFields:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},Re=oe({name:`${lt}/state`,initialState:ct,reducers:{setTableData:(o,a)=>{o.tableData=a.payload;const s=o.customFields.filter(n=>n.name.toLowerCase().includes(a.payload.query.toLowerCase()));o.displayedCustomFields=s.slice(a.payload.pageSize*(a.payload.pageIndex-1),a.payload.pageSize*a.payload.pageIndex)},setSelectedCustomField:(o,a)=>{o.selectedCustomField=a.payload},setDialogToggle:(o,a)=>{o.isDialogOpen=a.payload},setDialogMode:(o,a)=>{o.dialogMode=a.payload},toggleDeleteConfirmation:(o,a)=>{o.deleteConfirmation=a.payload},setLoading:(o,a)=>{o.loading=a.payload}},extraReducers:o=>{o.addCase(v.fulfilled,(a,s)=>{a.loading=!1}).addCase(v.pending,a=>{a.loading=!0}).addCase(W.fulfilled,(a,s)=>{var n;a.customFields=s==null?void 0:s.payload.data,a.tableData.total=(n=s.payload.data)==null?void 0:n.length,a.displayedCustomFields=s==null?void 0:s.payload.data.slice(0,10),a.loading=!1}).addCase(W.pending,a=>{a.loading=!0})}}),{setLoading:Me,setTableData:Y,setDialogToggle:H,setDialogMode:Oe,setSelectedCustomField:Ie,toggleDeleteConfirmation:ee}=Re.actions,mt=Re.reducer,pt=se({data:mt}),E=ne,Ke=b.forwardRef((o,a)=>{const{onInputChange:s}=o,n=ue(l,500);function l(r){s==null||s(r)}const u=r=>{n(r.target.value)};return e.jsx(D,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(ce,{className:"text-lg"}),onChange:u})});Ke.displayName="CFLeadTableSearch";const ut=()=>{const o=j(),a=b.useRef(null),s=E(r=>r.crmCustomFields.data.tableData),n=r=>{const d=M(s);d.query=r,d.pageIndex=1,typeof r=="string"&&r.length>1&&u(d),typeof r=="string"&&r.length===0&&u(d)},{getModule:l}=A(),u=r=>{if(r)o(Y(r));else{const d=l("leads");o(W(d))}};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(Ke,{ref:a,onInputChange:n})}),e.jsx("div",{className:"mb-4",children:e.jsx($,{size:"sm",onClick:()=>{o(H(!0)),o(Oe("Add"))},children:"Add New"})})]})},gt=()=>{const o=j(),a=E(c=>c.crmCustomFields.data.loading),s=O("roles","canModify"),n=O("roles","canDelete"),{pageIndex:l,pageSize:u,sort:r,query:d,total:f}=E(c=>c.crmCustomFields.data.tableData),m=E(c=>c.crmCustomFields.data.displayedCustomFields),t=({row:c})=>{const i=j();fe();const h=()=>{i(Ie(c)),i(H(!0)),i(Oe("Edit"))},C=async()=>{await i(Ie(c)),i(ee(!0))};return e.jsxs("div",{className:"flex justify-start text-base",children:[e.jsx("button",{className:"circle items-center  cursor-pointer hover:text-indigo-500",onClick:h,children:e.jsx(me,{})}),e.jsx("button",{className:"cursor-pointer hover:text-red-500 mx-1 circle items-center",onClick:C,children:e.jsx(pe,{})})]})},p=b.useMemo(()=>({pageIndex:l,pageSize:u,sort:r,query:d,total:f}),[l,u,r,d,f]),x=b.useMemo(()=>[{header:"Action",id:"action",cell:i=>e.jsx(t,{row:i.row.original})},{header:"Input Type",accessorKey:"inputType",cell:i=>i.row.original.inputType},{header:"Label",accessorKey:"label",cell:i=>i.row.original.label},{header:"Name",accessorKey:"name",cell:i=>i.row.original.name},{header:"Default Value",accessorKey:"defaultValue",cell:i=>{var C,F;const h=(C=i.row.original)!=null&&C.defaultValue?(F=i.row.original)==null?void 0:F.defaultValue:"-";return e.jsx(xe,{text:h,maxLength:15})}}],[s,n]),y=c=>{const i=M(p);i.pageIndex=c,o(Y(i))},g=c=>{const i=M(p);i.pageSize=Number(c),i.pageIndex=1,o(Y(i))},V=c=>{const i=M(p);i.sort=c,o(Y(i))};return e.jsx("div",{children:e.jsx(ge,{columns:x,data:m,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:a,pagingData:{total:p.total,pageIndex:p.pageIndex,pageSize:p.pageSize},onPaginationChange:y,onSelectChange:g,onSort:V})})},Pe=b.forwardRef((o,a)=>{const s=j(),n=E(m=>m.crmCustomFields.data.dialogMode),l=E(m=>m.crmCustomFields.data.selectedCustomField),u=()=>{s(H(!1))},{getModule:r}=A(),d=async(m,t,p,x,y)=>{var F,z,R;const g=await r("leads"),V={inputType:t==null?void 0:t.inputType,label:t==null?void 0:t.label,type:t==null?void 0:t.type,name:t==null?void 0:t.name,option:t==null?void 0:t.option,defaultValue:t==null?void 0:t.defaultValue},c=await x(m==="Add"?v({id:g,payload:V}):it({CustomFieldsId:p==null?void 0:p.id,updatedData:{inputType:t==null?void 0:t.inputType,label:t==null?void 0:t.label,type:t==null?void 0:t.type,name:t==null?void 0:t.name,option:t==null?void 0:t.option,defaultValue:t==null?void 0:t.defaultValue}}));let i="",h="",C="danger";(F=c==null?void 0:c.payload)!=null&&F.success?(i="Successfully Added",h=(z=c==null?void 0:c.payload)==null?void 0:z.message,C="success",x(H(!1))):(i="Something went wrong !!!",h=(R=c==null?void 0:c.error)==null?void 0:R.message),y.push(e.jsx(B,{title:i,type:C,duration:2500,children:h}),{placement:"top-end"}),await x(W(g))},f=we().shape({inputType:S().required("Input Type is required"),label:S().required("Label is required"),name:S().required("Field Name is required"),defaultValue:S()});return e.jsx(be,{innerRef:a,initialValues:{name:n==="Edit"?l==null?void 0:l.name:"",inputType:n==="Edit"?l==null?void 0:l.inputType:"",label:n==="Edit"?l==null?void 0:l.label:"",defaultValue:n==="Edit"?l==null?void 0:l.defaultValue:""},validationSchema:f,onSubmit:async(m,{setSubmitting:t})=>{n==="Add"?await d("Add",m,null,s,q):await d("Edit",m,l,s,q),t(!1)},children:({touched:m,errors:t,values:p,setFieldValue:x})=>{var y;return e.jsxs(je,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Input Type *",invalid:t.inputType&&m.inputType,errorMessage:t.inputType,children:e.jsx(w,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:he,options:K,value:(y=K)==null?void 0:y.find(g=>(g==null?void 0:g.value)==(p==null?void 0:p.inputType)),prefix:e.jsx(De,{className:"text-xl"}),onChange:g=>{x("inputType",g==null?void 0:g.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Label *",invalid:t.label&&m.label,errorMessage:t.label,children:e.jsx(w,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:D,prefix:e.jsx(T,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Name *",invalid:t.name&&m.name,errorMessage:t.name,children:e.jsx(w,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:D,prefix:e.jsx(T,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"DefaultValue",invalid:t.defaultValue&&m.defaultValue,errorMessage:t.defaultValue,children:p.inputType==="textArea"?e.jsx(w,{textArea:!0,type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:D,prefix:e.jsx(T,{className:"text-xl"})}):e.jsx(w,{type:p.inputType==="datetime-local"?"datetime-local":p.inputType==="number"?"number":"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:D,prefix:e.jsx(T,{className:"text-xl"})})})})]}),e.jsx(Ce,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx($,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:u,children:"Cancel"}),e.jsx($,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(Fe,{}),children:"Save"})]})})]})}})});Pe.displayName="CFLeadForm";const ft=()=>{const o=j(),a=E(d=>{var f,m;return(m=(f=d.crmCustomFields)==null?void 0:f.data)==null?void 0:m.deleteConfirmation}),s=E(d=>{var f,m;return(m=(f=d.crmCustomFields)==null?void 0:f.data)==null?void 0:m.selectedCustomField}),n=()=>{o(ee(!1))},l=(d,f,m,t)=>{var x,y,g;const p=(x=d==null?void 0:d.payload)==null?void 0:x.success;f.push(e.jsx(B,{title:p?m:t,type:p?"success":"danger",duration:2500,children:p?(y=d==null?void 0:d.payload)==null?void 0:y.message:(g=d==null?void 0:d.error)==null?void 0:g.message}),{placement:"top-end"})},{getModule:u}=A(),r=async()=>{o(ee(!1));const d=await o(dt(s==null?void 0:s.id));l(d,q,"Successfully Deleted","Something Went Wrong !!!");const f=await u("leads");await o(W(f))};return e.jsx(Te,{isOpen:a,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:n,onRequestClose:n,onCancel:n,onConfirm:r,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Lead? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};le("crmCustomFields",pt);const xt=()=>{const o=j(),a=E(u=>u.crmCustomFields.data.isDialogOpen),s=E(u=>u.crmCustomFields.data.dialogMode),n=()=>{o(H(!1))},{getModule:l}=A();return b.useEffect(()=>{(async()=>{try{await o(Me(!0));const r=await l("leads");await o(W(r))}catch(r){await o(Me(!1)),console.error("Error fetching module data:",r)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(ut,{}),e.jsx(gt,{}),e.jsxs(ye,{isOpen:a,onClose:n,children:[e.jsxs("h5",{className:"mb-4",children:[s==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(Pe,{})]}),e.jsx(ft,{})]})},yt="crmCustomerFields",te=I("crm/custom-fields",async({id:o,payload:a})=>{var s,n;try{return(await ie(o,a)).data}catch(l){throw new Error((n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.message)}}),ht=I("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:a})=>{var s,n;try{return(await de(o,a)).data}catch(l){throw new Error((n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.message)}}),Ct=I("crmCustomFields/data/deleteCustomFields",async o=>{var a,s;try{return await re(o)}catch(n){throw new Error((s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message)}}),_=I("crmCustomFields/data/getcustomFields",async o=>(await Qe(o)).data),bt={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},jt={loading:!1,tableData:bt,displayedCustomFields:[],customFields:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},We=oe({name:`${yt}/state`,initialState:jt,reducers:{setTableData:(o,a)=>{o.tableData=a.payload;const s=o.customFields.filter(n=>n.name.toLowerCase().includes(a.payload.query.toLowerCase()));o.displayedCustomFields=s.slice(a.payload.pageSize*(a.payload.pageIndex-1),a.payload.pageSize*a.payload.pageIndex)},setSelectedCustomField:(o,a)=>{o.selectedCustomField=a.payload},setDialogToggle:(o,a)=>{o.isDialogOpen=a.payload},setDialogMode:(o,a)=>{o.dialogMode=a.payload},toggleDeleteConfirmation:(o,a)=>{o.deleteConfirmation=a.payload},setLoading:(o,a)=>{o.loading=a.payload}},extraReducers:o=>{o.addCase(te.fulfilled,(a,s)=>{a.loading=!1}).addCase(te.pending,a=>{a.loading=!0}).addCase(_.fulfilled,(a,s)=>{var n;a.customFields=s==null?void 0:s.payload.data,a.tableData.total=(n=s.payload.data)==null?void 0:n.length,a.displayedCustomFields=s==null?void 0:s.payload.data.slice(0,10),a.loading=!1}).addCase(_.pending,a=>{a.loading=!0})}}),{setLoading:Ae,setTableData:J,setDialogToggle:U,setDialogMode:_e,setSelectedCustomField:Ve,toggleDeleteConfirmation:ae}=We.actions,Ft=We.reducer,wt=se({data:Ft}),L=ne,Be=b.forwardRef((o,a)=>{const{onInputChange:s}=o,n=ue(l,500);function l(r){s==null||s(r)}const u=r=>{n(r.target.value)};return e.jsx(D,{ref:a,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(ce,{className:"text-lg"}),onChange:u})});Be.displayName="CFTaskTableSearch";const Dt=()=>{const o=j(),a=b.useRef(null),s=L(r=>r.crmCustomFields.data.tableData),n=r=>{const d=M(s);d.query=r,d.pageIndex=1,typeof r=="string"&&r.length>1&&u(d),typeof r=="string"&&r.length===0&&u(d)},{getModule:l}=A(),u=r=>{if(r)o(J(r));else{const d=l("tasks");o(_(d))}};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(Be,{ref:a,onInputChange:n})}),e.jsx("div",{className:"mb-4",children:e.jsx($,{size:"sm",onClick:()=>{o(U(!0)),o(_e("Add"))},children:"Add New"})})]})},Tt=()=>{const o=j(),a=L(c=>c.crmCustomFields.data.loading),s=O("roles","canModify"),n=O("roles","canDelete"),{pageIndex:l,pageSize:u,sort:r,query:d,total:f}=L(c=>c.crmCustomFields.data.tableData),m=L(c=>c.crmCustomFields.data.displayedCustomFields),t=({row:c})=>{const i=j();fe();const h=()=>{i(Ve(c)),i(U(!0)),i(_e("Edit"))},C=async()=>{await i(Ve(c)),i(ae(!0))};return e.jsxs("div",{className:"flex justify-start text-base",children:[e.jsx("button",{className:"circle items-center  cursor-pointer hover:text-indigo-500",onClick:h,children:e.jsx(me,{})}),e.jsx("button",{className:"cursor-pointer hover:text-red-500 mx-1 circle items-center",onClick:C,children:e.jsx(pe,{})})]})},p=b.useMemo(()=>({pageIndex:l,pageSize:u,sort:r,query:d,total:f}),[l,u,r,d,f]),x=b.useMemo(()=>[{header:"Action",id:"action",cell:i=>e.jsx(t,{row:i.row.original})},{header:"Input Type",accessorKey:"inputType",cell:i=>i.row.original.inputType},{header:"Label",accessorKey:"label",cell:i=>i.row.original.label},{header:"Name",accessorKey:"name",cell:i=>i.row.original.name},{header:"Default Value",accessorKey:"defaultValue",cell:i=>{var C,F;const h=(C=i.row.original)!=null&&C.defaultValue?(F=i.row.original)==null?void 0:F.defaultValue:"-";return e.jsx(xe,{text:h,maxLength:15})}}],[s,n]),y=c=>{const i=M(p);i.pageIndex=c,o(J(i))},g=c=>{const i=M(p);i.pageSize=Number(c),i.pageIndex=1,o(J(i))},V=c=>{const i=M(p);i.sort=c,o(J(i))};return e.jsx("div",{children:e.jsx(ge,{columns:x,data:m,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:a,pagingData:{total:p.total,pageIndex:p.pageIndex,pageSize:p.pageSize},onPaginationChange:y,onSelectChange:g,onSort:V})})},Ge=b.forwardRef((o,a)=>{const s=j(),n=L(m=>m.crmCustomFields.data.dialogMode),l=L(m=>m.crmCustomFields.data.selectedCustomField),u=()=>{s(U(!1))},{getModule:r}=A(),d=async(m,t,p,x,y)=>{var F,z,R;const g=await r("tasks"),V={inputType:t==null?void 0:t.inputType,label:t==null?void 0:t.label,type:t==null?void 0:t.type,name:t==null?void 0:t.name,option:t==null?void 0:t.option,defaultValue:t==null?void 0:t.defaultValue},c=await x(m==="Add"?te({id:g,payload:V}):ht({CustomFieldsId:p==null?void 0:p.id,updatedData:{inputType:t==null?void 0:t.inputType,label:t==null?void 0:t.label,type:t==null?void 0:t.type,name:t==null?void 0:t.name,option:t==null?void 0:t.option,defaultValue:t==null?void 0:t.defaultValue}}));let i="",h="",C="danger";(F=c==null?void 0:c.payload)!=null&&F.success?(i="Successfully Added",h=(z=c==null?void 0:c.payload)==null?void 0:z.message,C="success",x(U(!1))):(i="Something went wrong !!!",h=(R=c==null?void 0:c.error)==null?void 0:R.message),y.push(e.jsx(B,{title:i,type:C,duration:2500,children:h}),{placement:"top-end"}),await x(_(g))},f=we().shape({inputType:S().required("Input Type is required"),label:S().required("Label is required"),name:S().required("Field Name is required"),defaultValue:S()});return e.jsx(be,{innerRef:a,initialValues:{name:n==="Edit"?l==null?void 0:l.name:"",inputType:n==="Edit"?l==null?void 0:l.inputType:"",label:n==="Edit"?l==null?void 0:l.label:"",defaultValue:n==="Edit"?l==null?void 0:l.defaultValue:""},validationSchema:f,onSubmit:async(m,{setSubmitting:t})=>{n==="Add"?await d("Add",m,null,s,q):await d("Edit",m,l,s,q),t(!1)},children:({touched:m,errors:t,values:p,setFieldValue:x})=>{var y;return e.jsxs(je,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Input Type *",invalid:t.inputType&&m.inputType,errorMessage:t.inputType,children:e.jsx(w,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:he,options:K,value:(y=K)==null?void 0:y.find(g=>(g==null?void 0:g.value)==(p==null?void 0:p.inputType)),prefix:e.jsx(De,{className:"text-xl"}),onChange:g=>{x("inputType",g==null?void 0:g.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Label *",invalid:t.label&&m.label,errorMessage:t.label,children:e.jsx(w,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:D,prefix:e.jsx(T,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"Name *",invalid:t.name&&m.name,errorMessage:t.name,children:e.jsx(w,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:D,prefix:e.jsx(T,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(N,{label:"DefaultValue",invalid:t.defaultValue&&m.defaultValue,errorMessage:t.defaultValue,children:p.inputType==="textArea"?e.jsx(w,{textArea:!0,type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:D,prefix:e.jsx(T,{className:"text-xl"})}):e.jsx(w,{type:p.inputType==="datetime-local"?"datetime-local":p.inputType==="number"?"number":"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:D,prefix:e.jsx(T,{className:"text-xl"})})})})]}),e.jsx(Ce,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx($,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:u,children:"Cancel"}),e.jsx($,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(Fe,{}),children:"Save"})]})})]})}})});Ge.displayName="CFTaskForm";const Nt=()=>{const o=j(),a=L(d=>{var f,m;return(m=(f=d.crmCustomFields)==null?void 0:f.data)==null?void 0:m.deleteConfirmation}),s=L(d=>{var f,m;return(m=(f=d.crmCustomFields)==null?void 0:f.data)==null?void 0:m.selectedCustomField}),n=()=>{o(ae(!1))},l=(d,f,m,t)=>{var x,y,g;const p=(x=d==null?void 0:d.payload)==null?void 0:x.success;f.push(e.jsx(B,{title:p?m:t,type:p?"success":"danger",duration:2500,children:p?(y=d==null?void 0:d.payload)==null?void 0:y.message:(g=d==null?void 0:d.error)==null?void 0:g.message}),{placement:"top-end"})},{getModule:u}=A(),r=async()=>{o(ae(!1));const d=await o(Ct(s==null?void 0:s.id));l(d,q,"Successfully Deleted","Something Went Wrong !!!");const f=await u("tasks");await o(_(f))};return e.jsx(Te,{isOpen:a,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:n,onRequestClose:n,onCancel:n,onConfirm:r,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Task? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};le("crmCustomFields",wt);const St=()=>{const o=j(),a=L(u=>u.crmCustomFields.data.isDialogOpen),s=L(u=>u.crmCustomFields.data.dialogMode),n=()=>{o(U(!1))},{getModule:l}=A();return b.useEffect(()=>{(async()=>{try{await o(Ae(!0));const r=await l("tasks");await o(_(r))}catch(r){await o(Ae(!1)),console.error("Error fetching module data:",r)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(Dt,{}),e.jsx(Tt,{}),e.jsxs(ye,{isOpen:a,onClose:n,children:[e.jsxs("h5",{className:"mb-4",children:[s==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(Ge,{})]}),e.jsx(Nt,{})]})},{TabNav:Mt,TabList:It}=Ee,ke={CFContact:{label:"Contact",path:"CFContact"},CFLead:{label:"Lead",path:"CFLead"},CFTask:{label:"Task",path:"CFTask"}},At=()=>{const[o,a]=b.useState("CFContact"),s=n=>{a(n)};return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{value:o,variant:"pill",onChange:n=>s(n),children:e.jsx(It,{children:Object.keys(ke).map(n=>e.jsx(Mt,{value:n,children:ke[n].label},n))})}),e.jsx("div",{className:"py-4",children:e.jsxs(b.Suspense,{fallback:e.jsx(e.Fragment,{children:"loading..."}),children:[o==="CFContact"&&e.jsx(nt,{}),o==="CFLead"&&e.jsx(xt,{}),o==="CFTask"&&e.jsx(St,{})]})})]})},$a=At;export{$a as C};
