import{al as A,am as ne,an as se,ao as le,r as b,j as e,a as F,aq as ie}from"./index-4fc5ac15.js";import{T as Me}from"./index-dbee2c90.js";import{aw as de,ax as re,ay as ce,O as Pe,r as We,D as _e}from"./CrmService-81e45160.js";import{B as q}from"./Button-7cd7d853.js";import{I as S}from"./Input-3854a622.js";import{b as pe,P as me,Q as ge,R as M}from"./index.esm-4a8db888.js";import{d as ue}from"./debounce-cd228677.js";import{c as I}from"./cloneDeep-715f167a.js";import{D as xe}from"./DataTable-814cf5c6.js";import{u as z}from"./checkEditUpdate-eb39f2b1.js";import{u as ye}from"./useThemeClass-9af86e8e.js";import{T as R}from"./TextTruncate-2746f080.js";import"./Alert-7075f24d.js";import"./index-ade064c2.js";import"./Badge-19df83fb.js";import"./RangeCalendar-5dd6ce1b.js";import"./Card-a6171fd9.js";import"./index-2e6c9811.js";import"./index-f81c3042.js";import{D as fe}from"./Dialog-5d93bc0a.js";import"./Drawer-8dc2fd43.js";import"./index-3903fc17.js";import{a as T}from"./FormItem-e8ff9726.js";import"./toString-73aeebea.js";import"./index-d3c2681a.js";import"./index-99b428ba.js";import"./index-8ced4f1f.js";import{N as H,t as L}from"./toast-b752ab56.js";import"./Pagination-1e482b61.js";import"./Progress-352773c6.js";import"./index-5dc9acd3.js";import"./ScrollBar-abdf3e1e.js";import"./index-1ece77e8.js";import{S as K}from"./Select-9180a255.js";import"./Skeleton-cef4628a.js";import"./index-5597ebd0.js";import"./Switcher-900c0698.js";import"./index-829995d1.js";import"./Tag-4b3b0483.js";import"./index-e5b54797.js";import"./index-534786cf.js";import"./Tooltip-56ad0384.js";import"./Upload-fe7ae2cb.js";import"./Views-63244708.js";import"./chart.constant-abefb831.js";import"./chart.config-099ad096.js";import"./GrowShrinkTag-093ec060.js";import"./react-tooltip.min-5552979b.js";import"./RichTextEditor-21962299.js";import"./SegmentItemOption-32fcaaa1.js";import{S as he}from"./StickyFooter-77543de3.js";import"./SvgIcon-cd84e0c4.js";import{F as Ce,a as je,b as D}from"./formik.esm-7fc98ee2.js";import{A as be}from"./index.esm-1c33c198.js";import{c as Te,a as w}from"./index.esm-4c38c838.js";import{I as O,D as P}from"./helper-17f33346.js";import{G as W}from"./index.esm-02396f1d.js";import{C as De}from"./ConfirmDialog-a24226b8.js";const Be="crmCustomerFields",Z=A("crm/custom-fields",async({id:o,payload:t})=>{var s,l;try{return(await de(o,t)).data}catch(n){throw new Error((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)}}),He=A("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:t})=>{var s,l;try{return(await re(o,t)).data}catch(n){throw new Error((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)}}),Ge=A("crmCustomFields/data/deleteCustomFields",async o=>{var t,s;try{return await ce(o)}catch(l){throw new Error((s=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:s.message)}}),$=A("crmCustomFields/data/getcustomFields",async()=>{const o=await Pe();return console.log({response:o}),o.data}),Ue={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Qe={loading:!1,tableData:Ue,displayedCustomFields:[],customFields:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},Ie=ne({name:`${Be}/state`,initialState:Qe,reducers:{setTableData:(o,t)=>{o.tableData=t.payload;const s=o.customFields.filter(l=>l.name.toLowerCase().includes(t.payload.query.toLowerCase()));o.displayedCustomFields=s.slice(t.payload.pageSize*(t.payload.pageIndex-1),t.payload.pageSize*t.payload.pageIndex)},setSelectedCustomField:(o,t)=>{o.selectedCustomField=t.payload},setDialogToggle:(o,t)=>{o.isDialogOpen=t.payload},setDialogMode:(o,t)=>{o.dialogMode=t.payload},toggleDeleteConfirmation:(o,t)=>{o.deleteConfirmation=t.payload}},extraReducers:o=>{o.addCase(Z.fulfilled,(t,s)=>{t.loading=!1}).addCase(Z.pending,t=>{t.loading=!0}).addCase($.fulfilled,(t,s)=>{var l;t.customFields=s==null?void 0:s.payload.data,t.tableData.total=(l=s.payload.data)==null?void 0:l.length,t.displayedCustomFields=s==null?void 0:s.payload.data.slice(0,10),t.loading=!1}).addCase($.pending,t=>{t.loading=!0})}}),{setTableData:J,setDialogToggle:G,setDialogMode:Ae,setSelectedCustomField:we,toggleDeleteConfirmation:v}=Ie.actions,Je=Ie.reducer,Xe=se({data:Je}),E=le,Ee=b.forwardRef((o,t)=>{const{onInputChange:s}=o,l=ue(n,500);function n(d){s==null||s(d)}const p=d=>{l(d.target.value)};return e.jsx(S,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(pe,{className:"text-lg"}),onChange:p})});Ee.displayName="CFContactTableSearch";const Ye=()=>{const o=F(),t=b.useRef(null),s=E(p=>p.crmCustomFields.data.tableData),l=p=>{const d=I(s);d.query=p,d.pageIndex=1,typeof p=="string"&&p.length>1&&n(d),typeof p=="string"&&p.length===0&&n(d)},n=p=>{o(p?J(p):$())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(Ee,{ref:t,onInputChange:l})}),e.jsx("div",{className:"mb-4",children:e.jsx(q,{size:"sm",onClick:()=>{o(G(!0)),o(Ae("Add"))},children:"Add New"})})]})},Ze=()=>{const o=F();b.useEffect(()=>{o($())},[o]);const t=E(m=>m.crmCustomFields.data.loading),s=z("roles","canModify"),l=z("roles","canDelete"),{pageIndex:n,pageSize:p,sort:d,query:x,total:c}=E(m=>m.crmCustomFields.data.tableData),a=E(m=>m.crmCustomFields.data.displayedCustomFields),u=({row:m})=>{const i=F(),{textTheme:j}=ye(),y=()=>{i(we(m)),i(G(!0)),i(Ae("Edit"))},f=async()=>{await i(we(m)),i(v(!0))};return e.jsxs("div",{className:"flex justify-start text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${j}`,onClick:y,children:e.jsx(me,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:f,children:e.jsx(ge,{})})]})},g=b.useMemo(()=>({pageIndex:n,pageSize:p,sort:d,query:x,total:c}),[n,p,d,x,c]),h=b.useMemo(()=>[{header:"Action",id:"action",cell:i=>e.jsx(u,{row:i.row.original})},{header:"Input Type",accessorKey:"inputType",cell:i=>i.row.original.inputType},{header:"Data Type",accessorKey:"type",cell:i=>i.row.original.type},{header:"Label",accessorKey:"label",cell:i=>i.row.original.label},{header:"Name",accessorKey:"name",cell:i=>i.row.original.name},{header:"Option",accessorKey:"option",cell:i=>{var y,f;const j=(y=i.row.original)!=null&&y.option?(f=i.row.original)==null?void 0:f.option:"-";return e.jsx(R,{text:j,maxLength:15})}},{header:"Default Value",accessorKey:"defaultValue",cell:i=>{var y,f;const j=(y=i.row.original)!=null&&y.defaultValue?(f=i.row.original)==null?void 0:f.defaultValue:"-";return e.jsx(R,{text:j,maxLength:15})}}],[s,l]),C=m=>{const i=I(g);i.pageIndex=m,o(J(i))},r=m=>{const i=I(g);i.pageSize=Number(m),i.pageIndex=1,o(J(i))},N=m=>{const i=I(g);i.sort=m,o(J(i))};return e.jsx("div",{children:e.jsx(xe,{columns:h,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:g.total,pageIndex:g.pageIndex,pageSize:g.pageSize},onPaginationChange:C,onSelectChange:r,onSort:N})})},Ve=b.forwardRef((o,t)=>{const s=F(),l=E(c=>c.crmCustomFields.data.dialogMode),n=E(c=>{var a;return(a=c==null?void 0:c.crmCustomFields)==null?void 0:a.data.selectedCustomField}),p=()=>{s(G(!1))},d=async(c,a,u,g,h)=>{var j,y,f;const C={inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue},r=await g(c==="Add"?Z({id:"1",payload:C}):He({CustomFieldsId:u==null?void 0:u.id,updatedData:{inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue}}));let N="",m="",i="danger";(j=r==null?void 0:r.payload)!=null&&j.success?(N="Successfully Added",m=(y=r==null?void 0:r.payload)==null?void 0:y.message,i="success"):(N="Something went wrong !!!",m=(f=r==null?void 0:r.error)==null?void 0:f.message),h.push(e.jsx(H,{title:N,type:i,duration:2500,children:m}),{placement:"top-end"}),g(G(!1)),await g($())},x=Te().shape({inputType:w().required("Input Type is required"),type:w().required("Data Type is required"),label:w().required("Label is required"),name:w().required("Field Name is required"),option:w(),defaultValue:w()});return e.jsx(Ce,{innerRef:t,initialValues:{name:l==="Edit"?n==null?void 0:n.name:"",inputType:l==="Edit"?n==null?void 0:n.inputType:"",type:l==="Edit"?n==null?void 0:n.type:"",label:l==="Edit"?n==null?void 0:n.label:"",option:l==="Edit"?n==null?void 0:n.option:"",defaultValue:l==="Edit"?n==null?void 0:n.defaultValue:""},validationSchema:x,onSubmit:async(c,{setSubmitting:a})=>{l==="Add"?await d("Add",c,null,s,L):await d("Edit",c,n,s,L),a(!1)},children:({touched:c,errors:a,values:u,setFieldValue:g})=>{var h,C;return e.jsxs(je,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Input Type *",invalid:a.inputType&&c.inputType,errorMessage:a.inputType,children:e.jsx(D,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:K,options:O,value:(h=O)==null?void 0:h.find(r=>(r==null?void 0:r.value)==(u==null?void 0:u.inputType)),prefix:e.jsx(W,{className:"text-xl"}),onChange:r=>{g("inputType",r==null?void 0:r.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Data Type *",invalid:a.type&&c.type,errorMessage:a.type,children:e.jsx(D,{type:"text",autoComplete:"off",name:"type",placeholder:"Input Type",component:K,options:P,value:(C=P)==null?void 0:C.find(r=>(r==null?void 0:r.value)==(u==null?void 0:u.type)),prefix:e.jsx(W,{className:"text-xl"}),onChange:r=>{g("type",r==null?void 0:r.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Label *",invalid:a.label&&c.label,errorMessage:a.label,children:e.jsx(D,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Name *",invalid:a.name&&c.name,errorMessage:a.name,children:e.jsx(D,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Option",invalid:a.option&&c.option,errorMessage:a.option,children:e.jsx(D,{type:"text",autoComplete:"off",name:"option",placeholder:"option",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"DefaultValue",invalid:a.defaultValue&&c.defaultValue,errorMessage:a.defaultValue,children:e.jsx(D,{type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:S,prefix:e.jsx(M,{className:"text-xl"})})})})]}),e.jsx(he,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(q,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:p,children:"Cancel"}),e.jsx(q,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(be,{}),children:"Save"})]})})]})}})});Ve.displayName="CFContactForm";const ve=()=>{const o=F(),t=E(d=>{var x,c;return(c=(x=d.crmCustomFields)==null?void 0:x.data)==null?void 0:c.deleteConfirmation}),s=E(d=>{var x,c;return(c=(x=d.crmCustomFields)==null?void 0:x.data)==null?void 0:c.selectedCustomField}),l=()=>{o(v(!1))},n=(d,x,c,a)=>{var g,h,C;const u=(g=d==null?void 0:d.payload)==null?void 0:g.success;x.push(e.jsx(H,{title:u?c:a,type:u?"success":"danger",duration:2500,children:u?(h=d==null?void 0:d.payload)==null?void 0:h.message:(C=d==null?void 0:d.error)==null?void 0:C.message}),{placement:"top-end"})},p=async()=>{o(v(!1));const d=await o(Ge(s==null?void 0:s.id));n(d,L,"Successfully Deleted","Something Went Wrong !!!"),await o($())};return e.jsx(De,{isOpen:t,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:p,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Contact? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};ie("crmCustomFields",Xe);const ea=()=>{const o=F(),t=E(n=>n.crmCustomFields.data.isDialogOpen),s=E(n=>n.crmCustomFields.data.dialogMode),l=()=>{o(G(!1))};return b.useEffect(()=>{o($)},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ye,{}),e.jsx(Ze,{}),e.jsxs(fe,{isOpen:t,onClose:l,children:[e.jsxs("h5",{className:"mb-4",children:[s==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(Ve,{})]}),e.jsx(ve,{})]})},aa="crmCustomerFields",ee=A("crm/custom-fields",async({id:o,payload:t})=>{var s,l;try{return(await de(o,t)).data}catch(n){throw new Error((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)}}),ta=A("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:t})=>{var s,l;try{return(await re(o,t)).data}catch(n){throw new Error((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)}}),oa=A("crmCustomFields/data/deleteCustomFields",async o=>{var t,s;try{return await ce(o)}catch(l){throw new Error((s=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:s.message)}}),_=A("crmCustomFields/data/getcustomFields",async()=>{const o=await We();return console.log({response:o}),o.data}),na={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},sa={loading:!1,tableData:na,displayedCustomFields:[],customFields:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},ke=ne({name:`${aa}/state`,initialState:sa,reducers:{setTableData:(o,t)=>{o.tableData=t.payload;const s=o.customFields.filter(l=>l.name.toLowerCase().includes(t.payload.query.toLowerCase()));o.displayedCustomFields=s.slice(t.payload.pageSize*(t.payload.pageIndex-1),t.payload.pageSize*t.payload.pageIndex)},setSelectedCustomField:(o,t)=>{o.selectedCustomField=t.payload},setDialogToggle:(o,t)=>{o.isDialogOpen=t.payload},setDialogMode:(o,t)=>{o.dialogMode=t.payload},toggleDeleteConfirmation:(o,t)=>{o.deleteConfirmation=t.payload}},extraReducers:o=>{o.addCase(ee.fulfilled,(t,s)=>{t.loading=!1}).addCase(ee.pending,t=>{t.loading=!0}).addCase(_.fulfilled,(t,s)=>{var l;t.customFields=s==null?void 0:s.payload.data,t.tableData.total=(l=s.payload.data)==null?void 0:l.length,t.displayedCustomFields=s==null?void 0:s.payload.data.slice(0,10),t.loading=!1}).addCase(_.pending,t=>{t.loading=!0})}}),{setTableData:X,setDialogToggle:U,setDialogMode:qe,setSelectedCustomField:Fe,toggleDeleteConfirmation:ae}=ke.actions,la=ke.reducer,ia=se({data:la}),V=le,Le=b.forwardRef((o,t)=>{const{onInputChange:s}=o,l=ue(n,500);function n(d){s==null||s(d)}const p=d=>{l(d.target.value)};return e.jsx(S,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(pe,{className:"text-lg"}),onChange:p})});Le.displayName="CFLeadTableSearch";const da=()=>{const o=F(),t=b.useRef(null),s=V(p=>p.crmCustomFields.data.tableData),l=p=>{const d=I(s);d.query=p,d.pageIndex=1,typeof p=="string"&&p.length>1&&n(d),typeof p=="string"&&p.length===0&&n(d)},n=p=>{o(p?X(p):_())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(Le,{ref:t,onInputChange:l})}),e.jsx("div",{className:"mb-4",children:e.jsx(q,{size:"sm",onClick:()=>{o(U(!0)),o(qe("Add"))},children:"Add New"})})]})},ra=()=>{const o=F(),t=V(m=>m.crmCustomFields.data.loading),s=z("roles","canModify"),l=z("roles","canDelete"),{pageIndex:n,pageSize:p,sort:d,query:x,total:c}=V(m=>m.crmCustomFields.data.tableData),a=V(m=>m.crmCustomFields.data.displayedCustomFields),u=({row:m})=>{const i=F(),{textTheme:j}=ye(),y=()=>{i(Fe(m)),i(U(!0)),i(qe("Edit"))},f=async()=>{await i(Fe(m)),i(ae(!0))};return e.jsxs("div",{className:"flex justify-start text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${j}`,onClick:y,children:e.jsx(me,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:f,children:e.jsx(ge,{})})]})},g=b.useMemo(()=>({pageIndex:n,pageSize:p,sort:d,query:x,total:c}),[n,p,d,x,c]),h=b.useMemo(()=>[{header:"Action",id:"action",cell:i=>e.jsx(u,{row:i.row.original})},{header:"Input Type",accessorKey:"inputType",cell:i=>i.row.original.inputType},{header:"Data Type",accessorKey:"type",cell:i=>i.row.original.type},{header:"Label",accessorKey:"label",cell:i=>i.row.original.label},{header:"Name",accessorKey:"name",cell:i=>i.row.original.name},{header:"Option",accessorKey:"option",cell:i=>{var y,f;const j=(y=i.row.original)!=null&&y.option?(f=i.row.original)==null?void 0:f.option:"-";return e.jsx(R,{text:j,maxLength:15})}},{header:"Default Value",accessorKey:"defaultValue",cell:i=>{var y,f;const j=(y=i.row.original)!=null&&y.defaultValue?(f=i.row.original)==null?void 0:f.defaultValue:"-";return e.jsx(R,{text:j,maxLength:15})}}],[s,l]),C=m=>{const i=I(g);i.pageIndex=m,o(X(i))},r=m=>{const i=I(g);i.pageSize=Number(m),i.pageIndex=1,o(X(i))},N=m=>{const i=I(g);i.sort=m,o(X(i))};return e.jsx("div",{children:e.jsx(xe,{columns:h,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:g.total,pageIndex:g.pageIndex,pageSize:g.pageSize},onPaginationChange:C,onSelectChange:r,onSort:N})})},$e=b.forwardRef((o,t)=>{const s=F(),l=V(c=>c.crmCustomFields.data.dialogMode),n=V(c=>c.crmCustomFields.data.selectedCustomField),p=()=>{s(U(!1))},d=async(c,a,u,g,h)=>{var j,y,f;const C={inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue},r=await g(c==="Add"?ee({id:"4",payload:C}):ta({CustomFieldsId:u==null?void 0:u.id,updatedData:{inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue}}));let N="",m="",i="danger";(j=r==null?void 0:r.payload)!=null&&j.success?(N="Successfully Added",m=(y=r==null?void 0:r.payload)==null?void 0:y.message,i="success"):(N="Something went wrong !!!",m=(f=r==null?void 0:r.error)==null?void 0:f.message),h.push(e.jsx(H,{title:N,type:i,duration:2500,children:m}),{placement:"top-end"}),g(U(!1)),await g(_())},x=Te().shape({inputType:w().required("Input Type is required"),type:w().required("Data Type is required"),label:w().required("Label is required"),name:w().required("Field Name is required"),option:w(),defaultValue:w()});return e.jsx(Ce,{innerRef:t,initialValues:{name:l==="Edit"?n==null?void 0:n.name:"",inputType:l==="Edit"?n==null?void 0:n.inputType:"",type:l==="Edit"?n==null?void 0:n.type:"",label:l==="Edit"?n==null?void 0:n.label:"",option:l==="Edit"?n==null?void 0:n.option:"",defaultValue:l==="Edit"?n==null?void 0:n.defaultValue:""},validationSchema:x,onSubmit:async(c,{setSubmitting:a})=>{l==="Add"?await d("Add",c,null,s,L):await d("Edit",c,n,s,L),a(!1)},children:({touched:c,errors:a,values:u,setFieldValue:g})=>{var h,C;return e.jsxs(je,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Input Type *",invalid:a.inputType&&c.inputType,errorMessage:a.inputType,children:e.jsx(D,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:K,options:O,value:(h=O)==null?void 0:h.find(r=>(r==null?void 0:r.value)==(u==null?void 0:u.inputType)),prefix:e.jsx(W,{className:"text-xl"}),onChange:r=>{g("inputType",r==null?void 0:r.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Data Type *",invalid:a.type&&c.type,errorMessage:a.type,children:e.jsx(D,{type:"text",autoComplete:"off",name:"type",placeholder:"Input Type",component:K,options:P,value:(C=P)==null?void 0:C.find(r=>(r==null?void 0:r.value)==(u==null?void 0:u.type)),prefix:e.jsx(W,{className:"text-xl"}),onChange:r=>{g("type",r==null?void 0:r.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Label *",invalid:a.label&&c.label,errorMessage:a.label,children:e.jsx(D,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Name *",invalid:a.name&&c.name,errorMessage:a.name,children:e.jsx(D,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Option",invalid:a.option&&c.option,errorMessage:a.option,children:e.jsx(D,{type:"text",autoComplete:"off",name:"option",placeholder:"option",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"DefaultValue",invalid:a.defaultValue&&c.defaultValue,errorMessage:a.defaultValue,children:e.jsx(D,{type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:S,prefix:e.jsx(M,{className:"text-xl"})})})})]}),e.jsx(he,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(q,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:p,children:"Cancel"}),e.jsx(q,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(be,{}),children:"Save"})]})})]})}})});$e.displayName="CFLeadForm";const ca=()=>{const o=F(),t=V(d=>{var x,c;return(c=(x=d.crmCustomFields)==null?void 0:x.data)==null?void 0:c.deleteConfirmation}),s=V(d=>{var x,c;return(c=(x=d.crmCustomFields)==null?void 0:x.data)==null?void 0:c.selectedCustomField}),l=()=>{o(ae(!1))},n=(d,x,c,a)=>{var g,h,C;const u=(g=d==null?void 0:d.payload)==null?void 0:g.success;x.push(e.jsx(H,{title:u?c:a,type:u?"success":"danger",duration:2500,children:u?(h=d==null?void 0:d.payload)==null?void 0:h.message:(C=d==null?void 0:d.error)==null?void 0:C.message}),{placement:"top-end"})},p=async()=>{o(ae(!1));const d=await o(oa(s==null?void 0:s.id));n(d,L,"Successfully Deleted","Something Went Wrong !!!"),await o(_())};return e.jsx(De,{isOpen:t,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:p,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Lead? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};ie("crmCustomFields",ia);const pa=()=>{const o=F(),t=V(n=>n.crmCustomFields.data.isDialogOpen),s=V(n=>n.crmCustomFields.data.dialogMode),l=()=>{o(U(!1))};return b.useEffect(()=>{o(_())},[]),e.jsxs(e.Fragment,{children:[e.jsx(da,{}),e.jsx(ra,{}),e.jsxs(fe,{isOpen:t,onClose:l,children:[e.jsxs("h5",{className:"mb-4",children:[s==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx($e,{})]}),e.jsx(ca,{})]})},ma="crmCustomerFields",te=A("crm/custom-fields",async({id:o,payload:t})=>{var s,l;try{return(await de(o,t)).data}catch(n){throw new Error((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)}}),ga=A("crmCustomFields/data/editCustomFields",async({CustomFieldsId:o,updatedData:t})=>{var s,l;try{return(await re(o,t)).data}catch(n){throw new Error((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)}}),ua=A("crmCustomFields/data/deleteCustomFields",async o=>{var t,s;try{return await ce(o)}catch(l){throw new Error((s=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:s.message)}}),B=A("crmCustomFields/data/getcustomFields",async()=>{const o=await _e();return console.log({response:o}),o.data}),xa={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ya={loading:!1,tableData:xa,displayedCustomFields:[],customFields:[],isDialogOpen:!1,dialogMode:"Add",selectedCustomField:null,deleteConfirmation:!1},ze=ne({name:`${ma}/state`,initialState:ya,reducers:{setTableData:(o,t)=>{o.tableData=t.payload;const s=o.customFields.filter(l=>l.name.toLowerCase().includes(t.payload.query.toLowerCase()));o.displayedCustomFields=s.slice(t.payload.pageSize*(t.payload.pageIndex-1),t.payload.pageSize*t.payload.pageIndex)},setSelectedCustomField:(o,t)=>{o.selectedCustomField=t.payload},setDialogToggle:(o,t)=>{o.isDialogOpen=t.payload},setDialogMode:(o,t)=>{o.dialogMode=t.payload},toggleDeleteConfirmation:(o,t)=>{o.deleteConfirmation=t.payload}},extraReducers:o=>{o.addCase(te.fulfilled,(t,s)=>{t.loading=!1}).addCase(te.pending,t=>{t.loading=!0}).addCase(B.fulfilled,(t,s)=>{var l;t.customFields=s==null?void 0:s.payload.data,t.tableData.total=(l=s.payload.data)==null?void 0:l.length,t.displayedCustomFields=s==null?void 0:s.payload.data.slice(0,10),t.loading=!1}).addCase(B.pending,t=>{t.loading=!0})}}),{setTableData:Y,setDialogToggle:Q,setDialogMode:Re,setSelectedCustomField:Ne,toggleDeleteConfirmation:oe}=ze.actions,fa=ze.reducer,ha=se({data:fa}),k=le,Ke=b.forwardRef((o,t)=>{const{onInputChange:s}=o,l=ue(n,500);function n(d){s==null||s(d)}const p=d=>{l(d.target.value)};return e.jsx(S,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(pe,{className:"text-lg"}),onChange:p})});Ke.displayName="CFTaskTableSearch";const Ca=()=>{const o=F(),t=b.useRef(null),s=k(p=>p.crmCustomFields.data.tableData),l=p=>{const d=I(s);d.query=p,d.pageIndex=1,typeof p=="string"&&p.length>1&&n(d),typeof p=="string"&&p.length===0&&n(d)},n=p=>{o(p?Y(p):B())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsx("div",{className:"md:flex items-center gap-4",children:e.jsx(Ke,{ref:t,onInputChange:l})}),e.jsx("div",{className:"mb-4",children:e.jsx(q,{size:"sm",onClick:()=>{o(Q(!0)),o(Re("Add"))},children:"Add New"})})]})},ja=()=>{const o=F(),t=k(m=>m.crmCustomFields.data.loading),s=z("roles","canModify"),l=z("roles","canDelete"),{pageIndex:n,pageSize:p,sort:d,query:x,total:c}=k(m=>m.crmCustomFields.data.tableData),a=k(m=>m.crmCustomFields.data.displayedCustomFields),u=({row:m})=>{const i=F(),{textTheme:j}=ye(),y=()=>{i(Ne(m)),i(Q(!0)),i(Re("Edit"))},f=async()=>{await i(Ne(m)),i(oe(!0))};return e.jsxs("div",{className:"flex justify-start text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${j}`,onClick:y,children:e.jsx(me,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:f,children:e.jsx(ge,{})})]})},g=b.useMemo(()=>({pageIndex:n,pageSize:p,sort:d,query:x,total:c}),[n,p,d,x,c]),h=b.useMemo(()=>[{header:"Action",id:"action",cell:i=>e.jsx(u,{row:i.row.original})},{header:"Input Type",accessorKey:"inputType",cell:i=>i.row.original.inputType},{header:"Data Type",accessorKey:"type",cell:i=>i.row.original.type},{header:"Label",accessorKey:"label",cell:i=>i.row.original.label},{header:"Name",accessorKey:"name",cell:i=>i.row.original.name},{header:"Option",accessorKey:"option",cell:i=>{var y,f;const j=(y=i.row.original)!=null&&y.option?(f=i.row.original)==null?void 0:f.option:"-";return e.jsx(R,{text:j,maxLength:15})}},{header:"Default Value",accessorKey:"defaultValue",cell:i=>{var y,f;const j=(y=i.row.original)!=null&&y.defaultValue?(f=i.row.original)==null?void 0:f.defaultValue:"-";return e.jsx(R,{text:j,maxLength:15})}}],[s,l]),C=m=>{const i=I(g);i.pageIndex=m,o(Y(i))},r=m=>{const i=I(g);i.pageSize=Number(m),i.pageIndex=1,o(Y(i))},N=m=>{const i=I(g);i.sort=m,o(Y(i))};return e.jsx("div",{children:e.jsx(xe,{columns:h,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:g.total,pageIndex:g.pageIndex,pageSize:g.pageSize},onPaginationChange:C,onSelectChange:r,onSort:N})})},Oe=b.forwardRef((o,t)=>{const s=F(),l=k(c=>c.crmCustomFields.data.dialogMode),n=k(c=>c.crmCustomFields.data.selectedCustomField),p=()=>{s(Q(!1))},d=async(c,a,u,g,h)=>{var j,y,f;const C={inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue},r=await g(c==="Add"?te({id:"6",payload:C}):ga({CustomFieldsId:u==null?void 0:u.id,updatedData:{inputType:a==null?void 0:a.inputType,label:a==null?void 0:a.label,type:a==null?void 0:a.type,name:a==null?void 0:a.name,option:a==null?void 0:a.option,defaultValue:a==null?void 0:a.defaultValue}}));let N="",m="",i="danger";(j=r==null?void 0:r.payload)!=null&&j.success?(N="Successfully Added",m=(y=r==null?void 0:r.payload)==null?void 0:y.message,i="success"):(N="Something went wrong !!!",m=(f=r==null?void 0:r.error)==null?void 0:f.message),h.push(e.jsx(H,{title:N,type:i,duration:2500,children:m}),{placement:"top-end"}),g(Q(!1)),await g(B())},x=Te().shape({inputType:w().required("Input Type is required"),type:w().required("Data Type is required"),label:w().required("Label is required"),name:w().required("Field Name is required"),option:w(),defaultValue:w()});return e.jsx(Ce,{innerRef:t,initialValues:{name:l==="Edit"?n==null?void 0:n.name:"",inputType:l==="Edit"?n==null?void 0:n.inputType:"",type:l==="Edit"?n==null?void 0:n.type:"",label:l==="Edit"?n==null?void 0:n.label:"",option:l==="Edit"?n==null?void 0:n.option:"",defaultValue:l==="Edit"?n==null?void 0:n.defaultValue:""},validationSchema:x,onSubmit:async(c,{setSubmitting:a})=>{l==="Add"?await d("Add",c,null,s,L):await d("Edit",c,n,s,L),a(!1)},children:({touched:c,errors:a,values:u,setFieldValue:g})=>{var h,C;return e.jsxs(je,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Input Type *",invalid:a.inputType&&c.inputType,errorMessage:a.inputType,children:e.jsx(D,{type:"text",autoComplete:"off",name:"inputType",placeholder:"Input Type",component:K,options:O,value:(h=O)==null?void 0:h.find(r=>(r==null?void 0:r.value)==(u==null?void 0:u.inputType)),prefix:e.jsx(W,{className:"text-xl"}),onChange:r=>{g("inputType",r==null?void 0:r.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Data Type *",invalid:a.type&&c.type,errorMessage:a.type,children:e.jsx(D,{type:"text",autoComplete:"off",name:"type",placeholder:"Input Type",component:K,options:P,value:(C=P)==null?void 0:C.find(r=>(r==null?void 0:r.value)==(u==null?void 0:u.type)),prefix:e.jsx(W,{className:"text-xl"}),onChange:r=>{g("type",r==null?void 0:r.value)}})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Label *",invalid:a.label&&c.label,errorMessage:a.label,children:e.jsx(D,{type:"text",autoComplete:"off",name:"label",placeholder:"label",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Name *",invalid:a.name&&c.name,errorMessage:a.name,children:e.jsx(D,{type:"text",autoComplete:"off",name:"name",placeholder:"name",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"Option",invalid:a.option&&c.option,errorMessage:a.option,children:e.jsx(D,{type:"text",autoComplete:"off",name:"option",placeholder:"option",component:S,prefix:e.jsx(M,{className:"text-xl"})})})}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{label:"DefaultValue",invalid:a.defaultValue&&c.defaultValue,errorMessage:a.defaultValue,children:e.jsx(D,{type:"text",autoComplete:"off",name:"defaultValue",placeholder:"defaultValue",component:S,prefix:e.jsx(M,{className:"text-xl"})})})})]}),e.jsx(he,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsx(q,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:p,children:"Cancel"}),e.jsx(q,{size:"sm",type:"submit",variant:"solid",icon:e.jsx(be,{}),children:"Save"})]})})]})}})});Oe.displayName="CFTaskForm";const ba=()=>{const o=F(),t=k(d=>{var x,c;return(c=(x=d.crmCustomFields)==null?void 0:x.data)==null?void 0:c.deleteConfirmation}),s=k(d=>{var x,c;return(c=(x=d.crmCustomFields)==null?void 0:x.data)==null?void 0:c.selectedCustomField}),l=()=>{o(oe(!1))},n=(d,x,c,a)=>{var g,h,C;const u=(g=d==null?void 0:d.payload)==null?void 0:g.success;x.push(e.jsx(H,{title:u?c:a,type:u?"success":"danger",duration:2500,children:u?(h=d==null?void 0:d.payload)==null?void 0:h.message:(C=d==null?void 0:d.error)==null?void 0:C.message}),{placement:"top-end"})},p=async()=>{o(oe(!1));const d=await o(ua(s==null?void 0:s.id));n(d,L,"Successfully Deleted","Something Went Wrong !!!"),await o(B())};return e.jsx(De,{isOpen:t,type:"danger",title:"Delete Custom Field",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:p,children:e.jsx("p",{children:"Are you sure you want to delete this Custom Field of Task? All record related to this Custom Field will be deleted as well. This action cannot be undone."})})};ie("crmCustomFields",ha);const Ta=()=>{const o=F(),t=k(n=>n.crmCustomFields.data.isDialogOpen),s=k(n=>n.crmCustomFields.data.dialogMode),l=()=>{o(Q(!1))};return b.useEffect(()=>{o(B())},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ca,{}),e.jsx(ja,{}),e.jsxs(fe,{isOpen:t,onClose:l,children:[e.jsxs("h5",{className:"mb-4",children:[s==="Edit"?"Edit":"Add New"," Custom Field"]}),e.jsx(Oe,{})]}),e.jsx(ba,{})]})},{TabNav:Da,TabList:wa}=Me,Se={CFContact:{label:"Contact",path:"CFContact"},CFLead:{label:"Lead",path:"CFLead"},CFTask:{label:"Task",path:"CFTask"}},Fa=()=>{const[o,t]=b.useState("CFContact"),s=l=>{t(l)};return e.jsxs(e.Fragment,{children:[e.jsx(Me,{value:o,variant:"pill",onChange:l=>s(l),children:e.jsx(wa,{children:Object.keys(Se).map(l=>e.jsx(Da,{value:l,children:Se[l].label},l))})}),e.jsx("div",{className:"py-4",children:e.jsxs(b.Suspense,{fallback:e.jsx(e.Fragment,{children:"loading..."}),children:[o==="CFContact"&&e.jsx(ea,{}),o==="CFLead"&&e.jsx(pa,{}),o==="CFTask"&&e.jsx(Ta,{})]})})]})},At=Fa;export{At as C};
