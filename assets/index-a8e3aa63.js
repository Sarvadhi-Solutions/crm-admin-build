import{r as m,j as t,a as A,$ as O,au as ue,av as it,aw as R,p as st,ap as rt,ah as ot,aq as lt}from"./index-dddc73b4.js";import{A as ct}from"./AdaptableCard-ce723550.js";import{u as S,c as Z,g as K,e as qe,s as Ue,a as ee,t as Ce,d as dt,b as oe,f as ut,h as pt,i as mt,j as ft,k as ve,p as le,l as ht,m as Ee,n as Se,r as xt}from"./index-afa54ef5.js";import{B as Q}from"./Button-fccc7ec9.js";import{c as re}from"./cloneDeep-85ce2294.js";import{I as L}from"./Input-5850a060.js";import{b as gt,U as xe,R as vt,P as yt,Q as jt,o as Tt,N as bt,C as Ct}from"./index.esm-d67f1fea.js";import{d as Et}from"./debounce-aee85e11.js";import{u as ge}from"./checkEditUpdate-f617cc5e.js";import{D as St}from"./DataTable-b15b5dcf.js";import"./Alert-cf54f403.js";import{A as Dt}from"./index-1362588f.js";import"./Badge-dc5489f9.js";import"./RangeCalendar-aa2dbffc.js";import{C as Nt}from"./Card-7410c075.js";import"./index-2a82ee21.js";import"./index-3357ac52.js";import{D as ze}from"./Dialog-ffb69b88.js";import{D as kt}from"./Drawer-b1e7a53d.js";import"./index-e4a64f41.js";import{a as I,F as we}from"./FormItem-0b75ed5f.js";import"./toString-a6a23b36.js";import"./index-5e738818.js";import"./index-9e2f2544.js";import"./index-b19ef1d4.js";import{t as te,N as ae}from"./toast-01ef835c.js";import"./Pagination-cf39b87f.js";import"./Progress-460bd8d4.js";import"./index-3c4abbfc.js";import"./ScrollBar-d0a61849.js";import"./index-fb12a62f.js";import{m as wt,d as Mt,S as B}from"./Select-5a530df2.js";import"./Skeleton-3cda18f0.js";import"./index-6059803a.js";import"./Switcher-66372525.js";import"./index-d1777bcb.js";import{T as We}from"./index-9c06c89e.js";import"./Tag-60ecae5b.js";import"./index-ab797a48.js";import"./index-3a5ac88e.js";import{T as pe}from"./Tooltip-8ca67ef0.js";import{U as It}from"./Upload-52acc79c.js";import{S as Pe}from"./StatusCapsule-2f323e31.js";import{T as Ft}from"./TagsList-5a45fdfe.js";import{T as me}from"./TextTruncate-18e43474.js";import{u as At}from"./useThemeClass-3ace2c60.js";import{h as Vt}from"./moment-fbc5633a.js";import{b as Me,A as _e,a as Pt}from"./index.esm-00b474e3.js";import{a as Rt}from"./index.esm-574076e0.js";import{d as Lt}from"./index.esm-76406a4c.js";import{C as Ot}from"./ConfirmDialog-fa58d2f8.js";import{i as $t}from"./Views-ae1e9425.js";import{u as qt,b as F,F as Ie,a as Fe}from"./formik.esm-f57476f4.js";import{c as je,a as k,e as He}from"./index.esm-fb83748d.js";import{t as Ut}from"./tagAndCategory-228f57e7.js";/* empty css              */import{G as Te}from"./index.esm-760b52b0.js";import{a as Ye,_ as ne}from"./objectWithoutProperties-8809bfcf.js";import{_ as z}from"./toConsumableArray-e88cb349.js";import{_ as De}from"./slicedToArray-424a3759.js";import{_ as Ge}from"./inheritsLoose-67785447.js";import{g as zt}from"./index-660e88d3.js";import"./chart.constant-504ce5e6.js";import"./chart.config-48a6b60d.js";import"./GrowShrinkTag-df005181.js";import"./react-tooltip.min-bf622d2a.js";import"./RichTextEditor-f5eb1640.js";import"./SegmentItemOption-dbaa1ba3.js";import{S as Ke}from"./StickyFooter-bab8eb54.js";import"./SvgIcon-213b65aa.js";import{D as Wt}from"./DoubleSidedImage-5495de24.js";import{M as _t}from"./MediaSkeleton-e448c71e.js";import{N as Ht}from"./react-number-format.es-c93b0e39.js";import"./CrmService-3830a070.js";import"./index-44d411be.js";import"./_MapCache-b582f7ad.js";import"./_getPrototype-510fa938.js";import"./isNil-4bbd6f18.js";import"./get-4796796c.js";import"./index-8a98a4c9.js";import"./useTimeout-4147c52c.js";import"./CloseButton-9c4c449e.js";import"./StatusIcon-49640060.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-a25289ca.js";import"./_baseIsEqual-a806cac4.js";import"./useRootClose-cdfb724d.js";import"./usePopper-12f3dc15.js";import"./TimeInput-18bcf36e.js";import"./useUniqueId-1e16ac78.js";import"./useDidUpdate-3c58017a.js";import"./index-9e55e515.js";import"./useUncertainRef-a033bd83.js";import"./index-81597033.js";import"./chainedFunction-070f832c.js";import"./floating-ui.dom-bef9cea3.js";import"./mapCloneElement-0d2e1396.js";import"./index.esm-9430486c.js";import"./index.esm-604e49a5.js";import"./index.esm-0a2a5ef5.js";const Qe=m.forwardRef((l,i)=>{const{onInputChange:e}=l,r=Et(a,500);function a(s){e==null||e(s)}const n=s=>{r(s.target.value)};return t.jsx(L,{ref:i,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search by title",prefix:t.jsx(gt,{className:"text-lg"}),onChange:n})});Qe.displayName="TasksTableSearch";const Yt=()=>{const l=A(),i=m.useRef(null),e=S(o=>o.crmTasks.data.tableData),r=ge("tasks","canCreate"),a=o=>{const c=re(e);c.query=o,c.pageIndex=1,typeof o=="string"&&o.length>1&&n(c),typeof o=="string"&&o.length===0&&n(c)},n=o=>{l(o?Z(o):K())},s=()=>{l(qe()),l(Ue("Add")),l(ee({}))};return m.useEffect(()=>{i.current&&(i.current.value=e.query||"",l(Z(e)))},[e==null?void 0:e.query]),t.jsxs("div",{className:"md:flex items-center justify-between",children:[t.jsx("div",{className:"md:flex items-center gap-4",children:t.jsx(Qe,{ref:i,onInputChange:a})}),t.jsx("div",{className:"mb-4",children:r&&t.jsx(Q,{size:"sm",onClick:s,children:"Add New"})})]})},Gt=()=>{const l=A(),i=S(n=>n.crmTasks.data.deleteConfirmation),e=S(n=>n.crmTasks.data.selectedTask),r=()=>{l(Ce(!1))},a=async()=>{var s,o,c;l(Ce(!1));const n=await l(dt(e.id));await l(K()),(s=n==null?void 0:n.payload)!=null&&s.success?te.push(t.jsx(ae,{title:"Successfuly Deleted",type:"success",duration:2500,children:(o=n==null?void 0:n.payload)==null?void 0:o.message}),{placement:"top-end"}):te.push(t.jsx(ae,{title:"Something Went Wrong !!!",type:"danger",duration:2500,children:(c=n==null?void 0:n.error)==null?void 0:c.message}),{placement:"top-end"}),await l(oe())};return t.jsx(Ot,{isOpen:i,type:"danger",title:"Delete Task",confirmButtonColor:"red-600",onClose:r,onRequestClose:r,onCancel:r,onConfirm:a,children:t.jsx("p",{children:"Are you sure you want to delete this Task? All record related to this task will be deleted as well. This action cannot be undone."})})},Re={disabled:!1},ye=O.createContext(null);var Kt=function(i){return i.scrollTop},ie="unmounted",H="exited",Y="entering",J="entered",Ne="exiting",$=function(l){Ge(i,l);function i(r,a){var n;n=l.call(this,r,a)||this;var s=a,o=s&&!s.isMounting?r.enter:r.appear,c;return n.appearStatus=null,r.in?o?(c=H,n.appearStatus=Y):c=J:r.unmountOnExit||r.mountOnEnter?c=ie:c=H,n.state={status:c},n.nextCallback=null,n}i.getDerivedStateFromProps=function(a,n){var s=a.in;return s&&n.status===ie?{status:H}:null};var e=i.prototype;return e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},e.componentDidUpdate=function(a){var n=null;if(a!==this.props){var s=this.state.status;this.props.in?s!==Y&&s!==J&&(n=Y):(s===Y||s===J)&&(n=Ne)}this.updateStatus(!1,n)},e.componentWillUnmount=function(){this.cancelNextCallback()},e.getTimeouts=function(){var a=this.props.timeout,n,s,o;return n=s=o=a,a!=null&&typeof a!="number"&&(n=a.exit,s=a.enter,o=a.appear!==void 0?a.appear:s),{exit:n,enter:s,appear:o}},e.updateStatus=function(a,n){if(a===void 0&&(a=!1),n!==null)if(this.cancelNextCallback(),n===Y){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:ue.findDOMNode(this);s&&Kt(s)}this.performEnter(a)}else this.performExit();else this.props.unmountOnExit&&this.state.status===H&&this.setState({status:ie})},e.performEnter=function(a){var n=this,s=this.props.enter,o=this.context?this.context.isMounting:a,c=this.props.nodeRef?[o]:[ue.findDOMNode(this),o],h=c[0],x=c[1],j=this.getTimeouts(),f=o?j.appear:j.enter;if(!a&&!s||Re.disabled){this.safeSetState({status:J},function(){n.props.onEntered(h)});return}this.props.onEnter(h,x),this.safeSetState({status:Y},function(){n.props.onEntering(h,x),n.onTransitionEnd(f,function(){n.safeSetState({status:J},function(){n.props.onEntered(h,x)})})})},e.performExit=function(){var a=this,n=this.props.exit,s=this.getTimeouts(),o=this.props.nodeRef?void 0:ue.findDOMNode(this);if(!n||Re.disabled){this.safeSetState({status:H},function(){a.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:Ne},function(){a.props.onExiting(o),a.onTransitionEnd(s.exit,function(){a.safeSetState({status:H},function(){a.props.onExited(o)})})})},e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},e.safeSetState=function(a,n){n=this.setNextCallback(n),this.setState(a,n)},e.setNextCallback=function(a){var n=this,s=!0;return this.nextCallback=function(o){s&&(s=!1,n.nextCallback=null,a(o))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},e.onTransitionEnd=function(a,n){this.setNextCallback(n);var s=this.props.nodeRef?this.props.nodeRef.current:ue.findDOMNode(this),o=a==null&&!this.props.addEndListener;if(!s||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],h=c[0],x=c[1];this.props.addEndListener(h,x)}a!=null&&setTimeout(this.nextCallback,a)},e.render=function(){var a=this.state.status;if(a===ie)return null;var n=this.props,s=n.children;n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef;var o=Ye(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return O.createElement(ye.Provider,{value:null},typeof s=="function"?s(a,o):O.cloneElement(O.Children.only(s),o))},i}(O.Component);$.contextType=ye;$.propTypes={};function X(){}$.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:X,onEntering:X,onEntered:X,onExit:X,onExiting:X,onExited:X};$.UNMOUNTED=ie;$.EXITED=H;$.ENTERING=Y;$.ENTERED=J;$.EXITING=Ne;const Be=$;function Ae(l,i){var e=function(n){return i&&m.isValidElement(n)?i(n):n},r=Object.create(null);return l&&m.Children.map(l,function(a){return a}).forEach(function(a){r[a.key]=e(a)}),r}function Qt(l,i){l=l||{},i=i||{};function e(x){return x in i?i[x]:l[x]}var r=Object.create(null),a=[];for(var n in l)n in i?a.length&&(r[n]=a,a=[]):a.push(n);var s,o={};for(var c in i){if(r[c])for(s=0;s<r[c].length;s++){var h=r[c][s];o[r[c][s]]=e(h)}o[c]=e(c)}for(s=0;s<a.length;s++)o[a[s]]=e(a[s]);return o}function G(l,i,e){return e[i]!=null?e[i]:l.props[i]}function Bt(l,i){return Ae(l.children,function(e){return m.cloneElement(e,{onExited:i.bind(null,e),in:!0,appear:G(e,"appear",l),enter:G(e,"enter",l),exit:G(e,"exit",l)})})}function Xt(l,i,e){var r=Ae(l.children),a=Qt(i,r);return Object.keys(a).forEach(function(n){var s=a[n];if(m.isValidElement(s)){var o=n in i,c=n in r,h=i[n],x=m.isValidElement(h)&&!h.props.in;c&&(!o||x)?a[n]=m.cloneElement(s,{onExited:e.bind(null,s),in:!0,exit:G(s,"exit",l),enter:G(s,"enter",l)}):!c&&o&&!x?a[n]=m.cloneElement(s,{in:!1}):c&&o&&m.isValidElement(h)&&(a[n]=m.cloneElement(s,{onExited:e.bind(null,s),in:h.props.in,exit:G(s,"exit",l),enter:G(s,"enter",l)}))}}),a}var Jt=Object.values||function(l){return Object.keys(l).map(function(i){return l[i]})},Zt={component:"div",childFactory:function(i){return i}},Ve=function(l){Ge(i,l);function i(r,a){var n;n=l.call(this,r,a)||this;var s=n.handleExited.bind(it(n));return n.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},n}var e=i.prototype;return e.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},e.componentWillUnmount=function(){this.mounted=!1},i.getDerivedStateFromProps=function(a,n){var s=n.children,o=n.handleExited,c=n.firstRender;return{children:c?Bt(a,o):Xt(a,s,o),firstRender:!1}},e.handleExited=function(a,n){var s=Ae(this.props.children);a.key in s||(a.props.onExited&&a.props.onExited(n),this.mounted&&this.setState(function(o){var c=z({},o.children);return delete c[a.key],{children:c}}))},e.render=function(){var a=this.props,n=a.component,s=a.childFactory,o=Ye(a,["component","childFactory"]),c=this.state.contextValue,h=Jt(this.state.children).map(s);return delete o.appear,delete o.enter,delete o.exit,n===null?O.createElement(ye.Provider,{value:c},h):O.createElement(ye.Provider,{value:c},O.createElement(n,o,h))},i}(O.Component);Ve.propTypes={};Ve.defaultProps=Zt;const Xe=Ve;var ea=["in","onExited","appear","enter","exit"],ta=function(i){return function(e){e.in,e.onExited,e.appear,e.enter,e.exit;var r=ne(e,ea);return m.createElement(i,r)}},aa=ta,na=["component","duration","in","onExited"],Je=function(i){var e=i.component,r=i.duration,a=r===void 0?1:r,n=i.in;i.onExited;var s=ne(i,na),o=m.useRef(null),c={entering:{opacity:0},entered:{opacity:1,transition:"opacity ".concat(a,"ms")},exiting:{opacity:0},exited:{opacity:0}};return m.createElement(Be,{mountOnEnter:!0,unmountOnExit:!0,in:n,timeout:a,nodeRef:o},function(h){var x={style:R({},c[h]),ref:o};return m.createElement(e,z({innerProps:x},s))})},ke=260,ia=function(i){var e=i.children,r=i.in,a=i.onExited,n=m.useRef(null),s=m.useState("auto"),o=De(s,2),c=o[0],h=o[1];m.useEffect(function(){var j=n.current;if(j){var f=window.requestAnimationFrame(function(){return h(j.getBoundingClientRect().width)});return function(){return window.cancelAnimationFrame(f)}}},[]);var x=function(f){switch(f){default:return{width:c};case"exiting":return{width:0,transition:"width ".concat(ke,"ms ease-out")};case"exited":return{width:0}}};return m.createElement(Be,{enter:!1,mountOnEnter:!0,unmountOnExit:!0,in:r,onExited:function(){var f=n.current;f&&(a==null||a(f))},timeout:ke,nodeRef:n},function(j){return m.createElement("div",{ref:n,style:R({overflow:"hidden",whiteSpace:"nowrap"},x(j))},e)})},sa=["in","onExited"],ra=function(i){return function(e){var r=e.in,a=e.onExited,n=ne(e,sa);return m.createElement(ia,{in:r,onExited:a},m.createElement(i,z({cropWithEllipsis:r},n)))}},oa=ra,la=function(i){return function(e){return m.createElement(Je,z({component:i,duration:e.isMulti?ke:1},e))}},ca=la,da=function(i){return function(e){return m.createElement(Je,z({component:i},e))}},ua=da,pa=["component"],ma=["children"],fa=function(i){return function(e){return e.isMulti?m.createElement(ha,z({component:i},e)):m.createElement(Xe,z({component:i},e))}},ha=function(i){var e=i.component,r=ne(i,pa),a=xa(r);return m.createElement(Xe,z({component:e},a))},xa=function(i){var e=i.children,r=ne(i,ma),a=r.isMulti,n=r.hasValue,s=r.innerProps,o=r.selectProps,c=o.components,h=o.controlShouldRenderValue,x=m.useState(a&&h&&n),j=De(x,2),f=j[0],C=j[1],N=m.useState(!1),T=De(N,2),b=T[0],E=T[1];m.useEffect(function(){n&&!f&&C(!0)},[n,f]),m.useEffect(function(){b&&!n&&f&&C(!1),E(!1)},[b,n,f]);var D=function(){return E(!0)},v=function(y){if(a&&m.isValidElement(y)){if(y.type===c.MultiValue)return m.cloneElement(y,{onExited:D});if(y.type===c.Placeholder&&f)return null}return y},d=R(R({},s),{},{style:R(R({},s==null?void 0:s.style),{},{display:a&&n||f?"flex":"grid"})}),p=R(R({},r),{},{innerProps:d,children:m.Children.toArray(e).map(v)});return p},ga=fa,va=["Input","MultiValue","Placeholder","SingleValue","ValueContainer"],Ze=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=Mt({components:i}),r=e.Input,a=e.MultiValue,n=e.Placeholder,s=e.SingleValue,o=e.ValueContainer,c=ne(e,va);return R({Input:aa(r),MultiValue:oa(a),Placeholder:ca(n),SingleValue:ua(s),ValueContainer:ga(o)},c)},ce=Ze();ce.Input;ce.MultiValue;ce.Placeholder;ce.SingleValue;ce.ValueContainer;var ya=wt(Ze);const Le=[{label:"None",value:"none"},{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"}],fe=[{label:"Contact",value:"contact"},{label:"Lead",value:"lead"},{label:"Deal",value:"deal"}],Oe={contact:[{label:"Meeting",value:"meeting"},{label:"Other",value:"other"}],lead:[{label:"FollowUp",value:"followup"},{label:"Quotation",value:"quotation"},{label:"Meeting",value:"meeting"},{label:"Other",value:"other"}],deal:[{label:"Feedback",value:"feedback"},{label:"Delivery",value:"delivery"},{label:"Payment Clearance",value:"Paymentclearness"}]},$e={followup:{label:"Next Follow-Up Date and Time*",placeholder:"Select Next Follow-Up Date and Time"},delivery:{label:"Delivery Date & Time*",placeholder:"Select Delivery Date & Time"},meeting:{label:"Meeting Date and Time*",placeholder:"Select Meeting Date & Time"}},se=[],he=[],ja=l=>{var W,P,_;const{touched:i,errors:e,setFieldValue:r,values:a}=l,n=A();m.useState(!1),m.useState(!1);const[s,o]=m.useState(null),[c,h]=m.useState(null),[x,j]=m.useState(""),[f,C]=m.useState([]),[N,T]=m.useState("");m.useEffect(()=>{const u=async()=>{var V,w;try{const{payload:M}=await n(pt()),q=(V=M==null?void 0:M.data)==null?void 0:V.find(U=>(U==null?void 0:U.moduleName)==="tasks");if(T(q.id),o(a==null?void 0:a.module),h(a==null?void 0:a.type),j(a==null?void 0:a.nextDateTime),q){const{payload:U}=await n(mt({id:(w=q==null?void 0:q.id)==null?void 0:w.toString()})),de=Ut(U.data);C(de)}}catch(M){console.error("Error fetching module data:",M)}};n(ut()),n(zt()),u()},[n]),S(u=>u.crmTasks.data.selectedTask);const b=S(u=>u.crmTasks.data.drawerMode),E=qt(),D=u=>{E.setFieldValue("tagId",u)},v=ya(),d=S(u=>u.crmTasks.data.usersList);se.length=0,d==null||d.forEach(u=>{se.push({label:`${u==null?void 0:u.firstName} ${u==null?void 0:u.lastName}`,value:u.id})});const p=u=>{o(u.value),r("module",u==null?void 0:u.value),h(null),j("")},g=u=>{r("type",u==null?void 0:u.value),h(u.value)},y=S(u=>u.crmTasks.data.leadsList);return he.length=0,y==null||y.forEach(u=>{he.push({value:u.id,label:u.title})}),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Module",invalid:e.module&&i.module,errorMessage:e.module,children:t.jsx(F,{type:"text",autoComplete:"off",name:"module",placeholder:"Module",component:B,options:fe,value:fe==null?void 0:fe.find(u=>(u==null?void 0:u.value)==(a==null?void 0:a.module)),prefix:t.jsx(Te,{className:"text-xl"}),onChange:p})})}),t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Type",invalid:e.type&&i.type,errorMessage:e.type,children:t.jsx(F,{type:"text",autoComplete:"off",name:"type",placeholder:"Type",component:B,options:Oe[s]||[],value:(W=Oe[s])==null?void 0:W.find(u=>(u==null?void 0:u.value)==(a==null?void 0:a.type)),prefix:t.jsx(Te,{className:"text-xl"}),onChange:g})})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c==="followup"||c==="delivery"||c==="meeting"?t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:(P=$e[c])==null?void 0:P.label,invalid:e.nextDateTime&&i.nextDateTime,errorMessage:e.nextDateTime,children:t.jsx(F,{type:"dateTime-local",autoComplete:"off",name:"nextDateTime",placeholder:(_=$e[c])==null?void 0:_.placeholder,component:L,prefix:t.jsx(xe,{className:"text-xl"}),value:a.nextDateTime,onChange:u=>{var V;j(u.target.value),r("nextDateTime",(V=u.target)==null?void 0:V.value)}})})}):null,c==="delivery"&&t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Delivery Address",invalid:e.address&&i.address,errorMessage:e.address,children:t.jsx(F,{type:"text",autoComplete:"off",name:"address",placeholder:"Delivery Address",component:L,prefix:t.jsx(xe,{className:"text-xl"})})})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Title *",invalid:e.title&&i.title,errorMessage:e.title,children:t.jsx(F,{type:"text",autoComplete:"off",name:"title",placeholder:"Title",component:L,prefix:t.jsx(vt,{className:"text-xl"})})})}),t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Due Date *",invalid:e.dueDate&&i.dueDate,errorMessage:e.dueDate,children:t.jsx(F,{isDisabled:b==="Edit",type:"dateTime-local",autoComplete:"off",name:"dueDate",component:L,prefix:t.jsx(xe,{className:"text-xl"})})})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Priority *",invalid:e.priority&&i.priority,errorMessage:e.priority,children:t.jsx(B,{name:"priority",id:"priority",components:v,value:Le.find(u=>(u==null?void 0:u.value)===(a==null?void 0:a.priority)),options:Le,onChange:u=>{r("priority",u.value||"")}})})}),t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Assigned To",invalid:e.assignedTo&&i.assignedTo,errorMessage:e.assignedTo,children:t.jsx(B,{name:"assignedTo",id:"assignedTo",value:se.find(u=>(u==null?void 0:u.value)===(a==null?void 0:a.assignedTo)),options:se,onChange:u=>{r("assignedTo",u.value||"")}})})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Connected Lead",invalid:e.connectedLead&&i.connectedLead,errorMessage:e.connectedLead,children:t.jsx(B,{name:"connectedLead",id:"connectedLead",value:he.find(u=>(u==null?void 0:u.value)===(a==null?void 0:a.connectedLead)),options:he,onChange:u=>{r("connectedLead",u.value||"")}})})}),t.jsx("div",{className:"col-span-1",children:t.jsx(I,{label:"Tag",children:t.jsx(F,{isClearable:!0,isMulti:!0,type:"text",autoComplete:"off",name:"tagId",placeholder:"Select tags",component:B,options:f,prefix:t.jsx(Te,{className:"text-xl"}),closeMenuOnSelect:!1,onChange:D})})})]}),t.jsx(I,{label:"Notes",invalid:e.descriptions&&i.descriptions,errorMessage:e.descriptions,children:t.jsx(F,{textArea:!0,type:"text",autoComplete:"off",name:"descriptions",placeholder:"Notes",component:L,prefix:t.jsx(Me,{className:"text-xl"})})})]})},Ta=je().shape({title:k().required("Title is Required"),module:k(),type:k(),tagId:He(),connectedLead:k(),descriptions:k(),priority:k().oneOf(["none","low","medium","high"]).required("Priority is required"),nextDateTime:k().test("date-required","Date is required",function(l){const i=this.parent.type;return!((i==="followup"||i==="delivery"||i==="meeting")&&!l)})}),ba=je().shape({module:k(),type:k(),nextDateTime:k().test("date-required","Date is required",function(l){const i=this.parent.type;return!((i==="followup"||i==="delivery"||i==="meeting")&&!l)}),address:k().test("Address is Require","Delivery Address is Require",function(l){return!(this.parent.type==="delivery"&&!l)}),title:k().required("Title is required"),dueDate:k().required("Due Date is required"),tagId:He(),connectedLead:k(),descriptions:k(),assignedTo:k().test("is-valid-user","Invalid user selected",function(l){return this.parent.assignedTo&&this.parent.assignedTo.length>0?!!se.find(i=>i.value==l):!0}),priority:k().oneOf(["none","low","medium","high"]).required("Priority is required")}),{TabNav:Ca,TabList:Ea,TabContent:Sa}=We,et=m.forwardRef((l,i)=>{var c,h,x,j;const e=S(f=>f.crmTasks.data.selectedTask),r=S(f=>f.crmTasks.data.drawerMode),a=A();function n(f){if(!f)return"";const C=f.split("T");if(C.length!==2)return"";const N=C[0],T=C[1].slice(0,5);return`${N}T${T}`}const s=f=>{const C=new Date(f);if(isNaN(C.getTime()))return"";const N=C.getFullYear(),T=(C.getMonth()+1).toString().padStart(2,"0"),b=C.getDate().toString().padStart(2,"0"),E=C.getHours().toString().padStart(2,"0"),D=C.getMinutes().toString().padStart(2,"0");return`${N}-${T}-${b} ${E}:${D}`},o=async(f,C)=>{var y,W,P,_,u,V,w;const{colorName:N,tagName:T,dueDate:b,...E}=f,D=s(b);let v,d,p;r==="Add"?(v=await a(ft({dueDate:D,...E,tagId:f==null?void 0:f.tagId.map(M=>M.value)})),d="Successfully Added",p="Something went wrong !!!",(y=v==null?void 0:v.payload)!=null&&y.success&&a(ve())):(v=await a(le({taskId:e==null?void 0:e.id,data:{...E,tagId:f==null?void 0:f.tagId.map(M=>M.value)}})),d="Successfully Updated",p="Something went wrong !!!",(W=v==null?void 0:v.payload)!=null&&W.success&&a(ve()));const g=(P=v==null?void 0:v.payload)!=null&&P.success?"success":"danger";te.push(t.jsx(ae,{title:(_=v==null?void 0:v.payload)!=null&&_.success?d:p,type:g,duration:2500,children:(u=v==null?void 0:v.payload)!=null&&u.success?(V=v==null?void 0:v.payload)==null?void 0:V.message:(w=v==null?void 0:v.error)==null?void 0:w.message}),{placement:"top-end"}),await a(K()),await a(oe()),C(!1)};return t.jsx(Ie,{innerRef:i,initialValues:{module:(e==null?void 0:e.module)||"",type:(e==null?void 0:e.type)||"",nextDateTime:n(e==null?void 0:e.nextDateTime)||"",title:(e==null?void 0:e.title)||"",address:(e==null?void 0:e.address)||"",connectedLead:(e==null?void 0:e.connectedLead)||"",dueDate:n(e==null?void 0:e.dueDate)||"",descriptions:(e==null?void 0:e.descriptions)||"",tagId:((c=e==null?void 0:e.tags)==null?void 0:c.map(f=>({label:f.tagName,value:f.id})))||[],tagName:((x=(h=e==null?void 0:e.tags)==null?void 0:h[0])==null?void 0:x.tagName)||"",priority:(e==null?void 0:e.priority)||"",assignedTo:((j=e==null?void 0:e.assignedToData)==null?void 0:j.id)||"",colorName:e!=null&&e.tags&&(e==null?void 0:e.tags.length)>0?e==null?void 0:e.tags[0].colorName:""},validationSchema:r==="Edit"?Ta:ba,onSubmit:async(f,{setSubmitting:C})=>{await o(f,C)},children:({touched:f,errors:C,setFieldValue:N,values:T})=>t.jsx(Fe,{children:t.jsx(we,{children:t.jsxs(We,{defaultValue:"taskDetails",children:[t.jsx(Ea,{children:t.jsx(Ca,{value:"taskDetails",children:"Tasks details"})}),t.jsx("div",{className:"p-6",children:t.jsx(Sa,{value:"taskDetails",children:t.jsx(ja,{touched:f,errors:C,values:T,setFieldValue:N})})})]})})})})});et.displayName="TasksForm";const tt=m.forwardRef((l,i)=>{const e=A(),r=S(o=>o.crmTasks.data.selectedTask),a=S(o=>o.crmTasks.data.tasksList),{id:n}=r,s=o=>{const{name:c,birthday:h,email:x,img:j,location:f,title:C,phoneNumber:N,facebook:T,twitter:b,pinterest:E,linkedIn:D}=o,v={name:c,email:x,img:j},d={location:f,title:C,birthday:st(h).format("DD/MM/YYYY"),phoneNumber:N,facebook:T,twitter:b,pinterest:E,linkedIn:D};let p=re(a),g={};p=p.map(y=>(y.id===n&&(y={...y,...v},y.personalInfo={...y.personalInfo,...d},g=y),y)),$t(g)||e(le(g)),e(ve()),e(ht(p))};return t.jsx(et,{ref:i,tasks:r,onFormSubmit:s})});tt.displayName="TasksEditContent";const Da=({onSaveClick:l,onCancel:i})=>t.jsxs("div",{className:"text-right w-full",children:[t.jsx(Q,{size:"sm",className:"mr-2",onClick:i,children:"Cancel"}),t.jsx(Q,{size:"sm",variant:"solid",onClick:l,children:"Save"})]}),Na=()=>{const l=A(),i=S(c=>c.crmTasks.data.drawerOpen);S(c=>c.crmTasks.data.drawerMode),S(c=>c.crmTasks.data.selectedTask);const[e,r]=m.useState(window.innerWidth/2),a=()=>{l(ve()),l(ee({}))},n=m.useRef(null),s=async()=>{var c;(c=n.current)==null||c.submitForm()};m.useEffect(()=>(window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}),[]);const o=()=>{r(window.innerWidth/2)};return t.jsx(kt,{isOpen:i,closable:!1,bodyClass:"p-0",width:e,footer:t.jsx(Da,{onCancel:a,onSaveClick:s}),onClose:a,onRequestClose:a,children:t.jsx(tt,{ref:n})})},at=m.forwardRef((l,i)=>{const e=A(),r=S(h=>h.crmTasks.data.followUPConfirmation),a=S(h=>h.crmTasks.data.selectedTask),n=S(h=>h.crmTasks.data.loading),s=()=>{e(Ee(!1))},o=je().shape({descriptions:k().required("Notes is required")}),c=async h=>{var f,C,N;const x=await e(le({taskId:a==null?void 0:a.id,data:h})),j=(f=x==null?void 0:x.payload)!=null&&f.success?{title:"Successfully Updated",type:"success",message:(C=x==null?void 0:x.payload)==null?void 0:C.message}:{title:"Something Went Wrong !!!",type:"danger",message:(N=x==null?void 0:x.error)==null?void 0:N.message};te.push(t.jsx(ae,{title:j.title,type:j==null?void 0:j.type,duration:2500,children:j.message}),{placement:"top-end"}),await e(K()),await e(oe()),await e(Ee(!1))};return t.jsxs(ze,{isOpen:r,onClose:s,children:[t.jsx("h5",{className:"mb-4",children:"Follow Up"}),t.jsx(Ie,{innerRef:i,initialValues:{descriptions:"",nextDateTime:""},validationSchema:o,onSubmit:async(h,{setSubmitting:x})=>{console.log(h);const j={completionStatus:"completed",...h};await c(j),x(!1)},children:({touched:h,errors:x,values:j,setFieldValue:f})=>t.jsxs(Fe,{children:[t.jsxs(we,{children:[t.jsx(I,{label:"Next Follow-Up Date and Time",invalid:x.nextDateTime&&h.nextDateTime,errorMessage:x.nextDateTime,children:t.jsx(F,{type:"dateTime-local",autoComplete:"off",name:"nextDateTime",placeholder:"Select Next Follow-Up Date and Time",component:L,prefix:t.jsx(xe,{className:"text-xl"})})}),t.jsx(I,{label:"Notes",invalid:x.descriptions&&h.descriptions,errorMessage:x.descriptions,children:t.jsx(F,{textArea:!0,type:"text",autoComplete:"off",name:"descriptions",placeholder:"Notes",component:L,prefix:t.jsx(Me,{className:"text-xl"})})})]}),t.jsx(Ke,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"md:flex items-center",children:[t.jsx(Q,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:s,children:"Cancel"}),t.jsx(Q,{size:"sm",type:"submit",variant:"solid",icon:t.jsx(_e,{}),loading:n,children:"Save"})]})})]})})]})});at.displayName="FollowUpTaskConfirmation";const nt=m.forwardRef((l,i)=>{const e=A(),[r,a]=m.useState(""),[n,s]=m.useState(""),o=S(T=>T.crmTasks.data.quotationConfirmation),c=S(T=>T.crmTasks.data.selectedTask),h=S(T=>T.crmTasks.data.loading),x=()=>{e(Se(!1)),a("")},j=je().shape({descriptions:k().required("Notes is required")}),f=async T=>{var D,v,d;const b=await e(le({taskId:c==null?void 0:c.id,data:T})),E=(D=b==null?void 0:b.payload)!=null&&D.success?{title:"Successfully Updated",type:"success",message:(v=b==null?void 0:b.payload)==null?void 0:v.message}:{title:"Something Went Wrong !!!",type:"danger",message:(d=b==null?void 0:b.error)==null?void 0:d.message};te.push(t.jsx(ae,{title:E.title,type:E==null?void 0:E.type,duration:2500,children:E.message}),{placement:"top-end"}),await e(K()),await e(oe()),await e(Se(!1)),a("")},C=T=>{let b=!0;const E=["image/png","image/jpeg","image/jpeg","image/webp","image/gif","application/pdf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/csv","text/plain","text/html","application/xml","application/json","application/zip","application/x-rar-compressed"],D=1e7;if(T)for(const v of T)E.includes(v.type)||(b="Please upload a .jpeg, .png, or .pdf file!"),v.size>=D&&(console.log(v.size),b="Uploaded file cannot be larger than 10MB!");return b},N=(T,b,E)=>{const D="1-img-0",v=E.length-1,d=new FileReader,p=E[v];d.onload=()=>{const g=d.result,y={id:D,name:p.name,img:g};s(p.type),a(p.name),b("attachments",y)},d.readAsDataURL(p)};return t.jsxs(ze,{isOpen:o,onClose:x,children:[t.jsx("h5",{className:"mb-4",children:"Quotation"}),t.jsx(Ie,{innerRef:i,initialValues:{descriptions:"",attachments:""},validationSchema:j,onSubmit:async(T,{setSubmitting:b})=>{var D,v;const E={completionStatus:"completed",descriptions:T.descriptions};(D=T.attachments)!=null&&D.img&&(E.attachments=(v=T.attachments)==null?void 0:v.img,E.fileType=n),await f(E),b(!1)},children:({field:T,form:b,touched:E,errors:D,values:v,setFieldValue:d})=>t.jsxs(Fe,{children:[t.jsxs(we,{children:[t.jsx(I,{label:"Upload File",children:t.jsx(It,{draggable:!0,className:"min-h-fit",beforeUpload:C,showList:!1,onChange:p=>N(b,d,p),children:t.jsxs("div",{className:"max-w-full flex flex-col px-4 py-2 justify-center items-center",children:[t.jsx(Wt,{src:"/img/others/upload.png",darkModeSrc:"/img/others/upload-dark.png"}),t.jsx("p",{className:"font-semibold",children:r?t.jsxs("span",{className:"text-gray-800 dark:text-white",children:["Selected file ",r]}):t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"text-gray-800 dark:text-white",children:["Drop your image here, or"," "]}),t.jsx("span",{className:"text-blue-500",children:"browse"})]})}),t.jsx("p",{className:"mt-1 opacity-60 dark:text-white",children:"Support: jpeg, png, pdf"})]})})}),t.jsx(I,{label:"Notes",invalid:D.descriptions&&E.descriptions,errorMessage:D.descriptions,children:t.jsx(F,{textArea:!0,type:"text",autoComplete:"off",name:"descriptions",placeholder:"Notes",component:L,prefix:t.jsx(Me,{className:"text-xl"})})})]}),t.jsx(Ke,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"md:flex items-center",children:[t.jsx(Q,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:x,children:"Cancel"}),t.jsx(Q,{size:"sm",type:"submit",variant:"solid",icon:t.jsx(_e,{}),loading:h,children:"Save"})]})})]})})]})});nt.displayName="QuotationTaskConfirmation";const ka=()=>{const l=A(),i=S(d=>d.crmTasks.data.displayedTasksList),e=S(d=>d.crmTasks.data.loading);S(d=>d.crmTasks.data.filterData);const r=S(d=>d.crmTasks.data.tableData),a=ge("tasks","canDelete"),n=ge("tasks","canModify"),s=ge("tasks","canView"),o=rt(),{pageIndex:c,pageSize:h,sort:x,query:j,total:f}=S(d=>d.crmTasks.data.tableData),C=m.useCallback(()=>{l(K())},[l]);m.useEffect(()=>(C(),()=>{window.location.pathname.includes("task")||l(Z({...r,query:""}))}),[C]);const N=m.useMemo(()=>({pageIndex:c,pageSize:h,sort:x,query:j,total:f}),[c,h,x,j,f]),T=({row:d})=>{const p=A();At();const g=()=>{p(qe()),p(ee(d)),p(Ue("Edit"))},y=async()=>{await p(ee(d)),p(Ce(!0))},W=async()=>{await p(ee(d));const u=`/app/crm/task-details/${d.id}`;o(u)},P=async u=>{var q,U,de;const V={completionStatus:u},w=await p(le({taskId:d==null?void 0:d.id,data:V})),M=(q=w==null?void 0:w.payload)!=null&&q.success?{title:"Successfully Updated",type:"success",message:(U=w==null?void 0:w.payload)==null?void 0:U.message}:{title:"Something Went Wrong !!!",type:"danger",message:(de=w==null?void 0:w.error)==null?void 0:de.message};te.push(t.jsx(ae,{title:M.title,type:M==null?void 0:M.type,duration:2500,children:M.message}),{placement:"top-end"}),await p(K())},_=async()=>{if(d!=null&&d.type)switch(await p(ee(d)),d==null?void 0:d.type){case"followup":p(Ee(!0));break;case"quotation":p(Se(!0));break;default:P("completed");break}else P("completed")};return t.jsxs("div",{className:"flex text-base items-center",children:[n&&t.jsx("span",{className:`cursor-pointer circle items-center ${(d==null?void 0:d.completionStatus)==="completed"?"!cursor-not-allowed":"cursor-pointer hover:text-indigo-500"}`,onClick:g,children:t.jsx(yt,{})}),a&&t.jsx("span",{className:"cursor-pointer hover:text-red-500 circle  mx-1 items-center",onClick:y,children:t.jsx(jt,{})}),s&&t.jsx("span",{className:"cursor-pointer  hover:text-green-500 circle items-center text-lg",onClick:W,children:t.jsx(Pt,{})}),n&&t.jsx(pe,{title:"Move To In Progress",children:t.jsx("button",{disabled:(d==null?void 0:d.completionStatus)!=="pending",className:`cursor-pointer mx-1 circle items-center ${(d==null?void 0:d.completionStatus)!=="pending"?"!cursor-not-allowed":"cursor-pointer hover:text-amber-500"}`,onClick:()=>P("inProgress"),children:t.jsx(Lt,{})})},d.id+"inprogress"),n&&t.jsx(pe,{title:"Move To Complete",children:t.jsx("button",{disabled:(d==null?void 0:d.completionStatus)==="completed",className:`cursor-pointer circle items-center ${(d==null?void 0:d.completionStatus)==="completed"?"!cursor-not-allowed":"cursor-pointer hover:text-emerald-500"}`,onClick:_,children:t.jsx(Rt,{})})},d.id+"complete")]})},b=m.useMemo(()=>[{header:"Action",id:"action",cell:p=>t.jsx(T,{row:p.row.original})},{header:"Title",accessorKey:"title",cell:p=>{const g=p.row.original.title;return t.jsx(pe,{title:g,children:t.jsx(me,{text:g,maxLength:20})},g)}},{header:"Due Date",accessorKey:"dueDate",cell:p=>{var g;return Vt((g=p.row.original)==null?void 0:g.dueDate).format("DD MMMM YYYY")}},{header:"priority",accessorKey:"priority",cell:p=>{const g=p.row.original.priority;return t.jsx(Pe,{status:g})}},{header:"module",accessorKey:"module",cell:p=>{var y;const g=(y=p.row.original)==null?void 0:y.module;return g?t.jsx(me,{text:g,maxLength:20}):"-"}},{header:"type",accessorKey:"type",cell:p=>{var y;const g=(y=p.row.original)==null?void 0:y.type;return g?t.jsx(me,{text:g,maxLength:20}):"-"}},{header:"Assigned to",accessorKey:"assignedTo",cell:p=>{const{firstName:g,lastName:y}=p.row.original.assignedToData||{};return g&&y?`${g} ${y}`:"-"}},{header:"Connected lead",accessorKey:"connectedLead",cell:p=>{var y;const g=p.row.original||{};return g!=null&&g.leadModel?`${(y=g==null?void 0:g.leadModel)==null?void 0:y.title}`:"-"}},{header:"Status",accessorKey:"completionStatus",cell:p=>{const g=p.row.original.completionStatus;return t.jsx(Pe,{status:g})}},{header:"Notes",accessorKey:"descriptions",cell:p=>{const g=p.row.original.descriptions;return t.jsx(pe,{title:g,children:t.jsx(me,{text:g,maxLength:20})},g)}},{header:"Tag Name",accessorKey:"tagName",cell:p=>{const g=p.row.original.tags||[];return g.length===0?"-":t.jsx(Ft,{tags:g})}}],[n,a]),E=d=>{const p=re(N);p.pageIndex=d,l(Z(p))},D=d=>{const p=re(N);p.pageSize=Number(d),p.pageIndex=1,l(Z(p))},v=d=>{const p=re(N);p.sort=d,l(Z(p))};return t.jsxs("div",{children:[t.jsx(St,{columns:b,data:i,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:e,pagingData:{total:N.total,pageIndex:N.pageIndex,pageSize:N.pageSize},onPaginationChange:E,onSelectChange:D,onSort:v}),t.jsx(Na,{}),t.jsx(nt,{}),t.jsx(at,{}),t.jsx(Gt,{})]})},be=l=>{const{icon:i,avatarClass:e,label:r,value:a,growthRate:n,loading:s}=l,o=55;return t.jsx(Nt,{bordered:!0,children:t.jsx(ot,{loading:s,customLoader:t.jsx(_t,{avatarProps:{className:"rounded",width:o,height:o}}),children:t.jsx("div",{className:"flex justify-between items-center",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(Dt,{className:e,size:o,icon:i}),t.jsxs("div",{children:[t.jsx("span",{children:r}),t.jsx("h3",{children:t.jsx(Ht,{thousandSeparator:!0,displayType:"text",value:a})})]})]})})})})},wa=()=>{const l=A(),i=S(r=>r.crmTasks.data.statisticData),e=S(r=>r.crmTasks.data.statisticLoading);return m.useEffect(()=>{l(oe())},[]),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[t.jsx(be,{icon:t.jsx(Tt,{}),avatarClass:"!bg-indigo-600",label:"Total Tasks",value:i==null?void 0:i.totalTasks,loading:e}),t.jsx(be,{icon:t.jsx(bt,{}),avatarClass:"!bg-blue-500",label:"Completed Tasks",value:i==null?void 0:i.completedTasks,loading:e}),t.jsx(be,{icon:t.jsx(Ct,{}),avatarClass:"!bg-emerald-500",label:"This Week's New Tasks",value:i==null?void 0:i.newTasks,loading:e})]})};lt("crmTasks",xt);const Ma=()=>t.jsxs(t.Fragment,{children:[t.jsx(wa,{}),t.jsxs(ct,{bodyClass:"h-full",children:[t.jsx(Yt,{}),t.jsx(ka,{})]})]}),Ei=Ma;export{Ei as default};
