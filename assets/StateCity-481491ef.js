import{al as D,am as Z,an as ee,ao as ae,r as x,j as s,a as S,aq as te}from"./index-c77e9099.js";import{T as De}from"./index-babb7f60.js";import{an as Oe,ao as je,ap as Fe,aq as qe,ar as Pe,as as We,at as _e,au as Be,J as Ve,G as Ge,av as Ke,aw as He}from"./CrmService-1a0eaaaa.js";import{B as I}from"./Button-8951ba48.js";import{I as k}from"./Input-2209e389.js";import{b as se,O as oe,P as ne}from"./index.esm-4b0bd194.js";import{d as le}from"./debounce-597d60f6.js";import{c as j}from"./cloneDeep-8de2d19d.js";import{D as ie}from"./DataTable-02d0d405.js";import{u as v}from"./checkEditUpdate-d1e8875a.js";import{u as re}from"./useThemeClass-3d925ead.js";import"./Alert-e397d8b3.js";import"./index-334a58a8.js";import"./Badge-fee63923.js";import"./RangeCalendar-0c8f3671.js";import"./Card-048c656a.js";import"./index-ea2be383.js";import"./index-37c5d495.js";import{D as ce}from"./Dialog-07ba3ada.js";import"./Drawer-a5c13906.js";import"./index-d00b8073.js";import{F as de,a as B}from"./FormItem-3a9f2b17.js";import"./toString-6e4e2442.js";import"./index-a0745529.js";import"./index-e5464857.js";import"./index-862fd306.js";import{N as R,t as A}from"./toast-66b29920.js";import"./Pagination-14db8ede.js";import"./Progress-983d1438.js";import"./index-6c291714.js";import"./ScrollBar-d87413db.js";import"./index-60a5479c.js";import{S as Je}from"./Select-f0211447.js";import"./Skeleton-5d24ad52.js";import"./index-6bbb7044.js";import"./Switcher-ef699af1.js";import"./index-e2fb49a8.js";import"./Tag-dd468785.js";import"./index-3979da2b.js";import"./index-b1d83239.js";import"./Tooltip-83166a48.js";import"./Upload-8d89e881.js";import"./Views-be916da3.js";import"./chart.constant-312f313d.js";import"./chart.config-f668461c.js";import"./GrowShrinkTag-e621e1e9.js";import"./react-tooltip.min-65526d18.js";import"./RichTextEditor-4a284a0a.js";import"./SegmentItemOption-f9b7a45e.js";import{S as me}from"./StickyFooter-a86fd9b9.js";import"./SvgIcon-4b780ed4.js";import{F as pe,a as ge,b as V}from"./formik.esm-60fd1e57.js";import{A as ue}from"./index.esm-0f2b90bd.js";import{a as G}from"./index.esm-ac969723.js";import{c as K,a as ye}from"./index.esm-831dcb16.js";import{C as he}from"./ConfirmDialog-b8c316ed.js";const Ue="crmState",H=D("crmState/data/createState",async t=>{var e,a;try{return(await Oe(t)).data}catch(o){throw new Error((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)}}),L=D("crmState/data/getState",async()=>{var t,e;try{return(await je()).data}catch(a){throw new Error((e=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:e.message)}}),Qe=D("crmState/data/editState",async({id:t,updatedData:e})=>{var a,o;try{return(await Fe(t,e)).data}catch(l){throw new Error((o=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:o.message)}}),Xe=D("crmLeads/data/deleteState",async t=>{var e,a;try{return await qe(t)}catch(o){throw new Error((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)}}),Ye={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Ze={loading:!1,tableData:Ye,displayedStateList:[],categoryList:[],isDialogOpen:!1,dialogMode:"Add",selectedState:null,deleteConfirmation:!1},we=Z({name:`${Ue}/state`,initialState:Ze,reducers:{setTableData:(t,e)=>{t.tableData=e.payload;const a=t.categoryList.filter(o=>o.stateName.toLowerCase().includes(e.payload.query.toLowerCase()));t.tableData.total=a.length,t.displayedStateList=a.slice(e.payload.pageSize*(e.payload.pageIndex-1),e.payload.pageSize*e.payload.pageIndex)},setSelectedState:(t,e)=>{t.selectedState=e.payload},setDialogToggle:(t,e)=>{t.isDialogOpen=e.payload},setDialogMode:(t,e)=>{t.dialogMode=e.payload},toggleDeleteConfirmation:(t,e)=>{t.deleteConfirmation=e.payload}},extraReducers:t=>{t.addCase(H.fulfilled,(e,a)=>{e.loading=!1}).addCase(H.pending,e=>{e.loading=!0}).addCase(L.fulfilled,(e,a)=>{var o,l,i,n,d;e.loading=!1,e.categoryList=a==null?void 0:a.payload.data,e.tableData.total=(o=a.payload.data)==null?void 0:o.length,e.displayedStateList=a==null?void 0:a.payload.data.slice(((l=e==null?void 0:e.tableData)==null?void 0:l.pageSize)*(((i=e==null?void 0:e.tableData)==null?void 0:i.pageIndex)-1),((n=e==null?void 0:e.tableData)==null?void 0:n.pageSize)*((d=e==null?void 0:e.tableData)==null?void 0:d.pageIndex))}).addCase(L.pending,e=>{e.loading=!0})}}),{setTableData:P,setDialogToggle:O,setDialogMode:Ne,setSelectedState:xe,toggleDeleteConfirmation:J}=we.actions,ea=we.reducer,aa=ee({data:ea}),N=ae,Te=x.forwardRef((t,e)=>{const{onInputChange:a}=t,o=le(l,500);function l(n){a==null||a(n)}const i=n=>{o(n.target.value)};return s.jsx(k,{ref:e,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:s.jsx(se,{className:"text-lg"}),onChange:i})});Te.displayName="StateTableSearch";const ta=()=>{const t=S(),e=x.useRef(null),a=N(i=>i.crmState.data.tableData),o=i=>{const n=j(a);n.query=i,n.pageIndex=1,typeof i=="string"&&i.length>1&&l(n),typeof i=="string"&&i.length===0&&l(n)},l=i=>{t(i?P(i):L())};return s.jsxs("div",{className:"md:flex items-center justify-between",children:[s.jsx("div",{className:"md:flex items-center gap-4",children:s.jsx(Te,{ref:e,onInputChange:o})}),s.jsx("div",{className:"mb-4",children:s.jsx(I,{size:"sm",onClick:()=>{t(O(!0)),t(Ne("Add"))},children:"Add New"})})]})},sa=()=>{const t=S(),e=N(c=>c.crmState.data.loading),a=v("roles","canModify"),o=v("roles","canDelete"),{pageIndex:l,pageSize:i,sort:n,query:d,total:u}=N(c=>c.crmState.data.tableData),p=N(c=>c.crmState.data.displayedStateList);console.log({data:p});const m=({row:c})=>{const r=S(),{textTheme:C}=re(),M=()=>{r(xe(c)),r(O(!0)),r(Ne("Edit"))},E=async()=>{await r(xe(c)),r(J(!0))};return s.jsxs("div",{className:"flex justify-start text-lg",children:[s.jsx("span",{className:`cursor-pointer p-2 hover:${C}`,onClick:M,children:s.jsx(oe,{})}),s.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:E,children:s.jsx(ne,{})})]})},y=x.useMemo(()=>({pageIndex:l,pageSize:i,sort:n,query:d,total:u}),[l,i,n,d,u]),g=x.useMemo(()=>[{header:"Action",id:"action",cell:r=>s.jsx(m,{row:r.row.original})},{header:"State",accessorKey:"name",cell:r=>r.row.original.stateName}],[a,o]),h=c=>{const r=j(y);r.pageIndex=c,t(P(r))},b=c=>{const r=j(y);r.pageSize=Number(c),r.pageIndex=1,t(P(r))},f=c=>{const r=j(y);r.sort=c,t(P(r))};return s.jsx("div",{children:s.jsx(ie,{columns:g,data:p,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:e,pagingData:{total:y.total,pageIndex:y.pageIndex,pageSize:y.pageSize},onPaginationChange:h,onSelectChange:b,onSort:f})})},oa=K().shape({stateName:ye().required("State name is required")}),Ie=x.forwardRef((t,e)=>{const a=S(),o=N(d=>d.crmState.data.dialogMode),l=N(d=>d.crmState.data.selectedState),i=()=>{a(O(!1))};console.log(o);const n=async(d,u,p,m,y)=>{var c,r,C;const g=await m(d==="Add"?H(u):Qe({id:p==null?void 0:p.id,updatedData:{name:u.name}}));let h="",b="",f="danger";(c=g==null?void 0:g.payload)!=null&&c.success?(h="Successfully Added",b=(r=g==null?void 0:g.payload)==null?void 0:r.message,f="success"):(h="Something went wrong !!!",b=(C=g==null?void 0:g.error)==null?void 0:C.message),y.push(s.jsx(R,{title:h,type:f,duration:2500,children:b}),{placement:"top-end"}),m(O(!1)),await m(L())};return s.jsx(pe,{innerRef:e,initialValues:{stateName:o==="Edit"?l==null?void 0:l.stateName:""},validationSchema:oa,onSubmit:async(d,{setSubmitting:u})=>{o==="Add"?await n("Add",d,null,a,A):await n("Edit",d,l,a,A),u(!1)},children:({touched:d,errors:u,values:p,setFieldValue:m})=>s.jsxs(ge,{children:[s.jsx(de,{children:s.jsx(B,{label:"State Name",invalid:u.stateName&&d.stateName,errorMessage:u.stateName,children:s.jsx(V,{type:"text",autoComplete:"off",name:"stateName",placeholder:"State Name",component:k,prefix:s.jsx(G,{className:"text-xl"})})})}),s.jsx(me,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"md:flex items-center",children:[s.jsx(I,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:i,children:"Cancel"}),s.jsx(I,{size:"sm",type:"submit",variant:"solid",icon:s.jsx(ue,{}),children:"Save"})]})})]})})});Ie.displayName="StateForm";const na=()=>{const t=S(),e=N(n=>n.crmState.data.deleteConfirmation),a=N(n=>n.crmState.data.selectedState),o=()=>{t(J(!1))},l=(n,d,u,p)=>{var y,g,h;const m=(y=n==null?void 0:n.payload)==null?void 0:y.success;d.push(s.jsx(R,{title:m?u:p,type:m?"success":"danger",duration:2500,children:m?(g=n==null?void 0:n.payload)==null?void 0:g.message:(h=n==null?void 0:n.error)==null?void 0:h.message}),{placement:"top-end"})},i=async()=>{t(J(!1));const n=await t(Xe(a==null?void 0:a.id));l(n,A,"Successfully Deleted","Something Went Wrong !!!"),await t(L())};return s.jsx(he,{isOpen:e,type:"danger",title:"Delete State",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:i,children:s.jsx("p",{children:"Are you sure you want to delete this State? All record related to this State will be deleted as well. This action cannot be undone."})})};te("crmState",aa);const la=()=>{const t=S(),e=N(l=>l.crmState.data.isDialogOpen),a=N(l=>l.crmState.data.dialogMode),o=()=>{t(O(!1))};return x.useEffect(()=>{t(L())},[]),s.jsxs(s.Fragment,{children:[s.jsx(ta,{}),s.jsx(sa,{}),s.jsxs(ce,{isOpen:e,onClose:o,children:[s.jsxs("h5",{className:"mb-4",children:[a==="Edit"?"Edit":"Add New"," State"]}),s.jsx(Ie,{})]}),s.jsx(na,{})]})},ia="crmCity",ra={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ca={loading:!1,tableData:ra,displayedCityList:[],cityList:[],stateList:[],isDialogOpen:!1,dialogMode:"Add",selectedCity:null,deleteConfirmation:!1},U=D("crmCity/data/createCity",async t=>{var e,a;try{return(await Pe(t)).data}catch(o){throw new Error((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)}}),z=D("crmCity/data/getCity",async()=>{var t,e;try{return(await We()).data}catch(a){throw new Error((e=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:e.message)}}),Ae=D("crmCity/data/getState",async()=>{var t,e;try{return(await je()).data}catch(a){throw new Error((e=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:e.message)}}),da=D("crmCity/data/editCity",async({id:t,updatedData:e})=>{var a,o;try{return(await _e(t,e)).data}catch(l){throw new Error((o=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:o.message)}}),ma=D("crmCity/data/deleteCity",async t=>{var e,a;try{return await Be(t)}catch(o){throw new Error((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)}}),Me=Z({name:`${ia}/state`,initialState:ca,reducers:{setTableData:(t,e)=>{t.tableData=e.payload;const a=t.cityList.filter(o=>{var l,i,n;return((l=o.cityName)==null?void 0:l.toLowerCase().includes(e.payload.query.toLowerCase()))||((n=(i=o==null?void 0:o.state)==null?void 0:i.stateName)==null?void 0:n.toLowerCase().includes(e.payload.query.toLowerCase()))});t.tableData.total=a.length,t.displayedCityList=a.slice(e.payload.pageSize*(e.payload.pageIndex-1),e.payload.pageSize*e.payload.pageIndex)},setSelectedCity:(t,e)=>{t.selectedCity=e.payload},setDialogToggle:(t,e)=>{t.isDialogOpen=e.payload},setDialogMode:(t,e)=>{t.dialogMode=e.payload},toggleDeleteConfirmation:(t,e)=>{t.deleteConfirmation=e.payload}},extraReducers:t=>{t.addCase(U.fulfilled,(e,a)=>{e.loading=!1}).addCase(U.pending,e=>{e.loading=!0}).addCase(z.fulfilled,(e,a)=>{var o,l,i,n,d;e.loading=!1,e.cityList=a==null?void 0:a.payload.data,e.tableData.total=(o=a.payload.data)==null?void 0:o.length,e.displayedCityList=a==null?void 0:a.payload.data.slice(((l=e==null?void 0:e.tableData)==null?void 0:l.pageSize)*(((i=e==null?void 0:e.tableData)==null?void 0:i.pageIndex)-1),((n=e==null?void 0:e.tableData)==null?void 0:n.pageSize)*((d=e==null?void 0:e.tableData)==null?void 0:d.pageIndex))}).addCase(Ae.fulfilled,(e,a)=>{e.stateList=a==null?void 0:a.payload.data}).addCase(z.pending,e=>{e.loading=!0})}}),{setTableData:W,setSelectedCity:Se,setDialogToggle:F,setDialogMode:Ee,toggleDeleteConfirmation:Q}=Me.actions,pa=Me.reducer,ga=ee({data:pa}),w=ae,ua=()=>{const t=S(),e=w(n=>n.crmCity.data.deleteConfirmation),a=w(n=>n.crmCity.data.selectedCity),o=()=>{t(Q(!1))},l=(n,d,u,p)=>{var y,g,h;const m=(y=n==null?void 0:n.payload)==null?void 0:y.success;d.push(s.jsx(R,{title:m?u:p,type:m?"success":"danger",duration:2500,children:m?(g=n==null?void 0:n.payload)==null?void 0:g.message:(h=n==null?void 0:n.error)==null?void 0:h.message}),{placement:"top-end"})},i=async()=>{t(Q(!1));const n=await t(ma(a==null?void 0:a.id));l(n,A,"Successfully Deleted","Something Went Wrong !!!"),await t(z())};return s.jsx(he,{isOpen:e,type:"danger",title:"Delete Sub Category",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:i,children:s.jsx("p",{children:"Are you sure you want to delete this Sub Category? All record related to this Sub Category will be deleted as well. This action cannot be undone."})})},ya=K().shape({stateId:K().required("State is required"),cityName:ye().required("City is required")}),ve=x.forwardRef((t,e)=>{const a=S(),o=w(p=>p.crmCity.data.dialogMode),l=w(p=>p.crmCity.data.selectedCity),i=w(p=>p.crmCity.data.stateList),n=x.useMemo(()=>(console.log({stateList:i}),i.map(m=>({label:m.stateName,value:m.id}))),[i]),d=()=>{a(F(!1))},u=async(p,m,y,g,h)=>{var M,E,fe;const b={cityName:m.cityName,stateId:m.stateId.value},f=await g(p==="Add"?U(b):da({id:y==null?void 0:y.id,updatedData:b}));let c="",r="",C="danger";(M=f==null?void 0:f.payload)!=null&&M.success?(c="Successfully Added",r=(E=f==null?void 0:f.payload)==null?void 0:E.message,C="success"):(c="Something went wrong !!!",r=(fe=f==null?void 0:f.error)==null?void 0:fe.message),h.push(s.jsx(R,{title:c,type:C,duration:2500,children:r}),{placement:"top-end"}),g(F(!1)),await g(z())};return console.log({selectedCity:l}),s.jsx(pe,{innerRef:e,initialValues:{cityName:o==="Edit"?l==null?void 0:l.cityName:"",stateId:o==="Edit"?n.find(p=>p.value===(l==null?void 0:l.stateId)):""},validationSchema:ya,onSubmit:async(p,{setSubmitting:m})=>{console.log({values:p}),o==="Add"?await u("Add",p,null,a,A):await u("Edit",p,l,a,A),m(!1)},children:({touched:p,errors:m,values:y,setFieldValue:g})=>s.jsxs(ge,{children:[s.jsxs(de,{children:[s.jsx(B,{label:"State",invalid:m.stateId&&p.stateId,errorMessage:m.stateId,children:s.jsx(V,{type:"text",autoComplete:"off",name:"stateId",placeholder:"State",options:n,component:Je,prefix:s.jsx(G,{className:"text-xl"}),onChange:h=>{g("stateId",h)}})}),s.jsx(B,{label:"City",invalid:m.cityName&&p.cityName,errorMessage:m.cityName,children:s.jsx(V,{type:"text",autoComplete:"off",name:"cityName",placeholder:"City",component:k,prefix:s.jsx(G,{className:"text-xl"})})})]}),s.jsx(me,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"md:flex items-center",children:[s.jsx(I,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:d,children:"Cancel"}),s.jsx(I,{size:"sm",type:"submit",variant:"solid",icon:s.jsx(ue,{}),children:"Save"})]})})]})})});ve.displayName="CityForm";const ha=()=>{const t=S(),e=w(c=>c.crmCity.data.loading),a=w(c=>c.crmCity.data.displayedCityList),o=v("roles","canModify"),l=v("roles","canDelete"),{pageIndex:i,pageSize:n,sort:d,query:u,total:p}=w(c=>c.crmCity.data.tableData),m=x.useMemo(()=>({pageIndex:i,pageSize:n,sort:d,query:u,total:p}),[i,n,d,u,p]),y=({row:c})=>{const r=S(),{textTheme:C}=re(),M=()=>{r(Se(c)),r(F(!0)),r(Ee("Edit"))},E=async()=>{await r(Se(c)),r(Q(!0))};return s.jsxs("div",{className:"flex justify-start text-lg",children:[s.jsx("span",{className:`cursor-pointer p-2 hover:${C}`,onClick:M,children:s.jsx(oe,{})}),s.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:E,children:s.jsx(ne,{})})]})},g=x.useMemo(()=>[{header:"Action",id:"action",cell:r=>s.jsx(y,{row:r.row.original})},{header:"City",accessorKey:"cityName",cell:r=>r.row.original.cityName},{header:"State",accessorKey:"state",cell:r=>{var C;return(C=r.row.original.state)==null?void 0:C.stateName}}],[o,l]),h=c=>{console.log({page:c});const r=j(m);r.pageIndex=c,t(W(r))},b=c=>{const r=j(m);r.pageSize=Number(c),r.pageIndex=1,t(W(r))},f=c=>{const r=j(m);r.sort=c,t(W(r))};return s.jsx("div",{children:s.jsx(ie,{columns:g,data:a,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:e,pagingData:{total:m.total,pageIndex:m.pageIndex,pageSize:m.pageSize},onPaginationChange:h,onSelectChange:b,onSort:f})})},Le=x.forwardRef((t,e)=>{const{onInputChange:a}=t,o=le(l,500);function l(n){a==null||a(n)}const i=n=>{o(n.target.value)};return s.jsx(k,{ref:e,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:s.jsx(se,{className:"text-lg"}),onChange:i})});Le.displayName="SubCategoryTableSearch";const fa=()=>{const t=S(),e=x.useRef(null),a=w(i=>i.crmCity.data.tableData),o=i=>{const n=j(a);n.query=i,n.pageIndex=1,typeof i=="string"&&i.length>1&&l(n),typeof i=="string"&&i.length===0&&l(n)},l=i=>{t(i?W(i):z())};return s.jsxs("div",{className:"md:flex items-center justify-between",children:[s.jsx("div",{className:"md:flex items-center gap-4",children:s.jsx(Le,{ref:e,onInputChange:o})}),s.jsx("div",{className:"mb-4",children:s.jsx(I,{size:"sm",onClick:()=>{t(F(!0)),t(Ee("Add"))},children:"Add New"})})]})};te("crmCity",ga);const xa=()=>{const t=S(),e=w(l=>l.crmCity.data.isDialogOpen),a=w(l=>l.crmCity.data.dialogMode),o=()=>{t(F(!1))};return x.useEffect(()=>{t(z()),t(Ae())},[]),s.jsxs(s.Fragment,{children:[s.jsx(fa,{}),s.jsx(ha,{}),s.jsxs(ce,{isOpen:e,onClose:o,children:[s.jsxs("h5",{className:"mb-4",children:[a==="Edit"?"Edit":"Add New"," City"]}),s.jsx(ve,{})]}),s.jsx(ua,{})]})},Sa="crmSource",X=D("crmSource/data/createSource",async t=>{var e,a;try{return(await Ve(t)).data}catch(o){throw new Error((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)}}),$=D("crmSource/data/getSource",async()=>{var t,e;try{return(await Ge()).data}catch(a){throw new Error((e=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:e.message)}}),Ca=D("crmSource/data/editSource",async({id:t,updatedData:e})=>{var a,o;try{return(await Ke(t,e)).data}catch(l){throw new Error((o=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:o.message)}}),ba=D("crmLeads/data/deleteSource",async t=>{var e,a;try{return await He(t)}catch(o){throw new Error((a=(e=o==null?void 0:o.response)==null?void 0:e.data)==null?void 0:a.message)}}),Da={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ja={loading:!1,tableData:Da,displayedSourceList:[],categoryList:[],isDialogOpen:!1,dialogMode:"Add",selectedSource:null,deleteConfirmation:!1},ze=Z({name:`${Sa}/state`,initialState:ja,reducers:{setTableData:(t,e)=>{t.tableData=e.payload,console.log(t.categoryList);const a=t.categoryList.filter(o=>o.sources.toLowerCase().includes(e.payload.query.toLowerCase()));t.tableData.total=a.length,t.displayedSourceList=a.slice(e.payload.pageSize*(e.payload.pageIndex-1),e.payload.pageSize*e.payload.pageIndex)},setSelectedState:(t,e)=>{t.selectedSource=e.payload},setDialogToggle:(t,e)=>{t.isDialogOpen=e.payload},setDialogMode:(t,e)=>{t.dialogMode=e.payload},toggleDeleteConfirmation:(t,e)=>{t.deleteConfirmation=e.payload}},extraReducers:t=>{t.addCase(X.fulfilled,(e,a)=>{e.loading=!1}).addCase(X.pending,e=>{e.loading=!0}).addCase($.fulfilled,(e,a)=>{var o,l,i,n,d;e.loading=!1,e.categoryList=a==null?void 0:a.payload.data,e.tableData.total=(o=a.payload.data)==null?void 0:o.length,e.displayedSourceList=a==null?void 0:a.payload.data.slice(((l=e==null?void 0:e.tableData)==null?void 0:l.pageSize)*(((i=e==null?void 0:e.tableData)==null?void 0:i.pageIndex)-1),((n=e==null?void 0:e.tableData)==null?void 0:n.pageSize)*((d=e==null?void 0:e.tableData)==null?void 0:d.pageIndex))}).addCase($.pending,e=>{e.loading=!0})}}),{setTableData:_,setDialogToggle:q,setDialogMode:$e,setSelectedState:Ce,toggleDeleteConfirmation:Y}=ze.actions,wa=ze.reducer,Na=ee({data:wa}),T=ae,ke=x.forwardRef((t,e)=>{const{onInputChange:a}=t,o=le(l,500);function l(n){a==null||a(n)}const i=n=>{o(n.target.value)};return s.jsx(k,{ref:e,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:s.jsx(se,{className:"text-lg"}),onChange:i})});ke.displayName="StateTableSearch";const Ta=()=>{const t=S(),e=x.useRef(null),a=T(i=>i.crmSource.data.tableData),o=i=>{const n=j(a);n.query=i,n.pageIndex=1,typeof i=="string"&&i.length>1&&l(n),typeof i=="string"&&i.length===0&&l(n)},l=i=>{t(i?_(i):$())};return s.jsxs("div",{className:"md:flex items-center justify-between",children:[s.jsx("div",{className:"md:flex items-center gap-4",children:s.jsx(ke,{ref:e,onInputChange:o})}),s.jsx("div",{className:"mb-4",children:s.jsx(I,{size:"sm",onClick:()=>{t(q(!0)),t($e("Add"))},children:"Add New"})})]})},Ia=()=>{const t=S(),e=T(c=>c.crmSource.data.loading),a=v("roles","canModify"),o=v("roles","canDelete"),{pageIndex:l,pageSize:i,sort:n,query:d,total:u}=T(c=>c.crmSource.data.tableData),p=T(c=>c.crmSource.data.displayedSourceList);console.log({data:p});const m=({row:c})=>{const r=S(),{textTheme:C}=re(),M=()=>{r(Ce(c)),r(q(!0)),r($e("Edit"))},E=async()=>{await r(Ce(c)),r(Y(!0))};return s.jsxs("div",{className:"flex justify-start text-lg",children:[s.jsx("span",{className:`cursor-pointer p-2 hover:${C}`,onClick:M,children:s.jsx(oe,{})}),s.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:E,children:s.jsx(ne,{})})]})},y=x.useMemo(()=>({pageIndex:l,pageSize:i,sort:n,query:d,total:u}),[l,i,n,d,u]),g=x.useMemo(()=>[{header:"Action",id:"action",cell:r=>s.jsx(m,{row:r.row.original})},{header:"Source",accessorKey:"sources",cell:r=>r.row.original.sources}],[a,o]),h=c=>{const r=j(y);r.pageIndex=c,t(_(r))},b=c=>{const r=j(y);r.pageSize=Number(c),r.pageIndex=1,t(_(r))},f=c=>{const r=j(y);r.sort=c,t(_(r))};return s.jsx("div",{children:s.jsx(ie,{columns:g,data:p,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:e,pagingData:{total:y.total,pageIndex:y.pageIndex,pageSize:y.pageSize},onPaginationChange:h,onSelectChange:b,onSort:f})})},Aa=K().shape({sources:ye().required("Source name is required")}),Re=x.forwardRef((t,e)=>{const a=S(),o=T(d=>d.crmSource.data.dialogMode),l=T(d=>d.crmSource.data.selectedSource),i=()=>{a(q(!1))};console.log(o);const n=async(d,u,p,m,y)=>{var c,r,C;const g=await m(d==="Add"?X(u):Ca({id:p==null?void 0:p.id,updatedData:{name:u.name}}));let h="",b="",f="danger";(c=g==null?void 0:g.payload)!=null&&c.success?(h="Successfully Added",b=(r=g==null?void 0:g.payload)==null?void 0:r.message,f="success"):(h="Something went wrong !!!",b=(C=g==null?void 0:g.error)==null?void 0:C.message),y.push(s.jsx(R,{title:h,type:f,duration:2500,children:b}),{placement:"top-end"}),m(q(!1)),await m($())};return s.jsx(pe,{innerRef:e,initialValues:{sources:o==="Edit"?l==null?void 0:l.sources:""},validationSchema:Aa,onSubmit:async(d,{setSubmitting:u})=>{o==="Add"?await n("Add",d,null,a,A):await n("Edit",d,l,a,A),u(!1)},children:({touched:d,errors:u,values:p,setFieldValue:m})=>s.jsxs(ge,{children:[s.jsx(de,{children:s.jsx(B,{label:"Source",invalid:u.sources&&d.sources,errorMessage:u.sources,children:s.jsx(V,{type:"text",autoComplete:"off",name:"sources",placeholder:"Source",component:k,prefix:s.jsx(G,{className:"text-xl"})})})}),s.jsx(me,{className:"flex items-center justify-end py-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"md:flex items-center",children:[s.jsx(I,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:i,children:"Cancel"}),s.jsx(I,{size:"sm",type:"submit",variant:"solid",icon:s.jsx(ue,{}),children:"Save"})]})})]})})});Re.displayName="SourceForm";const Ma=()=>{const t=S(),e=T(n=>n.crmSource.data.deleteConfirmation),a=T(n=>n.crmSource.data.selectedSource),o=()=>{t(Y(!1))},l=(n,d,u,p)=>{var y,g,h;const m=(y=n==null?void 0:n.payload)==null?void 0:y.success;d.push(s.jsx(R,{title:m?u:p,type:m?"success":"danger",duration:2500,children:m?(g=n==null?void 0:n.payload)==null?void 0:g.message:(h=n==null?void 0:n.error)==null?void 0:h.message}),{placement:"top-end"})},i=async()=>{t(Y(!1));const n=await t(ba(a==null?void 0:a.id));l(n,A,"Successfully Deleted","Something Went Wrong !!!"),await t($())};return s.jsx(he,{isOpen:e,type:"danger",title:"Delete Source",confirmButtonColor:"red-600",onClose:o,onRequestClose:o,onCancel:o,onConfirm:i,children:s.jsx("p",{children:"Are you sure you want to delete this Source? All record related to this Source will be deleted as well. This action cannot be undone."})})};te("crmSource",Na);const Ea=()=>{const t=S(),e=T(l=>l.crmSource.data.isDialogOpen),a=T(l=>l.crmSource.data.dialogMode),o=()=>{t(q(!1))};return x.useEffect(()=>{t($())},[]),s.jsxs(s.Fragment,{children:[s.jsx(Ta,{}),s.jsx(Ia,{}),s.jsxs(ce,{isOpen:e,onClose:o,children:[s.jsxs("h5",{className:"mb-4",children:[a==="Edit"?"Edit":"Add New"," Source"]}),s.jsx(Re,{})]}),s.jsx(Ma,{})]})},{TabNav:va,TabList:La}=De,be={state:{label:"State",path:"state"},city:{label:"City",path:"city"},source:{label:"Source",path:"source"}},za=()=>{const[t,e]=x.useState("state"),a=o=>{e(o)};return s.jsxs(s.Fragment,{children:[s.jsx(De,{value:t,variant:"pill",onChange:o=>a(o),children:s.jsx(La,{children:Object.keys(be).map(o=>s.jsx(va,{value:o,children:be[o].label},o))})}),s.jsx("div",{className:"py-4",children:s.jsxs(x.Suspense,{fallback:s.jsx(s.Fragment,{children:"loading..."}),children:[t==="state"&&s.jsx(la,{}),t==="city"&&s.jsx(xa,{}),t==="source"&&s.jsx(Ea,{})]})})]})},Rt=za;export{Rt as S};
