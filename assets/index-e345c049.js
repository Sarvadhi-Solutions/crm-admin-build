import{r as u,a as g,j as e,ai as K,ar as H}from"./index-7a16719d.js";import{A as L}from"./AdaptableCard-13b794a2.js";import{D as q}from"./DataTable-8d28e201.js";import{u as c,s as M,a as D,g as y,b,d as S,e as P,f as k,h as U,r as G}from"./AdditionalTag-d9d972e5.js";import{u as A}from"./useThemeClass-fd0ad3b7.js";import{B as j}from"./Button-796af526.js";import{D as V}from"./Drawer-8ba2eb60.js";import{C as _}from"./CustomerForm-894d660f.js";import{c as x}from"./cloneDeep-b8051bc5.js";import{C as J}from"./Card-1701bbfb.js";import"./Views-6f74b325.js";import{B as T}from"./Badge-1281613d.js";import"./chart.constant-5281a9f6.js";import"./chart.config-58aa9b75.js";import{C as Q}from"./ConfirmDialog-eba886ee.js";import{I as W}from"./Input-67ca38c6.js";import"./GrowShrinkTag-37fffd2e.js";import"./Skeleton-37e417fd.js";import"./react-tooltip.min-a9924b1b.js";import"./RichTextEditor-5911068e.js";import"./SegmentItemOption-7241e2fb.js";import"./SvgIcon-453c12ee.js";import"./Tooltip-d9375ea6.js";import{A as X}from"./index-a6767bf5.js";import{z as Y,B as Z,d as ee,a9 as te,r as re}from"./index.esm-a0bff864.js";import{d as se}from"./debounce-581daf1a.js";import{S as oe,c as ae}from"./Select-9b097dd7.js";import{M as ie}from"./MediaSkeleton-be71f6da.js";import{N as ne}from"./react-number-format.es-51238e39.js";import"./index-0e21c6e2.js";import"./index.esm-5d9ef8bc.js";import"./Pagination-48201899.js";import"./index-b0ca69aa.js";import"./_Uint8Array-cc34f89d.js";import"./_MapCache-4c25b116.js";import"./_baseIsEqual-2f7f19c2.js";import"./get-d062fc7e.js";import"./toString-8f2f6138.js";import"./TableRowSkeleton-7731763d.js";import"./index-f8af83e9.js";import"./formik.esm-e41f31d6.js";import"./context-0b7be94f.js";import"./index-7ccc27ab.js";import"./Alert-30cff1b8.js";import"./useTimeout-322537e2.js";import"./CloseButton-a0a179ae.js";import"./StatusIcon-d7c666ad.js";import"./Calendar-d980fa99.js";import"./useControllableState-a386f254.js";import"./index-a27a5065.js";import"./useMergeRef-788c4cb0.js";import"./useRootClose-846e7f72.js";import"./usePopper-f1e01f1f.js";import"./RangeCalendar-5a8bf6cb.js";import"./TimeInput-f92c5fbf.js";import"./useUniqueId-8e6b0c76.js";import"./useDidUpdate-c40d1f95.js";import"./Dialog-6329901c.js";import"./index-d79d31fc.js";import"./index-c8ec40dc.js";import"./useUncertainRef-cc932849.js";import"./isNil-e31eb1ef.js";import"./chainedFunction-070f832c.js";import"./index-8ce6c613.js";import"./index-4b73696b.js";import"./index-2891c22c.js";import"./toast-88b8cde7.js";import"./Progress-eccc530b.js";import"./index-ec94b59a.js";import"./ScrollBar-c40790ee.js";import"./index-f369fb39.js";import"./index-ad91be40.js";import"./mapCloneElement-cd5ba71d.js";import"./Switcher-9edb53af.js";import"./index-63d9e088.js";import"./Tag-35e609cf.js";import"./index-a7fd7ac6.js";import"./index-1fd6ab15.js";import"./Upload-43f1cdd5.js";import"./index.esm-4e1ebe60.js";import"./index.esm-a9630cba.js";import"./CrmService-a924234d.js";import"./index.esm-d14b6227.js";import"./index.esm-377c755d.js";/* empty css              */import"./index.esm-1010dceb.js";import"./_getPrototype-af9a5f7c.js";import"./floating-ui.dom-bef9cea3.js";import"./toConsumableArray-f36ee3dc.js";import"./objectWithoutPropertiesLoose-df62547b.js";const I=u.forwardRef((s,t)=>{g();const r=c(i=>i.crmCustomers.data.selectedCustomer);c(i=>i.crmCustomers.data.customerList);const o=async i=>{};return e.jsx(_,{ref:t,customer:r,onFormSubmit:o})});I.displayName="CustomerEditContent";const le=({onSaveClick:s,onCancel:t})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(j,{size:"sm",className:"mr-2",onClick:t,children:"Cancel"}),e.jsx(j,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),me=()=>{const s=g(),t=c(m=>m.crmCustomers.data.drawerOpen),r=()=>{s(M()),s(D({}))},o=u.useRef(null),i=()=>{var m,l;console.log("formSubmit function called",(m=o.current)==null?void 0:m.values),(l=o.current)==null||l.submitForm()};return e.jsx(V,{isOpen:t,closable:!1,bodyClass:"p-0",footer:e.jsx(le,{onCancel:r,onSaveClick:i}),onClose:r,onRequestClose:r,children:e.jsx(I,{ref:o})})},ce=({row:s})=>{const{textTheme:t}=A(),r=g(),o=()=>{r(S()),r(D(s))};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},de=({row:s})=>{const{textTheme:t}=A(),r=g(),[o,i]=u.useState(!1),m=async()=>{i(!0)},l=async()=>{await r(P(s.id)),i(!1),await r(y())},n=()=>{i(!1)};return e.jsxs("div",{children:[e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold text-red-500`,onClick:m,children:"Delete"}),o&&e.jsx(Q,{type:"danger",title:"Confirm Deletion",isOpen:o,onCancel:n,onConfirm:l,children:"Are you sure you want to delete this item?"})]})},pe=()=>{const s=g(),t=c(a=>a.crmCustomers.data.customerList),r=c(a=>a.crmCustomers.data.loading),o=c(a=>a.crmCustomers.data.filterData),{pageIndex:i,pageSize:m,sort:l,query:n,total:d}=c(a=>a.crmCustomers.data.tableData),h=u.useCallback(()=>{s(y())},[s]);u.useEffect(()=>{h()},[h,i,m,l,o]);const C=u.useMemo(()=>({pageIndex:i,pageSize:m,sort:l,query:n,total:d}),[i,m,l,n,d]),z=u.useMemo(()=>[{header:"Customer Name",accessorKey:"clientName",cell:a=>a.row.original.clientName,width:200},{header:"Contact Number",accessorKey:"contactInfo",cell:a=>a.row.original.contactInfo,width:200},{header:"Address",accessorKey:"address",cell:a=>a.row.original.address,width:200},{header:"Billing Details",accessorKey:"billingDetails",cell:a=>a.row.original.billingDetails,width:200},{header:"History",accessorKey:"history",cell:a=>a.row.original.history,width:200},{header:"Notes",accessorKey:"notes",cell:a=>a.row.original.notes,width:200},{header:"Tag Name",accessorKey:"tagName",width:200,cell:a=>{const B=(a.row.original.tags||[]).map(w=>{const f=w.colorName||"#000000",$={backgroundColor:`rgba(${parseInt(f.slice(1,3),16)}, ${parseInt(f.slice(3,5),16)}, ${parseInt(f.slice(5,7),16)}, 0.2)`,color:f,padding:"4px 8px",borderRadius:"4px",marginRight:"4px",marginBottom:"4px"};return e.jsx("div",{style:$,children:w.tagName},w.id)});return e.jsx("div",{children:B})}},{header:"Edit",id:"action",cell:a=>e.jsx(ce,{row:a.row.original})},{header:"Delete",id:"action",cell:a=>e.jsx(de,{row:a.row.original})}],[]),O=a=>{const p=x(C);p.pageIndex=a,s(b(p))},E=a=>{const p=x(C);p.pageSize=Number(a),p.pageIndex=1,s(b(p))},F=a=>{const p=x(C);p.sort=a,s(b(p))};return e.jsxs("div",{children:[e.jsx(q,{columns:z,data:t,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:r,pagingData:{total:C.total,pageIndex:C.pageIndex,pageSize:C.pageSize},onPaginationChange:O,onSelectChange:E,onSort:F}),e.jsx(me,{})]})},R=u.forwardRef((s,t)=>{const{onInputChange:r}=s,o=se(i,500);function i(l){r==null||r(l)}const m=l=>{o(l.target.value)};return e.jsx(W,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(Y,{className:"text-lg"}),onChange:m})});R.displayName="CustomerTableSearch";const{Control:ue}=ae,N=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],ge=({innerProps:s,label:t,data:r,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{innerClass:r.color}),e.jsx("span",{children:t})]}),o&&e.jsx(Z,{className:"text-emerald-500 text-xl"})]}),he=({children:s,...t})=>{const r=t.getValue()[0];return e.jsxs(ue,{...t,children:[r&&e.jsx(T,{className:"ltr:ml-4 rtl:mr-4",innerClass:r.color}),s]})},Ce=()=>{const s=g(),{status:t}=c(o=>o.crmCustomers.data.filterData),r=o=>{s(k({status:o==null?void 0:o.value}))};return e.jsx(oe,{options:N,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:ge,Control:he},value:N.filter(o=>o.value===t),onChange:r})},xe=()=>{const s=g(),t=u.useRef(null),r=c(n=>n.crmCustomers.data.tableData),o=n=>{const d=x(r);d.query=n,d.pageIndex=1,typeof n=="string"&&n.length>1&&i(d),typeof n=="string"&&n.length===0&&i(d)},i=n=>{s(b(n)),s(y())},m=()=>{const n=x(r);n.query="",t.current&&(t.current.value=""),s(k({status:""})),i(n)},l=()=>{s(S())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(R,{ref:t,onInputChange:o}),e.jsx(Ce,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(j,{size:"sm",className:"me-2",onClick:m,children:"Clear All"}),e.jsx(j,{size:"sm",onClick:l,children:"Add New"})]})]})},v=s=>{const{icon:t,avatarClass:r,label:o,value:i,growthRate:m,loading:l}=s,n=55;return e.jsx(J,{bordered:!0,children:e.jsx(K,{loading:l,customLoader:e.jsx(ie,{avatarProps:{className:"rounded",width:n,height:n}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(X,{className:r,size:n,icon:t}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(ne,{thousandSeparator:!0,displayType:"text",value:i})})]})]})})})})},fe=()=>{var o,i,m,l,n,d;const s=g(),t=c(h=>h.crmCustomers.data.statisticData),r=c(h=>h.crmCustomers.data.statisticLoading);return u.useEffect(()=>{s(U())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(v,{icon:e.jsx(ee,{}),avatarClass:"!bg-indigo-600",label:"Total Customers",value:(o=t==null?void 0:t.totalCustomers)==null?void 0:o.value,growthRate:(i=t==null?void 0:t.totalCustomers)==null?void 0:i.growShrink,loading:r}),e.jsx(v,{icon:e.jsx(te,{}),avatarClass:"!bg-blue-500",label:"Active Customers",value:(m=t==null?void 0:t.activeCustomers)==null?void 0:m.value,growthRate:(l=t==null?void 0:t.activeCustomers)==null?void 0:l.growShrink,loading:r}),e.jsx(v,{icon:e.jsx(re,{}),avatarClass:"!bg-emerald-500",label:"New Customers",value:(n=t==null?void 0:t.newCustomers)==null?void 0:n.value,growthRate:(d=t==null?void 0:t.newCustomers)==null?void 0:d.growShrink,loading:r})]})};H("crmCustomers",G);const be=()=>e.jsxs(e.Fragment,{children:[e.jsx(fe,{}),e.jsxs(L,{bodyClass:"h-full",children:[e.jsx(xe,{}),e.jsx(pe,{})]})]}),rr=be;export{rr as default};
