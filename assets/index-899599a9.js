import{r as u,a as g,j as e,ai as K,ar as H}from"./index-21d7ce34.js";import{A as L}from"./AdaptableCard-1403a507.js";import{D as q}from"./DataTable-2fc93372.js";import{u as m,s as M,a as S,g as N,b,d as D,e as P,f as k,h as U,r as G}from"./AdditionalTag-ee745a24.js";import{u as A}from"./useThemeClass-103b190c.js";import{B as j}from"./Button-6c3081fd.js";import{D as V}from"./Drawer-08bde54d.js";import{C as _}from"./CustomerForm-edb6db98.js";import{c as C}from"./cloneDeep-c49c3d8a.js";import{I as J}from"./Input-b18c5be2.js";import{z as Q,B as W,d as X,a9 as Y,r as Z}from"./index.esm-3f5f076a.js";import{d as ee}from"./debounce-4303ffbd.js";import{S as te,c as se}from"./Select-6e523134.js";import{B as T}from"./Badge-0547788a.js";import{C as re}from"./Card-c016d7e4.js";import{A as oe}from"./index-60ecab9e.js";import{M as ae}from"./MediaSkeleton-caa70ad7.js";import{N as ie}from"./react-number-format.es-4ce1f76b.js";import"./index-83ec9673.js";import"./index.esm-b042e3c5.js";import"./Pagination-d1806156.js";import"./index-0bf67457.js";import"./_Uint8Array-00b9b100.js";import"./_MapCache-e6bfd31d.js";import"./Views-aa9d3067.js";import"./_baseIsEqual-06f63cf1.js";import"./get-db5a0269.js";import"./toString-839cbc0d.js";import"./TableRowSkeleton-e0a9e899.js";import"./Skeleton-5f2460b7.js";import"./index-dfd66886.js";import"./formik.esm-b31c216f.js";import"./context-ff20449e.js";import"./index-99dab15c.js";import"./Alert-bd43990b.js";import"./useTimeout-c424fd3c.js";import"./CloseButton-8f19e7bd.js";import"./StatusIcon-cb41def8.js";import"./Calendar-d76733e5.js";import"./useControllableState-3f0dec55.js";import"./index-d0bd679a.js";import"./useMergeRef-788c4cb0.js";import"./useRootClose-aa5c19cb.js";import"./usePopper-50e8ad5a.js";import"./RangeCalendar-b8d72020.js";import"./TimeInput-53379264.js";import"./useUniqueId-18384f8e.js";import"./useDidUpdate-d17bf275.js";import"./Dialog-fcbd4cee.js";import"./index-e63aba64.js";import"./index-cbaf419c.js";import"./useUncertainRef-1f87b20a.js";import"./isNil-e652d611.js";import"./chainedFunction-070f832c.js";import"./index-a936af3e.js";import"./index-5f8b7824.js";import"./index-24a2595e.js";import"./toast-60e590e4.js";import"./Progress-1f726e4f.js";import"./index-489c77b3.js";import"./ScrollBar-83d9acc4.js";import"./index-97d1b97f.js";import"./index-de8563c1.js";import"./mapCloneElement-18ca430e.js";import"./Switcher-25855834.js";import"./index-cfa1d7b1.js";import"./Tag-49702b6e.js";import"./index-f9e4d97b.js";import"./index-c82bc72a.js";import"./Tooltip-1a8549c9.js";import"./index.esm-a8cf6609.js";import"./Upload-a60754e4.js";import"./index.esm-4dac136d.js";import"./index.esm-1004ce28.js";import"./CrmService-ca976601.js";import"./index.esm-078c9db1.js";import"./index.esm-74216463.js";/* empty css              */import"./_getPrototype-2575ec81.js";import"./toConsumableArray-26f6508e.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";const I=u.forwardRef((s,t)=>{g();const r=m(n=>n.crmCustomers.data.selectedCustomer);m(n=>n.crmCustomers.data.customerList);const o=async n=>{};return e.jsx(_,{ref:t,customer:r,onFormSubmit:o})});I.displayName="CustomerEditContent";const ne=({onSaveClick:s,onCancel:t})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(j,{size:"sm",className:"mr-2",onClick:t,children:"Cancel"}),e.jsx(j,{size:"sm",variant:"solid",onClick:s,children:"Save"})]}),le=()=>{const s=g(),t=m(c=>c.crmCustomers.data.drawerOpen),r=()=>{s(M()),s(S({}))},o=u.useRef(null),n=()=>{var c,l;console.log("formSubmit function called",(c=o.current)==null?void 0:c.values),(l=o.current)==null||l.submitForm()};return e.jsx(V,{isOpen:t,closable:!1,bodyClass:"p-0",footer:e.jsx(ne,{onCancel:r,onSaveClick:n}),onClose:r,onRequestClose:r,children:e.jsx(I,{ref:o})})},ce=({row:s})=>{const{textTheme:t}=A(),r=g(),o=()=>{r(D()),r(S(s))};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold`,onClick:o,children:"Edit"})},me=({row:s})=>{const{textTheme:t}=A(),r=g(),o=async()=>{console.log(s,"Bhai Agaya"),await r(P(s.id)),await r(N())};return e.jsx("div",{className:`${t} cursor-pointer select-none font-semibold text-red-500`,onClick:o,children:"Delete"})},de=()=>{const s=g(),t=m(a=>a.crmCustomers.data.customerList),r=m(a=>a.crmCustomers.data.loading),o=m(a=>a.crmCustomers.data.filterData),{pageIndex:n,pageSize:c,sort:l,query:i,total:d}=m(a=>a.crmCustomers.data.tableData),h=u.useCallback(()=>{s(N())},[s]);u.useEffect(()=>{h()},[h,n,c,l,o]);const x=u.useMemo(()=>({pageIndex:n,pageSize:c,sort:l,query:i,total:d}),[n,c,l,i,d]),z=u.useMemo(()=>[{header:"Customer Name",accessorKey:"clientName",cell:a=>a.row.original.clientName,width:200},{header:"Contact Number",accessorKey:"contactInfo",cell:a=>a.row.original.contactInfo,width:200},{header:"Address",accessorKey:"address",cell:a=>a.row.original.address,width:200},{header:"Billing Details",accessorKey:"billingDetails",cell:a=>a.row.original.billingDetails,width:200},{header:"History",accessorKey:"history",cell:a=>a.row.original.history,width:200},{header:"Notes",accessorKey:"notes",cell:a=>a.row.original.notes,width:200},{header:"Tag Name",accessorKey:"tagName",width:200,cell:a=>{const B=(a.row.original.tags||[]).map(w=>{const f=w.colorName||"#000000",$={backgroundColor:`rgba(${parseInt(f.slice(1,3),16)}, ${parseInt(f.slice(3,5),16)}, ${parseInt(f.slice(5,7),16)}, 0.2)`,color:f,padding:"4px 8px",borderRadius:"4px",marginRight:"4px",marginBottom:"4px"};return e.jsx("div",{style:$,children:w.tagName},w.id)});return e.jsx("div",{children:B})}},{header:"Edit",id:"action",cell:a=>e.jsx(ce,{row:a.row.original})},{header:"Delete",id:"action",cell:a=>e.jsx(me,{row:a.row.original})}],[]),E=a=>{const p=C(x);p.pageIndex=a,s(b(p))},F=a=>{const p=C(x);p.pageSize=Number(a),p.pageIndex=1,s(b(p))},O=a=>{const p=C(x);p.sort=a,s(b(p))};return e.jsxs("div",{children:[e.jsx(q,{columns:z,data:t,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:r,pagingData:{total:x.total,pageIndex:x.pageIndex,pageSize:x.pageSize},onPaginationChange:E,onSelectChange:F,onSort:O}),e.jsx(le,{})]})},R=u.forwardRef((s,t)=>{const{onInputChange:r}=s,o=ee(n,500);function n(l){r==null||r(l)}const c=l=>{o(l.target.value)};return e.jsx(J,{ref:t,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(Q,{className:"text-lg"}),onChange:c})});R.displayName="CustomerTableSearch";const{Control:pe}=se,y=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],ue=({innerProps:s,label:t,data:r,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{innerClass:r.color}),e.jsx("span",{children:t})]}),o&&e.jsx(W,{className:"text-emerald-500 text-xl"})]}),ge=({children:s,...t})=>{const r=t.getValue()[0];return e.jsxs(pe,{...t,children:[r&&e.jsx(T,{className:"ltr:ml-4 rtl:mr-4",innerClass:r.color}),s]})},he=()=>{const s=g(),{status:t}=m(o=>o.crmCustomers.data.filterData),r=o=>{s(k({status:o==null?void 0:o.value}))};return e.jsx(te,{options:y,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:ue,Control:ge},value:y.filter(o=>o.value===t),onChange:r})},xe=()=>{const s=g(),t=u.useRef(null),r=m(i=>i.crmCustomers.data.tableData),o=i=>{const d=C(r);d.query=i,d.pageIndex=1,typeof i=="string"&&i.length>1&&n(d),typeof i=="string"&&i.length===0&&n(d)},n=i=>{s(b(i)),s(N())},c=()=>{const i=C(r);i.query="",t.current&&(t.current.value=""),s(k({status:""})),n(i)},l=()=>{s(D())};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(R,{ref:t,onInputChange:o}),e.jsx(he,{})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(j,{size:"sm",className:"me-2",onClick:c,children:"Clear All"}),e.jsx(j,{size:"sm",onClick:l,children:"Add New"})]})]})},v=s=>{const{icon:t,avatarClass:r,label:o,value:n,growthRate:c,loading:l}=s,i=55;return e.jsx(re,{bordered:!0,children:e.jsx(K,{loading:l,customLoader:e.jsx(ae,{avatarProps:{className:"rounded",width:i,height:i}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(oe,{className:r,size:i,icon:t}),e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("h3",{children:e.jsx(ie,{thousandSeparator:!0,displayType:"text",value:n})})]})]})})})})},Ce=()=>{var o,n,c,l,i,d;const s=g(),t=m(h=>h.crmCustomers.data.statisticData),r=m(h=>h.crmCustomers.data.statisticLoading);return u.useEffect(()=>{s(U())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(v,{icon:e.jsx(X,{}),avatarClass:"!bg-indigo-600",label:"Total Customers",value:(o=t==null?void 0:t.totalCustomers)==null?void 0:o.value,growthRate:(n=t==null?void 0:t.totalCustomers)==null?void 0:n.growShrink,loading:r}),e.jsx(v,{icon:e.jsx(Y,{}),avatarClass:"!bg-blue-500",label:"Active Customers",value:(c=t==null?void 0:t.activeCustomers)==null?void 0:c.value,growthRate:(l=t==null?void 0:t.activeCustomers)==null?void 0:l.growShrink,loading:r}),e.jsx(v,{icon:e.jsx(Z,{}),avatarClass:"!bg-emerald-500",label:"New Customers",value:(i=t==null?void 0:t.newCustomers)==null?void 0:i.value,growthRate:(d=t==null?void 0:t.newCustomers)==null?void 0:d.growShrink,loading:r})]})};H("crmCustomers",G);const fe=()=>e.jsxs(e.Fragment,{children:[e.jsx(Ce,{}),e.jsxs(L,{bodyClass:"h-full",children:[e.jsx(xe,{}),e.jsx(de,{})]})]}),_t=fe;export{_t as default};
