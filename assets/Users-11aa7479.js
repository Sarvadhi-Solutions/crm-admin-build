import{a as f,r as u,j as e,ai as W,B as X,ar as ee}from"./index-21d7ce34.js";import{A as se}from"./AdaptableCard-1403a507.js";import{u as p,a as ae,s as V,b as D,g as I,p as Y,c as O,d as te,e as q,f as re,h as oe,i as ie,r as ne}from"./index-bad35e72.js";import{C as le}from"./Card-c016d7e4.js";import{A as ce}from"./index-60ecab9e.js";import{M as me}from"./MediaSkeleton-caa70ad7.js";import{d as de,a9 as pe,r as L,z as ue,B as xe,a6 as B}from"./index.esm-3f5f076a.js";import{N as he}from"./react-number-format.es-4ce1f76b.js";import{B as M}from"./Button-6c3081fd.js";import{c as v}from"./cloneDeep-c49c3d8a.js";import{I as w}from"./Input-b18c5be2.js";import{d as fe}from"./debounce-4303ffbd.js";import{S as be,c as ge,a as $}from"./Select-6e523134.js";import{B as Z}from"./Badge-0547788a.js";import{D as je}from"./DataTable-2fc93372.js";import{u as P}from"./useThemeClass-103b190c.js";import{D as ve}from"./Drawer-08bde54d.js";import{i as Ne}from"./Views-aa9d3067.js";import{T as _}from"./index-cfa1d7b1.js";import{c as j,d as y,F as we,a as Ce,b as Ue}from"./formik.esm-b31c216f.js";import{c as ye,a as N}from"./index.esm-078c9db1.js";/* empty css              */import{j as Se}from"./index.esm-14c2a8bb.js";import{v as De}from"./index.esm-a8cf6609.js";import"./Alert-bd43990b.js";import"./Calendar-d76733e5.js";import"./index-0bf67457.js";import"./index-d0bd679a.js";import"./Dialog-fcbd4cee.js";import"./index-cbaf419c.js";import"./toString-839cbc0d.js";import"./index-5f8b7824.js";import"./index-24a2595e.js";import"./index-a936af3e.js";import"./toast-60e590e4.js";import"./Pagination-d1806156.js";import"./Progress-1f726e4f.js";import"./index-489c77b3.js";import"./RangeCalendar-b8d72020.js";import"./ScrollBar-83d9acc4.js";import"./index-97d1b97f.js";import"./Skeleton-5f2460b7.js";import"./index-de8563c1.js";import"./Switcher-25855834.js";import"./index-83ec9673.js";import{T as H}from"./Tag-49702b6e.js";import"./index-f9e4d97b.js";import"./index-c82bc72a.js";import"./Tooltip-1a8549c9.js";import"./Upload-a60754e4.js";import{g as Ie}from"./index-b9d23c57.js";import"./CrmService-ca976601.js";import"./useMergeRef-788c4cb0.js";import"./context-ff20449e.js";import"./_Uint8Array-00b9b100.js";import"./_MapCache-e6bfd31d.js";import"./_getPrototype-2575ec81.js";import"./isNil-e652d611.js";import"./get-db5a0269.js";import"./toConsumableArray-26f6508e.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./floating-ui.dom-bef9cea3.js";import"./TableRowSkeleton-e0a9e899.js";import"./index-dfd66886.js";import"./index-e63aba64.js";import"./CloseButton-8f19e7bd.js";import"./useControllableState-3f0dec55.js";import"./index-99dab15c.js";import"./useTimeout-c424fd3c.js";import"./StatusIcon-cb41def8.js";import"./_baseIsEqual-06f63cf1.js";import"./useRootClose-aa5c19cb.js";import"./usePopper-50e8ad5a.js";import"./TimeInput-53379264.js";import"./useUniqueId-18384f8e.js";import"./useDidUpdate-d17bf275.js";import"./useUncertainRef-1f87b20a.js";import"./chainedFunction-070f832c.js";import"./mapCloneElement-18ca430e.js";import"./index.esm-b042e3c5.js";import"./index.esm-4dac136d.js";const S=r=>{const{icon:o,avatarClass:s,label:a,value:l,growthRate:n,loading:i}=r,c=55;return e.jsx(le,{bordered:!0,children:e.jsx(W,{loading:i,customLoader:e.jsx(me,{avatarProps:{className:"rounded",width:c,height:c}}),children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ce,{className:s,size:c,icon:o}),e.jsxs("div",{children:[e.jsx("span",{children:a}),e.jsx("h3",{children:e.jsx(he,{thousandSeparator:!0,displayType:"text",value:l})})]})]})})})})},Fe=()=>{const r=f(),o=p(a=>a.crmUsers.data.statisticData),s=p(a=>a.crmUsers.data.statisticLoading);return u.useEffect(()=>{r(ae())},[]),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(S,{icon:e.jsx(de,{}),avatarClass:"!bg-indigo-600",label:"Total Users",value:o==null?void 0:o.totalUser,loading:s}),e.jsx(S,{icon:e.jsx(pe,{}),avatarClass:"!bg-blue-500",label:"Active Users",value:o==null?void 0:o.activeUser,loading:s}),e.jsx(S,{icon:e.jsx(L,{}),avatarClass:"!bg-emerald-500",label:"Deactivate Users",value:o==null?void 0:o.deactiveUser,loading:s}),e.jsx(S,{icon:e.jsx(L,{}),avatarClass:"!bg-emerald-500",label:"New Users",value:o==null?void 0:o.newUser,loading:s})]})},G=u.forwardRef((r,o)=>{const{onInputChange:s}=r,a=fe(l,500);function l(i){s==null||s(i)}const n=i=>{a(i.target.value)};return e.jsx(w,{ref:o,className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(ue,{className:"text-lg"}),onChange:n})});G.displayName="UsersTableSearch";const{Control:Te}=ge,K=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],ke=({innerProps:r,label:o,data:s,isSelected:a})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${a?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...r,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{innerClass:s.color}),e.jsx("span",{children:o})]}),a&&e.jsx(xe,{className:"text-emerald-500 text-xl"})]}),Ee=({children:r,...o})=>{const s=o.getValue()[0];return e.jsxs(Te,{...o,children:[s&&e.jsx(Z,{className:"ltr:ml-4 rtl:mr-4",innerClass:s.color}),r]})},Ae=()=>{const r=f(),{status:o}=p(a=>a.crmUsers.data.filterData),s=a=>{r(V({status:a==null?void 0:a.value}))};return e.jsx(be,{options:K,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:ke,Control:Ee},value:K.filter(a=>a.value===o),onChange:s})},Re=()=>{const r=f(),o=u.useRef(null),s=p(i=>i.crmUsers.data.tableData),a=i=>{const c=v(s);c.query=i,c.pageIndex=1,typeof i=="string"&&i.length>1&&l(c),typeof i=="string"&&i.length===0&&l(c)},l=i=>{r(D(i)),r(I(i))},n=()=>{const i=v(s);i.query="",o.current&&(o.current.value=""),r(V({status:""})),l(i)};return e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(G,{ref:o,onInputChange:a}),e.jsx(Ae,{})]}),e.jsx("div",{className:"mb-4",children:e.jsx(M,{size:"sm",className:"me-2",onClick:n,children:"Clear All"})})]})},ze=r=>{const{touched:o,errors:s,setFieldValue:a,values:l}=r;f(),u.useState(""),p(m=>m.crmUsers.data.selectedUser);const n=p(m=>m.crmUsers.data.rolesList);console.log(n);const i=n.map(m=>({label:m.roleName,value:m.id})),c=[{label:"active",value:"active"},{label:"inactive",value:"inactive"}];return e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"First Name",children:e.jsx(y,{disabled:!0,type:"text",autoComplete:"off",name:"firstName",placeholder:"Customer Name",component:w,prefix:e.jsx(B,{className:"text-xl"})})}),e.jsx(j,{label:"Last Name",children:e.jsx(y,{disabled:!0,type:"text",autoComplete:"off",name:"lastName",component:w,prefix:e.jsx(B,{className:"text-xl"})})}),e.jsx(j,{label:"Email",children:e.jsx(y,{disabled:!0,type:"text",autoComplete:"off",name:"email",component:w,prefix:e.jsx(Se,{className:"text-xl"})})}),e.jsx(j,{label:"Phone",children:e.jsx(y,{disabled:!0,type:"text",autoComplete:"off",name:"phone",component:w,prefix:e.jsx(De,{className:"text-xl"})})}),e.jsx(j,{label:"Role",children:e.jsx($,{name:"roleId",id:"roleId",value:i.find(m=>(m==null?void 0:m.value)===(l==null?void 0:l.roleId)),onChange:m=>{a("roleId",m.value||"")},options:i})}),e.jsx(j,{label:"Status",children:e.jsx($,{name:"status",id:"status",value:c.find(m=>(m==null?void 0:m.value)===(l==null?void 0:l.status)),onChange:m=>{a("status",m.value||"")},options:c})})]})},qe=ye().shape({firstName:N().required("First name is required"),lastName:N().required("Last name is required"),email:N().matches(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i,"Invalid email").required("Email is required"),phone:N().matches(/^\d{10}$/,"Phone number must be 10 digits").required("Phone is required"),status:N().required("Status is required").oneOf(["active","inactive"])}),{TabNav:Me,TabList:Oe,TabContent:Le}=_,J=u.forwardRef((r,o)=>{const s=p(n=>n.crmUsers.data.selectedUser),a=p(n=>n.crmUsers.data.drawerMode),l=f();return console.log(a),e.jsx(we,{innerRef:o,initialValues:{firstName:a==="Edit"&&(s==null?void 0:s.firstName)||"",lastName:a==="Edit"&&(s==null?void 0:s.lastName)||"",email:a==="Edit"&&(s==null?void 0:s.email)||"",phone:a==="Edit"&&(s==null?void 0:s.phone)||"",status:a==="Add"?"inactive":(s==null?void 0:s.status)||"",roleId:a==="Edit"&&(s==null?void 0:s.roleId)||""},validationSchema:qe,onSubmit:async(n,{setSubmitting:i})=>{if(a==="Edit"){const c=await l(Y({id:s.id,data:n}));console.log(c,"response"),await l(O()),await l(I()),console.log(n,"fromikvalues"),console.log("on submit called ")}i(!1)},children:({touched:n,errors:i,setFieldValue:c,values:m})=>e.jsx(Ce,{children:e.jsx(Ue,{children:e.jsxs(_,{defaultValue:"usersInfo",children:[e.jsx(Oe,{children:e.jsx(Me,{value:"usersInfo",children:"Users Info"})}),e.jsx("div",{className:"p-6",children:e.jsx(Le,{value:"usersInfo",children:e.jsx(ze,{touched:n,errors:i,setFieldValue:c,values:m})})})]})})})})});J.displayName="UsersForm";const Q=u.forwardRef((r,o)=>{const s=f(),a=p(c=>c.crmUsers.data.selectedUser),l=p(c=>c.crmUsers.data.usersList),{id:n}=a,i=c=>{const{name:m,birthday:C,email:U,img:x,location:F,title:T,phoneNumber:k,facebook:E,twitter:A,pinterest:R,linkedIn:t}=c,d={name:m,email:U,img:x},h={location:F,title:T,birthday:X(C).format("DD/MM/YYYY"),phoneNumber:k,facebook:E,twitter:A,pinterest:R,linkedIn:t};let b=v(l),z={};b=b.map(g=>(g.id===n&&(g={...g,...d},g.personalInfo={...g.personalInfo,...h},z=g),g)),Ne(z)||s(Y(z)),s(O()),s(te(b))};return e.jsx(J,{ref:o,users:a,onFormSubmit:i})});Q.displayName="UsersEditContent";const Be=({onSaveClick:r,onCancel:o})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(M,{size:"sm",className:"mr-2",onClick:o,children:"Cancel"}),e.jsx(M,{size:"sm",variant:"solid",onClick:r,children:"Save"})]}),$e=()=>{const r=f(),o=p(n=>n.crmUsers.data.drawerOpen);p(n=>n.crmUsers.data.drawerMode),p(n=>n.crmUsers.data.selectedUser);const s=()=>{r(O()),r(q({}))},a=u.useRef(null),l=async()=>{var n,i;(n=a.current)==null||n.values,(i=a.current)==null||i.submitForm()};return e.jsx(ve,{isOpen:o,closable:!1,bodyClass:"p-0",footer:e.jsx(Be,{onCancel:s,onSaveClick:l}),onClose:s,onRequestClose:s,children:e.jsx(Q,{ref:a})})},Pe=({status:r})=>{switch(r){case"active":return e.jsx(H,{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100  border-0 rounded",children:"Active"});case"inactive":return e.jsx(H,{className:"text-amber-600 bg-amber-100 dark:text-amber-100 dark:bg-amber-500/20  border-0 rounded",children:"Inactive"});default:return e.jsx(e.Fragment,{})}},He=()=>{const r=f(),o=p(t=>t.crmUsers.data.usersList),s=p(t=>t.crmUsers.data.loading),a=p(t=>t.crmUsers.data.filterData),l=p(t=>t.crmUsers.data.rolesList);u.useEffect(()=>{async function t(){await r(Ie())}t()},[r]);const{pageIndex:n,pageSize:i,sort:c,query:m,total:C}=p(t=>t.crmUsers.data.tableData),U=u.useCallback(()=>{r(I())},[n,i,c,m,a,r]);u.useEffect(()=>{U()},[U,n,i,c,a]);const x=u.useMemo(()=>({pageIndex:n,pageSize:i,sort:c,query:m,total:C}),[n,i,c,m,C]),F=({row:t})=>{const{textTheme:d}=P(),h=()=>{r(re()),r(q(t)),r(oe("Edit"))};return e.jsx("div",{className:`${d} cursor-pointer select-none font-semibold`,onClick:h,children:"Edit"})},T=({row:t})=>{const{textTheme:d}=P(),h=async()=>{r(q(t)),await r(ie(t.id)),await r(I())};return e.jsx("div",{className:`${d} cursor-pointer select-none font-semibold text-red-500`,onClick:h,children:"Delete"})},k=u.useMemo(()=>[{header:"First Name",accessorKey:"firstName",cell:t=>t.row.original.firstName,width:200},{header:"Last Name",accessorKey:"lastName",cell:t=>t.row.original.lastName,width:200},{header:"Role",accessorKey:"role",cell:t=>{var h;return((h=l==null?void 0:l.find(b=>(b==null?void 0:b.id)===(t==null?void 0:t.row.original.roleId)))==null?void 0:h.roleName)||"-"},width:200},{header:"Email",accessorKey:"email",cell:t=>t.row.original.email,width:200},{header:"Phone",accessorKey:"phone",cell:t=>t.row.original.phone,width:200},{header:"Status",accessorKey:"status",cell:t=>{const d=t.row.original;return e.jsx(Pe,{status:d.status})},width:200},{header:"Edit",id:"action",cell:t=>e.jsx(F,{row:t.row.original})},{header:"Delete",id:"action",cell:t=>e.jsx(T,{row:t.row.original})}],[l]),E=t=>{const d=v(x);d.pageIndex=t,r(D(d))},A=t=>{const d=v(x);d.pageSize=Number(t),d.pageIndex=1,r(D(d))},R=t=>{const d=v(x);d.sort=t,r(D(d))};return e.jsxs("div",{children:[e.jsx(je,{columns:k,data:o,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:s,pagingData:{total:x.total,pageIndex:x.pageIndex,pageSize:x.pageSize},onPaginationChange:E,onSelectChange:A,onSort:R}),e.jsx($e,{})]})};ee("crmUsers",ne);const ba=()=>e.jsxs(e.Fragment,{children:[e.jsx(Fe,{}),e.jsxs(se,{bodyClass:"h-full",children:[e.jsx(Re,{}),e.jsx(He,{})]})]});export{ba as default};
