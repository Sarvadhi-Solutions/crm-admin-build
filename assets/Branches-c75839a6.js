import{a as O,r as I,j as e}from"./index-8f180057.js";import"./Alert-26b93c15.js";import"./index-50da1f05.js";import"./Badge-da9b4bac.js";import{B}from"./Button-9a124664.js";import"./RangeCalendar-4f882c48.js";import"./Card-c08b3dc7.js";import"./index-467c57d1.js";import"./index-f90d0a46.js";import"./Dialog-00762d81.js";import"./Drawer-9e2f40a2.js";import"./index-57f971c2.js";import{F as V,a as l}from"./FormItem-6da989b2.js";import"./toString-6546c1f5.js";import{I as x}from"./Input-80948cc5.js";import{I as k}from"./index-c14dd8b2.js";import"./index-7419ce87.js";import"./index-8db80fc8.js";import{t as q}from"./toast-d4a23693.js";import"./Pagination-02ddc899.js";import"./Progress-4aad2981.js";import"./index-f1c49e5c.js";import"./ScrollBar-cc732ada.js";import"./index-5c4aebcf.js";import{S as y,c as A}from"./Select-b8e32f8a.js";import"./Skeleton-a652bf9f.js";import"./index-3ad4fd06.js";import{S as v}from"./Switcher-b15fc15a.js";import"./index-68091566.js";import"./index-19730294.js";import"./Tag-f078f978.js";import"./index-04594492.js";import"./index-f2e93cf2.js";import"./Tooltip-c46cdf61.js";import"./Upload-5d1aec4a.js";import{c as C}from"./countries.constant-5369f7df.js";import{g as $,c as E}from"./index-8fcdd113.js";import{F as H,a as P,b as c}from"./formik.esm-23c950a3.js";import{N as Q}from"./react-number-format.es-8632b3a3.js";import{c as D,a as h}from"./index.esm-f2cf7456.js";import{u as M}from"./index-6dde7db2.js";import"./useTimeout-6ce9cc18.js";import"./index.esm-d559b7a8.js";import"./CloseButton-f457d2a5.js";import"./StatusIcon-af9b884d.js";import"./Views-0f0dd1b0.js";import"./useMergeRef-788c4cb0.js";import"./useControllableState-a20a08a7.js";import"./cloneDeep-1f39f070.js";import"./_MapCache-c801105a.js";import"./_getPrototype-6ef2344b.js";import"./_baseIsEqual-f757163a.js";import"./get-49349d76.js";import"./useRootClose-849d9b9c.js";import"./usePopper-4f231cdc.js";import"./TimeInput-a4c2e8c8.js";import"./useUniqueId-b6b18158.js";import"./useDidUpdate-6bcd31b9.js";import"./index-21bd03ca.js";import"./useUncertainRef-cd8eb299.js";import"./isNil-7f5c5bc3.js";import"./index-56b40026.js";import"./chainedFunction-070f832c.js";import"./slicedToArray-4e770983.js";import"./objectWithoutProperties-8809bfcf.js";import"./toConsumableArray-10fd47e9.js";import"./floating-ui.dom-4bc0055b.js";import"./mapCloneElement-4d24a9a7.js";import"./index.esm-7da1e9bd.js";import"./index.esm-047fe164.js";import"./index.esm-e628df3b.js";import"./CrmService-4ead0dba.js";import"./AdaptableCard-4ed28de0.js";import"./useThemeClass-fedd2393.js";import"./AccountServices-11482fa9.js";const{SingleValue:R}=A,T=r=>e.jsx(x,{...r,value:r.field.value}),z=({onValueChange:r,...i})=>e.jsx(Q,{customInput:x,type:"text",autoComplete:"off",onValueChange:r,...i}),G=({innerProps:r,data:i,isSelected:b})=>e.jsx("div",{className:`cursor-pointer flex items-center justify-between p-2 ${b?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...r,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{children:["(",i.value,") ",i.dialCode]})})}),d=[],L=r=>{const i=r.getValue()[0];return e.jsx(R,{...r,children:i&&e.jsx("span",{children:i.dialCode})})},W=D().shape({branchName:h().required("Details are required"),addressInformation:h(),isHeadQuarter:h(),branchOwnerId:h().required("This field is required").test("is-valid-contact","Invalid contact selected",r=>!!d.find(i=>i.value==r)),contact:h().typeError("Contact must be a number").required("Contact is required").test("is-number","Contact must be a number",r=>!isNaN(r)).test("is-ten-digits","Contact must be exactly 10 digits",r=>{if(r){const i=Number(r);return/^\d{10}$/.test(i.toString())}return!0}).test("is-ten-digits","Contact number cannot start with 0",r=>r?!r.startsWith("0"):!0)}),ht=({data:r={branchName:"",addressInformation:"",isHeadQuarter:"",branchOwnerId:"",contact:"",dialCode:""},onNextChange:i,currentStepStatus:b})=>{const f=O(),[g,S]=I.useState([]),N=I.useCallback(async()=>{const t=await f($());S(t==null?void 0:t.payload.data)},[f]);d.length=0,g==null||g.forEach(t=>{d==null||d.push({label:`${t==null?void 0:t.firstName} ${t==null?void 0:t.lastName}`,value:t.id})}),I.useEffect(()=>{N()},[N]);const j=M(t=>t.auth.user),F=async(t,n)=>{var s,m,w;const a=await f(E(t));let p="",u="",o="";(s=a==null?void 0:a.payload)!=null&&s.success?(p="Successfully Added",u=(m=a==null?void 0:a.payload)==null?void 0:m.message,o="success",i==null||i(t,"branches",n)):(p="Something went wrong !!!",u=(w=a==null?void 0:a.error)==null?void 0:w.message,o="danger"),q.push(e.jsx(Notification,{title:p,type:o,duration:2500,children:u}),{placement:"top-end"}),n(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"mb-2",children:"Branches Information"}),e.jsx("p",{children:"Basic information to create branch"})]}),e.jsx(H,{initialValues:r,enableReinitialize:!0,validationSchema:W,onSubmit:(t,{setSubmitting:n})=>{n(!0),setTimeout(()=>{F(t,n)},1e3)},children:({values:t,touched:n,errors:a,isSubmitting:p,setFieldValue:u})=>(console.log("wedwed",a),e.jsx(P,{children:e.jsxs(V,{children:[e.jsx("div",{className:"md:grid grid-cols-1 gap-4",children:e.jsx(l,{label:"Branch Name",invalid:a.branchName&&n.branchName,errorMessage:a.branchName,children:e.jsx(c,{type:"text",autoComplete:"off",name:"branchName",placeholder:"Branch Name",component:x})})}),e.jsx(l,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"form-label",style:{marginRight:"10px"},children:"Assign me as Owner"}),e.jsx(c,{autoComplete:"off",name:"branchOwnerId",component:v,checked:t.branchOwnerId,value:j==null?void 0:j.id})]})}),e.jsx("div",{className:"md:grid grid-cols-2 gap-4",children:e.jsxs(l,{label:"Branch Owner",style:{display:t.branchOwnerId?"none":"block"},children:[!t.branchOwnerId&&e.jsx(y,{isClearable:!0,name:"branchOwnerId",placeholder:"Branch Owner",options:d,id:"branchOwnerId",onChange:o=>{const s=o==null?void 0:o.value;u("branchOwnerId",s)}}),t.branchOwnerId&&e.jsx("input",{type:"hidden",name:"branchOwnerId",value:"whqd"})]})}),e.jsx(l,{children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"form-label",style:{marginRight:"10px"},children:"Head Quarter"}),e.jsx(c,{autoComplete:"off",name:"isHeadQuarter",component:v,checked:t.isHeadQuarter})]})}),e.jsx(l,{label:"Address",invalid:a.addressInformation&&n.addressInformation,errorMessage:a.addressInformation,children:e.jsx(c,{type:"text",autoComplete:"off",name:"addressInformation",placeholder:"Address",component:x})}),e.jsx("div",{className:"md:grid grid-cols-2 gap-4",children:e.jsx(l,{label:"Phone Number",invalid:a.dialCode&&n.dialCode||a.contact&&n.contact,errorMessage:"Please enter your phone number",children:e.jsxs(k,{children:[e.jsx(c,{name:"dialCode",children:({field:o,form:s})=>e.jsx(y,{className:"min-w-[130px]",placeholder:"Dial Code",components:{Option:G,SingleValue:L},field:o,form:s,options:C,value:C.filter(m=>m.value===t.dialCode),onChange:m=>s.setFieldValue(o.name,m==null?void 0:m.value)})}),e.jsx(c,{name:"contact",children:({field:o,form:s})=>e.jsx(z,{form:s,field:o,customInput:T,placeholder:"Phone Number",onValueChange:m=>{s.setFieldValue(o.name,m.value)}})})]})})}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(B,{loading:p,variant:"solid",type:"submit",children:b==="complete"?"Save":"Next"})})]})}))})]})};export{ht as default,d as usersOptions};
