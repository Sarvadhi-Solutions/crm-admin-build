import{am as N,an as L,ao as J,ap as R,j as e,aq as A,r as n,a as D,ai as y,ar as F}from"./index-f40e4d75.js";import{a as G,b as O}from"./CrmService-7c89f71e.js";import{C as h}from"./Card-902c739e.js";import{A as p}from"./index-3d26675f.js";import{F as B,a as E,b as z,c as M}from"./index.esm-338aec60.js";import{B as H}from"./Button-50d583fa.js";import{T}from"./index-a0876546.js";import{S as I}from"./StatusCapsule-f3e3296e.js";import{T as V}from"./TagsList-50570a10.js";import{T as v}from"./TextTruncate-1087102a.js";import{c as $,u as q,f as C,g as W}from"./index-04a1d3b6.js";import{S as g}from"./index-e26259ee.js";import{B as k}from"./Badge-6fa7c653.js";import{C as S}from"./Chart-c1cd69ed.js";import{C as j}from"./chart.constant-d3a29041.js";import{i as _}from"./Views-4f4cfc12.js";import"./useMergeRef-788c4cb0.js";import"./Tooltip-b58b263b.js";import"./usePopper-65abd083.js";import"./index.esm-2a4fc148.js";import"./index-ae89c783.js";import"./context-51e9908c.js";import"./index.esm-939b12b7.js";import"./Alert-40d5acad.js";import"./useTimeout-e87eb97a.js";import"./index.esm-0d86f991.js";import"./CloseButton-579d2861.js";import"./StatusIcon-e5b0e9d4.js";import"./Calendar-4d5136ed.js";import"./useControllableState-a88821e3.js";import"./index-fce80fcb.js";import"./cloneDeep-599ca6a7.js";import"./_Uint8Array-1aa2dd21.js";import"./_MapCache-11f94205.js";import"./_getPrototype-fd20deb2.js";import"./_baseIsEqual-6ce30dc4.js";import"./get-8208bc30.js";import"./toString-1320cce2.js";import"./index-a594a10f.js";import"./Input-a28838c6.js";import"./isNil-867ba5c2.js";import"./useRootClose-e34f1b82.js";import"./RangeCalendar-c94320b7.js";import"./TimeInput-8f1dcb6e.js";import"./useUniqueId-e478c472.js";import"./useDidUpdate-d2d404f7.js";import"./Dialog-7705a764.js";import"./index-abc0a377.js";import"./Drawer-4f8a2134.js";import"./index-89133a2f.js";import"./useUncertainRef-8f47aa92.js";import"./chainedFunction-070f832c.js";import"./index-1ec1c1e6.js";import"./FormItem-e9df506f.js";import"./index-05e52686.js";import"./index-b8391898.js";import"./toast-a13e90a2.js";import"./Pagination-968bd340.js";import"./Progress-93b8f813.js";import"./index-0b72efdb.js";import"./ScrollBar-96d4eb77.js";import"./Select-1c5bed57.js";import"./slicedToArray-ed1b3644.js";import"./objectWithoutProperties-8e2777d0.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./extends-98964cd2.js";import"./toConsumableArray-b6817789.js";import"./floating-ui.dom-bef9cea3.js";import"./Skeleton-70df546a.js";import"./index-d5b3e22f.js";import"./mapCloneElement-83eec5b9.js";import"./Switcher-5c6f9f0a.js";import"./index-e9a19be6.js";import"./Tag-d736e0a6.js";import"./index-8e701fec.js";import"./index-0051b6ff.js";import"./Upload-433277fb.js";import"./index.esm-b275af0e.js";import"./chart.config-31884a50.js";const K="crmDashboard",b=N("crmDashboard/data/dashboard",async()=>(await G()).data),P=N("crmDashboard/data/dashboard/tasks",async a=>(await O(a)).data),Q={loading:!0,dashboardData:{}},U=L({name:`${K}/state`,initialState:Q,reducers:{},extraReducers:a=>{a.addCase(b.fulfilled,(s,t)=>{s.dashboardData=t.payload.crmDashboardData,s.loading=!1}).addCase(b.pending,s=>{s.loading=!0})}}),X=U.reducer,Y=J({data:X}),f=R,Z=({type:a})=>{switch(a){case"newLeads":return e.jsx(p,{size:55,className:"bg-indigo-100 text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-100",icon:e.jsx(M,{})});case"company":return e.jsx(p,{size:55,className:"bg-cyan-100 text-cyan-600 dark:bg-cyan-500/20 dark:text-cyan-100",icon:e.jsx(z,{})});case"clients":return e.jsx(p,{size:55,className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100",icon:e.jsx(E,{})});case"task":return e.jsx(p,{size:55,className:"bg-amber-100 text-amber-600 dark:bg-amber-500/20 dark:text-amber-100",icon:e.jsx(B,{})});default:return e.jsx("div",{})}},ee=({data:a={}})=>e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Z,{type:a.key}),e.jsx("div",{children:e.jsxs("div",{className:"flex gap-1.5 items-end mb-2",children:[e.jsx("h3",{className:"font-bold leading-none",children:a.value}),e.jsx("p",{className:"font-semibold",children:a.label})]})})]})}),ae=({data:a=[]})=>e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4",children:a.map(s=>e.jsx(ee,{data:s},s.key))}),{Tr:w,Td:se,TBody:te,THead:re,Th:ie}=T,m=$(),oe=[m.accessor("associatedContact",{header:"Associated Contact",cell:a=>a.row.original.contactData.firstName+" "+a.row.original.contactData.lastName}),m.accessor("details",{header:"Details",cell:a=>{const s=a.row.original;return e.jsx(v,{text:s.details,maxLength:30})}}),m.accessor("status",{header:"Status",cell:a=>{const s=a.row.original;return e.jsx(I,{status:s.status})}}),m.accessor("tags",{header:"Tags",cell:a=>{const s=a.row.original;return e.jsx(V,{tags:s.tags})}}),m.accessor("notes",{header:"Notes",cell:a=>{const s=a.row.original.notes;return e.jsx(v,{text:s,maxLength:30})}})],ne=({data:a=[],className:s})=>{const t=A(),r=q({data:a,columns:oe,getCoreRowModel:W()}),d=()=>{t("/app/crm/leads")};return e.jsxs(h,{className:s,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{children:"Leads"}),e.jsx(H,{size:"sm",onClick:d,children:"View All Leads"})]}),e.jsxs(T,{children:[e.jsx(re,{children:r.getHeaderGroups().map(o=>e.jsx(w,{children:o.headers.map(i=>e.jsx(ie,{colSpan:i.colSpan,children:C(i.column.columnDef.header,i.getContext())},i.id))},o.id))}),e.jsx(te,{children:r.getRowModel().rows.map(o=>e.jsx(w,{children:o.getVisibleCells().map(i=>e.jsx(se,{children:C(i.column.columnDef.cell,i.getContext())},i.id))},o.id))})]})]})},u=({label:a,value:s,badgeClass:t,showBadge:r=!0})=>e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx(k,{className:"mt-2.5",innerClass:t}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold",children:s}),e.jsx("p",{children:a})]})]}),ce={chart:{daily:{onGoing:13,finished:9,total:21,series:[{name:"On Going",data:[20,19,18,14,12,10]},{name:"Finished",data:[1,4,8,15,16,18]}],range:["6:00am","9:00am","12:00pm","03:00pm","06:00pm","09:00pm"]},weekly:{onGoing:126,finished:87,total:213,series:[{name:"On Going",data:[45,52,68,84,103,112,126]},{name:"Finished",data:[35,41,62,62,75,81,87]}],range:["21 Jan","22 Jan","23 Jan","24 Jan","25 Jan","26 Jan","27 Jan"]},monthly:{onGoing:270,finished:113,total:383,series:[{name:"On Going",data:[28,52,91,154,227,256,270]},{name:"Finished",data:[22,31,74,88,97,107,113]}],range:["01 Jan","05 Jan","10 Jan","15 Jan","20 Jan","25 Jan","27 Jan"]}}},le=({className:a})=>{const[s,t]=n.useState(["weekly"]),[r,d]=n.useState(ce),[o,i]=n.useState(!1),x=f(c=>c.theme.layout.sideNavCollapse);n.useEffect(()=>{i(!0);const c=setTimeout(()=>i(!1),300);return()=>{clearTimeout(c)}},[r,x]);const l=D();return n.useEffect(()=>{l(P({selectedDate:"month"}))},[s]),e.jsxs(h,{className:a,children:[e.jsxs("div",{className:"flex sm:flex-row flex-col md:items-center justify-between mb-6 gap-4",children:[e.jsx("h4",{children:"Tasks Overview"}),e.jsxs(g,{value:s,size:"sm",onChange:c=>t(c),children:[e.jsx(g.Item,{value:"monthly",children:"Monthly"}),e.jsx(g.Item,{value:"weekly",children:"Weekly"})]})]}),!_(r)&&!o&&r.chart&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{children:e.jsx(u,{showBadge:!1,label:"Total Tasks",value:r.chart[s[0]].total})}),e.jsxs("div",{className:"flex gap-x-6",children:[e.jsx(u,{badgeClass:"bg-indigo-600",label:r.chart[s[0]].series[0].name,value:r.chart[s[0]].onGoing}),e.jsx(u,{badgeClass:"bg-emerald-500",label:r.chart[s[0]].series[1].name,value:r.chart[s[0]].finished})]})]}),e.jsx("div",{children:e.jsx(S,{series:r.chart[s[0]].series,xAxis:r.chart[s[0]].range,type:"bar",customOptions:{colors:[j[0],j[2]],legend:{show:!1}}})})]}),e.jsx(y,{loading:o,type:"cover",children:o&&e.jsx("div",{className:"h-[300px]"})})]})},me=({data:a={labels:[],data:[]}})=>e.jsxs(h,{children:[e.jsx("h4",{children:"Leads"}),e.jsx("div",{className:"mt-6",children:a.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{donutTitle:`${a.data.reduce((s,t)=>s+t,0)}`,donutText:"Leads",series:a.data,customOptions:{labels:a.labels},type:"donut"}),a.data.length===a.labels.length&&e.jsx("div",{className:"mt-6 grid grid-cols-2 gap-4 max-w-[180px] mx-auto",children:a.labels.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{badgeStyle:{backgroundColor:j[t]}}),e.jsx("span",{className:"font-semibold",children:s})]},s))})]})})]});F("crmDashboard",Y);const de=()=>{const a=D(),{statisticData:s,recentLeadsData:t}=f(i=>i.crmDashboard.data.dashboardData),r=f(i=>i.crmDashboard.data.loading);n.useEffect(()=>{d()},[]);const d=()=>{a(b())},o=n.useMemo(()=>{const i=(t==null?void 0:t.filter(l=>l.status==="active").length)||0,x=(t==null?void 0:t.filter(l=>l.status==="deactive").length)||0;return{labels:["Active","Deactive"],data:[i,x]}},[t]);return e.jsx("div",{className:"flex flex-col gap-4 h-full",children:e.jsxs(y,{loading:r,children:[e.jsx(ae,{data:s}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx(le,{className:"col-span-2"}),e.jsx(me,{data:o})]}),e.jsx(ne,{data:t})]})})},Ea=de;export{Ea as default};
